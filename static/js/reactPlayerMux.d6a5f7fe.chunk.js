/*! For license information please see reactPlayerMux.d6a5f7fe.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkshuffle_youtube_playlist=self.webpackChunkshuffle_youtube_playlist||[]).push([[723],{3572:(e,t,n)=>{n.r(t),n.d(t,{MaxResolution:()=>Wc,MediaError:()=>Mc,MinResolution:()=>Vc,RenditionOrder:()=>qc,default:()=>FL,generatePlayerInitTime:()=>fh,playerSoftwareName:()=>NL,playerSoftwareVersion:()=>PL});var i=n(9379),a=n(5544),r=n(3986),o=n(5043),s=n(4467),l=n(675),u=n(6045),c=n(3954),d=n(467),h=n(4765),f=n(436),v=n(2901),m=n(3029),p=n(5501),g=n(9640),y=n(3437),E=Object.create,A=Object.defineProperty,b=Object.getOwnPropertyDescriptor,k=Object.getOwnPropertyNames,T=Object.getPrototypeOf,_=Object.prototype.hasOwnProperty,S=function(e,t){return function(){return e&&(t=e(e=0)),t}},w=function(e,t){return function(){return t||e((t={exports:{}}).exports,t),t.exports}},R=function(e,t,n){return n=null!=e?E(T(e)):{},function(e,t,n,i){if(t&&"object"==typeof t||"function"==typeof t)for(var a,r=k(t),o=0,s=r.length;o<s;o++)a=r[o],!_.call(e,a)&&a!==n&&A(e,a,{get:function(e){return t[e]}.bind(null,a),enumerable:!(i=b(t,a))||i.enumerable});return e}(!t&&e&&e.__esModule?n:A(n,"default",{value:e,enumerable:!0}),e)},L=w((function(e,t){var n;n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t.exports=n}));function I(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):I(e,t)}var D=S((function(){D()}));function C(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}var x=S((function(){})),M=w((function(e,t){var n=Array.prototype.slice;t.exports=function(e,t){for(("length"in e||(e=[e]),e=n.call(e));e.length;){var i=e.shift(),a=t(i);if(a)return a;i.childNodes&&i.childNodes.length&&(e=n.call(i.childNodes).concat(e))}}})),O=w((function(e,t){function n(e,t){if(!I(this,n))return new n(e,t);this.data=e,this.nodeValue=e,this.length=e.length,this.ownerDocument=t||null}D(),t.exports=n,n.prototype.nodeType=8,n.prototype.nodeName="#comment",n.prototype.toString=function(){return"[object Comment]"}})),P=w((function(e,t){function n(e,t){if(!I(this,n))return new n(e);this.data=e||"",this.length=this.data.length,this.ownerDocument=t||null}D(),t.exports=n,n.prototype.type="DOMTextNode",n.prototype.nodeType=3,n.prototype.nodeName="#text",n.prototype.toString=function(){return this.data},n.prototype.replaceData=function(e,t,n){var i=this.data,a=i.substring(0,e),r=i.substring(e+t,i.length);this.data=a+n+r,this.length=this.data.length}})),N=w((function(e,t){t.exports=function(e){var t=this,n=e.type;e.target||(e.target=t),t.listeners||(t.listeners={});var i=t.listeners[n];if(i)return i.forEach((function(n){e.currentTarget=t,"function"==typeof n?n(e):n.handleEvent(e)}));t.parentNode&&t.parentNode.dispatchEvent(e)}})),U=w((function(e,t){t.exports=function(e,t){var n=this;n.listeners||(n.listeners={}),n.listeners[e]||(n.listeners[e]=[]),-1===n.listeners[e].indexOf(t)&&n.listeners[e].push(t)}})),F=w((function(e,t){t.exports=function(e,t){var n=this;if(n.listeners&&n.listeners[e]){var i=n.listeners[e],a=i.indexOf(t);-1!==a&&i.splice(a,1)}}})),B=w((function(e,t){x(),t.exports=i;var n=["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"];function i(e){switch(e.nodeType){case 3:return o(e.data);case 8:return"\x3c!--"+e.data+"--\x3e";default:return function(e){var t=[],s=e.tagName;return"http://www.w3.org/1999/xhtml"===e.namespaceURI&&(s=s.toLowerCase()),t.push("<"+s+function(e){var t=[];for(var n in e)a(e,n)&&t.push({name:n,value:e[n]});for(var i in e._attributes)for(var o in e._attributes[i]){var s=e._attributes[i][o],l=(s.prefix?s.prefix+":":"")+o;t.push({name:l,value:s.value})}return e.className&&t.push({name:"class",value:e.className}),t.length?r(t):""}(e)+function(e){var t=e.dataset,n=[];for(var i in t)n.push({name:"data-"+i,value:t[i]});return n.length?r(n):""}(e)),n.indexOf(s)>-1?t.push(" />"):(t.push(">"),e.childNodes.length?t.push.apply(t,e.childNodes.map(i)):e.textContent||e.innerText?t.push(o(e.textContent||e.innerText)):e.innerHTML&&t.push(e.innerHTML),t.push("</"+s+">")),t.join("")}(e)}}function a(e,t){var n=C(e[t]);return"style"===t&&Object.keys(e.style).length>0||e.hasOwnProperty(t)&&("string"===n||"boolean"===n||"number"===n)&&"nodeName"!==t&&"className"!==t&&"tagName"!==t&&"textContent"!==t&&"innerText"!==t&&"namespaceURI"!==t&&"innerHTML"!==t}function r(e){var t=[];return e.forEach((function(e){var n=e.name,i=e.value;"style"===n&&(i=function(e){if("string"==typeof e)return e;var t="";return Object.keys(e).forEach((function(n){var i=e[n];n=n.replace(/[A-Z]/g,(function(e){return"-"+e.toLowerCase()})),t+=n+":"+i+";"})),t}(i)),t.push(n+'="'+function(e){return o(e).replace(/"/g,"&quot;")}(i)+'"')})),t.length?" "+t.join(" "):""}function o(e){var t="";return"string"==typeof e?t=e:e&&(t=e.toString()),t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}})),H=w((function(e,t){D();var n=M(),i=N(),a=U(),r=F(),o=B(),s="http://www.w3.org/1999/xhtml";function l(e,t,n){if(!I(this,l))return new l(e);var i=void 0===n?s:n||null;this.tagName=i===s?String(e).toUpperCase():e,this.nodeName=this.tagName,this.className="",this.dataset={},this.childNodes=[],this.parentNode=null,this.style={},this.ownerDocument=t||null,this.namespaceURI=i,this._attributes={},"INPUT"===this.tagName&&(this.type="text")}t.exports=l,l.prototype.type="DOMElement",l.prototype.nodeType=1,l.prototype.appendChild=function(e){return e.parentNode&&e.parentNode.removeChild(e),this.childNodes.push(e),e.parentNode=this,e},l.prototype.replaceChild=function(e,t){e.parentNode&&e.parentNode.removeChild(e);var n=this.childNodes.indexOf(t);return t.parentNode=null,this.childNodes[n]=e,e.parentNode=this,t},l.prototype.removeChild=function(e){var t=this.childNodes.indexOf(e);return this.childNodes.splice(t,1),e.parentNode=null,e},l.prototype.insertBefore=function(e,t){e.parentNode&&e.parentNode.removeChild(e);var n=null==t?-1:this.childNodes.indexOf(t);return n>-1?this.childNodes.splice(n,0,e):this.childNodes.push(e),e.parentNode=this,e},l.prototype.setAttributeNS=function(e,t,n){var i=null,a=t,r=t.indexOf(":");(r>-1&&(i=t.substr(0,r),a=t.substr(r+1)),"INPUT"===this.tagName&&"type"===t)?this.type=n:(this._attributes[e]||(this._attributes[e]={}))[a]={value:n,prefix:i}},l.prototype.getAttributeNS=function(e,t){var n=this._attributes[e],i=n&&n[t]&&n[t].value;return"INPUT"===this.tagName&&"type"===t?this.type:"string"!=typeof i?null:i},l.prototype.removeAttributeNS=function(e,t){var n=this._attributes[e];n&&delete n[t]},l.prototype.hasAttributeNS=function(e,t){var n=this._attributes[e];return!!n&&t in n},l.prototype.setAttribute=function(e,t){return this.setAttributeNS(null,e,t)},l.prototype.getAttribute=function(e){return this.getAttributeNS(null,e)},l.prototype.removeAttribute=function(e){return this.removeAttributeNS(null,e)},l.prototype.hasAttribute=function(e){return this.hasAttributeNS(null,e)},l.prototype.removeEventListener=r,l.prototype.addEventListener=a,l.prototype.dispatchEvent=i,l.prototype.focus=function(){},l.prototype.toString=function(){return o(this)},l.prototype.getElementsByClassName=function(e){var t=e.split(" "),i=[];return n(this,(function(e){if(1===e.nodeType){var n=(e.className||"").split(" ");t.every((function(e){return-1!==n.indexOf(e)}))&&i.push(e)}})),i},l.prototype.getElementsByTagName=function(e){e=e.toLowerCase();var t=[];return n(this.childNodes,(function(n){1===n.nodeType&&("*"===e||n.tagName.toLowerCase()===e)&&t.push(n)})),t},l.prototype.contains=function(e){return n(this,(function(t){return e===t}))||!1}})),G=w((function(e,t){D();var n=H();function i(e){if(!I(this,i))return new i;this.childNodes=[],this.parentNode=null,this.ownerDocument=e||null}t.exports=i,i.prototype.type="DocumentFragment",i.prototype.nodeType=11,i.prototype.nodeName="#document-fragment",i.prototype.appendChild=n.prototype.appendChild,i.prototype.replaceChild=n.prototype.replaceChild,i.prototype.removeChild=n.prototype.removeChild,i.prototype.toString=function(){return this.childNodes.map((function(e){return String(e)})).join("")}})),K=w((function(e,t){function n(e){}t.exports=n,n.prototype.initEvent=function(e,t,n){this.type=e,this.bubbles=t,this.cancelable=n},n.prototype.preventDefault=function(){}})),W=w((function(e,t){D();var n=M(),i=O(),a=P(),r=H(),o=G(),s=K(),l=N(),u=U(),c=F();function d(){if(!I(this,d))return new d;this.head=this.createElement("head"),this.body=this.createElement("body"),this.documentElement=this.createElement("html"),this.documentElement.appendChild(this.head),this.documentElement.appendChild(this.body),this.childNodes=[this.documentElement],this.nodeType=9}t.exports=d;var h=d.prototype;h.createTextNode=function(e){return new a(e,this)},h.createElementNS=function(e,t){var n=null===e?null:String(e);return new r(t,this,n)},h.createElement=function(e){return new r(e,this)},h.createDocumentFragment=function(){return new o(this)},h.createEvent=function(e){return new s(e)},h.createComment=function(e){return new i(e,this)},h.getElementById=function(e){e=String(e);var t=n(this.childNodes,(function(t){if(String(t.id)===e)return t}));return t||null},h.getElementsByClassName=r.prototype.getElementsByClassName,h.getElementsByTagName=r.prototype.getElementsByTagName,h.contains=r.prototype.contains,h.removeEventListener=c,h.addEventListener=u,h.dispatchEvent=l})),V=w((function(e,t){var n=W();t.exports=new n})),q=w((function(e,t){var n,i="undefined"!=typeof global?global:"undefined"!=typeof window?window:{},a=V();"undefined"!=typeof document?n=document:(n=i["__GLOBAL_DOCUMENT_CACHE@4"])||(n=i["__GLOBAL_DOCUMENT_CACHE@4"]=a),t.exports=n}));function Y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function j(e,t){if(e){if("string"==typeof e)return Y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Y(e,t)}}function z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,a,r=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(i=n.next()).done)&&(r.push(i.value),!t||r.length!==t);o=!0);}catch(l){s=!0,a=l}finally{try{!o&&null!=n.return&&n.return()}finally{if(s)throw a}}return r}}(e,t)||j(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var X=R(L()),Q=R(L()),Z=R(L()),J={now:function(){var e=Z.default.performance,t=e&&e.timing,n=t&&t.navigationStart,i="number"==typeof n&&"function"==typeof e.now?n+e.now():Date.now();return Math.round(i)}},$=J,ee=function(){var e,t,n;if("function"==typeof(null===(e=Q.default.crypto)||void 0===e?void 0:e.getRandomValues)){n=new Uint8Array(32),Q.default.crypto.getRandomValues(n);for(var i=0;i<32;i++)n[i]=n[i]%16}else{n=[];for(var a=0;a<32;a++)n[a]=16*Math.random()|0}var r=0;t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t="x"===e?n[r]:3&n[r]|8;return r++,t.toString(16)}));var o=$.now(),s=null==o?void 0:o.toString(16).substring(3);return s?t.substring(0,28)+s:t},te=function(){return("000000"+(Math.random()*Math.pow(36,6)<<0).toString(36)).slice(-6)},ne=function(e){if(e&&"undefined"!=typeof e.nodeName)return e.muxId||(e.muxId=te()),e.muxId;var t;try{t=document.querySelector(e)}catch(Uv){}return t&&!t.muxId&&(t.muxId=e),(null==t?void 0:t.muxId)||e},ie=function(e){var t;e&&"undefined"!=typeof e.nodeName?e=ne(t=e):t=document.querySelector(e);var n=t&&t.nodeName?t.nodeName.toLowerCase():"";return[t,e,n]};function ae(e){return function(e){if(Array.isArray(e))return Y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||j(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var re=0,oe=1,se=2,le=3,ue=4,ce=function(e){var t,n,i,a,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,s=e?[console,e]:[console],l=(t=console.trace).bind.apply(t,ae(s)),u=(n=console.info).bind.apply(n,ae(s)),c=(i=console.debug).bind.apply(i,ae(s)),d=(a=console.warn).bind.apply(a,ae(s)),h=(r=console.error).bind.apply(r,ae(s)),f=o;return{trace:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!(f>re))return l.apply(void 0,ae(t))},debug:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!(f>oe))return c.apply(void 0,ae(t))},info:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!(f>se))return u.apply(void 0,ae(t))},warn:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!(f>le))return d.apply(void 0,ae(t))},error:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!(f>ue))return h.apply(void 0,ae(t))},get level(){return f},set level(e){e!==this.level&&(f=null!=e?e:o)}}}("[mux]"),de=R(L());function he(){return"1"===(de.default.doNotTrack||de.default.navigator&&de.default.navigator.doNotTrack)}function fe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ve(e,t){if(!I(e,t))throw new TypeError("Cannot call a class as a function")}function me(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function pe(e,t,n){return t&&me(e.prototype,t),n&&me(e,n),e}function ge(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ye(e){return ye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ye(e)}function Ee(e,t,n){return Ee="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ye(e)););return e}(e,t);if(i){var a=Object.getOwnPropertyDescriptor(i,t);return a.get?a.get.call(n||e):a.value}},Ee(e,t,n||e)}function Ae(e,t){return Ae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ae(e,t)}function be(e,t){return!t||"object"!==C(t)&&"function"!=typeof t?fe(e):t}function ke(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=ye(e);if(t){var a=ye(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return be(this,n)}}D(),x();var Te=function(e){return _e(e)[0]},_e=function(e){if("string"!=typeof e||""===e)return["localhost"];var t,n=(e.match(/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/)||[])[4];return n&&(t=(n.match(/[^\.]+\.[^\.]+$/)||[])[0]),[n,t]},Se=R(L()),we={exists:function(){var e=Se.default.performance;return void 0!==(e&&e.timing)},domContentLoadedEventEnd:function(){var e=Se.default.performance,t=e&&e.timing;return t&&t.domContentLoadedEventEnd},navigationStart:function(){var e=Se.default.performance,t=e&&e.timing;return t&&t.navigationStart}},Re=we;function Le(e,t,n){n=void 0===n?1:n,e[t]=e[t]||0,e[t]+=n}function Ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){ge(e,t,n[t])}))}return e}function De(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}var Ce=["x-request-id","cf-ray","x-amz-cf-id","x-akamai-request-id"],xe=["x-cdn","content-type"].concat(Ce);function Me(e){var t={};return(e=e||"").trim().split(/[\r\n]+/).forEach((function(e){if(e){var n=e.split(": "),i=n.shift();i&&(xe.indexOf(i.toLowerCase())>=0||0===i.toLowerCase().indexOf("x-litix-"))&&(t[i]=n.join(": "))}})),t}function Oe(e){if(e){var t=Ce.find((function(t){return void 0!==e[t]}));return t?e[t]:void 0}}var Pe=function(e){var t={};for(var n in e){var i=e[n];if(-1!==i["DATA-ID"].search("io.litix.data."))t[i["DATA-ID"].replace("io.litix.data.","")]=i.VALUE}return t},Ne=function(e){if(!e)return{};var t=Re.navigationStart(),n=e.loading,i=n?n.start:e.trequest,a=n?n.first:e.tfirst,r=n?n.end:e.tload;return{bytesLoaded:e.total,requestStart:Math.round(t+i),responseStart:Math.round(t+a),responseEnd:Math.round(t+r)}},Ue=function(e){if(e&&"function"==typeof e.getAllResponseHeaders)return Me(e.getAllResponseHeaders())},Fe=function(e,t){if(!e||!e.requestEndDate)return{};var n,i=Te(e.url),a=e.url,r=e.bytesLoaded,o=new Date(e.requestStartDate).getTime(),s=new Date(e.firstByteDate).getTime(),l=new Date(e.requestEndDate).getTime(),u=isNaN(e.duration)?0:e.duration,c="function"==typeof t.getMetricsFor?t.getMetricsFor(e.mediaType).HttpList:t.getDashMetrics().getHttpRequests(e.mediaType);return c.length>0&&(n=Me(c[c.length-1]._responseHeaders||"")),{requestStart:o,requestResponseStart:s,requestResponseEnd:l,requestBytesLoaded:r,requestResponseHeaders:n,requestMediaDuration:u,requestHostname:i,requestUrl:a,requestId:n?Oe(n):void 0}},Be=function(e,t){var n=t.getQualityFor(e),i=t.getCurrentTrackFor(e).bitrateList;return i?{currentLevel:n,renditionWidth:i[n].width||null,renditionHeight:i[n].height||null,renditionBitrate:i[n].bandwidth}:{}},He=function(e){var t;return null===(t=e.match(/.*codecs\*?="(.*)"/))||void 0===t?void 0:t[1]},Ge=function(e){try{var t,n,i=null===(n=e.getVersion)||void 0===n||null===(t=n.call(e))||void 0===t?void 0:t.split(".").map((function(e){return parseInt(e)}))[0];return i}catch(sf){return!1}},Ke=0,We=function(){function e(){ve(this,e),ge(this,"_listeners",void 0)}return pe(e,[{key:"on",value:function(e,t,n){return t._eventEmitterGuid=t._eventEmitterGuid||++Ke,this._listeners=this._listeners||{},this._listeners[e]=this._listeners[e]||[],n&&(t=t.bind(n)),this._listeners[e].push(t),t}},{key:"off",value:function(e,t){var n=this._listeners&&this._listeners[e];n&&n.forEach((function(e,i){e._eventEmitterGuid===t._eventEmitterGuid&&n.splice(i,1)}))}},{key:"one",value:function(e,t,n){var i=this;t._eventEmitterGuid=t._eventEmitterGuid||++Ke;var a=function a(){i.off(e,a),t.apply(n||this,arguments)};a._eventEmitterGuid=t._eventEmitterGuid,this.on(e,a)}},{key:"emit",value:function(e,t){var n=this;if(this._listeners){t=t||{};var i=this._listeners["before*"]||[],a=this._listeners[e]||[],r=this._listeners["after"+e]||[],o=function(t,i){(t=t.slice()).forEach((function(t){t.call(n,{type:e},i)}))};o(i,t),o(a,t),o(r,t)}}}]),e}(),Ve=We,qe=R(L()),Ye=function(){function e(t){var n=this;ve(this,e),ge(this,"_playbackHeartbeatInterval",void 0),ge(this,"_playheadShouldBeProgressing",void 0),ge(this,"pm",void 0),this.pm=t,this._playbackHeartbeatInterval=null,this._playheadShouldBeProgressing=!1,t.on("playing",(function(){n._playheadShouldBeProgressing=!0})),t.on("play",this._startPlaybackHeartbeatInterval.bind(this)),t.on("playing",this._startPlaybackHeartbeatInterval.bind(this)),t.on("adbreakstart",this._startPlaybackHeartbeatInterval.bind(this)),t.on("adplay",this._startPlaybackHeartbeatInterval.bind(this)),t.on("adplaying",this._startPlaybackHeartbeatInterval.bind(this)),t.on("devicewake",this._startPlaybackHeartbeatInterval.bind(this)),t.on("viewstart",this._startPlaybackHeartbeatInterval.bind(this)),t.on("rebufferstart",this._startPlaybackHeartbeatInterval.bind(this)),t.on("pause",this._stopPlaybackHeartbeatInterval.bind(this)),t.on("ended",this._stopPlaybackHeartbeatInterval.bind(this)),t.on("viewend",this._stopPlaybackHeartbeatInterval.bind(this)),t.on("error",this._stopPlaybackHeartbeatInterval.bind(this)),t.on("aderror",this._stopPlaybackHeartbeatInterval.bind(this)),t.on("adpause",this._stopPlaybackHeartbeatInterval.bind(this)),t.on("adended",this._stopPlaybackHeartbeatInterval.bind(this)),t.on("adbreakend",this._stopPlaybackHeartbeatInterval.bind(this)),t.on("seeked",(function(){t.data.player_is_paused?n._stopPlaybackHeartbeatInterval():n._startPlaybackHeartbeatInterval()})),t.on("timeupdate",(function(){null!==n._playbackHeartbeatInterval&&t.emit("playbackheartbeat")})),t.on("devicesleep",(function(e,i){null!==n._playbackHeartbeatInterval&&(qe.default.clearInterval(n._playbackHeartbeatInterval),t.emit("playbackheartbeatend",{viewer_time:i.viewer_time}),n._playbackHeartbeatInterval=null)}))}return pe(e,[{key:"_startPlaybackHeartbeatInterval",value:function(){var e=this;null===this._playbackHeartbeatInterval&&(this.pm.emit("playbackheartbeat"),this._playbackHeartbeatInterval=qe.default.setInterval((function(){e.pm.emit("playbackheartbeat")}),this.pm.playbackHeartbeatTime))}},{key:"_stopPlaybackHeartbeatInterval",value:function(){this._playheadShouldBeProgressing=!1,null!==this._playbackHeartbeatInterval&&(qe.default.clearInterval(this._playbackHeartbeatInterval),this.pm.emit("playbackheartbeatend"),this._playbackHeartbeatInterval=null)}}]),e}(),je=Ye,ze=function e(t){var n=this;ve(this,e),ge(this,"viewErrored",void 0),t.on("viewinit",(function(){n.viewErrored=!1})),t.on("error",(function(e,i){try{var a=t.errorTranslator({player_error_code:i.player_error_code,player_error_message:i.player_error_message,player_error_context:i.player_error_context,player_error_severity:i.player_error_severity,player_error_business_exception:i.player_error_business_exception});a&&(t.data.player_error_code=a.player_error_code||i.player_error_code,t.data.player_error_message=a.player_error_message||i.player_error_message,t.data.player_error_context=a.player_error_context||i.player_error_context,t.data.player_error_severity=a.player_error_severity||i.player_error_severity,t.data.player_error_business_exception=a.player_error_business_exception||i.player_error_business_exception,n.viewErrored=!0)}catch(uf){t.mux.log.warn("Exception in error translator callback.",uf),n.viewErrored=!0}})),t.on("aftererror",(function(){var e,n,i,a,r;null===(e=t.data)||void 0===e||delete e.player_error_code,null===(n=t.data)||void 0===n||delete n.player_error_message,null===(i=t.data)||void 0===i||delete i.player_error_context,null===(a=t.data)||void 0===a||delete a.player_error_severity,null===(r=t.data)||void 0===r||delete r.player_error_business_exception}))},Xe=function(){function e(t){ve(this,e),ge(this,"_watchTimeTrackerLastCheckedTime",void 0),ge(this,"pm",void 0),this.pm=t,this._watchTimeTrackerLastCheckedTime=null,t.on("playbackheartbeat",this._updateWatchTime.bind(this)),t.on("playbackheartbeatend",this._clearWatchTimeState.bind(this))}return pe(e,[{key:"_updateWatchTime",value:function(e,t){var n=t.viewer_time;null===this._watchTimeTrackerLastCheckedTime&&(this._watchTimeTrackerLastCheckedTime=n),Le(this.pm.data,"view_watch_time",n-this._watchTimeTrackerLastCheckedTime),this._watchTimeTrackerLastCheckedTime=n}},{key:"_clearWatchTimeState",value:function(e,t){this._updateWatchTime(e,t),this._watchTimeTrackerLastCheckedTime=null}}]),e}(),Qe=Xe,Ze=function(){function e(t){var n=this;ve(this,e),ge(this,"_playbackTimeTrackerLastPlayheadPosition",void 0),ge(this,"_lastTime",void 0),ge(this,"_isAdPlaying",void 0),ge(this,"_callbackUpdatePlaybackTime",void 0),ge(this,"pm",void 0),this.pm=t,this._playbackTimeTrackerLastPlayheadPosition=-1,this._lastTime=$.now(),this._isAdPlaying=!1,this._callbackUpdatePlaybackTime=null;var i=this._startPlaybackTimeTracking.bind(this);t.on("playing",i),t.on("adplaying",i),t.on("seeked",i);var a=this._stopPlaybackTimeTracking.bind(this);t.on("playbackheartbeatend",a),t.on("seeking",a),t.on("adplaying",(function(){n._isAdPlaying=!0})),t.on("adended",(function(){n._isAdPlaying=!1})),t.on("adpause",(function(){n._isAdPlaying=!1})),t.on("adbreakstart",(function(){n._isAdPlaying=!1})),t.on("adbreakend",(function(){n._isAdPlaying=!1})),t.on("adplay",(function(){n._isAdPlaying=!1})),t.on("viewinit",(function(){n._playbackTimeTrackerLastPlayheadPosition=-1,n._lastTime=$.now(),n._isAdPlaying=!1,n._callbackUpdatePlaybackTime=null}))}return pe(e,[{key:"_startPlaybackTimeTracking",value:function(){null===this._callbackUpdatePlaybackTime&&(this._callbackUpdatePlaybackTime=this._updatePlaybackTime.bind(this),this._playbackTimeTrackerLastPlayheadPosition=this.pm.data.player_playhead_time,this.pm.on("playbackheartbeat",this._callbackUpdatePlaybackTime))}},{key:"_stopPlaybackTimeTracking",value:function(){this._callbackUpdatePlaybackTime&&(this._updatePlaybackTime(),this.pm.off("playbackheartbeat",this._callbackUpdatePlaybackTime),this._callbackUpdatePlaybackTime=null,this._playbackTimeTrackerLastPlayheadPosition=-1)}},{key:"_updatePlaybackTime",value:function(){var e=this.pm.data.player_playhead_time,t=$.now(),n=-1;this._playbackTimeTrackerLastPlayheadPosition>=0&&e>this._playbackTimeTrackerLastPlayheadPosition?n=e-this._playbackTimeTrackerLastPlayheadPosition:this._isAdPlaying&&(n=t-this._lastTime),n>0&&n<=1e3&&Le(this.pm.data,"view_content_playback_time",n),this._playbackTimeTrackerLastPlayheadPosition=e,this._lastTime=t}}]),e}(),Je=Ze,$e=function(){function e(t){ve(this,e),ge(this,"pm",void 0),this.pm=t;var n=this._updatePlayheadTime.bind(this);t.on("playbackheartbeat",n),t.on("playbackheartbeatend",n),t.on("timeupdate",n),t.on("destroy",(function(){t.off("timeupdate",n)}))}return pe(e,[{key:"_updateMaxPlayheadPosition",value:function(){this.pm.data.view_max_playhead_position="undefined"==typeof this.pm.data.view_max_playhead_position?this.pm.data.player_playhead_time:Math.max(this.pm.data.view_max_playhead_position,this.pm.data.player_playhead_time)}},{key:"_updatePlayheadTime",value:function(e,t){var n=this,i=function(){n.pm.currentFragmentPDT&&n.pm.currentFragmentStart&&(n.pm.data.player_program_time=n.pm.currentFragmentPDT+n.pm.data.player_playhead_time-n.pm.currentFragmentStart)};if(t&&t.player_playhead_time)this.pm.data.player_playhead_time=t.player_playhead_time,i(),this._updateMaxPlayheadPosition();else if(this.pm.getPlayheadTime){var a=this.pm.getPlayheadTime();"undefined"!=typeof a&&(this.pm.data.player_playhead_time=a,i(),this._updateMaxPlayheadPosition())}}}]),e}(),et=$e,tt=3e5,nt=function e(t){if(ve(this,e),!t.disableRebufferTracking){var n,i=function(e,t){a(t),n=void 0},a=function(e){if(n){var i=e.viewer_time-n;Le(t.data,"view_rebuffer_duration",i),n=e.viewer_time,t.data.view_rebuffer_duration>tt&&(t.emit("viewend"),t.send("viewend"),t.mux.log.warn("Ending view after rebuffering for longer than ".concat(tt,"ms, future events will be ignored unless a programchange or videochange occurs.")))}t.data.view_watch_time>=0&&t.data.view_rebuffer_count>0&&(t.data.view_rebuffer_frequency=t.data.view_rebuffer_count/t.data.view_watch_time,t.data.view_rebuffer_percentage=t.data.view_rebuffer_duration/t.data.view_watch_time)};t.on("playbackheartbeat",(function(e,t){return a(t)})),t.on("rebufferstart",(function(e,a){n||(Le(t.data,"view_rebuffer_count",1),n=a.viewer_time,t.one("rebufferend",i))})),t.on("viewinit",(function(){n=void 0,t.off("rebufferend",i)}))}},it=function(){function e(t){var n=this;ve(this,e),ge(this,"_lastCheckedTime",void 0),ge(this,"_lastPlayheadTime",void 0),ge(this,"_lastPlayheadTimeUpdatedTime",void 0),ge(this,"_rebuffering",void 0),ge(this,"pm",void 0),this.pm=t,!t.disableRebufferTracking&&!t.disablePlayheadRebufferTracking&&(this._lastCheckedTime=null,this._lastPlayheadTime=null,this._lastPlayheadTimeUpdatedTime=null,t.on("playbackheartbeat",this._checkIfRebuffering.bind(this)),t.on("playbackheartbeatend",this._cleanupRebufferTracker.bind(this)),t.on("seeking",(function(){n._cleanupRebufferTracker(null,{viewer_time:$.now()})})))}return pe(e,[{key:"_checkIfRebuffering",value:function(e,t){if(this.pm.seekingTracker.isSeeking||this.pm.adTracker.isAdBreak||!this.pm.playbackHeartbeat._playheadShouldBeProgressing)this._cleanupRebufferTracker(e,t);else if(null!==this._lastCheckedTime)if(this._lastPlayheadTime===this.pm.data.player_playhead_time){var n=t.viewer_time-this._lastPlayheadTimeUpdatedTime;"number"==typeof this.pm.sustainedRebufferThreshold&&n>=this.pm.sustainedRebufferThreshold&&(this._rebuffering||(this._rebuffering=!0,this.pm.emit("rebufferstart",{viewer_time:this._lastPlayheadTimeUpdatedTime}))),this._lastCheckedTime=t.viewer_time}else this._cleanupRebufferTracker(e,t,!0);else this._prepareRebufferTrackerState(t.viewer_time)}},{key:"_clearRebufferTrackerState",value:function(){this._lastCheckedTime=null,this._lastPlayheadTime=null,this._lastPlayheadTimeUpdatedTime=null}},{key:"_prepareRebufferTrackerState",value:function(e){this._lastCheckedTime=e,this._lastPlayheadTime=this.pm.data.player_playhead_time,this._lastPlayheadTimeUpdatedTime=e}},{key:"_cleanupRebufferTracker",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this._rebuffering)this._rebuffering=!1,this.pm.emit("rebufferend",{viewer_time:t.viewer_time});else{if(null===this._lastCheckedTime)return;var i=this.pm.data.player_playhead_time-this._lastPlayheadTime,a=t.viewer_time-this._lastPlayheadTimeUpdatedTime;"number"==typeof this.pm.minimumRebufferDuration&&i>0&&a-i>this.pm.minimumRebufferDuration&&(this._lastCheckedTime=null,this.pm.emit("rebufferstart",{viewer_time:this._lastPlayheadTimeUpdatedTime}),this.pm.emit("rebufferend",{viewer_time:this._lastPlayheadTimeUpdatedTime+a-i}))}n?this._prepareRebufferTrackerState(t.viewer_time):this._clearRebufferTrackerState()}}]),e}(),at=it,rt=function(){function e(t){var n=this;ve(this,e),ge(this,"NAVIGATION_START",void 0),ge(this,"pm",void 0),this.pm=t,t.on("viewinit",(function(){var e=t.data,i=e.view_id;if(!e.view_program_changed){var a=function(e,a){var r=a.viewer_time;("playing"===e.type&&"undefined"==typeof t.data.view_time_to_first_frame||"adplaying"===e.type&&("undefined"==typeof t.data.view_time_to_first_frame||n._inPrerollPosition()))&&n.calculateTimeToFirstFrame(r||$.now(),i)};t.one("playing",a),t.one("adplaying",a),t.one("viewend",(function(){t.off("playing",a),t.off("adplaying",a)}))}}))}return pe(e,[{key:"_inPrerollPosition",value:function(){return"undefined"==typeof this.pm.data.view_content_playback_time||this.pm.data.view_content_playback_time<=1e3}},{key:"calculateTimeToFirstFrame",value:function(e,t){t===this.pm.data.view_id&&(this.pm.watchTimeTracker._updateWatchTime(null,{viewer_time:e}),this.pm.data.view_time_to_first_frame=this.pm.data.view_watch_time,(this.pm.data.player_autoplay_on||this.pm.data.video_is_autoplay)&&this.NAVIGATION_START&&(this.pm.data.view_aggregate_startup_time=this.pm.data.view_start+this.pm.data.view_watch_time-this.NAVIGATION_START))}}]),e}(),ot=rt,st=function e(t){var n=this;ve(this,e),ge(this,"_lastPlayerHeight",void 0),ge(this,"_lastPlayerWidth",void 0),ge(this,"_lastPlayheadPosition",void 0),ge(this,"_lastSourceHeight",void 0),ge(this,"_lastSourceWidth",void 0),t.on("viewinit",(function(){n._lastPlayheadPosition=-1}));["pause","rebufferstart","seeking","error","adbreakstart","hb","renditionchange","orientationchange","viewend"].forEach((function(e){t.on(e,(function(){if(n._lastPlayheadPosition>=0&&t.data.player_playhead_time>=0&&n._lastPlayerWidth>=0&&n._lastSourceWidth>0&&n._lastPlayerHeight>=0&&n._lastSourceHeight>0){var e=t.data.player_playhead_time-n._lastPlayheadPosition;if(e<0)return void(n._lastPlayheadPosition=-1);var i=Math.min(n._lastPlayerWidth/n._lastSourceWidth,n._lastPlayerHeight/n._lastSourceHeight),a=Math.max(0,i-1),r=Math.max(0,1-i);t.data.view_max_upscale_percentage=Math.max(t.data.view_max_upscale_percentage||0,a),t.data.view_max_downscale_percentage=Math.max(t.data.view_max_downscale_percentage||0,r),Le(t.data,"view_total_content_playback_time",e),Le(t.data,"view_total_upscaling",a*e),Le(t.data,"view_total_downscaling",r*e)}n._lastPlayheadPosition=-1}))})),["playing","hb","renditionchange","orientationchange"].forEach((function(e){t.on(e,(function(){n._lastPlayheadPosition=t.data.player_playhead_time,n._lastPlayerWidth=t.data.player_width,n._lastPlayerHeight=t.data.player_height,n._lastSourceWidth=t.data.video_source_width,n._lastSourceHeight=t.data.video_source_height}))}))},lt=function e(t){var n=this;ve(this,e),ge(this,"isSeeking",void 0),this.isSeeking=!1;var i=-1,a=function(){var e=$.now(),a=(t.data.viewer_time||e)-(i||e);Le(t.data,"view_seek_duration",a),t.data.view_max_seek_time=Math.max(t.data.view_max_seek_time||0,a),n.isSeeking=!1,i=-1};t.on("seeking",(function(e,r){Object.assign(t.data,r),n.isSeeking&&r.viewer_time-i<=2e3?i=r.viewer_time:(n.isSeeking&&a(),n.isSeeking=!0,i=r.viewer_time,Le(t.data,"view_seek_count",1),t.send("seeking"))})),t.on("seeked",(function(){a()})),t.on("viewend",(function(){n.isSeeking&&(a(),t.send("seeked")),n.isSeeking=!1,i=-1}))},ut=function(e,t){e.push(t),e.sort((function(e,t){return e.viewer_time-t.viewer_time}))},ct=["adbreakstart","adrequest","adresponse","adplay","adplaying","adpause","adended","adbreakend","aderror","adclicked","adskipped"],dt=function(){function e(t){var n=this;ve(this,e),ge(this,"_adHasPlayed",void 0),ge(this,"_adRequests",void 0),ge(this,"_adResponses",void 0),ge(this,"_currentAdRequestNumber",void 0),ge(this,"_currentAdResponseNumber",void 0),ge(this,"_prerollPlayTime",void 0),ge(this,"_wouldBeNewAdPlay",void 0),ge(this,"isAdBreak",void 0),ge(this,"pm",void 0),this.pm=t,t.on("viewinit",(function(){n.isAdBreak=!1,n._currentAdRequestNumber=0,n._currentAdResponseNumber=0,n._adRequests=[],n._adResponses=[],n._adHasPlayed=!1,n._wouldBeNewAdPlay=!0,n._prerollPlayTime=void 0})),ct.forEach((function(e){return t.on(e,n._updateAdData.bind(n))}));var i=function(){n.isAdBreak=!1};t.on("adbreakstart",(function(){n.isAdBreak=!0})),t.on("play",i),t.on("playing",i),t.on("viewend",i),t.on("adrequest",(function(e,i){i=Object.assign({ad_request_id:"generatedAdRequestId"+n._currentAdRequestNumber++},i),ut(n._adRequests,i),Le(t.data,"view_ad_request_count"),n.inPrerollPosition()&&(t.data.view_preroll_requested=!0,n._adHasPlayed||Le(t.data,"view_preroll_request_count"))})),t.on("adresponse",(function(e,i){i=Object.assign({ad_request_id:"generatedAdRequestId"+n._currentAdResponseNumber++},i),ut(n._adResponses,i);var a=n.findAdRequest(i.ad_request_id);a&&Le(t.data,"view_ad_request_time",Math.max(0,i.viewer_time-a.viewer_time))})),t.on("adplay",(function(e,i){n._adHasPlayed=!0,n._wouldBeNewAdPlay&&(n._wouldBeNewAdPlay=!1,Le(t.data,"view_ad_played_count")),n.inPrerollPosition()&&!t.data.view_preroll_played&&(t.data.view_preroll_played=!0,n._adRequests.length>0&&(t.data.view_preroll_request_time=Math.max(0,i.viewer_time-n._adRequests[0].viewer_time)),t.data.view_start&&(t.data.view_startup_preroll_request_time=Math.max(0,i.viewer_time-t.data.view_start)),n._prerollPlayTime=i.viewer_time)})),t.on("adplaying",(function(e,i){n.inPrerollPosition()&&"undefined"==typeof t.data.view_preroll_load_time&&"undefined"!=typeof n._prerollPlayTime&&(t.data.view_preroll_load_time=i.viewer_time-n._prerollPlayTime,t.data.view_startup_preroll_load_time=i.viewer_time-n._prerollPlayTime)})),t.on("adclicked",(function(e,i){n._wouldBeNewAdPlay||Le(t.data,"view_ad_clicked_count")})),t.on("adskipped",(function(e,i){n._wouldBeNewAdPlay||Le(t.data,"view_ad_skipped_count")})),t.on("adended",(function(){n._wouldBeNewAdPlay=!0})),t.on("aderror",(function(){n._wouldBeNewAdPlay=!0}))}return pe(e,[{key:"inPrerollPosition",value:function(){return"undefined"==typeof this.pm.data.view_content_playback_time||this.pm.data.view_content_playback_time<=1e3}},{key:"findAdRequest",value:function(e){for(var t=0;t<this._adRequests.length;t++)if(this._adRequests[t].ad_request_id===e)return this._adRequests[t]}},{key:"_updateAdData",value:function(e,t){if(this.inPrerollPosition()){if(!this.pm.data.view_preroll_ad_tag_hostname&&t.ad_tag_url){var n=z(_e(t.ad_tag_url),2),i=n[0],a=n[1];this.pm.data.view_preroll_ad_tag_domain=a,this.pm.data.view_preroll_ad_tag_hostname=i}if(!this.pm.data.view_preroll_ad_asset_hostname&&t.ad_asset_url){var r=z(_e(t.ad_asset_url),2),o=r[0],s=r[1];this.pm.data.view_preroll_ad_asset_domain=s,this.pm.data.view_preroll_ad_asset_hostname=o}}this.pm.data.ad_asset_url=null==t?void 0:t.ad_asset_url,this.pm.data.ad_tag_url=null==t?void 0:t.ad_tag_url,this.pm.data.ad_creative_id=null==t?void 0:t.ad_creative_id,this.pm.data.ad_id=null==t?void 0:t.ad_id,this.pm.data.ad_universal_id=null==t?void 0:t.ad_universal_id}}]),e}(),ht=dt,ft=R(L()),vt=function e(t){ve(this,e);var n,i,a=function(){t.disableRebufferTracking||n&&(Le(t.data,"view_waiting_rebuffer_duration",$.now()-n),n=!1,ft.default.clearInterval(i))},r=!1,o=function(){r=!1,a()};t.on("waiting",(function(){r&&(t.disableRebufferTracking||(Le(t.data,"view_waiting_rebuffer_count",1),n=$.now(),i=ft.default.setInterval((function(){if(n){var e=$.now();Le(t.data,"view_waiting_rebuffer_duration",e-n),n=e}}),250)))})),t.on("playing",(function(){a(),r=!0})),t.on("pause",o),t.on("seeking",o)},mt=function e(t){var n=this;ve(this,e),ge(this,"lastWallClockTime",void 0);var i=function(){n.lastWallClockTime=$.now(),t.on("before*",a)},a=function(e){var i=$.now(),a=n.lastWallClockTime;n.lastWallClockTime=i,i-a>3e4&&(t.emit("devicesleep",{viewer_time:a}),Object.assign(t.data,{viewer_time:a}),t.send("devicesleep"),t.emit("devicewake",{viewer_time:i}),Object.assign(t.data,{viewer_time:i}),t.send("devicewake"))};t.one("playbackheartbeat",i),t.on("playbackheartbeatend",(function(){t.off("before*",a),t.one("playbackheartbeat",i)}))},pt=R(L()),gt=function(){var e=function(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var i in n)t[i]=n[i]}return t};function t(n){function i(t,a,r){var o;if("undefined"!=typeof document){if(arguments.length>1){if("number"==typeof(r=e({path:"/"},i.defaults,r)).expires){var s=new Date;s.setMilliseconds(s.getMilliseconds()+864e5*r.expires),r.expires=s}try{o=JSON.stringify(a),/^[\{\[]/.test(o)&&(a=o)}catch(Xh){}return a=n.write?n.write(a,t):encodeURIComponent(String(a)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=(t=(t=encodeURIComponent(String(t))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape),document.cookie=[t,"=",a,r.expires?"; expires="+r.expires.toUTCString():"",r.path?"; path="+r.path:"",r.domain?"; domain="+r.domain:"",r.secure?"; secure":""].join("")}t||(o={});for(var l=document.cookie?document.cookie.split("; "):[],u=/(%[0-9A-Z]{2})+/g,c=0;c<l.length;c++){var d=l[c].split("="),h=d.slice(1).join("=");'"'===h.charAt(0)&&(h=h.slice(1,-1));try{var f=d[0].replace(u,decodeURIComponent);if(h=n.read?n.read(h,f):n(h,f)||h.replace(u,decodeURIComponent),this.json)try{h=JSON.parse(h)}catch(Xh){}if(t===f){o=h;break}t||(o[f]=h)}catch(Xh){}}return o}}return i.set=i,i.get=function(e){return i.call(i,e)},i.getJSON=function(){return i.apply({json:!0},[].slice.call(arguments))},i.defaults={},i.remove=function(t,n){i(t,"",e(n,{expires:-1}))},i.withConverter=t,i}return t((function(){}))}(),yt="muxData",Et=function(){var e;try{e=function(e){return e.split("&").reduce((function(e,t){var n=z(t.split("="),2),i=n[0],a=n[1],r=+a,o=a&&r==a?r:a;return e[i]=o,e}),{})}(gt.get(yt)||"")}catch(gm){e={}}return e},At=function(e){try{gt.set(yt,function(e){return Object.entries(e).map((function(e){var t=z(e,2),n=t[0],i=t[1];return"".concat(n,"=").concat(i)})).join("&")}(e),{expires:365})}catch(gm){}},bt=function(){var e=Et();return e.mux_viewer_id=e.mux_viewer_id||ee(),e.msn=e.msn||Math.random(),At(e),{mux_viewer_id:e.mux_viewer_id,mux_sample_number:e.msn}};function kt(e,t){var n=t.beaconCollectionDomain,i=t.beaconDomain;if(n)return"https://"+n;var a=i||"litix.io";return(e=e||"inferred").match(/^[a-z0-9]+$/)?"https://"+e+"."+a:"https://img.litix.io/a.gif"}var Tt=R(L()),_t=function(){var e;switch(St()){case"cellular":e="cellular";break;case"ethernet":e="wired";break;case"wifi":e="wifi";break;case void 0:break;default:e="other"}return e},St=function(){var e=Tt.default.navigator,t=e&&(e.connection||e.mozConnection||e.webkitConnection);return t&&t.type};_t.getConnectionFromAPI=St;var wt=_t,Rt=It({a:"env",b:"beacon",c:"custom",d:"ad",e:"event",f:"experiment",i:"internal",m:"mux",n:"response",p:"player",q:"request",r:"retry",s:"session",t:"timestamp",u:"viewer",v:"video",w:"page",x:"view",y:"sub"}),Lt=It({ad:"ad",af:"affiliate",ag:"aggregate",ap:"api",al:"application",ao:"audio",ar:"architecture",as:"asset",au:"autoplay",av:"average",bi:"bitrate",bn:"brand",br:"break",bw:"browser",by:"bytes",bz:"business",ca:"cached",cb:"cancel",cc:"codec",cd:"code",cg:"category",ch:"changed",ci:"client",ck:"clicked",cl:"canceled",cn:"config",co:"count",ce:"counter",cp:"complete",cq:"creator",cr:"creative",cs:"captions",ct:"content",cu:"current",cx:"connection",cz:"context",dg:"downscaling",dm:"domain",dn:"cdn",do:"downscale",dr:"drm",dp:"dropped",du:"duration",dv:"device",dy:"dynamic",eb:"enabled",ec:"encoding",ed:"edge",en:"end",eg:"engine",em:"embed",er:"error",ep:"experiments",es:"errorcode",et:"errortext",ee:"event",ev:"events",ex:"expires",ez:"exception",fa:"failed",fi:"first",fm:"family",ft:"format",fp:"fps",fq:"frequency",fr:"frame",fs:"fullscreen",ha:"has",hb:"holdback",he:"headers",ho:"host",hn:"hostname",ht:"height",id:"id",ii:"init",in:"instance",ip:"ip",is:"is",ke:"key",la:"language",lb:"labeled",le:"level",li:"live",ld:"loaded",lo:"load",ls:"lists",lt:"latency",ma:"max",md:"media",me:"message",mf:"manifest",mi:"mime",ml:"midroll",mm:"min",mn:"manufacturer",mo:"model",mx:"mux",ne:"newest",nm:"name",no:"number",on:"on",or:"origin",os:"os",pa:"paused",pb:"playback",pd:"producer",pe:"percentage",pf:"played",pg:"program",ph:"playhead",pi:"plugin",pl:"preroll",pn:"playing",po:"poster",pp:"pip",pr:"preload",ps:"position",pt:"part",py:"property",px:"pop",pz:"plan",ra:"rate",rd:"requested",re:"rebuffer",rf:"rendition",rg:"range",rm:"remote",ro:"ratio",rp:"response",rq:"request",rs:"requests",sa:"sample",sd:"skipped",se:"session",sh:"shift",sk:"seek",sm:"stream",so:"source",sq:"sequence",sr:"series",ss:"status",st:"start",su:"startup",sv:"server",sw:"software",sy:"severity",ta:"tag",tc:"tech",te:"text",tg:"target",th:"throughput",ti:"time",tl:"total",to:"to",tt:"title",ty:"type",ug:"upscaling",un:"universal",up:"upscale",ur:"url",us:"user",va:"variant",vd:"viewed",vi:"video",ve:"version",vw:"view",vr:"viewer",wd:"width",wa:"watch",wt:"waiting"});function It(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}function Dt(e){var t={},n={};return Object.keys(e).forEach((function(i){var a=!1;if(e.hasOwnProperty(i)&&void 0!==e[i]){var r=i.split("_"),o=r[0],s=Rt[o];s||(ce.info("Data key word `"+r[0]+"` not expected in "+i),s=o+"_"),r.splice(1).forEach((function(e){"url"===e&&(a=!0),Lt[e]?s+=Lt[e]:Number.isInteger(Number(e))?s+=e:(ce.info("Data key word `"+e+"` not expected in "+i),s+="_"+e+"_")})),a?n[s]=e[i]:t[s]=e[i]}})),Object.assign(t,n)}var Ct=R(L()),xt=R(q()),Mt={maxBeaconSize:300,maxQueueLength:3600,baseTimeBetweenBeacons:1e4,maxPayloadKBSize:500},Ot=["hb","requestcompleted","requestfailed","requestcanceled"],Pt="https://img.litix.io",Nt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._beaconUrl=e||Pt,this._eventQueue=[],this._postInFlight=!1,this._resendAfterPost=!1,this._failureCount=0,this._sendTimeout=!1,this._options=Object.assign({},Mt,t)};Nt.prototype.queueEvent=function(e,t){var n=Object.assign({},t);return(this._eventQueue.length<=this._options.maxQueueLength||"eventrateexceeded"===e)&&(this._eventQueue.push(n),this._sendTimeout||this._startBeaconSending(),this._eventQueue.length<=this._options.maxQueueLength)},Nt.prototype.flushEvents=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e&&1===this._eventQueue.length?this._eventQueue.pop():(this._eventQueue.length&&this._sendBeaconQueue(),this._startBeaconSending())},Nt.prototype.destroy=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.destroyed=!0,e?this._clearBeaconQueue():this.flushEvents(),Ct.default.clearTimeout(this._sendTimeout)},Nt.prototype._clearBeaconQueue=function(){var e=this._eventQueue.length>this._options.maxBeaconSize?this._eventQueue.length-this._options.maxBeaconSize:0,t=this._eventQueue.slice(e);e>0&&Object.assign(t[t.length-1],Dt({mux_view_message:"event queue truncated"}));var n=this._createPayload(t);Ft(this._beaconUrl,n,!0,(function(){}))},Nt.prototype._sendBeaconQueue=function(){var e=this;if(this._postInFlight)this._resendAfterPost=!0;else{var t=this._eventQueue.slice(0,this._options.maxBeaconSize);this._eventQueue=this._eventQueue.slice(this._options.maxBeaconSize),this._postInFlight=!0;var n=this._createPayload(t),i=$.now();Ft(this._beaconUrl,n,!1,(function(n,a){a?(e._eventQueue=t.concat(e._eventQueue),e._failureCount+=1,ce.info("Error sending beacon: "+a)):e._failureCount=0,e._roundTripTime=$.now()-i,e._postInFlight=!1,e._resendAfterPost&&(e._resendAfterPost=!1,e._eventQueue.length>0&&e._sendBeaconQueue())}))}},Nt.prototype._getNextBeaconTime=function(){if(!this._failureCount)return this._options.baseTimeBetweenBeacons;var e=Math.pow(2,this._failureCount-1);return(1+(e*=Math.random()))*this._options.baseTimeBetweenBeacons},Nt.prototype._startBeaconSending=function(){var e=this;Ct.default.clearTimeout(this._sendTimeout),!this.destroyed&&(this._sendTimeout=Ct.default.setTimeout((function(){e._eventQueue.length&&e._sendBeaconQueue(),e._startBeaconSending()}),this._getNextBeaconTime()))},Nt.prototype._createPayload=function(e){var t=this,n={transmission_timestamp:Math.round($.now())};this._roundTripTime&&(n.rtt_ms=Math.round(this._roundTripTime));var i,a,r,o=function(){i=JSON.stringify({metadata:n,events:a||e}),r=i.length/1024},s=function(){return r<=t._options.maxPayloadKBSize};return o(),s()||(ce.info("Payload size is too big ("+r+" kb). Removing unnecessary events."),a=e.filter((function(e){return-1===Ot.indexOf(e.e)})),o()),s()||(ce.info("Payload size still too big ("+r+" kb). Cropping fields.."),a.forEach((function(e){for(var t in e){var n=e[t];"string"==typeof n&&n.length>51200&&(e[t]=n.substring(0,51200))}})),o()),i};var Ut="function"==typeof xt.default.exitPictureInPicture?function(e){return e.length<=57344}:function(e){return!1},Ft=function(e,t,n,i){if(n&&navigator&&navigator.sendBeacon&&navigator.sendBeacon(e,t))i();else if(Ct.default.fetch)Ct.default.fetch(e,{method:"POST",body:t,headers:{"Content-Type":"text/plain"},keepalive:Ut(t)}).then((function(e){return i(null,e.ok?null:"Error")})).catch((function(e){return i(null,e)}));else{if(Ct.default.XMLHttpRequest){var a=new Ct.default.XMLHttpRequest;return a.onreadystatechange=function(){if(4===a.readyState)return i(null,200!==a.status?"error":void 0)},a.open("POST",e),a.setRequestHeader("Content-Type","text/plain"),void a.send(t)}i()}},Bt=Nt,Ht=["env_key","view_id","view_sequence_number","player_sequence_number","beacon_domain","player_playhead_time","viewer_time","mux_api_version","event","video_id","player_instance_id","player_error_code","player_error_message","player_error_context","player_error_severity","player_error_business_exception"],Gt=["adplay","adplaying","adpause","adfirstquartile","admidpoint","adthirdquartile","adended","adresponse","adrequest"],Kt=["ad_id","ad_creative_id","ad_universal_id"],Wt=["viewstart","error","ended","viewend"],Vt=function(){function e(t,n){var i,a,r,o,s,l,u,c,d,h,f,v,m,p,g,y=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};ve(this,e),ge(this,"mux",void 0),ge(this,"envKey",void 0),ge(this,"options",void 0),ge(this,"eventQueue",void 0),ge(this,"sampleRate",void 0),ge(this,"disableCookies",void 0),ge(this,"respectDoNotTrack",void 0),ge(this,"previousBeaconData",void 0),ge(this,"lastEventTime",void 0),ge(this,"rateLimited",void 0),ge(this,"pageLevelData",void 0),ge(this,"viewerData",void 0),this.mux=t,this.envKey=n,this.options=y,this.previousBeaconData=null,this.lastEventTime=0,this.rateLimited=!1,this.eventQueue=new Bt(kt(this.envKey,this.options)),this.sampleRate=null!==(m=this.options.sampleRate)&&void 0!==m?m:1,this.disableCookies=null!==(p=this.options.disableCookies)&&void 0!==p&&p,this.respectDoNotTrack=null!==(g=this.options.respectDoNotTrack)&&void 0!==g&&g,this.previousBeaconData=null,this.lastEventTime=0,this.rateLimited=!1,this.pageLevelData={mux_api_version:this.mux.API_VERSION,mux_embed:this.mux.NAME,mux_embed_version:this.mux.VERSION,viewer_application_name:null===(i=this.options.platform)||void 0===i?void 0:i.name,viewer_application_version:null===(a=this.options.platform)||void 0===a?void 0:a.version,viewer_application_engine:null===(r=this.options.platform)||void 0===r?void 0:r.layout,viewer_device_name:null===(o=this.options.platform)||void 0===o?void 0:o.product,viewer_device_category:"",viewer_device_manufacturer:null===(s=this.options.platform)||void 0===s?void 0:s.manufacturer,viewer_os_family:null===(u=this.options.platform)||void 0===u||null===(l=u.os)||void 0===l?void 0:l.family,viewer_os_architecture:null===(d=this.options.platform)||void 0===d||null===(c=d.os)||void 0===c?void 0:c.architecture,viewer_os_version:null===(f=this.options.platform)||void 0===f||null===(h=f.os)||void 0===h?void 0:h.version,viewer_connection_type:wt(),page_url:null===pt.default||void 0===pt.default||null===(v=pt.default.location)||void 0===v?void 0:v.href},this.viewerData=this.disableCookies?{}:bt()}return pe(e,[{key:"send",value:function(e,t){if(e&&null!=t&&t.view_id){if(this.respectDoNotTrack&&he())return ce.info("Not sending `"+e+"` because Do Not Track is enabled");if(!t||"object"!=typeof t)return ce.error("A data object was expected in send() but was not provided");var n=this.disableCookies?{}:function(){var e=Et(),t=$.now();return e.session_start&&(e.sst=e.session_start,delete e.session_start),e.session_id&&(e.sid=e.session_id,delete e.session_id),e.session_expires&&(e.sex=e.session_expires,delete e.session_expires),(!e.sex||e.sex<t)&&(e.sid=ee(),e.sst=t),e.sex=t+15e5,At(e),{session_id:e.sid,session_start:e.sst,session_expires:e.sex}}(),i=De(Ie({},this.pageLevelData,t,n,this.viewerData),{event:e,env_key:this.envKey});i.user_id&&(i.viewer_user_id=i.user_id,delete i.user_id);var a,r=(null!==(a=i.mux_sample_number)&&void 0!==a?a:0)>=this.sampleRate,o=Dt(this._deduplicateBeaconData(e,i));if(this.lastEventTime=this.mux.utils.now(),r)return ce.info("Not sending event due to sample rate restriction",e,i,o);if(this.envKey||ce.info("Missing environment key (envKey) - beacons will be dropped if the video source is not a valid mux video URL",e,i,o),!this.rateLimited)if(ce.info("Sending event",e,i,o),this.rateLimited=!this.eventQueue.queueEvent(e,o),this.mux.WINDOW_UNLOADING&&"viewend"===e)this.eventQueue.destroy(!0);else if(this.mux.WINDOW_HIDDEN&&"hb"===e?this.eventQueue.flushEvents(!0):Wt.indexOf(e)>=0&&this.eventQueue.flushEvents(),this.rateLimited)return i.event="eventrateexceeded",o=Dt(i),this.eventQueue.queueEvent(i.event,o),ce.error("Beaconing disabled due to rate limit.")}}},{key:"destroy",value:function(){this.eventQueue.destroy(!1)}},{key:"_deduplicateBeaconData",value:function(e,t){var n=this,i={},a=t.view_id;if("-1"===a||"viewstart"===e||"viewend"===e||!this.previousBeaconData||this.mux.utils.now()-this.lastEventTime>=6e5)i=Ie({},t),a&&(this.previousBeaconData=i),a&&"viewend"===e&&(this.previousBeaconData=null);else{var r=0===e.indexOf("request");Object.entries(t).forEach((function(t){var a=z(t,2),o=a[0],s=a[1];n.previousBeaconData&&(s!==n.previousBeaconData[o]||Ht.indexOf(o)>-1||n.objectHasChanged(r,o,s,n.previousBeaconData[o])||n.eventRequiresKey(e,o))&&(i[o]=s,n.previousBeaconData[o]=s)}))}return i}},{key:"objectHasChanged",value:function(e,t,n,i){return!(!e||0!==t.indexOf("request_"))&&("request_response_headers"===t||"object"!=typeof n||"object"!=typeof i||Object.keys(n||{}).length!==Object.keys(i||{}).length)}},{key:"eventRequiresKey",value:function(e,t){return!!("renditionchange"===e&&0===t.indexOf("video_source_")||Kt.includes(t)&&Gt.includes(e))}}]),e}(),qt=function e(t){ve(this,e);var n=0,i=0,a=0,r=0,o=0,s=0,l=0;t.on("requestcompleted",(function(e,s){var l,u,c=s.request_start,d=s.request_response_start,h=s.request_response_end,f=s.request_bytes_loaded;if(r++,d?(l=d-(null!=c?c:0),u=(null!=h?h:0)-d):u=(null!=h?h:0)-(null!=c?c:0),u>0&&f&&f>0){var v=f/u*8e3;o++,i+=f,a+=u,t.data.view_min_request_throughput=Math.min(t.data.view_min_request_throughput||1/0,v),t.data.view_average_request_throughput=i/a*8e3,t.data.view_request_count=r,l>0&&(n+=l,t.data.view_max_request_latency=Math.max(t.data.view_max_request_latency||0,l),t.data.view_average_request_latency=n/o)}})),t.on("requestfailed",(function(e,n){r++,s++,t.data.view_request_count=r,t.data.view_request_failed_count=s})),t.on("requestcanceled",(function(e,n){r++,l++,t.data.view_request_count=r,t.data.view_request_canceled_count=l}))},Yt=function e(t){var n=this;ve(this,e),ge(this,"_lastEventTime",void 0),t.on("before*",(function(e,i){var a=i.viewer_time,r=$.now(),o=n._lastEventTime;if(n._lastEventTime=r,o&&r-o>36e5){var s=Object.keys(t.data).reduce((function(e,n){return 0===n.indexOf("video_")?Object.assign(e,ge({},n,t.data[n])):e}),{});t.mux.log.info("Received event after at least an hour inactivity, creating a new view");var l=t.playbackHeartbeat._playheadShouldBeProgressing;t._resetView(Object.assign({viewer_time:a},s)),t.playbackHeartbeat._playheadShouldBeProgressing=l,t.playbackHeartbeat._playheadShouldBeProgressing&&"play"!==e.type&&"adbreakstart"!==e.type&&(t.emit("play",{viewer_time:a}),"playing"!==e.type&&t.emit("playing",{viewer_time:a}))}}))},jt=["viewstart","ended","loadstart","pause","play","playing","ratechange","waiting","adplay","adpause","adended","aderror","adplaying","adrequest","adresponse","adbreakstart","adbreakend","adfirstquartile","admidpoint","adthirdquartile","rebufferstart","rebufferend","seeked","error","hb","requestcompleted","requestfailed","requestcanceled","renditionchange"],zt=new Set(["requestcompleted","requestfailed","requestcanceled"]),Xt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ae(e,t)}(n,e);var t=ke(n);function n(e,i,a){var r;ve(this,n),ge(fe(r=t.call(this)),"DOM_CONTENT_LOADED_EVENT_END",void 0),ge(fe(r),"NAVIGATION_START",void 0),ge(fe(r),"_destroyed",void 0),ge(fe(r),"_heartBeatTimeout",void 0),ge(fe(r),"adTracker",void 0),ge(fe(r),"dashjs",void 0),ge(fe(r),"data",void 0),ge(fe(r),"disablePlayheadRebufferTracking",void 0),ge(fe(r),"disableRebufferTracking",void 0),ge(fe(r),"errorTracker",void 0),ge(fe(r),"errorTranslator",void 0),ge(fe(r),"emitTranslator",void 0),ge(fe(r),"getAdData",void 0),ge(fe(r),"getPlayheadTime",void 0),ge(fe(r),"getStateData",void 0),ge(fe(r),"stateDataTranslator",void 0),ge(fe(r),"hlsjs",void 0),ge(fe(r),"id",void 0),ge(fe(r),"longResumeTracker",void 0),ge(fe(r),"minimumRebufferDuration",void 0),ge(fe(r),"mux",void 0),ge(fe(r),"playbackEventDispatcher",void 0),ge(fe(r),"playbackHeartbeat",void 0),ge(fe(r),"playbackHeartbeatTime",void 0),ge(fe(r),"playheadTime",void 0),ge(fe(r),"seekingTracker",void 0),ge(fe(r),"sustainedRebufferThreshold",void 0),ge(fe(r),"watchTimeTracker",void 0),ge(fe(r),"currentFragmentPDT",void 0),ge(fe(r),"currentFragmentStart",void 0),r.DOM_CONTENT_LOADED_EVENT_END=Re.domContentLoadedEventEnd(),r.NAVIGATION_START=Re.navigationStart();var o={debug:!1,minimumRebufferDuration:250,sustainedRebufferThreshold:1e3,playbackHeartbeatTime:25,beaconDomain:"litix.io",sampleRate:1,disableCookies:!1,respectDoNotTrack:!1,disableRebufferTracking:!1,disablePlayheadRebufferTracking:!1,errorTranslator:function(e){return e},emitTranslator:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t},stateDataTranslator:function(e){return e}};r.mux=e,r.id=i,null!=a&&a.beaconDomain&&r.mux.log.warn("The `beaconDomain` setting has been deprecated in favor of `beaconCollectionDomain`. Please change your integration to use `beaconCollectionDomain` instead of `beaconDomain`."),(a=Object.assign(o,a)).data=a.data||{},a.data.property_key&&(a.data.env_key=a.data.property_key,delete a.data.property_key),ce.level=a.debug?oe:le,r.getPlayheadTime=a.getPlayheadTime,r.getStateData=a.getStateData||function(){return{}},r.getAdData=a.getAdData||function(){},r.minimumRebufferDuration=a.minimumRebufferDuration,r.sustainedRebufferThreshold=a.sustainedRebufferThreshold,r.playbackHeartbeatTime=a.playbackHeartbeatTime,r.disableRebufferTracking=a.disableRebufferTracking,r.disableRebufferTracking&&r.mux.log.warn("Disabling rebuffer tracking. This should only be used in specific circumstances as a last resort when your player is known to unreliably track rebuffering."),r.disablePlayheadRebufferTracking=a.disablePlayheadRebufferTracking,r.errorTranslator=a.errorTranslator,r.emitTranslator=a.emitTranslator,r.stateDataTranslator=a.stateDataTranslator,r.playbackEventDispatcher=new Vt(e,a.data.env_key,a),r.data={player_instance_id:ee(),mux_sample_rate:a.sampleRate,beacon_domain:a.beaconCollectionDomain||a.beaconDomain},r.data.view_sequence_number=1,r.data.player_sequence_number=1;var s=function(){"undefined"==typeof this.data.view_start&&(this.data.view_start=this.mux.utils.now(),this.emit("viewstart"))}.bind(fe(r));if(r.on("viewinit",(function(e,t){this._resetVideoData(),this._resetViewData(),this._resetErrorData(),this._updateStateData(),Object.assign(this.data,t),this._initializeViewData(),this.one("play",s),this.one("adbreakstart",s)})),r.on("videochange",(function(e,t){this._resetView(t)})),r.on("programchange",(function(e,t){this.data.player_is_paused&&this.mux.log.warn("The `programchange` event is intended to be used when the content changes mid playback without the video source changing, however the video is not currently playing. If the video source is changing please use the videochange event otherwise you will lose startup time information."),this._resetView(Object.assign(t,{view_program_changed:!0})),s(),this.emit("play"),this.emit("playing")})),r.on("fragmentchange",(function(e,t){this.currentFragmentPDT=t.currentFragmentPDT,this.currentFragmentStart=t.currentFragmentStart})),r.on("destroy",r.destroy),"undefined"!=typeof window&&"function"==typeof window.addEventListener&&"function"==typeof window.removeEventListener){var l=function(){var e="undefined"!=typeof r.data.view_start;r.mux.WINDOW_HIDDEN="hidden"===document.visibilityState,e&&r.mux.WINDOW_HIDDEN&&(r.data.player_is_paused||r.emit("hb"))};window.addEventListener("visibilitychange",l,!1);var u=function(e){e.persisted||r.destroy()};window.addEventListener("pagehide",u,!1),r.on("destroy",(function(){window.removeEventListener("visibilitychange",l),window.removeEventListener("pagehide",u)}))}r.on("playerready",(function(e,t){Object.assign(this.data,t)})),jt.forEach((function(e){r.on(e,(function(t,n){0!==e.indexOf("ad")&&this._updateStateData(),Object.assign(this.data,n),this._sanitizeData()})),r.on("after"+e,(function(){("error"!==e||this.errorTracker.viewErrored)&&this.send(e)}))})),r.on("viewend",(function(e,t){Object.assign(r.data,t)}));return r.one("playerready",(function(e){var t=this.mux.utils.now();this.data.player_init_time&&(this.data.player_startup_time=t-this.data.player_init_time),!this.mux.PLAYER_TRACKED&&this.NAVIGATION_START&&(this.mux.PLAYER_TRACKED=!0,(this.data.player_init_time||this.DOM_CONTENT_LOADED_EVENT_END)&&(this.data.page_load_time=Math.min(this.data.player_init_time||1/0,this.DOM_CONTENT_LOADED_EVENT_END||1/0)-this.NAVIGATION_START)),this.send("playerready"),delete this.data.player_startup_time,delete this.data.page_load_time})),r.longResumeTracker=new Yt(fe(r)),r.errorTracker=new ze(fe(r)),new mt(fe(r)),r.seekingTracker=new lt(fe(r)),r.playheadTime=new et(fe(r)),r.playbackHeartbeat=new je(fe(r)),new st(fe(r)),r.watchTimeTracker=new Qe(fe(r)),new Je(fe(r)),r.adTracker=new ht(fe(r)),new at(fe(r)),new nt(fe(r)),new ot(fe(r)),new vt(fe(r)),new qt(fe(r)),a.hlsjs&&r.addHLSJS(a),a.dashjs&&r.addDashJS(a),r.emit("viewinit",a.data),r}return pe(n,[{key:"emit",value:function(e,t){var i,a=Object.assign({viewer_time:this.mux.utils.now()},t),r=[e,a];if(this.emitTranslator)try{r=this.emitTranslator(e,a)}catch(Qh){this.mux.log.warn("Exception in emit translator callback.",Qh)}null!=r&&r.length&&(i=Ee(ye(n.prototype),"emit",this)).call.apply(i,[this].concat(ae(r)))}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,"undefined"!=typeof this.data.view_start&&(this.emit("viewend"),this.send("viewend")),this.playbackEventDispatcher.destroy(),this.removeHLSJS(),this.removeDashJS(),window.clearTimeout(this._heartBeatTimeout))}},{key:"send",value:function(e){if(this.data.view_id){var t=Object.assign({},this.data);if(void 0===t.video_source_is_live&&(t.player_source_duration===1/0||t.video_source_duration===1/0?t.video_source_is_live=!0:(t.player_source_duration>0||t.video_source_duration>0)&&(t.video_source_is_live=!1)),t.video_source_is_live||["player_program_time","player_manifest_newest_program_time","player_live_edge_program_time","player_program_time","video_holdback","video_part_holdback","video_target_duration","video_part_target_duration"].forEach((function(e){t[e]=void 0})),t.video_source_url=t.video_source_url||t.player_source_url,t.video_source_url){var n=z(_e(t.video_source_url),2),i=n[0],a=n[1];t.video_source_domain=a,t.video_source_hostname=i}delete t.ad_request_id,this.playbackEventDispatcher.send(e,t),this.data.view_sequence_number++,this.data.player_sequence_number++,zt.has(e)||this._restartHeartBeat(),"viewend"===e&&delete this.data.view_id}}},{key:"_resetView",value:function(e){this.emit("viewend"),this.send("viewend"),this.emit("viewinit",e)}},{key:"_updateStateData",value:function(){var e=this.getStateData();if("function"==typeof this.stateDataTranslator)try{e=this.stateDataTranslator(e)}catch(sf){this.mux.log.warn("Exception in stateDataTranslator translator callback.",sf)}Object.assign(this.data,e),this.playheadTime._updatePlayheadTime(),this._sanitizeData()}},{key:"_sanitizeData",value:function(){var e=this;["player_width","player_height","video_source_width","video_source_height","player_playhead_time","video_source_bitrate"].forEach((function(t){var n=parseInt(e.data[t],10);e.data[t]=isNaN(n)?void 0:n}));["player_source_url","video_source_url"].forEach((function(t){if(e.data[t]){var n=e.data[t].toLowerCase();(0===n.indexOf("data:")||0===n.indexOf("blob:"))&&(e.data[t]="MSE style URL")}}))}},{key:"_resetVideoData",value:function(){var e=this;Object.keys(this.data).forEach((function(t){0===t.indexOf("video_")&&delete e.data[t]}))}},{key:"_resetViewData",value:function(){var e=this;Object.keys(this.data).forEach((function(t){0===t.indexOf("view_")&&delete e.data[t]})),this.data.view_sequence_number=1}},{key:"_resetErrorData",value:function(){delete this.data.player_error_code,delete this.data.player_error_message,delete this.data.player_error_context,delete this.data.player_error_severity,delete this.data.player_error_business_exception}},{key:"_initializeViewData",value:function(){var e=this,t=this.data.view_id=ee(),n=function(){t===e.data.view_id&&Le(e.data,"player_view_count",1)};this.data.player_is_paused?this.one("play",n):n()}},{key:"_restartHeartBeat",value:function(){var e=this;window.clearTimeout(this._heartBeatTimeout),this._heartBeatTimeout=window.setTimeout((function(){e.data.player_is_paused||e.emit("hb")}),1e4)}},{key:"addHLSJS",value:function(e){e.hlsjs?this.hlsjs?this.mux.log.warn("An instance of HLS.js is already being monitored for this player."):(this.hlsjs=e.hlsjs,function(e,t,n){var i=arguments.length>4?arguments[4]:void 0,a=e.log,r=e.utils.secondsToMs,o=function(e){var t,n=parseInt(i.version);return 1===n&&null!==e.programDateTime&&(t=e.programDateTime),0===n&&null!==e.pdt&&(t=e.pdt),t};if(Re.exists()){var s=function(n,i){return e.emit(t,n,i)},l=function(e,t){var n=t.levels,i=t.audioTracks,a=t.url,r=t.stats,o=t.networkDetails,l=t.sessionData,u={},c={};n.forEach((function(e,t){u[t]={width:e.width,height:e.height,bitrate:e.bitrate,attrs:e.attrs}})),i.forEach((function(e,t){c[t]={name:e.name,language:e.lang,bitrate:e.bitrate}}));var d=Ne(r),h=d.bytesLoaded,f=d.requestStart,v=d.responseStart,m=d.responseEnd;s("requestcompleted",De(Ie({},Pe(l)),{request_event_type:e,request_bytes_loaded:h,request_start:f,request_response_start:v,request_response_end:m,request_type:"manifest",request_hostname:Te(a),request_response_headers:Ue(o),request_rendition_lists:{media:u,audio:c,video:{}}}))};n.on(i.Events.MANIFEST_LOADED,l);var u=function(e,t){var n=t.details,i=t.level,a=t.networkDetails,l=t.stats,u=Ne(l),c=u.bytesLoaded,d=u.requestStart,h=u.responseStart,f=u.responseEnd,v=n.fragments[n.fragments.length-1],m=o(v)+r(v.duration);s("requestcompleted",{request_event_type:e,request_bytes_loaded:c,request_start:d,request_response_start:h,request_response_end:f,request_current_level:i,request_type:"manifest",request_hostname:Te(n.url),request_response_headers:Ue(a),video_holdback:n.holdBack&&r(n.holdBack),video_part_holdback:n.partHoldBack&&r(n.partHoldBack),video_part_target_duration:n.partTarget&&r(n.partTarget),video_target_duration:n.targetduration&&r(n.targetduration),video_source_is_live:n.live,player_manifest_newest_program_time:isNaN(m)?void 0:m})};n.on(i.Events.LEVEL_LOADED,u);var c=function(e,t){var n=t.details,i=t.networkDetails,a=t.stats,r=Ne(a),o=r.bytesLoaded,l=r.requestStart,u=r.responseStart,c=r.responseEnd;s("requestcompleted",{request_event_type:e,request_bytes_loaded:o,request_start:l,request_response_start:u,request_response_end:c,request_type:"manifest",request_hostname:Te(n.url),request_response_headers:Ue(i)})};n.on(i.Events.AUDIO_TRACK_LOADED,c);var d=function(e,t){var i=t.stats,a=t.networkDetails,r=t.frag;i=i||r.stats;var o=Ne(i),l=o.bytesLoaded,u=o.requestStart,c=o.responseStart,d=o.responseEnd,h=a?Ue(a):void 0,f={request_event_type:e,request_bytes_loaded:l,request_start:u,request_response_start:c,request_response_end:d,request_hostname:a?Te(a.responseURL):void 0,request_id:h?Oe(h):void 0,request_response_headers:h,request_media_duration:r.duration,request_url:null==a?void 0:a.responseURL};"main"===r.type?(f.request_type="media",f.request_current_level=r.level,f.request_video_width=(n.levels[r.level]||{}).width,f.request_video_height=(n.levels[r.level]||{}).height,f.request_labeled_bitrate=(n.levels[r.level]||{}).bitrate):f.request_type=r.type,s("requestcompleted",f)};n.on(i.Events.FRAG_LOADED,d);var h=function(e,t){var n=t.frag,i=n.start,a={currentFragmentPDT:o(n),currentFragmentStart:r(i)};s("fragmentchange",a)};n.on(i.Events.FRAG_CHANGED,h);var f=function(e,t){var n=t.type,a=t.details,r=t.response,o=t.fatal,l=t.frag,u=t.networkDetails,c=(null==l?void 0:l.url)||t.url||"",d=u?Ue(u):void 0;if((a===i.ErrorDetails.MANIFEST_LOAD_ERROR||a===i.ErrorDetails.MANIFEST_LOAD_TIMEOUT||a===i.ErrorDetails.FRAG_LOAD_ERROR||a===i.ErrorDetails.FRAG_LOAD_TIMEOUT||a===i.ErrorDetails.LEVEL_LOAD_ERROR||a===i.ErrorDetails.LEVEL_LOAD_TIMEOUT||a===i.ErrorDetails.AUDIO_TRACK_LOAD_ERROR||a===i.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT||a===i.ErrorDetails.SUBTITLE_LOAD_ERROR||a===i.ErrorDetails.SUBTITLE_LOAD_TIMEOUT||a===i.ErrorDetails.KEY_LOAD_ERROR||a===i.ErrorDetails.KEY_LOAD_TIMEOUT)&&s("requestfailed",{request_error:a,request_url:c,request_hostname:Te(c),request_id:d?Oe(d):void 0,request_type:a===i.ErrorDetails.FRAG_LOAD_ERROR||a===i.ErrorDetails.FRAG_LOAD_TIMEOUT?"media":a===i.ErrorDetails.AUDIO_TRACK_LOAD_ERROR||a===i.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT?"audio":a===i.ErrorDetails.SUBTITLE_LOAD_ERROR||a===i.ErrorDetails.SUBTITLE_LOAD_TIMEOUT?"subtitle":a===i.ErrorDetails.KEY_LOAD_ERROR||a===i.ErrorDetails.KEY_LOAD_TIMEOUT?"encryption":"manifest",request_error_code:null==r?void 0:r.code,request_error_text:null==r?void 0:r.text}),o){var h,f="".concat(c?"url: ".concat(c,"\n"):"")+"".concat(r&&(r.code||r.text)?"response: ".concat(r.code,", ").concat(r.text,"\n"):"")+"".concat(t.reason?"failure reason: ".concat(t.reason,"\n"):"")+"".concat(t.level?"level: ".concat(t.level,"\n"):"")+"".concat(t.parent?"parent stream controller: ".concat(t.parent,"\n"):"")+"".concat(t.buffer?"buffer length: ".concat(t.buffer,"\n"):"")+"".concat(t.error?"error: ".concat(t.error,"\n"):"")+"".concat(t.event?"event: ".concat(t.event,"\n"):"")+"".concat(t.err?"error message: ".concat(null===(h=t.err)||void 0===h?void 0:h.message,"\n"):"");s("error",{player_error_code:n,player_error_message:a,player_error_context:f})}};n.on(i.Events.ERROR,f);var v=function(e,t){var n=t.frag,i=n&&n._url||"";s("requestcanceled",{request_event_type:e,request_url:i,request_type:"media",request_hostname:Te(i)})};n.on(i.Events.FRAG_LOAD_EMERGENCY_ABORTED,v);var m=function(e,t){var i=t.level,r=n.levels[i];if(r&&r.attrs&&r.attrs.BANDWIDTH){var o,l=r.attrs.BANDWIDTH,u=parseFloat(r.attrs["FRAME-RATE"]);isNaN(u)||(o=u),l?s("renditionchange",{video_source_fps:o,video_source_bitrate:l,video_source_width:r.width,video_source_height:r.height,video_source_rendition_name:r.name,video_source_codec:null==r?void 0:r.videoCodec}):a.warn("missing BANDWIDTH from HLS manifest parsed by HLS.js")}};n.on(i.Events.LEVEL_SWITCHED,m),n._stopMuxMonitor=function(){n.off(i.Events.MANIFEST_LOADED,l),n.off(i.Events.LEVEL_LOADED,u),n.off(i.Events.AUDIO_TRACK_LOADED,c),n.off(i.Events.FRAG_LOADED,d),n.off(i.Events.FRAG_CHANGED,h),n.off(i.Events.ERROR,f),n.off(i.Events.FRAG_LOAD_EMERGENCY_ABORTED,v),n.off(i.Events.LEVEL_SWITCHED,m),n.off(i.Events.DESTROYING,n._stopMuxMonitor),delete n._stopMuxMonitor},n.on(i.Events.DESTROYING,n._stopMuxMonitor)}else a.warn("performance timing not supported. Not tracking HLS.js.")}(this.mux,this.id,e.hlsjs,{},e.Hls||window.Hls)):this.mux.log.warn("You must pass a valid hlsjs instance in order to track it.")}},{key:"removeHLSJS",value:function(){this.hlsjs&&(function(e){e&&"function"==typeof e._stopMuxMonitor&&e._stopMuxMonitor()}(this.hlsjs),this.hlsjs=void 0)}},{key:"addDashJS",value:function(e){e.dashjs?this.dashjs?this.mux.log.warn("An instance of Dash.js is already being monitored for this player."):(this.dashjs=e.dashjs,function(e,t,n){var i=e.log;if(n&&n.on){var a=Ge(n),r=function(n,i){return e.emit(t,n,i)},o=function(e){var t=e.type,n=(e.data||{}).url;r("requestcompleted",{request_event_type:t,request_start:0,request_response_start:0,request_response_end:0,request_bytes_loaded:-1,request_type:"manifest",request_hostname:Te(n),request_url:n})};n.on("manifestLoaded",o);var s={},l=function(e){if("function"!=typeof e.getRequests)return null;var t=e.getRequests({state:"executed"});return 0===t.length?null:t[t.length-1]},u=function(e){var t=e.type,n=e.fragmentModel,i=e.chunk,a=l(n);c({type:t,request:a,chunk:i})},c=function(e){var t=e.type,i=e.chunk,a=e.request,o=(i||{}).mediaInfo||{},l=o.type,u=o.bitrateList,c={};(u=u||[]).forEach((function(e,t){c[t]={},c[t].width=e.width,c[t].height=e.height,c[t].bitrate=e.bandwidth,c[t].attrs={}})),"video"===l?s.video=c:"audio"===l?s.audio=c:s.media=c;var d=Fe(a,n),h=d.requestStart,f=d.requestResponseStart,v=d.requestResponseEnd,m=d.requestResponseHeaders,p=d.requestMediaDuration,g=d.requestHostname,y=d.requestUrl,E=d.requestId;r("requestcompleted",{request_event_type:t,request_start:h,request_response_start:f,request_response_end:v,request_bytes_loaded:-1,request_type:l+"_init",request_response_headers:m,request_hostname:g,request_id:E,request_url:y,request_media_duration:p,request_rendition_lists:s})};a>=4?n.on("initFragmentLoaded",c):n.on("initFragmentLoaded",u);var d=function(e){var t=e.type,n=e.fragmentModel,i=e.chunk,a=l(n);h({type:t,request:a,chunk:i})},h=function(e){var t=e.type,i=e.chunk,a=e.request,o=i||{},s=o.mediaInfo,l=o.start,u=(s||{}).type,c=Fe(a,n),d=c.requestStart,h=c.requestResponseStart,f=c.requestResponseEnd,v=c.requestBytesLoaded,m=c.requestResponseHeaders,p=c.requestMediaDuration,g=c.requestHostname,y=c.requestUrl,E=c.requestId,A=Be(u,n),b=A.currentLevel,k=A.renditionWidth,T=A.renditionHeight,_=A.renditionBitrate;r("requestcompleted",{request_event_type:t,request_start:d,request_response_start:h,request_response_end:f,request_bytes_loaded:v,request_type:u,request_response_headers:m,request_hostname:g,request_id:E,request_url:y,request_media_start_time:l,request_media_duration:p,request_current_level:b,request_labeled_bitrate:_,request_video_width:k,request_video_height:T})};a>=4?n.on("mediaFragmentLoaded",h):n.on("mediaFragmentLoaded",d);var f={video:void 0,audio:void 0,totalBitrate:void 0},v=function(){if(f.video&&"number"==typeof f.video.bitrate){if(!f.video.width||!f.video.height)return void i.warn("have bitrate info for video but missing width/height");var e=f.video.bitrate;if(f.audio&&"number"==typeof f.audio.bitrate&&(e+=f.audio.bitrate),e!==f.totalBitrate)return f.totalBitrate=e,{video_source_bitrate:e,video_source_height:f.video.height,video_source_width:f.video.width,video_source_codec:He(f.video.codec)}}},m=function(e,t,a){if("number"==typeof e.newQuality){var o=e.mediaType;if("audio"===o||"video"===o){var s=n.getBitrateInfoListFor(o).find((function(t){return t.qualityIndex===e.newQuality}));if(!s||"number"!=typeof s.bitrate)return void i.warn("missing bitrate info for ".concat(o));f[o]=De(Ie({},s),{codec:n.getCurrentTrackFor(o).codec});var l=v();l&&r("renditionchange",l)}}else i.warn("missing evt.newQuality in qualityChangeRendered event",e)};n.on("qualityChangeRendered",m);var p=function(e){var t=e.request,n=e.mediaType;r("requestcanceled",{request_event_type:(t=t||{}).type+"_"+t.action,request_url:t.url,request_type:n,request_hostname:Te(t.url)})};n.on("fragmentLoadingAbandoned",p);var g=function(e){var t,n,i=e.error,a=(null==i||null===(t=i.data)||void 0===t?void 0:t.request)||{},o=(null==i||null===(n=i.data)||void 0===n?void 0:n.response)||{};27===(null==i?void 0:i.code)&&r("requestfailed",{request_error:a.type+"_"+a.action,request_url:a.url,request_hostname:Te(a.url),request_type:a.mediaType,request_error_code:o.status,request_error_text:o.statusText});var s="".concat(null!=a&&a.url?"url: ".concat(a.url,"\n"):"")+"".concat(null!=o&&o.status||null!=o&&o.statusText?"response: ".concat(null==o?void 0:o.status,", ").concat(null==o?void 0:o.statusText,"\n"):"");r("error",{player_error_code:null==i?void 0:i.code,player_error_message:null==i?void 0:i.message,player_error_context:s})};n.on("error",g),n._stopMuxMonitor=function(){n.off("manifestLoaded",o),n.off("initFragmentLoaded",c),n.off("mediaFragmentLoaded",h),n.off("qualityChangeRendered",m),n.off("error",g),n.off("fragmentLoadingAbandoned",p),delete n._stopMuxMonitor}}else i.warn("Invalid dash.js player reference. Monitoring blocked.")}(this.mux,this.id,e.dashjs)):this.mux.log.warn("You must pass a valid dashjs instance in order to track it.")}},{key:"removeDashJS",value:function(){this.dashjs&&(function(e){e&&"function"==typeof e._stopMuxMonitor&&e._stopMuxMonitor()}(this.dashjs),this.dashjs=void 0)}}]),n}(Ve),Qt=Xt,Zt=R(q());var Jt=["loadstart","pause","play","playing","seeking","seeked","timeupdate","ratechange","stalled","waiting","error","ended"],$t={1:"MEDIA_ERR_ABORTED",2:"MEDIA_ERR_NETWORK",3:"MEDIA_ERR_DECODE",4:"MEDIA_ERR_SRC_NOT_SUPPORTED"};var en,tn=R(L());tn.default&&tn.default.WeakMap&&(en=new WeakMap);var nn="#EXT-X-TARGETDURATION",an="#EXT-X-PART-INF",rn="#EXT-X-SERVER-CONTROL",on="#EXTINF",sn="#EXT-X-PROGRAM-DATE-TIME",ln="#EXT-X-VERSION",un="#EXT-X-SESSION-DATA",cn=function(e){return this.buffer="",this.manifest={segments:[],serverControl:{},sessionData:{}},this.currentUri={},this.process(e),this.manifest};cn.prototype.process=function(e){var t;for(this.buffer+=e,t=this.buffer.indexOf("\n");t>-1;t=this.buffer.indexOf("\n"))this.processLine(this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)},cn.prototype.processLine=function(e){var t=e.indexOf(":"),n=gn(e,t),i=n[0],a=2===n.length?fn(n[1]):void 0;if("#"!==i[0])this.currentUri.uri=i,this.manifest.segments.push(this.currentUri),this.manifest.targetDuration&&!("duration"in this.currentUri)&&(this.currentUri.duration=this.manifest.targetDuration),this.currentUri={};else switch(i){case nn:if(!isFinite(a)||a<0)return;this.manifest.targetDuration=a,this.setHoldBack();break;case an:dn(this.manifest,n),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),this.setHoldBack();break;case rn:dn(this.manifest,n),this.setHoldBack();break;case on:0===a?this.currentUri.duration=.01:a>0&&(this.currentUri.duration=a);break;case sn:var r=a,o=new Date(r);this.manifest.dateTimeString||(this.manifest.dateTimeString=r,this.manifest.dateTimeObject=o),this.currentUri.dateTimeString=r,this.currentUri.dateTimeObject=o;break;case ln:dn(this.manifest,n);break;case un:var s=yn(n[1]),l=Pe(s);Object.assign(this.manifest.sessionData,l)}},cn.prototype.setHoldBack=function(){var e=this.manifest,t=e.serverControl,n=e.targetDuration,i=e.partTargetDuration;if(t){var a="holdBack",r="partHoldBack",o=n&&3*n,s=i&&2*i;n&&!t.hasOwnProperty(a)&&(t[a]=o),o&&t[a]<o&&(t[a]=o),i&&!t.hasOwnProperty(r)&&(t[r]=3*i),i&&t[r]<s&&(t[r]=s)}};var dn=function(e,t){var n,i=hn(t[0].replace("#EXT-X-",""));pn(t[1])?(n={},n=Object.assign(mn(t[1]),n)):n=fn(t[1]),e[i]=n},hn=function(e){return e.toLowerCase().replace(/-(\w)/g,(function(e){return e[1].toUpperCase()}))},fn=function(e){if("yes"===e.toLowerCase()||"no"===e.toLowerCase())return"yes"===e.toLowerCase();var t=-1!==e.indexOf(":")?e:parseFloat(e);return isNaN(t)?e:t},vn=function(e){var t={},n=e.split("=");n.length>1&&(t[hn(n[0])]=fn(n[1]));return t},mn=function(e){for(var t=e.split(","),n={},i=0;t.length>i;i++){var a=t[i],r=vn(a);n=Object.assign(r,n)}return n},pn=function(e){return e.indexOf("=")>-1},gn=function(e,t){return-1===t?[e]:[e.substring(0,t),e.substring(t+1)]},yn=function(e){var t={};if(e){var n=e.search(",");return[e.slice(0,n),e.slice(n+1)].forEach((function(e,n){for(var i=e.replace(/['"]+/g,"").split("="),a=0;a<i.length;a++)"DATA-ID"===i[a]&&(t["DATA-ID"]=i[1-a]),"VALUE"===i[a]&&(t.VALUE=i[1-a])})),{data:t}}},En=cn,An={safeCall:function(e,t,n,i){var a=i;if(e&&"function"==typeof e[t])try{a=e[t].apply(e,n)}catch(sf){ce.info("safeCall error",sf)}return a},safeIncrement:Le,getComputedStyle:function(e,t){return e&&t&&tn.default&&"function"==typeof tn.default.getComputedStyle?(en&&en.has(e)&&(n=en.get(e)),n||(n=tn.default.getComputedStyle(e,null),en&&en.set(e,n)),n.getPropertyValue(t)):"";var n},secondsToMs:function(e){return Math.floor(1e3*e)},assign:Object.assign,headersStringToObject:Me,cdnHeadersToRequestId:Oe,extractHostnameAndDomain:_e,extractHostname:Te,manifestParser:En,generateShortID:te,generateUUID:ee,now:$.now,findMediaElement:ie},bn=An,kn={PLAYER_READY:"playerready",VIEW_INIT:"viewinit",VIDEO_CHANGE:"videochange",PLAY:"play",PAUSE:"pause",PLAYING:"playing",TIME_UPDATE:"timeupdate",SEEKING:"seeking",SEEKED:"seeked",REBUFFER_START:"rebufferstart",REBUFFER_END:"rebufferend",ERROR:"error",ENDED:"ended",RENDITION_CHANGE:"renditionchange",ORIENTATION_CHANGE:"orientationchange",AD_REQUEST:"adrequest",AD_RESPONSE:"adresponse",AD_BREAK_START:"adbreakstart",AD_PLAY:"adplay",AD_PLAYING:"adplaying",AD_PAUSE:"adpause",AD_FIRST_QUARTILE:"adfirstquartile",AD_MID_POINT:"admidpoint",AD_THIRD_QUARTILE:"adthirdquartile",AD_ENDED:"adended",AD_BREAK_END:"adbreakend",AD_ERROR:"aderror",REQUEST_COMPLETED:"requestcompleted",REQUEST_FAILED:"requestfailed",REQUEST_CANCELLED:"requestcanceled",HEARTBEAT:"hb",DESTROY:"destroy"},Tn={},_n=function e(t){var n=arguments;"string"==typeof t?e.hasOwnProperty(t)?X.default.setTimeout((function(){n=Array.prototype.splice.call(n,1),e[t].apply(null,n)}),0):ce.warn("`"+t+"` is an unknown task"):"function"==typeof t?X.default.setTimeout((function(){t(e)}),0):ce.warn("`"+t+"` is invalid.")},Sn={loaded:$.now(),NAME:"mux-embed",VERSION:"5.9.0",API_VERSION:"2.1",PLAYER_TRACKED:!1,monitor:function(e,t){return function(e,t,n){var i=z(ie(t),3),a=i[0],r=i[1],o=i[2],s=e.log,l=e.utils.getComputedStyle,u=e.utils.secondsToMs;if(!a)return s.error("No element was found with the `"+r+"` query selector.");if("video"!==o&&"audio"!==o)return s.error("The element of `"+r+"` was not a media element.");a.mux&&(a.mux.destroy(),delete a.mux,s.warn("Already monitoring this video element, replacing existing event listeners"));var c={getPlayheadTime:function(){return u(a.currentTime)},getStateData:function(){var e,t,n=(null===(e=this.getPlayheadTime)||void 0===e?void 0:e.call(this))||u(a.currentTime),i=this.hlsjs&&this.hlsjs.url,r=this.dashjs&&"function"==typeof this.dashjs.getSource&&this.dashjs.getSource(),o={player_is_paused:a.paused,player_width:parseInt(l(a,"width")),player_height:parseInt(l(a,"height")),player_autoplay_on:a.autoplay,player_preload_on:a.preload,player_language_code:a.lang,player_is_fullscreen:Zt.default&&!!(Zt.default.fullscreenElement||Zt.default.webkitFullscreenElement||Zt.default.mozFullScreenElement||Zt.default.msFullscreenElement),video_poster_url:a.poster,video_source_url:i||r||a.currentSrc,video_source_duration:u(a.duration),video_source_height:a.videoHeight,video_source_width:a.videoWidth,view_dropped_frame_count:null==a||null===(t=a.getVideoPlaybackQuality)||void 0===t?void 0:t.call(a).droppedVideoFrames};if(a.getStartDate&&n>0){var s=a.getStartDate();if(s&&"function"==typeof s.getTime&&s.getTime()){var c=s.getTime();if(o.player_program_time=c+n,a.seekable.length>0){var d=c+a.seekable.end(a.seekable.length-1);o.player_live_edge_program_time=d}}}return o}};(n=Object.assign({automaticErrorTracking:!0},n,c)).data=Object.assign({player_software:"HTML5 Video Element",player_mux_plugin_name:"VideoElementMonitor",player_mux_plugin_version:e.VERSION},n.data),a.mux=a.mux||{},a.mux.deleted=!1,a.mux.emit=function(t,n){e.emit(r,t,n)},a.mux.updateData=function(e){a.mux.emit("hb",e)};var d=function(){s.error("The monitor for this video element has already been destroyed.")};a.mux.destroy=function(){Object.keys(a.mux.listeners).forEach((function(e){a.removeEventListener(e,a.mux.listeners[e],!1)})),delete a.mux.listeners,a.mux.destroy=d,a.mux.swapElement=d,a.mux.emit=d,a.mux.addHLSJS=d,a.mux.addDashJS=d,a.mux.removeHLSJS=d,a.mux.removeDashJS=d,a.mux.updateData=d,a.mux.setEmitTranslator=d,a.mux.setStateDataTranslator=d,a.mux.setGetPlayheadTime=d,a.mux.deleted=!0,e.emit(r,"destroy")},a.mux.swapElement=function(t){var n=z(ie(t),3),i=n[0],r=n[1],o=n[2];return i?"video"!==o&&"audio"!==o?e.log.error("The element of `"+r+"` was not a media element."):(i.muxId=a.muxId,delete a.muxId,i.mux=i.mux||{},i.mux.listeners=Object.assign({},a.mux.listeners),delete a.mux.listeners,Object.keys(i.mux.listeners).forEach((function(e){a.removeEventListener(e,i.mux.listeners[e],!1),i.addEventListener(e,i.mux.listeners[e],!1)})),i.mux.swapElement=a.mux.swapElement,i.mux.destroy=a.mux.destroy,delete a.mux,void(a=i)):e.log.error("No element was found with the `"+r+"` query selector.")},a.mux.addHLSJS=function(t){e.addHLSJS(r,t)},a.mux.addDashJS=function(t){e.addDashJS(r,t)},a.mux.removeHLSJS=function(){e.removeHLSJS(r)},a.mux.removeDashJS=function(){e.removeDashJS(r)},a.mux.setEmitTranslator=function(t){e.setEmitTranslator(r,t)},a.mux.setStateDataTranslator=function(t){e.setStateDataTranslator(r,t)},a.mux.setGetPlayheadTime=function(t){t||(t=n.getPlayheadTime),e.setGetPlayheadTime(r,t)},e.init(r,n),e.emit(r,"playerready"),a.paused||(e.emit(r,"play"),a.readyState>2&&e.emit(r,"playing")),a.mux.listeners={},Jt.forEach((function(t){"error"===t&&!n.automaticErrorTracking||(a.mux.listeners[t]=function(){var n={};if("error"===t){if(!a.error||1===a.error.code)return;n.player_error_code=a.error.code,n.player_error_message=$t[a.error.code]||a.error.message}e.emit(r,t,n)},a.addEventListener(t,a.mux.listeners[t],!1))}))}(_n,e,t)},destroyMonitor:function(e){var t=z(ie(e),1)[0];t&&t.mux&&"function"==typeof t.mux.destroy?t.mux.destroy():ce.error("A video element monitor for `"+e+"` has not been initialized via `mux.monitor`.")},addHLSJS:function(e,t){var n=ne(e);Tn[n]?Tn[n].addHLSJS(t):ce.error("A monitor for `"+n+"` has not been initialized.")},addDashJS:function(e,t){var n=ne(e);Tn[n]?Tn[n].addDashJS(t):ce.error("A monitor for `"+n+"` has not been initialized.")},removeHLSJS:function(e){var t=ne(e);Tn[t]?Tn[t].removeHLSJS():ce.error("A monitor for `"+t+"` has not been initialized.")},removeDashJS:function(e){var t=ne(e);Tn[t]?Tn[t].removeDashJS():ce.error("A monitor for `"+t+"` has not been initialized.")},init:function(e,t){he()&&t&&t.respectDoNotTrack&&ce.info("The browser's Do Not Track flag is enabled - Mux beaconing is disabled.");var n=ne(e);Tn[n]=new Qt(_n,n,t)},emit:function(e,t,n){var i=ne(e);Tn[i]?(Tn[i].emit(t,n),"destroy"===t&&delete Tn[i]):ce.error("A monitor for `"+i+"` has not been initialized.")},updateData:function(e,t){var n=ne(e);Tn[n]?Tn[n].emit("hb",t):ce.error("A monitor for `"+n+"` has not been initialized.")},setEmitTranslator:function(e,t){var n=ne(e);Tn[n]?Tn[n].emitTranslator=t:ce.error("A monitor for `"+n+"` has not been initialized.")},setStateDataTranslator:function(e,t){var n=ne(e);Tn[n]?Tn[n].stateDataTranslator=t:ce.error("A monitor for `"+n+"` has not been initialized.")},setGetPlayheadTime:function(e,t){var n=ne(e);Tn[n]?Tn[n].getPlayheadTime=t:ce.error("A monitor for `"+n+"` has not been initialized.")},checkDoNotTrack:he,log:ce,utils:bn,events:kn,WINDOW_HIDDEN:!1,WINDOW_UNLOADING:!1};Object.assign(_n,Sn),"undefined"!=typeof X.default&&"function"==typeof X.default.addEventListener&&X.default.addEventListener("pagehide",(function(e){e.persisted||(_n.WINDOW_UNLOADING=!0)}),!1);var wn,Rn=_n,Ln=n(9417);function In(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Dn,Cn={exports:{}};Dn=Cn,function(e){var t=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,n=/^(?=([^\/?#]*))\1([^]*)$/,i=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,r={buildAbsoluteURL:function(e,t,i){if(i=i||{},e=e.trim(),!(t=t.trim())){if(!i.alwaysNormalize)return e;var a=r.parseURL(e);if(!a)throw new Error("Error trying to parse base URL.");return a.path=r.normalizePath(a.path),r.buildURLFromParts(a)}var o=r.parseURL(t);if(!o)throw new Error("Error trying to parse relative URL.");if(o.scheme)return i.alwaysNormalize?(o.path=r.normalizePath(o.path),r.buildURLFromParts(o)):t;var s=r.parseURL(e);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var l=n.exec(s.path);s.netLoc=l[1],s.path=l[2]}s.netLoc&&!s.path&&(s.path="/");var u={scheme:s.scheme,netLoc:o.netLoc,path:null,params:o.params,query:o.query,fragment:o.fragment};if(!o.netLoc&&(u.netLoc=s.netLoc,"/"!==o.path[0]))if(o.path){var c=s.path,d=c.substring(0,c.lastIndexOf("/")+1)+o.path;u.path=r.normalizePath(d)}else u.path=s.path,o.params||(u.params=s.params,o.query||(u.query=s.query));return null===u.path&&(u.path=i.alwaysNormalize?r.normalizePath(o.path):o.path),r.buildURLFromParts(u)},parseURL:function(e){var n=t.exec(e);return n?{scheme:n[1]||"",netLoc:n[2]||"",path:n[3]||"",params:n[4]||"",query:n[5]||"",fragment:n[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(i,"");e.length!==(e=e.replace(a,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}};Dn.exports=r}();var xn=Cn.exports;function Mn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function On(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mn(Object(n),!0).forEach((function(t){Nn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Pn(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function Nn(e,t,n){return(t=Pn(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Un(){return Un=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Un.apply(this,arguments)}var Fn=Number.isFinite||function(e){return"number"===typeof e&&isFinite(e)},Bn=Number.isSafeInteger||function(e){return"number"===typeof e&&Math.abs(e)<=Hn},Hn=Number.MAX_SAFE_INTEGER||9007199254740991,Gn=function(e){return e.MEDIA_ATTACHING="hlsMediaAttaching",e.MEDIA_ATTACHED="hlsMediaAttached",e.MEDIA_DETACHING="hlsMediaDetaching",e.MEDIA_DETACHED="hlsMediaDetached",e.BUFFER_RESET="hlsBufferReset",e.BUFFER_CODECS="hlsBufferCodecs",e.BUFFER_CREATED="hlsBufferCreated",e.BUFFER_APPENDING="hlsBufferAppending",e.BUFFER_APPENDED="hlsBufferAppended",e.BUFFER_EOS="hlsBufferEos",e.BUFFER_FLUSHING="hlsBufferFlushing",e.BUFFER_FLUSHED="hlsBufferFlushed",e.MANIFEST_LOADING="hlsManifestLoading",e.MANIFEST_LOADED="hlsManifestLoaded",e.MANIFEST_PARSED="hlsManifestParsed",e.LEVEL_SWITCHING="hlsLevelSwitching",e.LEVEL_SWITCHED="hlsLevelSwitched",e.LEVEL_LOADING="hlsLevelLoading",e.LEVEL_LOADED="hlsLevelLoaded",e.LEVEL_UPDATED="hlsLevelUpdated",e.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",e.LEVELS_UPDATED="hlsLevelsUpdated",e.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",e.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",e.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",e.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",e.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",e.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",e.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",e.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",e.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",e.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",e.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",e.CUES_PARSED="hlsCuesParsed",e.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",e.INIT_PTS_FOUND="hlsInitPtsFound",e.FRAG_LOADING="hlsFragLoading",e.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",e.FRAG_LOADED="hlsFragLoaded",e.FRAG_DECRYPTED="hlsFragDecrypted",e.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",e.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",e.FRAG_PARSING_METADATA="hlsFragParsingMetadata",e.FRAG_PARSED="hlsFragParsed",e.FRAG_BUFFERED="hlsFragBuffered",e.FRAG_CHANGED="hlsFragChanged",e.FPS_DROP="hlsFpsDrop",e.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",e.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",e.ERROR="hlsError",e.DESTROYING="hlsDestroying",e.KEY_LOADING="hlsKeyLoading",e.KEY_LOADED="hlsKeyLoaded",e.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",e.BACK_BUFFER_REACHED="hlsBackBufferReached",e.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",e}({}),Kn=function(e){return e.NETWORK_ERROR="networkError",e.MEDIA_ERROR="mediaError",e.KEY_SYSTEM_ERROR="keySystemError",e.MUX_ERROR="muxError",e.OTHER_ERROR="otherError",e}({}),Wn=function(e){return e.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",e.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",e.KEY_SYSTEM_NO_SESSION="keySystemNoSession",e.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",e.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",e.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",e.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",e.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",e.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",e.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",e.MANIFEST_LOAD_ERROR="manifestLoadError",e.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",e.MANIFEST_PARSING_ERROR="manifestParsingError",e.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",e.LEVEL_EMPTY_ERROR="levelEmptyError",e.LEVEL_LOAD_ERROR="levelLoadError",e.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",e.LEVEL_PARSING_ERROR="levelParsingError",e.LEVEL_SWITCH_ERROR="levelSwitchError",e.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",e.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",e.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",e.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",e.FRAG_LOAD_ERROR="fragLoadError",e.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",e.FRAG_DECRYPT_ERROR="fragDecryptError",e.FRAG_PARSING_ERROR="fragParsingError",e.FRAG_GAP="fragGap",e.REMUX_ALLOC_ERROR="remuxAllocError",e.KEY_LOAD_ERROR="keyLoadError",e.KEY_LOAD_TIMEOUT="keyLoadTimeOut",e.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",e.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",e.BUFFER_APPEND_ERROR="bufferAppendError",e.BUFFER_APPENDING_ERROR="bufferAppendingError",e.BUFFER_STALLED_ERROR="bufferStalledError",e.BUFFER_FULL_ERROR="bufferFullError",e.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",e.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",e.INTERNAL_EXCEPTION="internalException",e.INTERNAL_ABORTED="aborted",e.UNKNOWN="unknown",e}({}),Vn=function(){},qn={trace:Vn,debug:Vn,log:Vn,warn:Vn,info:Vn,error:Vn},Yn=qn;function jn(e){var t=self.console[e];return t?t.bind(self.console,"[".concat(e,"] >")):Vn}function zn(e,t){if("object"===typeof console&&!0===e||"object"===typeof e){!function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];n.forEach((function(t){Yn[t]=e[t]?e[t].bind(e):jn(t)}))}(e,"debug","log","info","warn","error");try{Yn.log('Debug logs enabled for "'.concat(t,'" in hls.js version ',"1.5.20"))}catch(Rv){Yn=qn}}else Yn=qn}var Xn=Yn,Qn=/^(\d+)x(\d+)$/,Zn=/(.+?)=(".*?"|.*?)(?:,|$)/g,Jn=function(){function e(t){(0,m.A)(this,e),"string"===typeof t&&(t=e.parseAttrList(t)),Un(this,t)}return(0,v.A)(e,[{key:"clientAttrs",get:function(){return Object.keys(this).filter((function(e){return"X-"===e.substring(0,2)}))}},{key:"decimalInteger",value:function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}},{key:"hexadecimalInteger",value:function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var n=new Uint8Array(t.length/2),i=0;i<t.length/2;i++)n[i]=parseInt(t.slice(2*i,2*i+2),16);return n}return null}},{key:"hexadecimalIntegerAsNumber",value:function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}},{key:"decimalFloatingPoint",value:function(e){return parseFloat(this[e])}},{key:"optionalFloat",value:function(e,t){var n=this[e];return n?parseFloat(n):t}},{key:"enumeratedString",value:function(e){return this[e]}},{key:"bool",value:function(e){return"YES"===this[e]}},{key:"decimalResolution",value:function(e){var t=Qn.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}}],[{key:"parseAttrList",value:function(e){var t,n={};for(Zn.lastIndex=0;null!==(t=Zn.exec(e));){var i=t[2];0===i.indexOf('"')&&i.lastIndexOf('"')===i.length-1&&(i=i.slice(1,-1)),n[t[1].trim()]=i}return n}}]),e}();function $n(e){return"SCTE35-OUT"===e||"SCTE35-IN"===e}var ei=function(){function e(t,n){if((0,m.A)(this,e),this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,n){var i=n.attr;for(var a in i)if(Object.prototype.hasOwnProperty.call(t,a)&&t[a]!==i[a]){Xn.warn('DATERANGE tag attribute: "'.concat(a,'" does not match for tags with ID: "').concat(t.ID,'"')),this._badValueForSameId=a;break}t=Un(new Jn({}),i,t)}if(this.attr=t,this._startDate=new Date(t["START-DATE"]),"END-DATE"in this.attr){var r=new Date(this.attr["END-DATE"]);Fn(r.getTime())&&(this._endDate=r)}}return(0,v.A)(e,[{key:"id",get:function(){return this.attr.ID}},{key:"class",get:function(){return this.attr.CLASS}},{key:"startDate",get:function(){return this._startDate}},{key:"endDate",get:function(){if(this._endDate)return this._endDate;var e=this.duration;return null!==e?new Date(this._startDate.getTime()+1e3*e):null}},{key:"duration",get:function(){if("DURATION"in this.attr){var e=this.attr.decimalFloatingPoint("DURATION");if(Fn(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}},{key:"plannedDuration",get:function(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}},{key:"endOnNext",get:function(){return this.attr.bool("END-ON-NEXT")}},{key:"isValid",get:function(){return!!this.id&&!this._badValueForSameId&&Fn(this.startDate.getTime())&&(null===this.duration||this.duration>=0)&&(!this.endOnNext||!!this.class)}}]),e}(),ti=(0,v.A)((function e(){(0,m.A)(this,e),this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}})),ni="audio",ii="video",ai="audiovideo",ri=function(){function e(t){var n;(0,m.A)(this,e),this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams=(n={},(0,s.A)(n,ni,null),(0,s.A)(n,ii,null),(0,s.A)(n,ai,null),n),this.baseurl=t}return(0,v.A)(e,[{key:"setByteRange",value:function(e,t){var n,i=e.split("@",2);n=1===i.length?(null==t?void 0:t.byteRangeEndOffset)||0:parseInt(i[1]),this._byteRange=[n,parseInt(i[0])+n]}},{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=xn.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(e){this._url=e}}]),e}(),oi=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(e,i){var a;return(0,m.A)(this,n),(a=t.call(this,i))._decryptdata=null,a.rawProgramDateTime=null,a.programDateTime=null,a.tagList=[],a.duration=0,a.sn=0,a.levelkeys=void 0,a.type=void 0,a.loader=null,a.keyLoader=null,a.level=-1,a.cc=0,a.startPTS=void 0,a.endPTS=void 0,a.startDTS=void 0,a.endDTS=void 0,a.start=0,a.deltaPTS=void 0,a.maxStartPTS=void 0,a.minEndPTS=void 0,a.stats=new ti,a.data=void 0,a.bitrateTest=!1,a.title=null,a.initSegment=null,a.endList=void 0,a.gap=void 0,a.urlId=0,a.type=e,a}return(0,v.A)(n,[{key:"decryptdata",get:function(){if(!this.levelkeys&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){var e=this.levelkeys.identity;if(e)this._decryptdata=e.getDecryptData(this.sn);else{var t=Object.keys(this.levelkeys);if(1===t.length)return this._decryptdata=this.levelkeys[t[0]].getDecryptData(this.sn)}}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(null===this.programDateTime)return null;if(!Fn(this.programDateTime))return null;var e=Fn(this.duration)?this.duration:0;return this.programDateTime+1e3*e}},{key:"encrypted",get:function(){var e;if(null!=(e=this._decryptdata)&&e.encrypted)return!0;if(this.levelkeys){var t=Object.keys(this.levelkeys),n=t.length;if(n>1||1===n&&this.levelkeys[t[0]].encrypted)return!0}return!1}},{key:"setKeyFormat",value:function(e){if(this.levelkeys){var t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}},{key:"abortRequests",value:function(){var e,t;null==(e=this.loader)||e.abort(),null==(t=this.keyLoader)||t.abort()}},{key:"setElementaryStreamInfo",value:function(e,t,n,i,a){var r=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=this.elementaryStreams,s=o[e];s?(s.startPTS=Math.min(s.startPTS,t),s.endPTS=Math.max(s.endPTS,n),s.startDTS=Math.min(s.startDTS,i),s.endDTS=Math.max(s.endDTS,a)):o[e]={startPTS:t,endPTS:n,startDTS:i,endDTS:a,partial:r}}},{key:"clearElementaryStreamInfo",value:function(){var e=this.elementaryStreams;e[ni]=null,e[ii]=null,e[ai]=null}}]),n}(ri),si=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(e,i,a,r,o){var s;(0,m.A)(this,n),(s=t.call(this,a)).fragOffset=0,s.duration=0,s.gap=!1,s.independent=!1,s.relurl=void 0,s.fragment=void 0,s.index=void 0,s.stats=new ti,s.duration=e.decimalFloatingPoint("DURATION"),s.gap=e.bool("GAP"),s.independent=e.bool("INDEPENDENT"),s.relurl=e.enumeratedString("URI"),s.fragment=i,s.index=r;var l=e.enumeratedString("BYTERANGE");return l&&s.setByteRange(l,o),o&&(s.fragOffset=o.fragOffset+o.duration),s}return(0,v.A)(n,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var e=this.elementaryStreams;return!!(e.audio||e.video||e.audiovideo)}}]),n}(ri),li=function(){function e(t){(0,m.A)(this,e),this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=t}return(0,v.A)(e,[{key:"reloaded",value:function(e){if(!e)return this.advanced=!0,void(this.updated=!0);var t=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||0===t&&n>0,this.updated||this.advanced?this.misses=Math.floor(.6*e.misses):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay}},{key:"hasProgramDateTime",get:function(){return!!this.fragments.length&&Fn(this.fragments[this.fragments.length-1].programDateTime)}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||10}},{key:"drift",get:function(){var e=this.driftEndTime-this.driftStartTime;return e>0?1e3*(this.driftEnd-this.driftStart)/e:1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var e;return null!=(e=this.fragments)&&e.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}]),e}();function ui(e){return Uint8Array.from(atob(e),(function(e){return e.charCodeAt(0)}))}function ci(e){var t=e.split(":"),n=null;if("data"===t[0]&&2===t.length){var i=t[1].split(";"),a=i[i.length-1].split(",");if(2===a.length){var r="base64"===a[0],o=a[1];r?(i.splice(-1,1),n=ui(o)):n=function(e){var t=di(e).subarray(0,16),n=new Uint8Array(16);return n.set(t,16-t.length),n}(o)}}return n}function di(e){return Uint8Array.from(unescape(encodeURIComponent(e)),(function(e){return e.charCodeAt(0)}))}var hi="undefined"!==typeof self?self:void 0,fi={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},vi="org.w3.clearkey",mi="com.apple.streamingkeydelivery",pi="com.microsoft.playready",gi="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";function yi(e){switch(e){case mi:return fi.FAIRPLAY;case pi:return fi.PLAYREADY;case gi:return fi.WIDEVINE;case vi:return fi.CLEARKEY}}var Ei="1077efecc0b24d02ace33c1e52e2fb4b",Ai="e2719d58a985b3c9781ab030af78d30e",bi="9a04f07998404286ab92e65be0885f95",ki="edef8ba979d64acea3c827dcd51d21ed";function Ti(e){return e===ki?fi.WIDEVINE:e===bi?fi.PLAYREADY:e===Ei||e===Ai?fi.CLEARKEY:void 0}function _i(e){switch(e){case fi.FAIRPLAY:return mi;case fi.PLAYREADY:return pi;case fi.WIDEVINE:return gi;case fi.CLEARKEY:return vi}}function Si(e){var t=e.drmSystems,n=e.widevineLicenseUrl,i=t?[fi.FAIRPLAY,fi.WIDEVINE,fi.PLAYREADY,fi.CLEARKEY].filter((function(e){return!!t[e]})):[];return!i[fi.WIDEVINE]&&n&&i.push(fi.WIDEVINE),i}var wi,Ri=null!=hi&&null!=(wi=hi.navigator)&&wi.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null;function Li(e){var t=new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2),n=String.fromCharCode.apply(null,Array.from(t)),i=n.substring(n.indexOf("<"),n.length),a=(new DOMParser).parseFromString(i,"text/xml").getElementsByTagName("KID")[0];if(a){var r=a.childNodes[0]?a.childNodes[0].nodeValue:a.getAttribute("VALUE");if(r){var o=ui(r).subarray(0,16);return function(e){var t=function(e,t,n){var i=e[t];e[t]=e[n],e[n]=i};t(e,0,3),t(e,1,2),t(e,4,5),t(e,6,7)}(o),o}}return null}function Ii(e,t,n){return Uint8Array.prototype.slice?e.slice(t,n):new Uint8Array(Array.prototype.slice.call(e,t,n))}var Di,Ci=function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},xi=function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},Mi=function(e,t){for(var n=t,i=0;Ci(e,t);){i+=10,i+=Oi(e,t+6),xi(e,t+10)&&(i+=10),t+=i}if(i>0)return e.subarray(n,n+i)},Oi=function(e,t){var n=0;return n=(127&e[t])<<21,n|=(127&e[t+1])<<14,n|=(127&e[t+2])<<7,n|=127&e[t+3]},Pi=function(e,t){return Ci(e,t)&&Oi(e,t+6)+10<=e.length-t},Ni=function(e){for(var t=Bi(e),n=0;n<t.length;n++){var i=t[n];if(Ui(i))return Vi(i)}},Ui=function(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info},Fi=function(e){var t=String.fromCharCode(e[0],e[1],e[2],e[3]),n=Oi(e,4);return{type:t,size:n,data:e.subarray(10,10+n)}},Bi=function(e){for(var t=0,n=[];Ci(e,t);){for(var i=Oi(e,t+6),a=(t+=10)+i;t+8<a;){var r=Fi(e.subarray(t)),o=Hi(r);o&&n.push(o),t+=r.size+10}xi(e,t)&&(t+=10)}return n},Hi=function(e){return"PRIV"===e.type?Gi(e):"W"===e.type[0]?Wi(e):Ki(e)},Gi=function(e){if(!(e.size<2)){var t=qi(e.data,!0),n=new Uint8Array(e.data.subarray(t.length+1));return{key:e.type,info:t,data:n.buffer}}},Ki=function(e){if(!(e.size<2)){if("TXXX"===e.type){var t=1,n=qi(e.data.subarray(t),!0);t+=n.length+1;var i=qi(e.data.subarray(t));return{key:e.type,info:n,data:i}}var a=qi(e.data.subarray(1));return{key:e.type,data:a}}},Wi=function(e){if("WXXX"===e.type){if(e.size<2)return;var t=1,n=qi(e.data.subarray(t),!0);t+=n.length+1;var i=qi(e.data.subarray(t));return{key:e.type,info:n,data:i}}var a=qi(e.data);return{key:e.type,data:a}},Vi=function(e){if(8===e.data.byteLength){var t=new Uint8Array(e.data),n=1&t[3],i=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return i/=45,n&&(i+=47721858.84),Math.round(i)}},qi=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Yi();if(n){var i=n.decode(e);if(t){var a=i.indexOf("\0");return-1!==a?i.substring(0,a):i}return i.replace(/\0/g,"")}for(var r,o,s,l=e.length,u="",c=0;c<l;){if(0===(r=e[c++])&&t)return u;if(0!==r&&3!==r)switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:u+=String.fromCharCode(r);break;case 12:case 13:o=e[c++],u+=String.fromCharCode((31&r)<<6|63&o);break;case 14:o=e[c++],s=e[c++],u+=String.fromCharCode((15&r)<<12|(63&o)<<6|(63&s)<<0)}}return u};function Yi(){if(!navigator.userAgent.includes("PlayStation 4"))return Di||"undefined"===typeof self.TextDecoder||(Di=new self.TextDecoder("utf-8")),Di}var ji=function(e){for(var t="",n=0;n<e.length;n++){var i=e[n].toString(16);i.length<2&&(i="0"+i),t+=i}return t},zi=Math.pow(2,32)-1,Xi=[].push,Qi={video:1,audio:2,id3:3,text:4};function Zi(e){return String.fromCharCode.apply(null,e)}function Ji(e,t){var n=e[t]<<8|e[t+1];return n<0?65536+n:n}function $i(e,t){var n=ta(e,t);return n<0?4294967296+n:n}function ea(e,t){var n=$i(e,t);return n*=Math.pow(2,32),n+=$i(e,t+4)}function ta(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function na(e,t,n){e[t]=n>>24,e[t+1]=n>>16&255,e[t+2]=n>>8&255,e[t+3]=255&n}function ia(e,t){var n=[];if(!t.length)return n;for(var i=e.byteLength,a=0;a<i;){var r=$i(e,a),o=r>1?a+r:i;if(Zi(e.subarray(a+4,a+8))===t[0])if(1===t.length)n.push(e.subarray(a+8,o));else{var s=ia(e.subarray(a+8,o),t.slice(1));s.length&&Xi.apply(n,s)}a=o}return n}function aa(e){var t=[],n=e[0],i=8,a=$i(e,i);i+=4;var r=0,o=0;0===n?(r=$i(e,i),o=$i(e,i+4),i+=8):(r=ea(e,i),o=ea(e,i+8),i+=16),i+=2;var s=e.length+o,l=Ji(e,i);i+=2;for(var u=0;u<l;u++){var c=i,d=$i(e,c);c+=4;var h=2147483647&d;if(1===(2147483648&d)>>>31)return Xn.warn("SIDX has hierarchical references (not supported)"),null;var f=$i(e,c);c+=4,t.push({referenceSize:h,subsegmentDuration:f,info:{duration:f/a,start:s,end:s+h-1}}),s+=h,i=c+=4}return{earliestPresentationTime:r,timescale:a,version:n,referencesCount:l,references:t}}function ra(e){for(var t=[],n=ia(e,["moov","trak"]),i=0;i<n.length;i++){var a=n[i],r=ia(a,["tkhd"])[0];if(r){var o=r[0],s=$i(r,0===o?12:20),l=ia(a,["mdia","mdhd"])[0];if(l){var u=$i(l,0===(o=l[0])?12:20),c=ia(a,["mdia","hdlr"])[0];if(c){var d=Zi(c.subarray(8,12)),h={soun:ni,vide:ii}[d];if(h){var f=oa(ia(a,["mdia","minf","stbl","stsd"])[0]);t[s]={timescale:u,type:h},t[h]=On({timescale:u,id:s},f)}}}}}return ia(e,["moov","mvex","trex"]).forEach((function(e){var n=$i(e,4),i=t[n];i&&(i.default={duration:$i(e,12),flags:$i(e,20)})})),t}function oa(e){var t=e.subarray(8),n=t.subarray(86),i=Zi(t.subarray(4,8)),a=i,r="enca"===i||"encv"===i;if(r){var o=ia(t,[i])[0];ia(o.subarray("enca"===i?28:78),["sinf"]).forEach((function(e){var t=ia(e,["schm"])[0];if(t){var n=Zi(t.subarray(4,8));if("cbcs"===n||"cenc"===n){var i=ia(e,["frma"])[0];i&&(a=Zi(i))}}}))}switch(a){case"avc1":case"avc2":case"avc3":case"avc4":var s=ia(n,["avcC"])[0];a+="."+la(s[1])+la(s[2])+la(s[3]);break;case"mp4a":var l=ia(t,[i])[0],u=ia(l.subarray(28),["esds"])[0];if(u&&u.length>12){var c=4;if(3!==u[c++])break;c=sa(u,c),c+=2;var d=u[c++];if(128&d&&(c+=2),64&d&&(c+=u[c++]),4!==u[c++])break;c=sa(u,c);var h=u[c++];if(64!==h)break;if(a+="."+la(h),c+=12,5!==u[c++])break;c=sa(u,c);var f=u[c++],v=(248&f)>>3;31===v&&(v+=1+((7&f)<<3)+((224&u[c])>>5)),a+="."+v}break;case"hvc1":case"hev1":var m=ia(n,["hvcC"])[0],p=m[1],g=["","A","B","C"][p>>6],y=31&p,E=$i(m,2),A=(32&p)>>5?"H":"L",b=m[12],k=m.subarray(6,12);a+="."+g+y,a+="."+E.toString(16).toUpperCase(),a+="."+A+b;for(var T="",_=k.length;_--;){var S=k[_];if(S||T)T="."+S.toString(16).toUpperCase()+T}a+=T;break;case"dvh1":case"dvhe":var w=ia(n,["dvcC"])[0],R=w[2]>>1&127,L=w[2]<<5&32|w[3]>>3&31;a+="."+ua(R)+"."+ua(L);break;case"vp09":var I=ia(n,["vpcC"])[0],D=I[4],C=I[5],x=I[6]>>4&15;a+="."+ua(D)+"."+ua(C)+"."+ua(x);break;case"av01":var M=ia(n,["av1C"])[0],O=M[1]>>>5,P=31&M[1],N=M[2]>>>7?"H":"M",U=(64&M[2])>>6,F=(32&M[2])>>5,B=2===O&&U?F?12:10:U?10:8,H=(16&M[2])>>4,G=(8&M[2])>>3,K=(4&M[2])>>2,W=3&M[2];a+="."+O+"."+ua(P)+N+"."+ua(B)+"."+H+"."+G+K+W+"."+ua(1)+"."+ua(1)+"."+ua(1)+".0"}return{codec:a,encrypted:r}}function sa(e,t){for(var n=t+5;128&e[t++]&&t<n;);return t}function la(e){return("0"+e.toString(16).toUpperCase()).slice(-2)}function ua(e){return(e<10?"0":"")+e}function ca(e){var t=ia(e,["schm"])[0];if(t){var n=Zi(t.subarray(4,8));if("cbcs"===n||"cenc"===n)return ia(e,["schi","tenc"])[0]}return null}function da(e){var t=$i(e,0),n=8;1&t&&(n+=4),4&t&&(n+=4);for(var i=0,a=$i(e,4),r=0;r<a;r++){if(256&t)i+=$i(e,n),n+=4;512&t&&(n+=4),1024&t&&(n+=4),2048&t&&(n+=4)}return i}function ha(e,t){var n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}function fa(e,t){var n=[],i=t.samples,a=t.timescale,r=t.id,o=!1;return ia(i,["moof"]).map((function(s){var l=s.byteOffset-8;ia(s,["traf"]).map((function(s){var u=ia(s,["tfdt"]).map((function(e){var t=e[0],n=$i(e,4);return 1===t&&(n*=Math.pow(2,32),n+=$i(e,8)),n/a}))[0];return void 0!==u&&(e=u),ia(s,["tfhd"]).map((function(u){var c=$i(u,4),d=16777215&$i(u,0),h=0,f=0!==(16&d),v=0,m=0!==(32&d),p=8;c===r&&(0!==(1&d)&&(p+=8),0!==(2&d)&&(p+=4),0!==(8&d)&&(h=$i(u,p),p+=4),f&&(v=$i(u,p),p+=4),m&&(p+=4),"video"===t.type&&(o=function(e){if(!e)return!1;var t=e.indexOf("."),n=t<0?e:e.substring(0,t);return"hvc1"===n||"hev1"===n||"dvh1"===n||"dvhe"===n}(t.codec)),ia(s,["trun"]).map((function(r){var s=r[0],u=16777215&$i(r,0),c=0!==(1&u),d=0,f=0!==(4&u),m=0!==(256&u),p=0,g=0!==(512&u),y=0,E=0!==(1024&u),A=0!==(2048&u),b=0,k=$i(r,4),T=8;c&&(d=$i(r,T),T+=4),f&&(T+=4);for(var _=d+l,S=0;S<k;S++){if(m?(p=$i(r,T),T+=4):p=h,g?(y=$i(r,T),T+=4):y=v,E&&(T+=4),A&&(b=0===s?$i(r,T):ta(r,T),T+=4),t.type===ii)for(var w=0;w<y;){var R=$i(i,_);if(va(o,i[_+=4]))ma(i.subarray(_,_+R),o?2:1,e+b/a,n);_+=R,w+=R+4}e+=p/a}})))}))}))})),n}function va(e,t){if(e){var n=t>>1&63;return 39===n||40===n}return 6===(31&t)}function ma(e,t,n,i){var a=pa(e),r=0;r+=t;for(var o=0,s=0,l=0;r<a.length;){o=0;do{if(r>=a.length)break;o+=l=a[r++]}while(255===l);s=0;do{if(r>=a.length)break;s+=l=a[r++]}while(255===l);var u=a.length-r,c=r;if(s<u)r+=s;else if(s>u){Xn.error("Malformed SEI payload. ".concat(s," is too small, only ").concat(u," bytes left to parse."));break}if(4===o){if(181===a[c++]){var d=Ji(a,c);if(c+=2,49===d){var h=$i(a,c);if(c+=4,1195456820===h){var f=a[c++];if(3===f){var v=a[c++],m=64&v,p=m?2+3*(31&v):0,g=new Uint8Array(p);if(m){g[0]=v;for(var y=1;y<p;y++)g[y]=a[c++]}i.push({type:f,payloadType:o,pts:n,bytes:g})}}}}}else if(5===o&&s>16){for(var E=[],A=0;A<16;A++){var b=a[c++].toString(16);E.push(1==b.length?"0"+b:b),3!==A&&5!==A&&7!==A&&9!==A||E.push("-")}for(var k=s-16,T=new Uint8Array(k),_=0;_<k;_++)T[_]=a[c++];i.push({payloadType:o,pts:n,uuid:E.join(""),userData:qi(T),userDataBytes:T})}}}function pa(e){for(var t=e.byteLength,n=[],i=1;i<t-2;)0===e[i]&&0===e[i+1]&&3===e[i+2]?(n.push(i+2),i+=2):i++;if(0===n.length)return e;var a=t-n.length,r=new Uint8Array(a),o=0;for(i=0;i<a;o++,i++)o===n[0]&&(o++,n.shift()),r[i]=e[o];return r}function ga(e,t,n){if(16!==e.byteLength)throw new RangeError("Invalid system id");var i,a,r;if(t){i=1,a=new Uint8Array(16*t.length);for(var o=0;o<t.length;o++){var s=t[o];if(16!==s.byteLength)throw new RangeError("Invalid key");a.set(s,16*o)}}else i=0,a=new Uint8Array;i>0?(r=new Uint8Array(4),t.length>0&&new DataView(r.buffer).setUint32(0,t.length,!1)):r=new Uint8Array;var l=new Uint8Array(4);return n&&n.byteLength>0&&new DataView(l.buffer).setUint32(0,n.byteLength,!1),function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(var a=n.length,r=8,o=a;o--;)r+=n[o].byteLength;var s=new Uint8Array(r);for(s[0]=r>>24&255,s[1]=r>>16&255,s[2]=r>>8&255,s[3]=255&r,s.set(e,4),o=0,r=8;o<a;o++)s.set(n[o],r),r+=n[o].byteLength;return s}([112,115,115,104],new Uint8Array([i,0,0,0]),e,r,a,l,n||new Uint8Array)}function ya(e){var t=e.getUint32(0),n=e.byteOffset,i=e.byteLength;if(i<t)return{offset:n,size:i};if(1886614376!==e.getUint32(4))return{offset:n,size:t};var a=e.getUint32(8)>>>24;if(0!==a&&1!==a)return{offset:n,size:t};var r=e.buffer,o=ji(new Uint8Array(r,n+12,16)),s=e.getUint32(28),l=null,u=null;if(0===a){if(t-32<s||s<22)return{offset:n,size:t};u=new Uint8Array(r,n+32,s)}else if(1===a){if(!s||i<n+32+16*s+16)return{offset:n,size:t};l=[];for(var c=0;c<s;c++)l.push(new Uint8Array(r,n+32+16*c,16))}return{version:a,systemId:o,kids:l,data:u,offset:n,size:t}}var Ea={},Aa=function(){function e(t,n,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;(0,m.A)(this,e),this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=t,this.uri=n,this.keyFormat=i,this.keyFormatVersions=a,this.iv=r,this.encrypted=!!t&&"NONE"!==t,this.isCommonEncryption=this.encrypted&&"AES-128"!==t}return(0,v.A)(e,[{key:"isSupported",value:function(){if(this.method){if("AES-128"===this.method||"NONE"===this.method)return!0;if("identity"===this.keyFormat)return"SAMPLE-AES"===this.method;switch(this.keyFormat){case mi:case gi:case pi:case vi:return-1!==["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)}}return!1}},{key:"getDecryptData",value:function(t){if(!this.encrypted||!this.uri)return null;if("AES-128"===this.method&&this.uri&&!this.iv){"number"!==typeof t&&("AES-128"!==this.method||this.iv||Xn.warn('missing IV for initialization segment with method="'.concat(this.method,'" - compliance issue')),t=0);var n=function(e){for(var t=new Uint8Array(16),n=12;n<16;n++)t[n]=e>>8*(15-n)&255;return t}(t);return new e(this.method,this.uri,"identity",this.keyFormatVersions,n)}var i=ci(this.uri);if(i)switch(this.keyFormat){case gi:this.pssh=i,i.length>=22&&(this.keyId=i.subarray(i.length-22,i.length-6));break;case pi:var a=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=ga(a,null,i),this.keyId=Li(i);break;default:var r=i.subarray(0,16);if(16!==r.length){var o=new Uint8Array(16);o.set(r,16-r.length),r=o}this.keyId=r}if(!this.keyId||16!==this.keyId.byteLength){var s=Ea[this.uri];if(!s){var l=Object.keys(Ea).length%Number.MAX_SAFE_INTEGER;s=new Uint8Array(16),new DataView(s.buffer,12,4).setUint32(0,l),Ea[this.uri]=s}this.keyId=s}return this}}],[{key:"clearKeyUriToKeyIdMap",value:function(){Ea={}}}]),e}();var ba=/\{\$([a-zA-Z0-9-_]+)\}/g;function ka(e){return ba.test(e)}function Ta(e,t,n){if(null!==e.variableList||e.hasVariableRefs)for(var i=n.length;i--;){var a=n[i],r=t[a];r&&(t[a]=_a(e,r))}}function _a(e,t){if(null!==e.variableList||e.hasVariableRefs){var n=e.variableList;return t.replace(ba,(function(t){var i=t.substring(2,t.length-1),a=null==n?void 0:n[i];return void 0===a?(e.playlistParsingError||(e.playlistParsingError=new Error('Missing preceding EXT-X-DEFINE tag for Variable Reference: "'.concat(i,'"'))),t):a}))}return t}function Sa(e,t,n){var i,a,r=e.variableList;if(r||(e.variableList=r={}),"QUERYPARAM"in t){i=t.QUERYPARAM;try{var o=new self.URL(n).searchParams;if(!o.has(i))throw new Error('"'.concat(i,'" does not match any query parameter in URI: "').concat(n,'"'));a=o.get(i)}catch(s){e.playlistParsingError||(e.playlistParsingError=new Error("EXT-X-DEFINE QUERYPARAM: ".concat(s.message)))}}else i=t.NAME,a=t.VALUE;i in r?e.playlistParsingError||(e.playlistParsingError=new Error('EXT-X-DEFINE duplicate Variable Name declarations: "'.concat(i,'"'))):r[i]=a||""}function wa(e,t,n){var i=t.IMPORT;if(n&&i in n){var a=e.variableList;a||(e.variableList=a={}),a[i]=n[i]}else e.playlistParsingError||(e.playlistParsingError=new Error('EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "'.concat(i,'"')))}function Ra(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if("undefined"!==typeof self){var t=(e||!self.MediaSource)&&self.ManagedMediaSource;return t||self.MediaSource||self.WebKitMediaSource}}var La={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function Ia(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return!e.split(",").some((function(e){return!Da(e,t,n)}))}function Da(e,t){var n,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=Ra(i);return null!=(n=null==a?void 0:a.isTypeSupported(Ca(e,t)))&&n}function Ca(e,t){return"".concat(t,'/mp4;codecs="').concat(e,'"')}function xa(e){if(e){var t=e.substring(0,4);return La.video[t]}return 2}function Ma(e){return e.split(",").reduce((function(e,t){var n=La.video[t];return n?(2*n+e)/(e?3:2):(La.audio[t]+e)/(e?2:1)}),0)}var Oa={};function Pa(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(Oa[e])return Oa[e];for(var n={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"]}[e],i=0;i<n.length;i++)if(Da(n[i],"audio",t))return Oa[e]=n[i],n[i];return e}var Na=/flac|opus/i;function Ua(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.replace(Na,(function(e){return Pa(e.toLowerCase(),t)}))}function Fa(e,t){return e&&"mp4a"!==e?e:t?t.split(",")[0]:t}var Ba=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,Ha=/#EXT-X-MEDIA:(.*)/g,Ga=/^#EXT(?:INF|-X-TARGETDURATION):/m,Ka=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),Wa=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),Va=function(){function e(){(0,m.A)(this,e)}return(0,v.A)(e,null,[{key:"findGroup",value:function(e,t){for(var n=0;n<e.length;n++){var i=e[n];if(i.id===t)return i}}},{key:"resolve",value:function(e,t){return xn.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}},{key:"isMediaPlaylist",value:function(e){return Ga.test(e)}},{key:"parseMasterPlaylist",value:function(t,n){var i,a={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:ka(t)},r=[];for(Ba.lastIndex=0;null!=(i=Ba.exec(t));)if(i[1]){var o,s=new Jn(i[1]);Ta(a,s,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);var l=_a(a,i[2]),u={attrs:s,bitrate:s.decimalInteger("BANDWIDTH")||s.decimalInteger("AVERAGE-BANDWIDTH"),name:s.NAME,url:e.resolve(l,n)},c=s.decimalResolution("RESOLUTION");c&&(u.width=c.width,u.height=c.height),ja(s.CODECS,u),null!=(o=u.unknownCodecs)&&o.length||r.push(u),a.levels.push(u)}else if(i[3]){var d=i[3],h=i[4];switch(d){case"SESSION-DATA":var f=new Jn(h);Ta(a,f,["DATA-ID","LANGUAGE","VALUE","URI"]);var v=f["DATA-ID"];v&&(null===a.sessionData&&(a.sessionData={}),a.sessionData[v]=f);break;case"SESSION-KEY":var m=qa(h,n,a);m.encrypted&&m.isSupported()?(null===a.sessionKeys&&(a.sessionKeys=[]),a.sessionKeys.push(m)):Xn.warn('[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "'.concat(h,'"'));break;case"DEFINE":var p=new Jn(h);Ta(a,p,["NAME","VALUE","QUERYPARAM"]),Sa(a,p,n);break;case"CONTENT-STEERING":var g=new Jn(h);Ta(a,g,["SERVER-URI","PATHWAY-ID"]),a.contentSteering={uri:e.resolve(g["SERVER-URI"],n),pathwayId:g["PATHWAY-ID"]||"."};break;case"START":a.startTimeOffset=Ya(h)}}var y=r.length>0&&r.length<a.levels.length;return a.levels=y?r:a.levels,0===a.levels.length&&(a.playlistParsingError=new Error("no levels found in manifest")),a}},{key:"parseMasterPlaylistMedia",value:function(t,n,i){var a,r={},o=i.levels,s={AUDIO:o.map((function(e){return{id:e.attrs.AUDIO,audioCodec:e.audioCodec}})),SUBTITLES:o.map((function(e){return{id:e.attrs.SUBTITLES,textCodec:e.textCodec}})),"CLOSED-CAPTIONS":[]},l=0;for(Ha.lastIndex=0;null!==(a=Ha.exec(t));){var u=new Jn(a[1]),c=u.TYPE;if(c){var d=s[c],h=r[c]||[];r[c]=h,Ta(i,u,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);var f=u.LANGUAGE,v=u["ASSOC-LANGUAGE"],m=u.CHANNELS,p=u.CHARACTERISTICS,g=u["INSTREAM-ID"],y={attrs:u,bitrate:0,id:l++,groupId:u["GROUP-ID"]||"",name:u.NAME||f||"",type:c,default:u.bool("DEFAULT"),autoselect:u.bool("AUTOSELECT"),forced:u.bool("FORCED"),lang:f,url:u.URI?e.resolve(u.URI,n):""};if(v&&(y.assocLang=v),m&&(y.channels=m),p&&(y.characteristics=p),g&&(y.instreamId=g),null!=d&&d.length){var E=e.findGroup(d,y.groupId)||d[0];za(y,E,"audioCodec"),za(y,E,"textCodec")}h.push(y)}}return r}},{key:"parseLevelPlaylist",value:function(e,t,n,i,a,r){var o,s,l,u=new li(t),c=u.fragments,d=null,h=0,f=0,v=0,m=0,p=null,g=new oi(i,t),y=-1,E=!1,A=null;for(Ka.lastIndex=0,u.m3u8=e,u.hasVariableRefs=ka(e);null!==(o=Ka.exec(e));){E&&(E=!1,(g=new oi(i,t)).start=v,g.sn=h,g.cc=m,g.level=n,d&&(g.initSegment=d,g.rawProgramDateTime=d.rawProgramDateTime,d.rawProgramDateTime=null,A&&(g.setByteRange(A),A=null)));var b=o[1];if(b){g.duration=parseFloat(b);var k=(" "+o[2]).slice(1);g.title=k||null,g.tagList.push(k?["INF",b,k]:["INF",b])}else if(o[3]){if(Fn(g.duration)){g.start=v,l&&Za(g,l,u),g.sn=h,g.level=n,g.cc=m,c.push(g);var T=(" "+o[3]).slice(1);g.relurl=_a(u,T),Xa(g,p),p=g,v+=g.duration,h++,f=0,E=!0}}else if(o[4]){var _=(" "+o[4]).slice(1);p?g.setByteRange(_,p):g.setByteRange(_)}else if(o[5])g.rawProgramDateTime=(" "+o[5]).slice(1),g.tagList.push(["PROGRAM-DATE-TIME",g.rawProgramDateTime]),-1===y&&(y=c.length);else{if(!(o=o[0].match(Wa))){Xn.warn("No matches on slow regex match for level playlist!");continue}for(s=1;s<o.length&&"undefined"===typeof o[s];s++);var S=(" "+o[s]).slice(1),w=(" "+o[s+1]).slice(1),R=o[s+2]?(" "+o[s+2]).slice(1):"";switch(S){case"PLAYLIST-TYPE":u.type=w.toUpperCase();break;case"MEDIA-SEQUENCE":h=u.startSN=parseInt(w);break;case"SKIP":var L=new Jn(w);Ta(u,L,["RECENTLY-REMOVED-DATERANGES"]);var I=L.decimalInteger("SKIPPED-SEGMENTS");if(Fn(I)){u.skippedSegments=I;for(var D=I;D--;)c.unshift(null);h+=I}var C=L.enumeratedString("RECENTLY-REMOVED-DATERANGES");C&&(u.recentlyRemovedDateranges=C.split("\t"));break;case"TARGETDURATION":u.targetduration=Math.max(parseInt(w),1);break;case"VERSION":u.version=parseInt(w);break;case"INDEPENDENT-SEGMENTS":case"EXTM3U":break;case"ENDLIST":u.live=!1;break;case"#":(w||R)&&g.tagList.push(R?[w,R]:[w]);break;case"DISCONTINUITY":m++,g.tagList.push(["DIS"]);break;case"GAP":g.gap=!0,g.tagList.push([S]);break;case"BITRATE":g.tagList.push([S,w]);break;case"DATERANGE":var x=new Jn(w);Ta(u,x,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),Ta(u,x,x.clientAttrs);var M=new ei(x,u.dateRanges[x.ID]);M.isValid||u.skippedSegments?u.dateRanges[M.id]=M:Xn.warn('Ignoring invalid DATERANGE tag: "'.concat(w,'"')),g.tagList.push(["EXT-X-DATERANGE",w]);break;case"DEFINE":var O=new Jn(w);Ta(u,O,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in O?wa(u,O,r):Sa(u,O,t);break;case"DISCONTINUITY-SEQUENCE":m=parseInt(w);break;case"KEY":var P=qa(w,t,u);if(P.isSupported()){if("NONE"===P.method){l=void 0;break}l||(l={}),l[P.keyFormat]&&(l=Un({},l)),l[P.keyFormat]=P}else Xn.warn('[Keys] Ignoring invalid EXT-X-KEY tag: "'.concat(w,'"'));break;case"START":u.startTimeOffset=Ya(w);break;case"MAP":var N=new Jn(w);if(Ta(u,N,["BYTERANGE","URI"]),g.duration){var U=new oi(i,t);Qa(U,N,n,l),d=U,g.initSegment=d,d.rawProgramDateTime&&!g.rawProgramDateTime&&(g.rawProgramDateTime=d.rawProgramDateTime)}else{var F=g.byteRangeEndOffset;if(F){var B=g.byteRangeStartOffset;A="".concat(F-B,"@").concat(B)}else A=null;Qa(g,N,n,l),d=g,E=!0}break;case"SERVER-CONTROL":var H=new Jn(w);u.canBlockReload=H.bool("CAN-BLOCK-RELOAD"),u.canSkipUntil=H.optionalFloat("CAN-SKIP-UNTIL",0),u.canSkipDateRanges=u.canSkipUntil>0&&H.bool("CAN-SKIP-DATERANGES"),u.partHoldBack=H.optionalFloat("PART-HOLD-BACK",0),u.holdBack=H.optionalFloat("HOLD-BACK",0);break;case"PART-INF":var G=new Jn(w);u.partTarget=G.decimalFloatingPoint("PART-TARGET");break;case"PART":var K=u.partList;K||(K=u.partList=[]);var W=f>0?K[K.length-1]:void 0,V=f++,q=new Jn(w);Ta(u,q,["BYTERANGE","URI"]);var Y=new si(q,g,t,V,W);K.push(Y),g.duration+=Y.duration;break;case"PRELOAD-HINT":var j=new Jn(w);Ta(u,j,["URI"]),u.preloadHint=j;break;case"RENDITION-REPORT":var z=new Jn(w);Ta(u,z,["URI"]),u.renditionReports=u.renditionReports||[],u.renditionReports.push(z);break;default:Xn.warn("line parsed but not handled: ".concat(o))}}}p&&!p.relurl?(c.pop(),v-=p.duration,u.partList&&(u.fragmentHint=p)):u.partList&&(Xa(g,p),g.cc=m,u.fragmentHint=g,l&&Za(g,l,u));var X=c.length,Q=c[0],Z=c[X-1];if((v+=u.skippedSegments*u.targetduration)>0&&X&&Z){u.averagetargetduration=v/X;var J=Z.sn;u.endSN="initSegment"!==J?J:0,u.live||(Z.endList=!0),Q&&(u.startCC=Q.cc)}else u.endSN=0,u.startCC=0;return u.fragmentHint&&(v+=u.fragmentHint.duration),u.totalduration=v,u.endCC=m,y>0&&function(e,t){for(var n=e[t],i=t;i--;){var a=e[i];if(!a)return;a.programDateTime=n.programDateTime-1e3*a.duration,n=a}}(c,y),u}}]),e}();function qa(e,t,n){var i,a,r=new Jn(e);Ta(n,r,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);var o=null!=(i=r.METHOD)?i:"",s=r.URI,l=r.hexadecimalInteger("IV"),u=r.KEYFORMATVERSIONS,c=null!=(a=r.KEYFORMAT)?a:"identity";s&&r.IV&&!l&&Xn.error("Invalid IV: ".concat(r.IV));var d=s?Va.resolve(s,t):"",h=(u||"1").split("/").map(Number).filter(Number.isFinite);return new Aa(o,d,c,h,l)}function Ya(e){var t=new Jn(e).decimalFloatingPoint("TIME-OFFSET");return Fn(t)?t:null}function ja(e,t){var n=(e||"").split(/[ ,]+/).filter((function(e){return e}));["video","audio","text"].forEach((function(e){var i=n.filter((function(t){return function(e,t){var n=La[t];return!!n&&!!n[e.slice(0,4)]}(t,e)}));i.length&&(t["".concat(e,"Codec")]=i.join(","),n=n.filter((function(e){return-1===i.indexOf(e)})))})),t.unknownCodecs=n}function za(e,t,n){var i=t[n];i&&(e[n]=i)}function Xa(e,t){e.rawProgramDateTime?e.programDateTime=Date.parse(e.rawProgramDateTime):null!=t&&t.programDateTime&&(e.programDateTime=t.endProgramDateTime),Fn(e.programDateTime)||(e.programDateTime=null,e.rawProgramDateTime=null)}function Qa(e,t,n,i){e.relurl=t.URI,t.BYTERANGE&&e.setByteRange(t.BYTERANGE),e.level=n,e.sn="initSegment",i&&(e.levelkeys=i),e.initSegment=null}function Za(e,t,n){e.levelkeys=t;var i=n.encryptedFragments;i.length&&i[i.length-1].levelkeys===t||!Object.keys(t).some((function(e){return t[e].isCommonEncryption}))||i.push(e)}var Ja="manifest",$a="level",er="audioTrack",tr="subtitleTrack",nr="main",ir="audio",ar="subtitle";function rr(e){switch(e.type){case er:return ir;case tr:return ar;default:return nr}}function or(e,t){var n=e.url;return void 0!==n&&0!==n.indexOf("data:")||(n=t.url),n}var sr=function(){function e(t){(0,m.A)(this,e),this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=t,this.registerListeners()}return(0,v.A)(e,[{key:"startLoad",value:function(e){}},{key:"stopLoad",value:function(){this.destroyInternalLoaders()}},{key:"registerListeners",value:function(){var e=this.hls;e.on(Gn.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Gn.LEVEL_LOADING,this.onLevelLoading,this),e.on(Gn.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(Gn.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}},{key:"unregisterListeners",value:function(){var e=this.hls;e.off(Gn.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Gn.LEVEL_LOADING,this.onLevelLoading,this),e.off(Gn.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(Gn.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}},{key:"createInternalLoader",value:function(e){var t=this.hls.config,n=t.pLoader,i=t.loader,a=new(n||i)(t);return this.loaders[e.type]=a,a}},{key:"getInternalLoader",value:function(e){return this.loaders[e.type]}},{key:"resetInternalLoader",value:function(e){this.loaders[e]&&delete this.loaders[e]}},{key:"destroyInternalLoaders",value:function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}},{key:"destroy",value:function(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}},{key:"onManifestLoading",value:function(e,t){var n=t.url;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:Ja,url:n,deliveryDirectives:null})}},{key:"onLevelLoading",value:function(e,t){var n=t.id,i=t.level,a=t.pathwayId,r=t.url,o=t.deliveryDirectives;this.load({id:n,level:i,pathwayId:a,responseType:"text",type:$a,url:r,deliveryDirectives:o})}},{key:"onAudioTrackLoading",value:function(e,t){var n=t.id,i=t.groupId,a=t.url,r=t.deliveryDirectives;this.load({id:n,groupId:i,level:null,responseType:"text",type:er,url:a,deliveryDirectives:r})}},{key:"onSubtitleTrackLoading",value:function(e,t){var n=t.id,i=t.groupId,a=t.url,r=t.deliveryDirectives;this.load({id:n,groupId:i,level:null,responseType:"text",type:tr,url:a,deliveryDirectives:r})}},{key:"load",value:function(e){var t,n,i,a=this,r=this.hls.config,o=this.getInternalLoader(e);if(o){var s=o.context;if(s&&s.url===e.url&&s.level===e.level)return void Xn.trace("[playlist-loader]: playlist request ongoing");Xn.log("[playlist-loader]: aborting previous loader for type: ".concat(e.type)),o.abort()}if((n=e.type===Ja?r.manifestLoadPolicy.default:Un({},r.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),o=this.createInternalLoader(e),Fn(null==(t=e.deliveryDirectives)?void 0:t.part))&&(e.type===$a&&null!==e.level?i=this.hls.levels[e.level].details:e.type===er&&null!==e.id?i=this.hls.audioTracks[e.id].details:e.type===tr&&null!==e.id&&(i=this.hls.subtitleTracks[e.id].details),i)){var l=i.partTarget,u=i.targetduration;if(l&&u){var c=1e3*Math.max(3*l,.8*u);n=Un({},n,{maxTimeToFirstByteMs:Math.min(c,n.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(c,n.maxTimeToFirstByteMs)})}}var d=n.errorRetry||n.timeoutRetry||{},h={loadPolicy:n,timeout:n.maxLoadTimeMs,maxRetry:d.maxNumRetry||0,retryDelay:d.retryDelayMs||0,maxRetryDelay:d.maxRetryDelayMs||0},f={onSuccess:function(e,t,n,i){var r=a.getInternalLoader(n);a.resetInternalLoader(n.type);var o=e.data;0===o.indexOf("#EXTM3U")?(t.parsing.start=performance.now(),Va.isMediaPlaylist(o)?a.handleTrackOrLevelPlaylist(e,t,n,i||null,r):a.handleMasterPlaylist(e,t,n,i)):a.handleManifestParsingError(e,n,new Error("no EXTM3U delimiter"),i||null,t)},onError:function(e,t,n,i){a.handleNetworkError(t,n,!1,e,i)},onTimeout:function(e,t,n){a.handleNetworkError(t,n,!0,void 0,e)}};o.load(e,h,f)}},{key:"handleMasterPlaylist",value:function(e,t,n,i){var a=this.hls,r=e.data,o=or(e,n),s=Va.parseMasterPlaylist(r,o);if(s.playlistParsingError)this.handleManifestParsingError(e,n,s.playlistParsingError,i,t);else{var l=s.contentSteering,u=s.levels,c=s.sessionData,d=s.sessionKeys,h=s.startTimeOffset,f=s.variableList;this.variableList=f;var v=Va.parseMasterPlaylistMedia(r,o,s),m=v.AUDIO,p=void 0===m?[]:m,g=v.SUBTITLES,y=v["CLOSED-CAPTIONS"];if(p.length)p.some((function(e){return!e.url}))||!u[0].audioCodec||u[0].attrs.AUDIO||(Xn.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),p.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new Jn({}),bitrate:0,url:""}));a.trigger(Gn.MANIFEST_LOADED,{levels:u,audioTracks:p,subtitles:g,captions:y,contentSteering:l,url:o,stats:t,networkDetails:i,sessionData:c,sessionKeys:d,startTimeOffset:h,variableList:f})}}},{key:"handleTrackOrLevelPlaylist",value:function(e,t,n,i,a){var r=this.hls,o=n.id,s=n.level,l=n.type,u=or(e,n),c=Fn(s)?s:Fn(o)?o:0,d=rr(n),h=Va.parseLevelPlaylist(e.data,u,c,d,0,this.variableList);if(l===Ja){var f={attrs:new Jn({}),bitrate:0,details:h,name:"",url:u};r.trigger(Gn.MANIFEST_LOADED,{levels:[f],audioTracks:[],url:u,stats:t,networkDetails:i,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),n.levelDetails=h,this.handlePlaylistLoaded(h,e,t,n,i,a)}},{key:"handleManifestParsingError",value:function(e,t,n,i,a){this.hls.trigger(Gn.ERROR,{type:Kn.NETWORK_ERROR,details:Wn.MANIFEST_PARSING_ERROR,fatal:t.type===Ja,url:e.url,err:n,error:n,reason:n.message,response:e,context:t,networkDetails:i,stats:a})}},{key:"handleNetworkError",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,r="A network ".concat(n?"timeout":"error"+(i?" (status "+i.code+")":"")," occurred while loading ").concat(e.type);e.type===$a?r+=": ".concat(e.level," id: ").concat(e.id):e.type!==er&&e.type!==tr||(r+=" id: ".concat(e.id,' group-id: "').concat(e.groupId,'"'));var o=new Error(r);Xn.warn("[playlist-loader]: ".concat(r));var s=Wn.UNKNOWN,l=!1,u=this.getInternalLoader(e);switch(e.type){case Ja:s=n?Wn.MANIFEST_LOAD_TIMEOUT:Wn.MANIFEST_LOAD_ERROR,l=!0;break;case $a:s=n?Wn.LEVEL_LOAD_TIMEOUT:Wn.LEVEL_LOAD_ERROR,l=!1;break;case er:s=n?Wn.AUDIO_TRACK_LOAD_TIMEOUT:Wn.AUDIO_TRACK_LOAD_ERROR,l=!1;break;case tr:s=n?Wn.SUBTITLE_TRACK_LOAD_TIMEOUT:Wn.SUBTITLE_LOAD_ERROR,l=!1}u&&this.resetInternalLoader(e.type);var c={type:Kn.NETWORK_ERROR,details:s,fatal:l,url:e.url,loader:u,context:e,error:o,networkDetails:t,stats:a};if(i){var d=(null==t?void 0:t.url)||e.url;c.response=On({url:d,data:void 0},i)}this.hls.trigger(Gn.ERROR,c)}},{key:"handlePlaylistLoaded",value:function(e,t,n,i,a,r){var o=this.hls,s=i.type,l=i.level,u=i.id,c=i.groupId,d=i.deliveryDirectives,h=or(t,i),f=rr(i),v="number"===typeof i.level&&f===nr?l:void 0;if(e.fragments.length){e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));var m=e.playlistParsingError;if(m)o.trigger(Gn.ERROR,{type:Kn.NETWORK_ERROR,details:Wn.LEVEL_PARSING_ERROR,fatal:!1,url:h,error:m,reason:m.message,response:t,context:i,level:v,parent:f,networkDetails:a,stats:n});else switch(e.live&&r&&(r.getCacheAge&&(e.ageHeader=r.getCacheAge()||0),r.getCacheAge&&!isNaN(e.ageHeader)||(e.ageHeader=0)),s){case Ja:case $a:o.trigger(Gn.LEVEL_LOADED,{details:e,level:v||0,id:u||0,stats:n,networkDetails:a,deliveryDirectives:d});break;case er:o.trigger(Gn.AUDIO_TRACK_LOADED,{details:e,id:u||0,groupId:c||"",stats:n,networkDetails:a,deliveryDirectives:d});break;case tr:o.trigger(Gn.SUBTITLE_TRACK_LOADED,{details:e,id:u||0,groupId:c||"",stats:n,networkDetails:a,deliveryDirectives:d})}}else{var p=new Error("No Segments found in Playlist");o.trigger(Gn.ERROR,{type:Kn.NETWORK_ERROR,details:Wn.LEVEL_EMPTY_ERROR,fatal:!1,url:h,error:p,reason:p.message,response:t,context:i,level:v,parent:f,networkDetails:a,stats:n})}}}]),e}();function lr(e,t){var n;try{n=new Event("addtrack")}catch(i){(n=document.createEvent("Event")).initEvent("addtrack",!1,!1)}n.track=e,t.dispatchEvent(n)}function ur(e,t){var n=e.mode;if("disabled"===n&&(e.mode="hidden"),e.cues&&!e.cues.getCueById(t.id))try{if(e.addCue(t),!e.cues.getCueById(t.id))throw new Error("addCue is failed for: ".concat(t))}catch(a){Xn.debug("[texttrack-utils]: ".concat(a));try{var i=new self.TextTrackCue(t.startTime,t.endTime,t.text);i.id=t.id,e.addCue(i)}catch(r){Xn.debug("[texttrack-utils]: Legacy TextTrackCue fallback failed: ".concat(r))}}"disabled"===n&&(e.mode=n)}function cr(e){var t=e.mode;if("disabled"===t&&(e.mode="hidden"),e.cues)for(var n=e.cues.length;n--;)e.removeCue(e.cues[n]);"disabled"===t&&(e.mode=t)}function dr(e,t,n,i){var a=e.mode;if("disabled"===a&&(e.mode="hidden"),e.cues&&e.cues.length>0)for(var r=function(e,t,n){var i=[],a=function(e,t){if(t<e[0].startTime)return 0;var n=e.length-1;if(t>e[n].endTime)return-1;var i=0,a=n;for(;i<=a;){var r=Math.floor((a+i)/2);if(t<e[r].startTime)a=r-1;else{if(!(t>e[r].startTime&&i<n))return r;i=r+1}}return e[i].startTime-t<t-e[a].startTime?i:a}(e,t);if(a>-1)for(var r=a,o=e.length;r<o;r++){var s=e[r];if(s.startTime>=t&&s.endTime<=n)i.push(s);else if(s.startTime>n)return i}return i}(e.cues,t,n),o=0;o<r.length;o++)i&&!i(r[o])||e.removeCue(r[o]);"disabled"===a&&(e.mode=a)}function hr(e){for(var t=[],n=0;n<e.length;n++){var i=e[n];"subtitles"!==i.kind&&"captions"!==i.kind||!i.label||t.push(e[n])}return t}var fr="org.id3",vr="com.apple.quicktime.HLS",mr="https://aomedia.org/emsg/ID3";function pr(){if("undefined"!==typeof self)return self.VTTCue||self.TextTrackCue}function gr(e,t,n,i,a){var r=new e(t,n,"");try{r.value=i,a&&(r.type=a)}catch(Rv){r=new e(t,n,JSON.stringify(a?On({type:a},i):i))}return r}var yr=function(){var e=pr();try{e&&new e(0,Number.POSITIVE_INFINITY,"")}catch(Rv){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY}();function Er(e,t){return e.getTime()/1e3-t}var Ar=function(){function e(t){(0,m.A)(this,e),this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=t,this._registerListeners()}return(0,v.A)(e,[{key:"destroy",value:function(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}},{key:"_registerListeners",value:function(){var e=this.hls;e.on(Gn.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Gn.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Gn.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Gn.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(Gn.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(Gn.LEVEL_UPDATED,this.onLevelUpdated,this)}},{key:"_unregisterListeners",value:function(){var e=this.hls;e.off(Gn.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Gn.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Gn.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Gn.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(Gn.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(Gn.LEVEL_UPDATED,this.onLevelUpdated,this)}},{key:"onMediaAttached",value:function(e,t){this.media=t.media}},{key:"onMediaDetaching",value:function(){this.id3Track&&(cr(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}},{key:"onManifestLoading",value:function(){this.dateRangeCuesAppended={}}},{key:"createTrack",value:function(e){var t=this.getID3Track(e.textTracks);return t.mode="hidden",t}},{key:"getID3Track",value:function(e){if(this.media){for(var t=0;t<e.length;t++){var n=e[t];if("metadata"===n.kind&&"id3"===n.label)return lr(n,this.media),n}return this.media.addTextTrack("metadata","id3")}}},{key:"onFragParsingMetadata",value:function(e,t){if(this.media){var n=this.hls.config,i=n.enableEmsgMetadataCues,a=n.enableID3MetadataCues;if(i||a){var r=t.samples;this.id3Track||(this.id3Track=this.createTrack(this.media));var o=pr();if(o)for(var s=0;s<r.length;s++){var l=r[s].type;if((l!==mr||i)&&a){var u=Bi(r[s].data);if(u){var c=r[s].pts,d=c+r[s].duration;d>yr&&(d=yr),d-c<=0&&(d=c+.25);for(var h=0;h<u.length;h++){var f=u[h];if(!Ui(f)){this.updateId3CueEnds(c,l);var v=gr(o,c,d,f,l);v&&this.id3Track.addCue(v)}}}}}}}}},{key:"updateId3CueEnds",value:function(e,t){var n,i=null==(n=this.id3Track)?void 0:n.cues;if(i)for(var a=i.length;a--;){var r=i[a];r.type===t&&r.startTime<e&&r.endTime===yr&&(r.endTime=e)}}},{key:"onBufferFlushing",value:function(e,t){var n=t.startOffset,i=t.endOffset,a=t.type,r=this.id3Track,o=this.hls;if(o){var s=o.config,l=s.enableEmsgMetadataCues,u=s.enableID3MetadataCues;if(r&&(l||u))dr(r,n,i,"audio"===a?function(e){return e.type===fr&&u}:"video"===a?function(e){return e.type===mr&&l}:function(e){return e.type===fr&&u||e.type===mr&&l})}}},{key:"onLevelUpdated",value:function(e,t){var n=this,i=t.details;if(this.media&&i.hasProgramDateTime&&this.hls.config.enableDateRangeMetadataCues){var a=this.dateRangeCuesAppended,r=this.id3Track,o=i.dateRanges,s=Object.keys(o);if(r)for(var l=Object.keys(a).filter((function(e){return!s.includes(e)})),u=function(e){var t=l[e];Object.keys(a[t].cues).forEach((function(e){r.removeCue(a[t].cues[e])})),delete a[t]},c=l.length;c--;)u(c);var d=i.fragments[i.fragments.length-1];if(0!==s.length&&Fn(null==d?void 0:d.programDateTime)){this.id3Track||(this.id3Track=this.createTrack(this.media));for(var h=d.programDateTime/1e3-d.start,f=pr(),v=function(e){var t=s[e],i=o[t],r=Er(i.startDate,h),l=a[t],u=(null==l?void 0:l.cues)||{},c=(null==l?void 0:l.durationKnown)||!1,d=yr,v=i.endDate;if(v)d=Er(v,h),c=!0;else if(i.endOnNext&&!c){var m=s.reduce((function(e,t){if(t!==i.id){var n=o[t];if(n.class===i.class&&n.startDate>i.startDate&&(!e||i.startDate<e.startDate))return n}return e}),null);m&&(d=Er(m.startDate,h),c=!0)}for(var p,g,y=Object.keys(i.attr),E=0;E<y.length;E++){var A=y[E];if("ID"!==(g=A)&&"CLASS"!==g&&"START-DATE"!==g&&"DURATION"!==g&&"END-DATE"!==g&&"END-ON-NEXT"!==g){var b=u[A];if(b)c&&!l.durationKnown&&(b.endTime=d);else if(f){var k=i.attr[A];$n(A)&&(p=k,k=Uint8Array.from(p.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer);var T=gr(f,r,d,{key:A,data:k},vr);T&&(T.id=t,n.id3Track.addCue(T),u[A]=T)}}}a[t]={cues:u,dateRange:i,durationKnown:c}},m=0;m<s.length;m++)v(m)}}}}]),e}(),br=function(){function e(t){var n=this;(0,m.A)(this,e),this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=function(){return n.timeupdate()},this.hls=t,this.config=t.config,this.registerListeners()}return(0,v.A)(e,[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var e=this.config,t=this.levelDetails;return void 0!==e.liveMaxLatencyDuration?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}},{key:"targetLatency",get:function(){var e=this.levelDetails;if(null===e)return null;var t=e.holdBack,n=e.partHoldBack,i=e.targetduration,a=this.config,r=a.liveSyncDuration,o=a.liveSyncDurationCount,s=a.lowLatencyMode,l=this.hls.userConfig,u=s&&n||t;(l.liveSyncDuration||l.liveSyncDurationCount||0===u)&&(u=void 0!==r?r:o*i);var c=i;return u+Math.min(1*this.stallCount,c)}},{key:"liveSyncPosition",get:function(){var e=this.estimateLiveEdge(),t=this.targetLatency,n=this.levelDetails;if(null===e||null===t||null===n)return null;var i=n.edge,a=e-t-this.edgeStalled,r=i-n.totalduration,o=i-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(r,a),o)}},{key:"drift",get:function(){var e=this.levelDetails;return null===e?1:e.drift}},{key:"edgeStalled",get:function(){var e=this.levelDetails;if(null===e)return 0;var t=3*(this.config.lowLatencyMode&&e.partTarget||e.targetduration);return Math.max(e.age-t,0)}},{key:"forwardBufferLength",get:function(){var e=this.media,t=this.levelDetails;if(!e||!t)return 0;var n=e.buffered.length;return(n?e.buffered.end(n-1):t.edge)-this.currentTime}},{key:"destroy",value:function(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}},{key:"registerListeners",value:function(){this.hls.on(Gn.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(Gn.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(Gn.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(Gn.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(Gn.ERROR,this.onError,this)}},{key:"unregisterListeners",value:function(){this.hls.off(Gn.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(Gn.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(Gn.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(Gn.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(Gn.ERROR,this.onError,this)}},{key:"onMediaAttached",value:function(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}},{key:"onMediaDetaching",value:function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}},{key:"onManifestLoading",value:function(){this.levelDetails=null,this._latency=null,this.stallCount=0}},{key:"onLevelUpdated",value:function(e,t){var n=t.details;this.levelDetails=n,n.advanced&&this.timeupdate(),!n.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}},{key:"onError",value:function(e,t){var n;t.details===Wn.BUFFER_STALLED_ERROR&&(this.stallCount++,null!=(n=this.levelDetails)&&n.live&&Xn.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}},{key:"timeupdate",value:function(){var e=this.media,t=this.levelDetails;if(e&&t){this.currentTime=e.currentTime;var n=this.computeLatency();if(null!==n){this._latency=n;var i=this.config,a=i.lowLatencyMode,r=i.maxLiveSyncPlaybackRate;if(a&&1!==r&&t.live){var o=this.targetLatency;if(null!==o){var s=n-o;if(s<Math.min(this.maxLatency,o+t.targetduration)&&s>.05&&this.forwardBufferLength>1){var l=Math.min(2,Math.max(1,r)),u=Math.round(2/(1+Math.exp(-.75*s-this.edgeStalled))*20)/20;e.playbackRate=Math.min(l,Math.max(1,u))}else 1!==e.playbackRate&&0!==e.playbackRate&&(e.playbackRate=1)}}}}}},{key:"estimateLiveEdge",value:function(){var e=this.levelDetails;return null===e?null:e.edge+e.age}},{key:"computeLatency",value:function(){var e=this.estimateLiveEdge();return null===e?null:e-this.currentTime}}]),e}(),kr=["NONE","TYPE-0","TYPE-1",null];var Tr=["SDR","PQ","HLG"];var _r="",Sr="YES",wr="v2";function Rr(e){var t=e.canSkipUntil,n=e.canSkipDateRanges,i=e.age;return t&&i<t/2?n?wr:Sr:_r}var Lr=function(){function e(t,n,i){(0,m.A)(this,e),this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=t,this.part=n,this.skip=i}return(0,v.A)(e,[{key:"addDirectives",value:function(e){var t=new self.URL(e);return void 0!==this.msn&&t.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}]),e}(),Ir=function(){function e(t){(0,m.A)(this,e),this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[t.url],this._attrs=[t.attrs],this.bitrate=t.bitrate,t.details&&(this.details=t.details),this.id=t.id||0,this.name=t.name,this.width=t.width||0,this.height=t.height||0,this.frameRate=t.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=t.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=t.audioCodec,this.videoCodec=t.videoCodec,this.codecSet=[t.videoCodec,t.audioCodec].filter((function(e){return!!e})).map((function(e){return e.substring(0,4)})).join(","),this.addGroupId("audio",t.attrs.AUDIO),this.addGroupId("text",t.attrs.SUBTITLES)}return(0,v.A)(e,[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"averageBitrate",get:function(){return this._avgBitrate||this.realBitrate||this.bitrate}},{key:"attrs",get:function(){return this._attrs[0]}},{key:"codecs",get:function(){return this.attrs.CODECS||""}},{key:"pathwayId",get:function(){return this.attrs["PATHWAY-ID"]||"."}},{key:"videoRange",get:function(){return this.attrs["VIDEO-RANGE"]||"SDR"}},{key:"score",get:function(){return this.attrs.optionalFloat("SCORE",0)}},{key:"uri",get:function(){return this.url[0]||""}},{key:"hasAudioGroup",value:function(e){return Dr(this._audioGroups,e)}},{key:"hasSubtitleGroup",value:function(e){return Dr(this._subtitleGroups,e)}},{key:"audioGroups",get:function(){return this._audioGroups}},{key:"subtitleGroups",get:function(){return this._subtitleGroups}},{key:"addGroupId",value:function(e,t){if(t)if("audio"===e){var n=this._audioGroups;n||(n=this._audioGroups=[]),-1===n.indexOf(t)&&n.push(t)}else if("text"===e){var i=this._subtitleGroups;i||(i=this._subtitleGroups=[]),-1===i.indexOf(t)&&i.push(t)}}},{key:"urlId",get:function(){return 0},set:function(e){}},{key:"audioGroupIds",get:function(){return this.audioGroups?[this.audioGroupId]:void 0}},{key:"textGroupIds",get:function(){return this.subtitleGroups?[this.textGroupId]:void 0}},{key:"audioGroupId",get:function(){var e;return null==(e=this.audioGroups)?void 0:e[0]}},{key:"textGroupId",get:function(){var e;return null==(e=this.subtitleGroups)?void 0:e[0]}},{key:"addFallback",value:function(){}}]),e}();function Dr(e,t){return!(!t||!e)&&-1!==e.indexOf(t)}function Cr(e,t){var n=t.startPTS;if(Fn(n)){var i,a=0;t.sn>e.sn?(a=n-e.start,i=e):(a=e.start-n,i=t),i.duration!==a&&(i.duration=a)}else if(t.sn>e.sn){e.cc===t.cc&&e.minEndPTS?t.start=e.start+(e.minEndPTS-e.start):t.start=e.start+e.duration}else t.start=Math.max(e.start-t.duration,0)}function xr(e,t,n,i,a,r){i-n<=0&&(Xn.warn("Fragment should have a positive duration",t),i=n+t.duration,r=a+t.duration);var o=n,s=i,l=t.startPTS,u=t.endPTS;if(Fn(l)){var c=Math.abs(l-n);Fn(t.deltaPTS)?t.deltaPTS=Math.max(c,t.deltaPTS):t.deltaPTS=c,o=Math.max(n,l),n=Math.min(n,l),a=Math.min(a,t.startDTS),s=Math.min(i,u),i=Math.max(i,u),r=Math.max(r,t.endDTS)}var d=n-t.start;0!==t.start&&(t.start=n),t.duration=i-t.start,t.startPTS=n,t.maxStartPTS=o,t.startDTS=a,t.endPTS=i,t.minEndPTS=s,t.endDTS=r;var h,f=t.sn;if(!e||f<e.startSN||f>e.endSN)return 0;var v=f-e.startSN,m=e.fragments;for(m[v]=t,h=v;h>0;h--)Cr(m[h],m[h-1]);for(h=v;h<m.length-1;h++)Cr(m[h],m[h+1]);return e.fragmentHint&&Cr(m[m.length-1],e.fragmentHint),e.PTSKnown=e.alignedSliding=!0,d}function Mr(e,t){for(var n,i=null,a=e.fragments,r=a.length-1;r>=0;r--){var o=a[r].initSegment;if(o){i=o;break}}e.fragmentHint&&delete e.fragmentHint.endPTS,function(e,t,n){for(var i=t.skippedSegments,a=Math.max(e.startSN,t.startSN)-t.startSN,r=(e.fragmentHint?1:0)+(i?t.endSN:Math.min(e.endSN,t.endSN))-t.startSN,o=t.startSN-e.startSN,s=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,l=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,u=a;u<=r;u++){var c=l[o+u],d=s[u];i&&!d&&u<i&&(d=t.fragments[u]=c),c&&d&&n(c,d,u,s)}}(e,t,(function(e,a,r,o){if(t.skippedSegments&&a.cc!==e.cc)for(var s=e.cc-a.cc,l=r;l<o.length;l++)o[l].cc+=s;Fn(e.startPTS)&&Fn(e.endPTS)&&(a.start=a.startPTS=e.startPTS,a.startDTS=e.startDTS,a.maxStartPTS=e.maxStartPTS,a.endPTS=e.endPTS,a.endDTS=e.endDTS,a.minEndPTS=e.minEndPTS,a.duration=e.endPTS-e.startPTS,a.duration&&(n=a),t.PTSKnown=t.alignedSliding=!0),a.elementaryStreams=e.elementaryStreams,a.loader=e.loader,a.stats=e.stats,e.initSegment&&(a.initSegment=e.initSegment,i=e.initSegment)}));var s=t.fragments;i&&(t.fragmentHint?s.concat(t.fragmentHint):s).forEach((function(e){var t;!e||e.initSegment&&e.initSegment.relurl!==(null==(t=i)?void 0:t.relurl)||(e.initSegment=i)}));if(t.skippedSegments){if(t.deltaUpdateFailed=s.some((function(e){return!e})),t.deltaUpdateFailed){Xn.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var l=t.skippedSegments;l--;)s.shift();t.startSN=s[0].sn}else t.canSkipDateRanges&&(t.dateRanges=function(e,t,n){var i=Un({},e);n&&n.forEach((function(e){delete i[e]}));return Object.keys(t).forEach((function(e){var n=new ei(t[e].attr,i[e]);n.isValid?i[e]=n:Xn.warn('Ignoring invalid Playlist Delta Update DATERANGE tag: "'.concat(JSON.stringify(t[e].attr),'"'))})),i}(e.dateRanges,t.dateRanges,t.recentlyRemovedDateranges));t.startCC=t.fragments[0].cc,t.endCC=s[s.length-1].cc}!function(e,t,n){if(e&&t)for(var i=0,a=0,r=e.length;a<=r;a++){var o=e[a],s=t[a+i];o&&s&&o.index===s.index&&o.fragment.sn===s.fragment.sn?n(o,s):i--}}(e.partList,t.partList,(function(e,t){t.elementaryStreams=e.elementaryStreams,t.stats=e.stats})),n?xr(t,n,n.startPTS,n.endPTS,n.startDTS,n.endDTS):Or(e,t),s.length&&(t.totalduration=t.edge-s[0].start),t.driftStartTime=e.driftStartTime,t.driftStart=e.driftStart;var u=t.advancedDateTime;if(t.advanced&&u){var c=t.edge;t.driftStart||(t.driftStartTime=u,t.driftStart=c),t.driftEndTime=u,t.driftEnd=c}else t.driftEndTime=e.driftEndTime,t.driftEnd=e.driftEnd,t.advancedDateTime=e.advancedDateTime}function Or(e,t){var n=t.startSN+t.skippedSegments-e.startSN,i=e.fragments;n<0||n>=i.length||Pr(t,i[n].start)}function Pr(e,t){if(t){for(var n=e.fragments,i=e.skippedSegments;i<n.length;i++)n[i].start+=t;e.fragmentHint&&(e.fragmentHint.start+=t)}}function Nr(e,t,n){var i;return null!=e&&e.details?Ur(null==(i=e.details)?void 0:i.partList,t,n):null}function Ur(e,t,n){if(e)for(var i=e.length;i--;){var a=e[i];if(a.index===n&&a.fragment.sn===t)return a}return null}function Fr(e){e.forEach((function(e,t){var n=e.details;null!=n&&n.fragments&&n.fragments.forEach((function(e){e.level=t}))}))}function Br(e){switch(e.details){case Wn.FRAG_LOAD_TIMEOUT:case Wn.KEY_LOAD_TIMEOUT:case Wn.LEVEL_LOAD_TIMEOUT:case Wn.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function Hr(e,t){var n=Br(t);return e.default["".concat(n?"timeout":"error","Retry")]}function Gr(e,t){var n="linear"===e.backoff?1:Math.pow(2,t);return Math.min(n*e.retryDelayMs,e.maxRetryDelayMs)}function Kr(e){return On(On({},e),{errorRetry:null,timeoutRetry:null})}function Wr(e,t,n,i){if(!e)return!1;var a=null==i?void 0:i.code,r=t<e.maxNumRetry&&(function(e){return 0===e&&!1===navigator.onLine||!!e&&(e<400||e>499)}(a)||!!n);return e.shouldRetry?e.shouldRetry(e,t,n,i,r):r}var Vr=function(e,t){for(var n=0,i=e.length-1,a=null,r=null;n<=i;){var o=t(r=e[a=(n+i)/2|0]);if(o>0)n=a+1;else{if(!(o<0))return r;i=a-1}}return null};function qr(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.005,r=null;if(e){r=t[e.sn-t[0].sn+1]||null;var o=e.endDTS-n;o>0&&o<15e-7&&(n+=15e-7)}else 0===n&&0===t[0].start&&(r=t[0]);if(r&&((!e||e.level===r.level)&&0===jr(n,i,r)||Yr(r,e,Math.min(a,i))))return r;var s=Vr(t,jr.bind(null,n,i));return!s||s===e&&r?r:s}function Yr(e,t,n){if(t&&0===t.start&&t.level<e.level&&(t.endPTS||0)>0){var i=t.tagList.reduce((function(e,t){return"INF"===t[0]&&(e+=parseFloat(t[1])),e}),n);return e.start<=i}return!1}function jr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;if(n.start<=e&&n.start+n.duration>e)return 0;var i=Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0));return n.start+n.duration-i<=e?1:n.start-i>e&&n.start?-1:0}function zr(e,t,n){var i=1e3*Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0));return(n.endProgramDateTime||0)-i>e}var Xr=0,Qr=2,Zr=3,Jr=5,$r=0,eo=1,to=2,no=function(){function e(t){(0,m.A)(this,e),this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=t,this.log=Xn.log.bind(Xn,"[info]:"),this.warn=Xn.warn.bind(Xn,"[warning]:"),this.error=Xn.error.bind(Xn,"[error]:"),this.registerListeners()}return(0,v.A)(e,[{key:"registerListeners",value:function(){var e=this.hls;e.on(Gn.ERROR,this.onError,this),e.on(Gn.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Gn.LEVEL_UPDATED,this.onLevelUpdated,this)}},{key:"unregisterListeners",value:function(){var e=this.hls;e&&(e.off(Gn.ERROR,this.onError,this),e.off(Gn.ERROR,this.onErrorOut,this),e.off(Gn.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Gn.LEVEL_UPDATED,this.onLevelUpdated,this))}},{key:"destroy",value:function(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}},{key:"startLoad",value:function(e){}},{key:"stopLoad",value:function(){this.playlistError=0}},{key:"getVariantLevelIndex",value:function(e){return(null==e?void 0:e.type)===nr?e.level:this.hls.loadLevel}},{key:"onManifestLoading",value:function(){this.playlistError=0,this.penalizedRenditions={}}},{key:"onLevelUpdated",value:function(){this.playlistError=0}},{key:"onError",value:function(e,t){var n,i;if(!t.fatal){var a=this.hls,r=t.context;switch(t.details){case Wn.FRAG_LOAD_ERROR:case Wn.FRAG_LOAD_TIMEOUT:case Wn.KEY_LOAD_ERROR:case Wn.KEY_LOAD_TIMEOUT:return void(t.errorAction=this.getFragRetryOrSwitchAction(t));case Wn.FRAG_PARSING_ERROR:if(null!=(n=t.frag)&&n.gap)return void(t.errorAction={action:Xr,flags:$r});case Wn.FRAG_GAP:case Wn.FRAG_DECRYPT_ERROR:return t.errorAction=this.getFragRetryOrSwitchAction(t),void(t.errorAction.action=Qr);case Wn.LEVEL_EMPTY_ERROR:case Wn.LEVEL_PARSING_ERROR:var o,s,l=t.parent===nr?t.level:a.loadLevel;return void(t.details===Wn.LEVEL_EMPTY_ERROR&&null!=(o=t.context)&&null!=(s=o.levelDetails)&&s.live?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,l):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,l)));case Wn.LEVEL_LOAD_ERROR:case Wn.LEVEL_LOAD_TIMEOUT:return void("number"===typeof(null==r?void 0:r.level)&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,r.level)));case Wn.AUDIO_TRACK_LOAD_ERROR:case Wn.AUDIO_TRACK_LOAD_TIMEOUT:case Wn.SUBTITLE_LOAD_ERROR:case Wn.SUBTITLE_TRACK_LOAD_TIMEOUT:if(r){var u=a.levels[a.loadLevel];if(u&&(r.type===er&&u.hasAudioGroup(r.groupId)||r.type===tr&&u.hasSubtitleGroup(r.groupId)))return t.errorAction=this.getPlaylistRetryOrSwitchAction(t,a.loadLevel),t.errorAction.action=Qr,void(t.errorAction.flags=eo)}return;case Wn.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:var c=a.levels[a.loadLevel],d=null==c?void 0:c.attrs["HDCP-LEVEL"];return void(d?t.errorAction={action:Qr,flags:to,hdcpLevel:d}:this.keySystemError(t));case Wn.BUFFER_ADD_CODEC_ERROR:case Wn.REMUX_ALLOC_ERROR:case Wn.BUFFER_APPEND_ERROR:return void(t.errorAction=this.getLevelSwitchAction(t,null!=(i=t.level)?i:a.loadLevel));case Wn.INTERNAL_EXCEPTION:case Wn.BUFFER_APPENDING_ERROR:case Wn.BUFFER_FULL_ERROR:case Wn.LEVEL_SWITCH_ERROR:case Wn.BUFFER_STALLED_ERROR:case Wn.BUFFER_SEEK_OVER_HOLE:case Wn.BUFFER_NUDGE_ON_STALL:return void(t.errorAction={action:Xr,flags:$r})}t.type===Kn.KEY_SYSTEM_ERROR&&this.keySystemError(t)}}},{key:"keySystemError",value:function(e){var t=this.getVariantLevelIndex(e.frag);e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,t)}},{key:"getPlaylistRetryOrSwitchAction",value:function(e,t){var n=Hr(this.hls.config.playlistLoadPolicy,e),i=this.playlistError++;if(Wr(n,i,Br(e),e.response))return{action:Jr,flags:$r,retryConfig:n,retryCount:i};var a=this.getLevelSwitchAction(e,t);return n&&(a.retryConfig=n,a.retryCount=i),a}},{key:"getFragRetryOrSwitchAction",value:function(e){var t=this.hls,n=this.getVariantLevelIndex(e.frag),i=t.levels[n],a=t.config,r=a.fragLoadPolicy,o=a.keyLoadPolicy,s=Hr(e.details.startsWith("key")?o:r,e),l=t.levels.reduce((function(e,t){return e+t.fragmentError}),0);if(i&&(e.details!==Wn.FRAG_GAP&&i.fragmentError++,Wr(s,l,Br(e),e.response)))return{action:Jr,flags:$r,retryConfig:s,retryCount:l};var u=this.getLevelSwitchAction(e,n);return s&&(u.retryConfig=s,u.retryCount=l),u}},{key:"getLevelSwitchAction",value:function(e,t){var n=this.hls;null!==t&&void 0!==t||(t=n.loadLevel);var i=this.hls.levels[t];if(i){var a,r,o=e.details;i.loadError++,o===Wn.BUFFER_APPEND_ERROR&&i.fragmentError++;var s=-1,l=n.levels,u=n.loadLevel,c=n.minAutoLevel,d=n.maxAutoLevel;n.autoLevelEnabled||(n.loadLevel=-1);for(var h=null==(a=e.frag)?void 0:a.type,f=(h===ir&&o===Wn.FRAG_PARSING_ERROR||"audio"===e.sourceBufferName&&(o===Wn.BUFFER_ADD_CODEC_ERROR||o===Wn.BUFFER_APPEND_ERROR))&&l.some((function(e){var t=e.audioCodec;return i.audioCodec!==t})),v="video"===e.sourceBufferName&&(o===Wn.BUFFER_ADD_CODEC_ERROR||o===Wn.BUFFER_APPEND_ERROR)&&l.some((function(e){var t=e.codecSet,n=e.audioCodec;return i.codecSet!==t&&i.audioCodec===n})),m=null!=(r=e.context)?r:{},p=m.type,g=m.groupId,y=l.length;y--;){var E=(y+u)%l.length;if(E!==u&&E>=c&&E<=d&&0===l[E].loadError){var A,b,k=function(){var t=l[E];if(o===Wn.FRAG_GAP&&h===nr&&e.frag){var n=l[E].details;if(n){var a=qr(e.frag,n.fragments,e.frag.start);if(null!=a&&a.gap)return"continue"}}else{if(p===er&&t.hasAudioGroup(g)||p===tr&&t.hasSubtitleGroup(g))return"continue";if(h===ir&&null!=(A=i.audioGroups)&&A.some((function(e){return t.hasAudioGroup(e)}))||h===ar&&null!=(b=i.subtitleGroups)&&b.some((function(e){return t.hasSubtitleGroup(e)}))||f&&i.audioCodec===t.audioCodec||!f&&i.audioCodec!==t.audioCodec||v&&i.codecSet===t.codecSet)return"continue"}return s=E,"break"}();if("continue"===k)continue;if("break"===k)break}}if(s>-1&&n.loadLevel!==s)return e.levelRetry=!0,this.playlistError=0,{action:Qr,flags:$r,nextAutoLevel:s}}return{action:Qr,flags:eo}}},{key:"onErrorOut",value:function(e,t){var n;switch(null==(n=t.errorAction)?void 0:n.action){case Xr:break;case Qr:this.sendAlternateToPenaltyBox(t),t.errorAction.resolved||t.details===Wn.FRAG_GAP?/MediaSource readyState: ended/.test(t.error.message)&&(this.warn('MediaSource ended after "'.concat(t.sourceBufferName,'" sourceBuffer append error. Attempting to recover from media error.')),this.hls.recoverMediaError()):t.fatal=!0}t.fatal&&this.hls.stopLoad()}},{key:"sendAlternateToPenaltyBox",value:function(e){var t=this.hls,n=e.errorAction;if(n){var i=n.flags,a=n.hdcpLevel,r=n.nextAutoLevel;switch(i){case $r:this.switchLevel(e,r);break;case to:a&&(t.maxHdcpLevel=kr[kr.indexOf(a)-1],n.resolved=!0),this.warn('Restricting playback to HDCP-LEVEL of "'.concat(t.maxHdcpLevel,'" or lower'))}n.resolved||this.switchLevel(e,r)}}},{key:"switchLevel",value:function(e,t){void 0!==t&&e.errorAction&&(this.warn("switching to level ".concat(t," after ").concat(e.details)),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}}]),e}(),io=function(){function e(t,n){(0,m.A)(this,e),this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=Xn.log.bind(Xn,"".concat(n,":")),this.warn=Xn.warn.bind(Xn,"".concat(n,":")),this.hls=t}return(0,v.A)(e,[{key:"destroy",value:function(){this.clearTimer(),this.hls=this.log=this.warn=null}},{key:"clearTimer",value:function(){-1!==this.timer&&(self.clearTimeout(this.timer),this.timer=-1)}},{key:"startLoad",value:function(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}},{key:"stopLoad",value:function(){this.canLoad=!1,this.clearTimer()}},{key:"switchParams",value:function(e,t,n){var i=null==t?void 0:t.renditionReports;if(i){for(var a=-1,r=0;r<i.length;r++){var o=i[r],s=void 0;try{s=new self.URL(o.URI,t.url).href}catch(f){Xn.warn("Could not construct new URL for Rendition Report: ".concat(f)),s=o.URI||""}if(s===e){a=r;break}s===e.substring(0,s.length)&&(a=r)}if(-1!==a){var l=i[a],u=parseInt(l["LAST-MSN"])||(null==t?void 0:t.lastPartSn),c=parseInt(l["LAST-PART"])||(null==t?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){var d=Math.min(t.age-t.partTarget,t.targetduration);c>=0&&d>t.partTarget&&(c+=1)}var h=n&&Rr(n);return new Lr(u,c>=0?c:void 0,h)}}}},{key:"loadPlaylist",value:function(e){-1===this.requestScheduled&&(this.requestScheduled=self.performance.now())}},{key:"shouldLoadPlaylist",value:function(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}},{key:"shouldReloadPlaylist",value:function(e){return-1===this.timer&&-1===this.requestScheduled&&this.shouldLoadPlaylist(e)}},{key:"playlistLoaded",value:function(e,t,n){var i=this,a=t.details,r=t.stats,o=self.performance.now(),s=r.loading.first?Math.max(0,o-r.loading.first):0;if(a.advancedDateTime=Date.now()-s,a.live||null!=n&&n.live){if(a.reloaded(n),n&&this.log("live playlist ".concat(e," ").concat(a.advanced?"REFRESHED "+a.lastPartSn+"-"+a.lastPartIndex:a.updated?"UPDATED":"MISSED")),n&&a.fragments.length>0&&Mr(n,a),!this.canLoad||!a.live)return;var l,u=void 0,c=void 0;if(a.canBlockReload&&a.endSN&&a.advanced){var d=this.hls.config.lowLatencyMode,h=a.lastPartSn,f=a.endSN,v=a.lastPartIndex,m=h===f;-1!==v?(u=m?f+1:h,c=m?d?0:v:v+1):u=f+1;var p=a.age,g=p+a.ageHeader,y=Math.min(g-a.partTarget,1.5*a.targetduration);if(y>0){if(n&&y>n.tuneInGoal)this.warn("CDN Tune-in goal increased from: ".concat(n.tuneInGoal," to: ").concat(y," with playlist age: ").concat(a.age)),y=0;else{var E=Math.floor(y/a.targetduration);if(u+=E,void 0!==c)c+=Math.round(y%a.targetduration/a.partTarget);this.log("CDN Tune-in age: ".concat(a.ageHeader,"s last advanced ").concat(p.toFixed(2),"s goal: ").concat(y," skip sn ").concat(E," to part ").concat(c))}a.tuneInGoal=y}if(l=this.getDeliveryDirectives(a,t.deliveryDirectives,u,c),d||!m)return void this.loadPlaylist(l)}else(a.canBlockReload||a.canSkipUntil)&&(l=this.getDeliveryDirectives(a,t.deliveryDirectives,u,c));var A=this.hls.mainForwardBufferInfo,b=A?A.end-A.len:0,k=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=1e3*e.targetduration;if(e.updated){var i=e.fragments,a=4;if(i.length&&n*a>t){var r=1e3*i[i.length-1].duration;r<n&&(n=r)}}else n/=2;return Math.round(n)}(a,1e3*(a.edge-b));a.updated&&o>this.requestScheduled+k&&(this.requestScheduled=r.loading.start),void 0!==u&&a.canBlockReload?this.requestScheduled=r.loading.first+k-(1e3*a.partTarget||1e3):-1===this.requestScheduled||this.requestScheduled+k<o?this.requestScheduled=o:this.requestScheduled-o<=0&&(this.requestScheduled+=k);var T=this.requestScheduled-o;T=Math.max(0,T),this.log("reload live playlist ".concat(e," in ").concat(Math.round(T)," ms")),this.timer=self.setTimeout((function(){return i.loadPlaylist(l)}),T)}else this.clearTimer()}},{key:"getDeliveryDirectives",value:function(e,t,n,i){var a=Rr(e);return null!=t&&t.skip&&e.deltaUpdateFailed&&(n=t.msn,i=t.part,a=_r),new Lr(n,i,a)}},{key:"checkRetry",value:function(e){var t=this,n=e.details,i=Br(e),a=e.errorAction,r=a||{},o=r.action,s=r.retryCount,l=void 0===s?0:s,u=r.retryConfig,c=!!a&&!!u&&(o===Jr||!a.resolved&&o===Qr);if(c){var d;if(this.requestScheduled=-1,l>=u.maxNumRetry)return!1;if(i&&null!=(d=e.context)&&d.deliveryDirectives)this.warn("Retrying playlist loading ".concat(l+1,"/").concat(u.maxNumRetry,' after "').concat(n,'" without delivery-directives')),this.loadPlaylist();else{var h=Gr(u,l);this.timer=self.setTimeout((function(){return t.loadPlaylist()}),h),this.warn("Retrying playlist loading ".concat(l+1,"/").concat(u.maxNumRetry,' after "').concat(n,'" in ').concat(h,"ms"))}e.levelRetry=!0,a.resolved=!0}return c}}]),e}(),ao=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,m.A)(this,e),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=t,this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=n,this.totalWeight_=i}return(0,v.A)(e,[{key:"sample",value:function(e,t){var n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e}},{key:"getTotalWeight",value:function(){return this.totalWeight_}},{key:"getEstimate",value:function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}]),e}(),ro=function(){function e(t,n,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;(0,m.A)(this,e),this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=i,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new ao(t),this.fast_=new ao(n),this.defaultTTFB_=a,this.ttfb_=new ao(t)}return(0,v.A)(e,[{key:"update",value:function(e,t){var n=this.slow_,i=this.fast_,a=this.ttfb_;n.halfLife!==e&&(this.slow_=new ao(e,n.getEstimate(),n.getTotalWeight())),i.halfLife!==t&&(this.fast_=new ao(t,i.getEstimate(),i.getTotalWeight())),a.halfLife!==e&&(this.ttfb_=new ao(e,a.getEstimate(),a.getTotalWeight()))}},{key:"sample",value:function(e,t){var n=(e=Math.max(e,this.minDelayMs_))/1e3,i=8*t/n;this.fast_.sample(n,i),this.slow_.sample(n,i)}},{key:"sampleTTFB",value:function(e){var t=e/1e3,n=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(n,Math.max(e,5))}},{key:"canEstimate",value:function(){return this.fast_.getTotalWeight()>=this.minWeight_}},{key:"getEstimate",value:function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}},{key:"getEstimateTTFB",value:function(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}},{key:"destroy",value:function(){}}]),e}(),oo={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]},so={};function lo(e,t,n){var i=e.videoCodec,a=e.audioCodec;if(!i||!a||!n)return Promise.resolve(oo);var r={width:e.width,height:e.height,bitrate:Math.ceil(Math.max(.9*e.bitrate,e.averageBitrate)),framerate:e.frameRate||30},o=e.videoRange;"SDR"!==o&&(r.transferFunction=o.toLowerCase());var s=i.split(",").map((function(e){return{type:"media-source",video:On(On({},r),{},{contentType:Ca(e,"video")})}}));return a&&e.audioGroups&&e.audioGroups.forEach((function(e){var n;e&&(null==(n=t.groups[e])||n.tracks.forEach((function(t){if(t.groupId===e){var n=t.channels||"",i=parseFloat(n);Fn(i)&&i>2&&s.push.apply(s,a.split(",").map((function(e){return{type:"media-source",audio:{contentType:Ca(e,"audio"),channels:""+i}}})))}})))})),Promise.all(s.map((function(e){var t=function(e){var t=e.audio,n=e.video,i=n||t;if(i){var a=i.contentType.split('"')[1];if(n)return"r".concat(n.height,"x").concat(n.width,"f").concat(Math.ceil(n.framerate)).concat(n.transferFunction||"sd","_").concat(a,"_").concat(Math.ceil(n.bitrate/1e5));if(t)return"c".concat(t.channels).concat(t.spatialRendering?"s":"n","_").concat(a)}return""}(e);return so[t]||(so[t]=n.decodingInfo(e))}))).then((function(e){return{supported:!e.some((function(e){return!e.supported})),configurations:s,decodingInfoResults:e}})).catch((function(e){return{supported:!1,configurations:s,decodingInfoResults:[],error:e}}))}function uo(e,t){var n=!1,i=[];return e&&(n="SDR"!==e,i=[e]),t&&(i=t.allowedVideoRanges||Tr.slice(0),i=(n=void 0!==t.preferHDR?t.preferHDR:function(){if("function"===typeof matchMedia){var e=matchMedia("(dynamic-range: high)"),t=matchMedia("bad query");if(e.media!==t.media)return!0===e.matches}return!1}())?i.filter((function(e){return"SDR"!==e})):["SDR"]),{preferHDR:n,allowedVideoRanges:i}}function co(e,t){Xn.log('[abr] start candidates with "'.concat(e,'" ignored because ').concat(t))}function ho(e,t,n){if("attrs"in e){var i=t.indexOf(e);if(-1!==i)return i}for(var a=0;a<t.length;a++){if(fo(e,t[a],n))return a}return-1}function fo(e,t,n){var i=e.groupId,a=e.name,r=e.lang,o=e.assocLang,s=e.default,l=e.forced;return(void 0===i||t.groupId===i)&&(void 0===a||t.name===a)&&(void 0===r||t.lang===r)&&(void 0===r||t.assocLang===o)&&(void 0===s||t.default===s)&&(void 0===l||t.forced===l)&&(!("characteristics"in e)||function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=e.split(","),i=t.split(",");return n.length===i.length&&!n.some((function(e){return-1===i.indexOf(e)}))}(e.characteristics||"",t.characteristics))&&(void 0===n||n(e,t))}function vo(e,t){var n=e.audioCodec,i=e.channels;return(void 0===n||(t.audioCodec||"").substring(0,4)===n.substring(0,4))&&(void 0===i||i===(t.channels||"2"))}function mo(e,t,n){for(var i=t;i>-1;i--)if(n(e[i]))return i;for(var a=t+1;a<e.length;a++)if(n(e[a]))return a;return-1}var po=function(){function e(t){var n=this;(0,m.A)(this,e),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this._abandonRulesCheck=function(){var e=n.fragCurrent,t=n.partCurrent,i=n.hls,a=i.autoLevelEnabled,r=i.media;if(e&&r){var o=performance.now(),s=t?t.stats:e.stats,l=t?t.duration:e.duration,u=o-s.loading.start,c=i.minAutoLevel;if(s.aborted||s.loaded&&s.loaded===s.total||e.level<=c)return n.clearTimer(),void(n._nextAutoLevel=-1);if(a&&!r.paused&&r.playbackRate&&r.readyState){var d=i.mainForwardBufferInfo;if(null!==d){var h=n.bwEstimator.getEstimateTTFB(),f=Math.abs(r.playbackRate);if(!(u<=Math.max(h,l/(2*f)*1e3))){var v=d.len/f,m=s.loading.first?s.loading.first-s.loading.start:-1,p=s.loaded&&m>-1,g=n.getBwEstimate(),y=i.levels,E=y[e.level],A=s.total||Math.max(s.loaded,Math.round(l*E.averageBitrate/8)),b=p?u-m:u;b<1&&p&&(b=Math.min(u,8*s.loaded/g));var k=p?1e3*s.loaded/b:0,T=k?(A-s.loaded)/k:8*A/g+h/1e3;if(!(T<=v)){var _,S=k?8*k:g,w=Number.POSITIVE_INFINITY;for(_=e.level-1;_>c;_--){var R=y[_].maxBitrate;if((w=n.getTimeToLoadFrag(h/1e3,S,l*R,!y[_].details))<v)break}if(!(w>=T)&&!(w>10*l)){i.nextLoadLevel=i.nextAutoLevel=_,p?n.bwEstimator.sample(u-Math.min(h,m),s.loaded):n.bwEstimator.sampleTTFB(u);var L=y[_].maxBitrate;n.getBwEstimate()*n.hls.config.abrBandWidthUpFactor>L&&n.resetEstimator(L),n.clearTimer(),Xn.warn("[abr] Fragment ".concat(e.sn).concat(t?" part "+t.index:""," of level ").concat(e.level," is loading too slowly;\n      Time to underbuffer: ").concat(v.toFixed(3)," s\n      Estimated load time for current fragment: ").concat(T.toFixed(3)," s\n      Estimated load time for down switch fragment: ").concat(w.toFixed(3)," s\n      TTFB estimate: ").concat(0|m," ms\n      Current BW estimate: ").concat(Fn(g)?0|g:"Unknown"," bps\n      New BW estimate: ").concat(0|n.getBwEstimate()," bps\n      Switching to level ").concat(_," @ ").concat(0|L," bps")),i.trigger(Gn.FRAG_LOAD_EMERGENCY_ABORTED,{frag:e,part:t,stats:s})}}}}}}},this.hls=t,this.bwEstimator=this.initEstimator(),this.registerListeners()}return(0,v.A)(e,[{key:"resetEstimator",value:function(e){e&&(Xn.log("setting initial bwe to ".concat(e)),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}},{key:"initEstimator",value:function(){var e=this.hls.config;return new ro(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}},{key:"registerListeners",value:function(){var e=this.hls;e.on(Gn.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Gn.FRAG_LOADING,this.onFragLoading,this),e.on(Gn.FRAG_LOADED,this.onFragLoaded,this),e.on(Gn.FRAG_BUFFERED,this.onFragBuffered,this),e.on(Gn.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(Gn.LEVEL_LOADED,this.onLevelLoaded,this),e.on(Gn.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(Gn.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(Gn.ERROR,this.onError,this)}},{key:"unregisterListeners",value:function(){var e=this.hls;e&&(e.off(Gn.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Gn.FRAG_LOADING,this.onFragLoading,this),e.off(Gn.FRAG_LOADED,this.onFragLoaded,this),e.off(Gn.FRAG_BUFFERED,this.onFragBuffered,this),e.off(Gn.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(Gn.LEVEL_LOADED,this.onLevelLoaded,this),e.off(Gn.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(Gn.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(Gn.ERROR,this.onError,this))}},{key:"destroy",value:function(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}},{key:"onManifestLoading",value:function(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}},{key:"onLevelsUpdated",value:function(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}},{key:"onMaxAutoLevelUpdated",value:function(){this.firstSelection=-1,this.nextAutoLevelKey=""}},{key:"onFragLoading",value:function(e,t){var n=t.frag;if(!this.ignoreFragment(n)){var i;if(!n.bitrateTest)this.fragCurrent=n,this.partCurrent=null!=(i=t.part)?i:null;this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}},{key:"onLevelSwitching",value:function(e,t){this.clearTimer()}},{key:"onError",value:function(e,t){if(!t.fatal)switch(t.details){case Wn.BUFFER_ADD_CODEC_ERROR:case Wn.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case Wn.FRAG_LOAD_TIMEOUT:var n=t.frag,i=this.fragCurrent,a=this.partCurrent;if(n&&i&&n.sn===i.sn&&n.level===i.level){var r=performance.now(),o=a?a.stats:n.stats,s=r-o.loading.start,l=o.loading.first?o.loading.first-o.loading.start:-1;if(o.loaded&&l>-1){var u=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(s-Math.min(u,l),o.loaded)}else this.bwEstimator.sampleTTFB(s)}}}},{key:"getTimeToLoadFrag",value:function(e,t,n,i){return e+n/t+(i?this.lastLevelLoadSec:0)}},{key:"onLevelLoaded",value:function(e,t){var n=this.hls.config,i=t.stats.loading,a=i.end-i.start;Fn(a)&&(this.lastLevelLoadSec=a/1e3),t.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD)}},{key:"onFragLoaded",value:function(e,t){var n=t.frag,i=t.part,a=i?i.stats:n.stats;if(n.type===nr&&this.bwEstimator.sampleTTFB(a.loading.first-a.loading.start),!this.ignoreFragment(n)){if(this.clearTimer(),n.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){var r=i?i.duration:n.duration,o=this.hls.levels[n.level],s=(o.loaded?o.loaded.bytes:0)+a.loaded,l=(o.loaded?o.loaded.duration:0)+r;o.loaded={bytes:s,duration:l},o.realBitrate=Math.round(8*s/l)}if(n.bitrateTest){var u={stats:a,frag:n,part:i,id:n.type};this.onFragBuffered(Gn.FRAG_BUFFERED,u),n.bitrateTest=!1}else this.lastLoadedFragLevel=n.level}}},{key:"onFragBuffered",value:function(e,t){var n=t.frag,i=t.part,a=null!=i&&i.stats.loaded?i.stats:n.stats;if(!a.aborted&&!this.ignoreFragment(n)){var r=a.parsing.end-a.loading.start-Math.min(a.loading.first-a.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(r,a.loaded),a.bwEstimate=this.getBwEstimate(),n.bitrateTest?this.bitrateTestDelay=r/1e3:this.bitrateTestDelay=0}}},{key:"ignoreFragment",value:function(e){return e.type!==nr||"initSegment"===e.sn}},{key:"clearTimer",value:function(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}},{key:"firstAutoLevel",get:function(){var e=this.hls,t=e.maxAutoLevel,n=e.minAutoLevel,i=this.getBwEstimate(),a=this.hls.config.maxStarvationDelay,r=this.findBestLevel(i,n,t,0,a,1,1);if(r>-1)return r;var o=this.hls.firstLevel,s=Math.min(Math.max(o,n),t);return Xn.warn("[abr] Could not find best starting auto level. Defaulting to first in playlist ".concat(o," clamped to ").concat(s)),s}},{key:"forcedAutoLevel",get:function(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}},{key:"nextAutoLevel",get:function(){var e=this.forcedAutoLevel,t=this.bwEstimator.canEstimate(),n=this.lastLoadedFragLevel>-1;if(-1!==e&&(!t||!n||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;var i=t&&n?this.getNextABRAutoLevel():this.firstAutoLevel;if(-1!==e){var a=this.hls.levels;if(a.length>Math.max(e,i)&&a[e].loadError<=a[i].loadError)return e}return this._nextAutoLevel=i,this.nextAutoLevelKey=this.getAutoLevelKey(),i},set:function(e){var t=this.hls,n=t.maxAutoLevel,i=t.minAutoLevel,a=Math.min(Math.max(e,i),n);this._nextAutoLevel!==a&&(this.nextAutoLevelKey="",this._nextAutoLevel=a)}},{key:"getAutoLevelKey",value:function(){return"".concat(this.getBwEstimate(),"_").concat(this.getStarvationDelay().toFixed(2))}},{key:"getNextABRAutoLevel",value:function(){var e=this.fragCurrent,t=this.partCurrent,n=this.hls,i=n.maxAutoLevel,a=n.config,r=n.minAutoLevel,o=t?t.duration:e?e.duration:0,s=this.getBwEstimate(),l=this.getStarvationDelay(),u=a.abrBandWidthFactor,c=a.abrBandWidthUpFactor;if(l){var d=this.findBestLevel(s,r,i,l,0,u,c);if(d>=0)return d}var h=o?Math.min(o,a.maxStarvationDelay):a.maxStarvationDelay;if(!l){var f=this.bitrateTestDelay;if(f)h=(o?Math.min(o,a.maxLoadingDelay):a.maxLoadingDelay)-f,Xn.info("[abr] bitrate test took ".concat(Math.round(1e3*f),"ms, set first fragment max fetchDuration to ").concat(Math.round(1e3*h)," ms")),u=c=1}var v=this.findBestLevel(s,r,i,l,h,u,c);if(Xn.info("[abr] ".concat(l?"rebuffering expected":"buffer is empty",", optimal quality level ").concat(v)),v>-1)return v;var m=n.levels[r],p=n.levels[n.loadLevel];return(null==m?void 0:m.bitrate)<(null==p?void 0:p.bitrate)?r:n.loadLevel}},{key:"getStarvationDelay",value:function(){var e=this.hls,t=e.media;if(!t)return 1/0;var n=t&&0!==t.playbackRate?Math.abs(t.playbackRate):1,i=e.mainForwardBufferInfo;return(i?i.len:0)/n}},{key:"getBwEstimate",value:function(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}},{key:"findBestLevel",value:function(e,t,n,i,a,r,o){var s,l=this,u=i+a,c=this.lastLoadedFragLevel,d=-1===c?this.hls.firstLevel:c,h=this.fragCurrent,f=this.partCurrent,v=this.hls,m=v.levels,p=v.allAudioTracks,g=v.loadLevel,y=v.config;if(1===m.length)return 0;var E,A=m[d],b=!(null==A||null==(s=A.details)||!s.live),k=-1===g||-1===c,T="SDR",_=(null==A?void 0:A.frameRate)||0,S=y.audioPreference,w=y.videoPreference,R=this.audioTracksByGroup||(this.audioTracksByGroup=function(e){return e.reduce((function(e,t){var n=e.groups[t.groupId];n||(n=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),n.tracks.push(t);var i=t.channels||"2";return n.channels[i]=(n.channels[i]||0)+1,n.hasDefault=n.hasDefault||t.default,n.hasAutoSelect=n.hasAutoSelect||t.autoselect,n.hasDefault&&(e.hasDefaultAudio=!0),n.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e}),{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}(p));if(k){if(-1!==this.firstSelection)return this.firstSelection;var L=this.codecTiers||(this.codecTiers=function(e,t,n,i){return e.slice(n,i+1).reduce((function(e,n){if(!n.codecSet)return e;var i=n.audioGroups,a=e[n.codecSet];a||(e[n.codecSet]=a={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!i,fragmentError:0}),a.minBitrate=Math.min(a.minBitrate,n.bitrate);var r=Math.min(n.height,n.width);return a.minHeight=Math.min(a.minHeight,r),a.minFramerate=Math.min(a.minFramerate,n.frameRate),a.maxScore=Math.max(a.maxScore,n.score),a.fragmentError+=n.fragmentError,a.videoRanges[n.videoRange]=(a.videoRanges[n.videoRange]||0)+1,i&&i.forEach((function(e){if(e){var n=t.groups[e];n&&(a.hasDefaultAudio=a.hasDefaultAudio||t.hasDefaultAudio?n.hasDefault:n.hasAutoSelect||!t.hasDefaultAudio&&!t.hasAutoSelectAudio,Object.keys(n.channels).forEach((function(e){a.channels[e]=(a.channels[e]||0)+n.channels[e]})))}})),e}),{})}(m,R,t,n)),I=function(e,t,n,i,a){for(var r=Object.keys(e),o=null==i?void 0:i.channels,s=null==i?void 0:i.audioCodec,l=o&&2===parseInt(o),u=!0,c=!1,d=1/0,h=1/0,f=1/0,v=0,m=[],p=uo(t,a),g=p.preferHDR,y=p.allowedVideoRanges,E=function(t){var n=e[r[t]];u=n.channels[2]>0,d=Math.min(d,n.minHeight),h=Math.min(h,n.minFramerate),f=Math.min(f,n.minBitrate);var i=y.filter((function(e){return n.videoRanges[e]>0}));i.length>0&&(c=!0,m=i)},A=r.length;A--;)E(A);d=Fn(d)?d:0,h=Fn(h)?h:0;var b=Math.max(1080,d),k=Math.max(30,h);return f=Fn(f)?f:n,n=Math.max(f,n),c||(t=void 0,m=[]),{codecSet:r.reduce((function(t,i){var a=e[i];if(i===t)return t;if(a.minBitrate>n)return co(i,"min bitrate of ".concat(a.minBitrate," > current estimate of ").concat(n)),t;if(!a.hasDefaultAudio)return co(i,"no renditions with default or auto-select sound found"),t;if(s&&i.indexOf(s.substring(0,4))%5!==0)return co(i,'audio codec preference "'.concat(s,'" not found')),t;if(o&&!l){if(!a.channels[o])return co(i,"no renditions with ".concat(o," channel sound found (channels options: ").concat(Object.keys(a.channels),")")),t}else if((!s||l)&&u&&0===a.channels[2])return co(i,"no renditions with stereo sound found"),t;return a.minHeight>b?(co(i,"min resolution of ".concat(a.minHeight," > maximum of ").concat(b)),t):a.minFramerate>k?(co(i,"min framerate of ".concat(a.minFramerate," > maximum of ").concat(k)),t):m.some((function(e){return a.videoRanges[e]>0}))?a.maxScore<v?(co(i,"max score of ".concat(a.maxScore," < selected max of ").concat(v)),t):t&&(Ma(i)>=Ma(t)||a.fragmentError>e[t].fragmentError)?t:(v=a.maxScore,i):(co(i,"no variants with VIDEO-RANGE of ".concat(JSON.stringify(m)," found")),t)}),void 0),videoRanges:m,preferHDR:g,minFramerate:h,minBitrate:f}}(L,T,e,S,w),D=I.codecSet,C=I.videoRanges,x=I.minFramerate,M=I.minBitrate,O=I.preferHDR;E=D,T=O?C[C.length-1]:C[0],_=x,e=Math.max(e,M),Xn.log("[abr] picked start tier ".concat(JSON.stringify(I)))}else E=null==A?void 0:A.codecSet,T=null==A?void 0:A.videoRange;for(var P=f?f.duration:h?h.duration:0,N=this.bwEstimator.getEstimateTTFB()/1e3,U=[],F=function(t){var s=m[t],h=t>d;if(!s)return"continue";if(y.useMediaCapabilities&&!s.supportedResult&&!s.supportedPromise){var v=navigator.mediaCapabilities;"function"===typeof(null==v?void 0:v.decodingInfo)&&function(e,t,n,i,a,r){var o=e.audioCodec?e.audioGroups:null,s=null==r?void 0:r.audioCodec,l=null==r?void 0:r.channels,u=l?parseInt(l):s?1/0:2,c=null;if(null!=o&&o.length)try{c=1===o.length&&o[0]?t.groups[o[0]].channels:o.reduce((function(e,n){if(n){var i=t.groups[n];if(!i)throw new Error("Audio track group ".concat(n," not found"));Object.keys(i.channels).forEach((function(t){e[t]=(e[t]||0)+i.channels[t]}))}return e}),{2:0})}catch(d){return!0}return void 0!==e.videoCodec&&(e.width>1920&&e.height>1088||e.height>1920&&e.width>1088||e.frameRate>Math.max(i,30)||"SDR"!==e.videoRange&&e.videoRange!==n||e.bitrate>Math.max(a,8e6))||!!c&&Fn(u)&&Object.keys(c).some((function(e){return parseInt(e)>u}))}(s,R,T,_,e,S)?(s.supportedPromise=lo(s,R,v),s.supportedPromise.then((function(e){if(l.hls){s.supportedResult=e;var t=l.hls.levels,n=t.indexOf(s);e.error?Xn.warn('[abr] MediaCapabilities decodingInfo error: "'.concat(e.error,'" for level ').concat(n," ").concat(JSON.stringify(e))):e.supported||(Xn.warn("[abr] Unsupported MediaCapabilities decodingInfo result for level ".concat(n," ").concat(JSON.stringify(e))),n>-1&&t.length>1&&(Xn.log("[abr] Removing unsupported level ".concat(n)),l.hls.removeLevel(n)))}}))):s.supportedResult=oo}if(E&&s.codecSet!==E||T&&s.videoRange!==T||h&&_>s.frameRate||!h&&_>0&&_<s.frameRate||s.supportedResult&&(null==(H=s.supportedResult.decodingInfoResults)||!H[0].smooth))return U.push(t),"continue";var p=s.details,w=(f?null==p?void 0:p.partTarget:null==p?void 0:p.averagetargetduration)||P,L=void 0;L=h?o*e:r*e;var I=P&&i>=2*P&&0===a?m[t].averageBitrate:m[t].maxBitrate,D=l.getTimeToLoadFrag(N,L,I*w,void 0===p);if(L>=I&&(t===c||0===s.loadError&&0===s.fragmentError)&&(D<=N||!Fn(D)||b&&!l.bitrateTestDelay||D<u)){var C=l.forcedAutoLevel;return t===g||-1!==C&&C===g||(U.length&&Xn.trace("[abr] Skipped level(s) ".concat(U.join(",")," of ").concat(n,' max with CODECS and VIDEO-RANGE:"').concat(m[U[0]].codecs,'" ').concat(m[U[0]].videoRange,'; not compatible with "').concat(A.codecs,'" ').concat(T)),Xn.info("[abr] switch candidate:".concat(d,"->").concat(t," adjustedbw(").concat(Math.round(L),")-bitrate=").concat(Math.round(L-I)," ttfb:").concat(N.toFixed(1)," avgDuration:").concat(w.toFixed(1)," maxFetchDuration:").concat(u.toFixed(1)," fetchDuration:").concat(D.toFixed(1)," firstSelection:").concat(k," codecSet:").concat(E," videoRange:").concat(T," hls.loadLevel:").concat(g))),k&&(l.firstSelection=t),{v:t}}},B=n;B>=t;B--){var H,G=F(B);if("continue"!==G&&"object"===typeof G)return G.v}return-1}}]),e}(),go=function(){function e(){(0,m.A)(this,e),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}return(0,v.A)(e,[{key:"destroy",value:function(){this.onHandlerDestroying(),this.onHandlerDestroyed()}},{key:"onHandlerDestroying",value:function(){this.clearNextTick(),this.clearInterval()}},{key:"onHandlerDestroyed",value:function(){}},{key:"hasInterval",value:function(){return!!this._tickInterval}},{key:"hasNextTick",value:function(){return!!this._tickTimer}},{key:"setInterval",value:function(e){return!this._tickInterval&&(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}},{key:"clearInterval",value:function(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)}},{key:"clearNextTick",value:function(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)}},{key:"tick",value:function(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}},{key:"tickImmediate",value:function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}},{key:"doTick",value:function(){}}]),e}(),yo="NOT_LOADED",Eo="APPENDING",Ao="PARTIAL",bo="OK",ko=function(){function e(t){(0,m.A)(this,e),this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=t,this._registerListeners()}return(0,v.A)(e,[{key:"_registerListeners",value:function(){var e=this.hls;e.on(Gn.BUFFER_APPENDED,this.onBufferAppended,this),e.on(Gn.FRAG_BUFFERED,this.onFragBuffered,this),e.on(Gn.FRAG_LOADED,this.onFragLoaded,this)}},{key:"_unregisterListeners",value:function(){var e=this.hls;e.off(Gn.BUFFER_APPENDED,this.onBufferAppended,this),e.off(Gn.FRAG_BUFFERED,this.onFragBuffered,this),e.off(Gn.FRAG_LOADED,this.onFragLoaded,this)}},{key:"destroy",value:function(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}},{key:"getAppendedFrag",value:function(e,t){var n=this.activePartLists[t];if(n)for(var i=n.length;i--;){var a=n[i];if(!a)break;var r=a.end;if(a.start<=e&&null!==r&&e<=r)return a}return this.getBufferedFrag(e,t)}},{key:"getBufferedFrag",value:function(e,t){for(var n=this.fragments,i=Object.keys(n),a=i.length;a--;){var r=n[i[a]];if((null==r?void 0:r.body.type)===t&&r.buffered){var o=r.body;if(o.start<=e&&e<=o.end)return o}}return null}},{key:"detectEvictedFragments",value:function(e,t,n,i){var a=this;this.timeRanges&&(this.timeRanges[e]=t);var r=(null==i?void 0:i.fragment.sn)||-1;Object.keys(this.fragments).forEach((function(i){var o=a.fragments[i];if(o&&!(r>=o.body.sn))if(o.buffered||o.loaded){var s=o.range[e];s&&s.time.some((function(e){var n=!a.isTimeBuffered(e.startPTS,e.endPTS,t);return n&&a.removeFragment(o.body),n}))}else o.body.type===n&&a.removeFragment(o.body)}))}},{key:"detectPartialFragments",value:function(e){var t=this,n=this.timeRanges,i=e.frag,a=e.part;if(n&&"initSegment"!==i.sn){var r=_o(i),o=this.fragments[r];if(!(!o||o.buffered&&i.gap)){var s=!i.relurl;if(Object.keys(n).forEach((function(e){var r=i.elementaryStreams[e];if(r){var l=n[e],u=s||!0===r.partial;o.range[e]=t.getBufferedTimes(i,a,u,l)}})),o.loaded=null,Object.keys(o.range).length)o.buffered=!0,(o.body.endList=i.endList||o.body.endList)&&(this.endListFragments[o.body.type]=o),To(o)||this.removeParts(i.sn-1,i.type);else this.removeFragment(o.body)}}}},{key:"removeParts",value:function(e,t){var n=this.activePartLists[t];n&&(this.activePartLists[t]=n.filter((function(t){return t.fragment.sn>=e})))}},{key:"fragBuffered",value:function(e,t){var n=_o(e),i=this.fragments[n];!i&&t&&(i=this.fragments[n]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),i&&(i.loaded=null,i.buffered=!0)}},{key:"getBufferedTimes",value:function(e,t,n,i){for(var a={time:[],partial:n},r=e.start,o=e.end,s=e.minEndPTS||o,l=e.maxStartPTS||r,u=0;u<i.length;u++){var c=i.start(u)-this.bufferPadding,d=i.end(u)+this.bufferPadding;if(l>=c&&s<=d){a.time.push({startPTS:Math.max(r,i.start(u)),endPTS:Math.min(o,i.end(u))});break}if(r<d&&o>c){var h=Math.max(r,i.start(u)),f=Math.min(o,i.end(u));f>h&&(a.partial=!0,a.time.push({startPTS:h,endPTS:f}))}else if(o<=c)break}return a}},{key:"getPartialFragment",value:function(e){var t,n,i,a=null,r=0,o=this.bufferPadding,s=this.fragments;return Object.keys(s).forEach((function(l){var u=s[l];u&&To(u)&&(n=u.body.start-o,i=u.body.end+o,e>=n&&e<=i&&(t=Math.min(e-n,i-e),r<=t&&(a=u.body,r=t)))})),a}},{key:"isEndListAppended",value:function(e){var t=this.endListFragments[e];return void 0!==t&&(t.buffered||To(t))}},{key:"getState",value:function(e){var t=_o(e),n=this.fragments[t];return n?n.buffered?To(n)?Ao:bo:Eo:yo}},{key:"isTimeBuffered",value:function(e,t,n){for(var i,a,r=0;r<n.length;r++){if(i=n.start(r)-this.bufferPadding,a=n.end(r)+this.bufferPadding,e>=i&&t<=a)return!0;if(t<=i)return!1}return!1}},{key:"onFragLoaded",value:function(e,t){var n=t.frag,i=t.part;if("initSegment"!==n.sn&&!n.bitrateTest){var a=i?null:t,r=_o(n);this.fragments[r]={body:n,appendedPTS:null,loaded:a,buffered:!1,range:Object.create(null)}}}},{key:"onBufferAppended",value:function(e,t){var n=this,i=t.frag,a=t.part,r=t.timeRanges;if("initSegment"!==i.sn){var o=i.type;if(a){var s=this.activePartLists[o];s||(this.activePartLists[o]=s=[]),s.push(a)}this.timeRanges=r,Object.keys(r).forEach((function(e){var t=r[e];n.detectEvictedFragments(e,t,o,a)}))}}},{key:"onFragBuffered",value:function(e,t){this.detectPartialFragments(t)}},{key:"hasFragment",value:function(e){var t=_o(e);return!!this.fragments[t]}},{key:"hasParts",value:function(e){var t;return!(null==(t=this.activePartLists[e])||!t.length)}},{key:"removeFragmentsInRange",value:function(e,t,n,i,a){var r=this;i&&!this.hasGaps||Object.keys(this.fragments).forEach((function(o){var s=r.fragments[o];if(s){var l=s.body;l.type!==n||i&&!l.gap||l.start<t&&l.end>e&&(s.buffered||a)&&r.removeFragment(l)}}))}},{key:"removeFragment",value:function(e){var t=_o(e);e.stats.loaded=0,e.clearElementaryStreamInfo();var n=this.activePartLists[e.type];if(n){var i=e.sn;this.activePartLists[e.type]=n.filter((function(e){return e.fragment.sn!==i}))}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}},{key:"removeAllFragments",value:function(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}]),e}();function To(e){var t,n,i;return e.buffered&&(e.body.gap||(null==(t=e.range.video)?void 0:t.partial)||(null==(n=e.range.audio)?void 0:n.partial)||(null==(i=e.range.audiovideo)?void 0:i.partial))}function _o(e){return"".concat(e.type,"_").concat(e.level,"_").concat(e.sn)}var So={length:0,start:function(){return 0},end:function(){return 0}},wo=function(){function e(){(0,m.A)(this,e)}return(0,v.A)(e,null,[{key:"isBuffered",value:function(t,n){try{if(t)for(var i=e.getBuffered(t),a=0;a<i.length;a++)if(n>=i.start(a)&&n<=i.end(a))return!0}catch(r){}return!1}},{key:"bufferInfo",value:function(t,n,i){try{if(t){var a,r=e.getBuffered(t),o=[];for(a=0;a<r.length;a++)o.push({start:r.start(a),end:r.end(a)});return this.bufferedInfo(o,n,i)}}catch(s){}return{len:0,start:n,end:n,nextStart:void 0}}},{key:"bufferedInfo",value:function(e,t,n){t=Math.max(0,t),e.sort((function(e,t){var n=e.start-t.start;return n||t.end-e.end}));var i=[];if(n)for(var a=0;a<e.length;a++){var r=i.length;if(r){var o=i[r-1].end;e[a].start-o<n?e[a].end>o&&(i[r-1].end=e[a].end):i.push(e[a])}else i.push(e[a])}else i=e;for(var s,l=0,u=t,c=t,d=0;d<i.length;d++){var h=i[d].start,f=i[d].end;if(t+n>=h&&t<f)u=h,l=(c=f)-t;else if(t+n<h){s=h;break}}return{len:l,start:u||0,end:c||0,nextStart:s}}},{key:"getBuffered",value:function(e){try{return e.buffered}catch(Rv){return Xn.log("failed to get media.buffered",Rv),So}}}]),e}(),Ro=(0,v.A)((function e(t,n,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1,o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];(0,m.A)(this,e),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=t,this.sn=n,this.id=i,this.size=a,this.part=r,this.partial=o}));function Lo(e,t){for(var n=0,i=e.length;n<i;n++){var a;if((null==(a=e[n])?void 0:a.cc)===t)return e[n]}return null}function Io(e,t){if(e){var n=e.start+t;e.start=e.startPTS=n,e.endPTS=n+e.duration}}function Do(e,t){for(var n=t.fragments,i=0,a=n.length;i<a;i++)Io(n[i],e);t.fragmentHint&&Io(t.fragmentHint,e),t.alignedSliding=!0}function Co(e,t,n){t&&(!function(e,t,n){if(function(e,t,n){return!(!t||!(n.endCC>n.startCC||e&&e.cc<n.startCC))}(e,n,t)){var i=function(e,t){var n=e.fragments,i=t.fragments;if(i.length&&n.length){var a=Lo(n,i[0].cc);if(a&&(!a||a.startPTS))return a;Xn.log("No frag in previous level to align on")}else Xn.log("No fragments to align")}(n,t);i&&Fn(i.start)&&(Xn.log("Adjusting PTS using last level due to CC increase within current level ".concat(t.url)),Do(i.start,t))}}(e,n,t),!n.alignedSliding&&t&&xo(n,t),n.alignedSliding||!t||n.skippedSegments||Or(t,n))}function xo(e,t){if(e.hasProgramDateTime&&t.hasProgramDateTime){var n=e.fragments,i=t.fragments;if(n.length&&i.length){var a,r,o=Math.min(t.endCC,e.endCC);t.startCC<o&&e.startCC<o&&(a=Lo(i,o),r=Lo(n,o)),a&&r||(r=Lo(n,(a=i[Math.floor(i.length/2)]).cc)||n[Math.floor(n.length/2)]);var s=a.programDateTime,l=r.programDateTime;if(s&&l)Do((l-s)/1e3-(r.start-a.start),e)}}}var Mo=Math.pow(2,17),Oo=function(){function e(t){(0,m.A)(this,e),this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=t}return(0,v.A)(e,[{key:"destroy",value:function(){this.loader&&(this.loader.destroy(),this.loader=null)}},{key:"abort",value:function(){this.loader&&this.loader.abort()}},{key:"load",value:function(e,t){var n=this,i=e.url;if(!i)return Promise.reject(new Uo({type:Kn.NETWORK_ERROR,details:Wn.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error("Fragment does not have a ".concat(i?"part list":"url")),networkDetails:null}));this.abort();var a=this.config,r=a.fLoader,o=a.loader;return new Promise((function(s,l){if(n.loader&&n.loader.destroy(),e.gap){if(e.tagList.some((function(e){return"GAP"===e[0]})))return void l(No(e));e.gap=!1}var u=n.loader=e.loader=r?new r(a):new o(a),c=Po(e),d=Kr(a.fragLoadPolicy.default),h={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:"initSegment"===e.sn?1/0:Mo};e.stats=u.stats,u.load(c,h,{onSuccess:function(t,i,a,r){n.resetLoader(e,u);var o=t.data;a.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(o.slice(0,16)),o=o.slice(16)),s({frag:e,part:null,payload:o,networkDetails:r})},onError:function(t,a,r,o){n.resetLoader(e,u),l(new Uo({type:Kn.NETWORK_ERROR,details:Wn.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:On({url:i,data:void 0},t),error:new Error("HTTP Error ".concat(t.code," ").concat(t.text)),networkDetails:r,stats:o}))},onAbort:function(t,i,a){n.resetLoader(e,u),l(new Uo({type:Kn.NETWORK_ERROR,details:Wn.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:a,stats:t}))},onTimeout:function(t,i,a){n.resetLoader(e,u),l(new Uo({type:Kn.NETWORK_ERROR,details:Wn.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error("Timeout after ".concat(h.timeout,"ms")),networkDetails:a,stats:t}))},onProgress:function(n,i,a,r){t&&t({frag:e,part:null,payload:a,networkDetails:r})}})}))}},{key:"loadPart",value:function(e,t,n){var i=this;this.abort();var a=this.config,r=a.fLoader,o=a.loader;return new Promise((function(s,l){if(i.loader&&i.loader.destroy(),e.gap||t.gap)l(No(e,t));else{var u=i.loader=e.loader=r?new r(a):new o(a),c=Po(e,t),d=Kr(a.fragLoadPolicy.default),h={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:Mo};t.stats=u.stats,u.load(c,h,{onSuccess:function(a,r,o,l){i.resetLoader(e,u),i.updateStatsFromPart(e,t);var c={frag:e,part:t,payload:a.data,networkDetails:l};n(c),s(c)},onError:function(n,a,r,o){i.resetLoader(e,u),l(new Uo({type:Kn.NETWORK_ERROR,details:Wn.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:On({url:c.url,data:void 0},n),error:new Error("HTTP Error ".concat(n.code," ").concat(n.text)),networkDetails:r,stats:o}))},onAbort:function(n,a,r){e.stats.aborted=t.stats.aborted,i.resetLoader(e,u),l(new Uo({type:Kn.NETWORK_ERROR,details:Wn.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:r,stats:n}))},onTimeout:function(n,a,r){i.resetLoader(e,u),l(new Uo({type:Kn.NETWORK_ERROR,details:Wn.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error("Timeout after ".concat(h.timeout,"ms")),networkDetails:r,stats:n}))}})}}))}},{key:"updateStatsFromPart",value:function(e,t){var n=e.stats,i=t.stats,a=i.total;if(n.loaded+=i.loaded,a){var r=Math.round(e.duration/t.duration),o=Math.min(Math.round(n.loaded/a),r),s=(r-o)*Math.round(n.loaded/o);n.total=n.loaded+s}else n.total=Math.max(n.loaded,n.total);var l=n.loading,u=i.loading;l.start?l.first+=u.first-u.start:(l.start=u.start,l.first=u.first),l.end=u.end}},{key:"resetLoader",value:function(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}]),e}();function Po(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=t||e,i={frag:e,part:t,responseType:"arraybuffer",url:n.url,headers:{},rangeStart:0,rangeEnd:0},a=n.byteRangeStartOffset,r=n.byteRangeEndOffset;if(Fn(a)&&Fn(r)){var o,s=a,l=r;if("initSegment"===e.sn&&"AES-128"===(null==(o=e.decryptdata)?void 0:o.method)){var u=r-a;u%16&&(l=r+(16-u%16)),0!==a&&(i.resetIV=!0,s=a-16)}i.rangeStart=s,i.rangeEnd=l}return i}function No(e,t){var n=new Error("GAP ".concat(e.gap?"tag":"attribute"," found")),i={type:Kn.MEDIA_ERROR,details:Wn.FRAG_GAP,fatal:!1,frag:e,error:n,networkDetails:null};return t&&(i.part=t),(t||e).stats.aborted=!0,new Uo(i)}var Uo=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(e){var i;return(0,m.A)(this,n),(i=t.call(this,e.error.message)).data=void 0,i.data=e,i}return(0,v.A)(n)}((0,y.A)(Error)),Fo=function(){function e(t,n){(0,m.A)(this,e),this.subtle=void 0,this.aesIV=void 0,this.subtle=t,this.aesIV=n}return(0,v.A)(e,[{key:"decrypt",value:function(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}]),e}(),Bo=function(){function e(t,n){(0,m.A)(this,e),this.subtle=void 0,this.key=void 0,this.subtle=t,this.key=n}return(0,v.A)(e,[{key:"expandKey",value:function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}]),e}();var Ho=function(){function e(){(0,m.A)(this,e),this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}return(0,v.A)(e,[{key:"uint8ArrayToUint32Array_",value:function(e){for(var t=new DataView(e),n=new Uint32Array(4),i=0;i<4;i++)n[i]=t.getUint32(4*i);return n}},{key:"initTable",value:function(){var e=this.sBox,t=this.invSBox,n=this.subMix,i=n[0],a=n[1],r=n[2],o=n[3],s=this.invSubMix,l=s[0],u=s[1],c=s[2],d=s[3],h=new Uint32Array(256),f=0,v=0,m=0;for(m=0;m<256;m++)h[m]=m<128?m<<1:m<<1^283;for(m=0;m<256;m++){var p=v^v<<1^v<<2^v<<3^v<<4;p=p>>>8^255&p^99,e[f]=p,t[p]=f;var g=h[f],y=h[g],E=h[y],A=257*h[p]^16843008*p;i[f]=A<<24|A>>>8,a[f]=A<<16|A>>>16,r[f]=A<<8|A>>>24,o[f]=A,A=16843009*E^65537*y^257*g^16843008*f,l[p]=A<<24|A>>>8,u[p]=A<<16|A>>>16,c[p]=A<<8|A>>>24,d[p]=A,f?(f=g^h[h[h[E^g]]],v^=h[h[v]]):f=v=1}}},{key:"expandKey",value:function(e){for(var t=this.uint8ArrayToUint32Array_(e),n=!0,i=0;i<t.length&&n;)n=t[i]===this.key[i],i++;if(!n){this.key=t;var a=this.keySize=t.length;if(4!==a&&6!==a&&8!==a)throw new Error("Invalid aes key size="+a);var r,o,s,l,u=this.ksRows=4*(a+6+1),c=this.keySchedule=new Uint32Array(u),d=this.invKeySchedule=new Uint32Array(u),h=this.sBox,f=this.rcon,v=this.invSubMix,m=v[0],p=v[1],g=v[2],y=v[3];for(r=0;r<u;r++)r<a?s=c[r]=t[r]:(l=s,r%a===0?(l=h[(l=l<<8|l>>>24)>>>24]<<24|h[l>>>16&255]<<16|h[l>>>8&255]<<8|h[255&l],l^=f[r/a|0]<<24):a>6&&r%a===4&&(l=h[l>>>24]<<24|h[l>>>16&255]<<16|h[l>>>8&255]<<8|h[255&l]),c[r]=s=(c[r-a]^l)>>>0);for(o=0;o<u;o++)r=u-o,l=3&o?c[r]:c[r-4],d[o]=o<4||r<=4?l:m[h[l>>>24]]^p[h[l>>>16&255]]^g[h[l>>>8&255]]^y[h[255&l]],d[o]=d[o]>>>0}}},{key:"networkToHostOrderSwap",value:function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}},{key:"decrypt",value:function(e,t,n){for(var i,a,r,o,s,l,u,c,d,h,f,v,m,p,g=this.keySize+6,y=this.invKeySchedule,E=this.invSBox,A=this.invSubMix,b=A[0],k=A[1],T=A[2],_=A[3],S=this.uint8ArrayToUint32Array_(n),w=S[0],R=S[1],L=S[2],I=S[3],D=new Int32Array(e),C=new Int32Array(D.length),x=this.networkToHostOrderSwap;t<D.length;){for(d=x(D[t]),h=x(D[t+1]),f=x(D[t+2]),v=x(D[t+3]),s=d^y[0],l=v^y[1],u=f^y[2],c=h^y[3],m=4,p=1;p<g;p++)i=b[s>>>24]^k[l>>16&255]^T[u>>8&255]^_[255&c]^y[m],a=b[l>>>24]^k[u>>16&255]^T[c>>8&255]^_[255&s]^y[m+1],r=b[u>>>24]^k[c>>16&255]^T[s>>8&255]^_[255&l]^y[m+2],o=b[c>>>24]^k[s>>16&255]^T[l>>8&255]^_[255&u]^y[m+3],s=i,l=a,u=r,c=o,m+=4;i=E[s>>>24]<<24^E[l>>16&255]<<16^E[u>>8&255]<<8^E[255&c]^y[m],a=E[l>>>24]<<24^E[u>>16&255]<<16^E[c>>8&255]<<8^E[255&s]^y[m+1],r=E[u>>>24]<<24^E[c>>16&255]<<16^E[s>>8&255]<<8^E[255&l]^y[m+2],o=E[c>>>24]<<24^E[s>>16&255]<<16^E[l>>8&255]<<8^E[255&u]^y[m+3],C[t]=x(i^w),C[t+1]=x(o^R),C[t+2]=x(r^L),C[t+3]=x(a^I),w=d,R=h,L=f,I=v,t+=4}return C.buffer}}]),e}(),Go=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.removePKCS7Padding,a=void 0===i||i;if((0,m.A)(this,e),this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=t.enableSoftwareAES,this.removePKCS7Padding=a,a)try{var r=self.crypto;r&&(this.subtle=r.subtle||r.webkitSubtle)}catch(Rv){}this.useSoftware=!this.subtle}return(0,v.A)(e,[{key:"destroy",value:function(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}},{key:"isSync",value:function(){return this.useSoftware}},{key:"flush",value:function(){var e=this.currentResult,t=this.remainderData;if(!e||t)return this.reset(),null;var n=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?function(e){var t=e.byteLength,n=t&&new DataView(e.buffer).getUint8(t-1);return n?Ii(e,0,t-n):e}(n):n}},{key:"reset",value:function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}},{key:"decrypt",value:function(e,t,n){var i=this;return this.useSoftware?new Promise((function(a,r){i.softwareDecrypt(new Uint8Array(e),t,n);var o=i.flush();o?a(o.buffer):r(new Error("[softwareDecrypt] Failed to decrypt data"))})):this.webCryptoDecrypt(new Uint8Array(e),t,n)}},{key:"softwareDecrypt",value:function(e,t,n){var i=this.currentIV,a=this.currentResult,r=this.remainderData;this.logOnce("JS AES decrypt"),r&&(e=ha(r,e),this.remainderData=null);var o=this.getValidChunk(e);if(!o.length)return null;i&&(n=i);var s=this.softwareDecrypter;s||(s=this.softwareDecrypter=new Ho),s.expandKey(t);var l=a;return this.currentResult=s.decrypt(o.buffer,0,n),this.currentIV=Ii(o,-16).buffer,l||null}},{key:"webCryptoDecrypt",value:function(e,t,n){var i=this;if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,n));this.key=t,this.fastAesKey=new Bo(this.subtle,t)}return this.fastAesKey.expandKey().then((function(t){return i.subtle?(i.logOnce("WebCrypto AES decrypt"),new Fo(i.subtle,new Uint8Array(n)).decrypt(e.buffer,t)):Promise.reject(new Error("web crypto not initialized"))})).catch((function(a){return Xn.warn("[decrypter]: WebCrypto Error, disable WebCrypto API, ".concat(a.name,": ").concat(a.message)),i.onWebCryptoError(e,t,n)}))}},{key:"onWebCryptoError",value:function(e,t,n){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,n);var i=this.flush();if(i)return i.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}},{key:"getValidChunk",value:function(e){var t=e,n=e.length-e.length%16;return n!==e.length&&(t=Ii(e,0,n),this.remainderData=Ii(e,n)),t}},{key:"logOnce",value:function(e){this.logEnabled&&(Xn.log("[decrypter]: ".concat(e)),this.logEnabled=!1)}}]),e}(),Ko=function(e){for(var t="",n=e.length,i=0;i<n;i++)t+="[".concat(e.start(i).toFixed(3),"-").concat(e.end(i).toFixed(3),"]");return t},Wo="STOPPED",Vo="IDLE",qo="KEY_LOADING",Yo="FRAG_LOADING",jo="FRAG_LOADING_WAITING_RETRY",zo="WAITING_TRACK",Xo="PARSING",Qo="PARSED",Zo="ENDED",Jo="ERROR",$o="WAITING_INIT_PTS",es="WAITING_LEVEL",ts=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(e,i,a,r,o){var s;return(0,m.A)(this,n),(s=t.call(this)).hls=void 0,s.fragPrevious=null,s.fragCurrent=null,s.fragmentTracker=void 0,s.transmuxer=null,s._state=Wo,s.playlistType=void 0,s.media=null,s.mediaBuffer=null,s.config=void 0,s.bitrateTest=!1,s.lastCurrentTime=0,s.nextLoadPosition=0,s.startPosition=0,s.startTimeOffset=null,s.loadedmetadata=!1,s.retryDate=0,s.levels=null,s.fragmentLoader=void 0,s.keyLoader=void 0,s.levelLastLoaded=null,s.startFragRequested=!1,s.decrypter=void 0,s.initPTS=[],s.buffering=!0,s.onvseeking=null,s.onvended=null,s.logPrefix="",s.log=void 0,s.warn=void 0,s.playlistType=o,s.logPrefix=r,s.log=Xn.log.bind(Xn,"".concat(r,":")),s.warn=Xn.warn.bind(Xn,"".concat(r,":")),s.hls=e,s.fragmentLoader=new Oo(e.config),s.keyLoader=a,s.fragmentTracker=i,s.config=e.config,s.decrypter=new Go(e.config),e.on(Gn.MANIFEST_LOADED,s.onManifestLoaded,(0,Ln.A)(s)),s}return(0,v.A)(n,[{key:"doTick",value:function(){this.onTickEnd()}},{key:"onTickEnd",value:function(){}},{key:"startLoad",value:function(e){}},{key:"stopLoad",value:function(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);var e=this.fragCurrent;null!=e&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=Wo}},{key:"pauseBuffering",value:function(){this.buffering=!1}},{key:"resumeBuffering",value:function(){this.buffering=!0}},{key:"_streamEnded",value:function(e,t){if(t.live||e.nextStart||!e.end||!this.media)return!1;var n=t.partList;if(null!=n&&n.length){var i=n[n.length-1];return wo.isBuffered(this.media,i.start+i.duration/2)}var a=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(a)}},{key:"getLevelDetails",value:function(){var e;if(this.levels&&null!==this.levelLastLoaded)return null==(e=this.levelLastLoaded)?void 0:e.details}},{key:"onMediaAttached",value:function(e,t){var n=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),n.addEventListener("seeking",this.onvseeking),n.addEventListener("ended",this.onvended);var i=this.config;this.levels&&i.autoStartLoad&&this.state===Wo&&this.startLoad(i.startPosition)}},{key:"onMediaDetaching",value:function(){var e=this.media;null!=e&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}},{key:"onMediaSeeking",value:function(){var e=this.config,t=this.fragCurrent,n=this.media,i=this.mediaBuffer,a=this.state,r=n?n.currentTime:0,o=wo.bufferInfo(i||n,r,e.maxBufferHole);if(this.log("media seeking to ".concat(Fn(r)?r.toFixed(3):r,", state: ").concat(a)),this.state===Zo)this.resetLoadingState();else if(t){var s=e.maxFragLookUpTolerance,l=t.start-s,u=t.start+t.duration+s;if(!o.len||u<o.start||l>o.end){var c=r>u;(r<l||c)&&(c&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}n&&(this.fragmentTracker.removeFragmentsInRange(r,1/0,this.playlistType,!0),this.lastCurrentTime=r),this.loadedmetadata||o.len||(this.nextLoadPosition=this.startPosition=r),this.tickImmediate()}},{key:"onMediaEnded",value:function(){this.startPosition=this.lastCurrentTime=0}},{key:"onManifestLoaded",value:function(e,t){this.startTimeOffset=t.startTimeOffset,this.initPTS=[]}},{key:"onHandlerDestroying",value:function(){this.hls.off(Gn.MANIFEST_LOADED,this.onManifestLoaded,this),this.stopLoad(),(0,u.A)((0,c.A)(n.prototype),"onHandlerDestroying",this).call(this),this.hls=null}},{key:"onHandlerDestroyed",value:function(){this.state=Wo,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,(0,u.A)((0,c.A)(n.prototype),"onHandlerDestroyed",this).call(this)}},{key:"loadFragment",value:function(e,t,n){this._loadFragForPlayback(e,t,n)}},{key:"_loadFragForPlayback",value:function(e,t,n){var i=this;this._doFragLoad(e,t,n,(function(t){if(i.fragContextChanged(e))return i.warn("Fragment ".concat(e.sn).concat(t.part?" p: "+t.part.index:""," of level ").concat(e.level," was dropped during download.")),void i.fragmentTracker.removeFragment(e);e.stats.chunkCount++,i._handleFragmentLoadProgress(t)})).then((function(t){if(t){var n=i.state;i.fragContextChanged(e)?(n===Yo||!i.fragCurrent&&n===Xo)&&(i.fragmentTracker.removeFragment(e),i.state=Vo):("payload"in t&&(i.log("Loaded fragment ".concat(e.sn," of level ").concat(e.level)),i.hls.trigger(Gn.FRAG_LOADED,t)),i._handleFragmentLoadComplete(t))}})).catch((function(t){i.state!==Wo&&i.state!==Jo&&(i.warn("Frag error: ".concat((null==t?void 0:t.message)||t)),i.resetFragmentLoading(e))}))}},{key:"clearTrackerIfNeeded",value:function(e){var t,n=this.fragmentTracker;if(n.getState(e)===Eo){var i=e.type,a=this.getFwdBufferInfo(this.mediaBuffer,i),r=Math.max(e.duration,a?a.len:this.config.maxBufferLength),o=this.backtrackFragment;(1===(o?e.sn-o.sn:0)||this.reduceMaxBufferLength(r,e.duration))&&n.removeFragment(e)}else 0===(null==(t=this.mediaBuffer)?void 0:t.buffered.length)?n.removeAllFragments():n.hasParts(e.type)&&(n.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),n.getState(e)===Ao&&n.removeFragment(e))}},{key:"checkLiveUpdate",value:function(e){if(e.updated&&!e.live){var t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}},{key:"flushMainBuffer",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(e-t){var i={startOffset:e,endOffset:t,type:n};this.hls.trigger(Gn.BUFFER_FLUSHING,i)}}},{key:"_loadInitSegment",value:function(e,t){var n=this;this._doFragLoad(e,t).then((function(t){if(!t||n.fragContextChanged(e)||!n.levels)throw new Error("init load aborted");return t})).then((function(t){var i=n.hls,a=t.payload,r=e.decryptdata;if(a&&a.byteLength>0&&null!=r&&r.key&&r.iv&&"AES-128"===r.method){var o=self.performance.now();return n.decrypter.decrypt(new Uint8Array(a),r.key.buffer,r.iv.buffer).catch((function(t){throw i.trigger(Gn.ERROR,{type:Kn.MEDIA_ERROR,details:Wn.FRAG_DECRYPT_ERROR,fatal:!1,error:t,reason:t.message,frag:e}),t})).then((function(a){var r=self.performance.now();return i.trigger(Gn.FRAG_DECRYPTED,{frag:e,payload:a,stats:{tstart:o,tdecrypt:r}}),t.payload=a,n.completeInitSegmentLoad(t)}))}return n.completeInitSegmentLoad(t)})).catch((function(t){n.state!==Wo&&n.state!==Jo&&(n.warn(t),n.resetFragmentLoading(e))}))}},{key:"completeInitSegmentLoad",value:function(e){if(!this.levels)throw new Error("init load aborted, missing levels");var t=e.frag.stats;this.state=Vo,e.frag.data=new Uint8Array(e.payload),t.parsing.start=t.buffering.start=self.performance.now(),t.parsing.end=t.buffering.end=self.performance.now(),this.tick()}},{key:"fragContextChanged",value:function(e){var t=this.fragCurrent;return!e||!t||e.sn!==t.sn||e.level!==t.level}},{key:"fragBufferedComplete",value:function(e,t){var n,i,a,r,o=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log("Buffered ".concat(e.type," sn: ").concat(e.sn).concat(t?" part: "+t.index:""," of ").concat(this.playlistType===nr?"level":"track"," ").concat(e.level," (frag:[").concat((null!=(n=e.startPTS)?n:NaN).toFixed(3),"-").concat((null!=(i=e.endPTS)?i:NaN).toFixed(3),"] > buffer:").concat(o?Ko(wo.getBuffered(o)):"(detached)",")")),"initSegment"!==e.sn){var s;if(e.type!==ar){var l=e.elementaryStreams;if(!Object.keys(l).some((function(e){return!!l[e]})))return void(this.state=Vo)}var u=null==(s=this.levels)?void 0:s[e.level];null!=u&&u.fragmentError&&(this.log("Resetting level fragment error count of ".concat(u.fragmentError," on frag buffered")),u.fragmentError=0)}this.state=Vo,o&&(!this.loadedmetadata&&e.type==nr&&o.buffered.length&&(null==(a=this.fragCurrent)?void 0:a.sn)===(null==(r=this.fragPrevious)?void 0:r.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}},{key:"seekToStartPos",value:function(){}},{key:"_handleFragmentLoadComplete",value:function(e){var t=this.transmuxer;if(t){var n=e.frag,i=e.part,a=e.partsLoaded,r=!a||0===a.length||a.some((function(e){return!e})),o=new Ro(n.level,n.sn,n.stats.chunkCount+1,0,i?i.index:-1,!r);t.flush(o)}}},{key:"_handleFragmentLoadProgress",value:function(e){}},{key:"_doFragLoad",value:function(e,t){var n,i=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3?arguments[3]:void 0,s=null==t?void 0:t.details;if(!this.levels||!s)throw new Error("frag load aborted, missing level".concat(s?"":" detail","s"));var l=null;if(!e.encrypted||null!=(n=e.decryptdata)&&n.key?!e.encrypted&&s.encryptedFragments.length&&this.keyLoader.loadClear(e,s.encryptedFragments):(this.log("Loading key for ".concat(e.sn," of [").concat(s.startSN,"-").concat(s.endSN,"], ").concat("[stream-controller]"===this.logPrefix?"level":"track"," ").concat(e.level)),this.state=qo,this.fragCurrent=e,l=this.keyLoader.load(e).then((function(e){if(!i.fragContextChanged(e.frag))return i.hls.trigger(Gn.KEY_LOADED,e),i.state===qo&&(i.state=Vo),e})),this.hls.trigger(Gn.KEY_LOADING,{frag:e}),null===this.fragCurrent&&(l=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))),r=Math.max(e.start,r||0),this.config.lowLatencyMode&&"initSegment"!==e.sn){var u=s.partList;if(u&&o){r>e.end&&s.fragmentHint&&(e=s.fragmentHint);var c=this.getNextPart(u,e,r);if(c>-1){var d,h=u[c];return this.log("Loading part sn: ".concat(e.sn," p: ").concat(h.index," cc: ").concat(e.cc," of playlist [").concat(s.startSN,"-").concat(s.endSN,"] parts [0-").concat(c,"-").concat(u.length-1,"] ").concat("[stream-controller]"===this.logPrefix?"level":"track",": ").concat(e.level,", target: ").concat(parseFloat(r.toFixed(3)))),this.nextLoadPosition=h.start+h.duration,this.state=Yo,d=l?l.then((function(n){return!n||i.fragContextChanged(n.frag)?null:i.doFragPartsLoad(e,h,t,o)})).catch((function(e){return i.handleFragLoadError(e)})):this.doFragPartsLoad(e,h,t,o).catch((function(e){return i.handleFragLoadError(e)})),this.hls.trigger(Gn.FRAG_LOADING,{frag:e,part:h,targetBufferTime:r}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):d}if(!e.url||this.loadedEndOfParts(u,r))return Promise.resolve(null)}}this.log("Loading fragment ".concat(e.sn," cc: ").concat(e.cc," ").concat(s?"of ["+s.startSN+"-"+s.endSN+"] ":"").concat("[stream-controller]"===this.logPrefix?"level":"track",": ").concat(e.level,", target: ").concat(parseFloat(r.toFixed(3)))),Fn(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=Yo;var f,v=this.config.progressive;return f=v&&l?l.then((function(t){return!t||i.fragContextChanged(null==t?void 0:t.frag)?null:i.fragmentLoader.load(e,o)})).catch((function(e){return i.handleFragLoadError(e)})):Promise.all([this.fragmentLoader.load(e,v?o:void 0),l]).then((function(e){var t=(0,a.A)(e,1)[0];return!v&&t&&o&&o(t),t})).catch((function(e){return i.handleFragLoadError(e)})),this.hls.trigger(Gn.FRAG_LOADING,{frag:e,targetBufferTime:r}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):f}},{key:"doFragPartsLoad",value:function(e,t,n,i){var a=this;return new Promise((function(r,o){var s,l=[],u=null==(s=n.details)?void 0:s.partList;!function t(s){a.fragmentLoader.loadPart(e,s,i).then((function(i){l[s.index]=i;var o=i.part;a.hls.trigger(Gn.FRAG_LOADED,i);var c=Nr(n,e.sn,s.index+1)||Ur(u,e.sn,s.index+1);if(!c)return r({frag:e,part:o,partsLoaded:l});t(c)})).catch(o)}(t)}))}},{key:"handleFragLoadError",value:function(e){if("data"in e){var t=e.data;e.data&&t.details===Wn.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(Gn.ERROR,t)}else this.hls.trigger(Gn.ERROR,{type:Kn.OTHER_ERROR,details:Wn.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}},{key:"_handleTransmuxerFlush",value:function(e){var t=this.getCurrentContext(e);if(t&&this.state===Xo){var n=t.frag,i=t.part,a=t.level,r=self.performance.now();n.stats.parsing.end=r,i&&(i.stats.parsing.end=r),this.updateLevelTiming(n,i,a,e.partial)}else this.fragCurrent||this.state===Wo||this.state===Jo||(this.state=Vo)}},{key:"getCurrentContext",value:function(e){var t=this.levels,n=this.fragCurrent,i=e.level,a=e.sn,r=e.part;if(null==t||!t[i])return this.warn("Levels object was unset while buffering fragment ".concat(a," of level ").concat(i,". The current chunk will not be buffered.")),null;var o=t[i],s=r>-1?Nr(o,a,r):null,l=s?s.fragment:function(e,t,n){if(null==e||!e.details)return null;var i=e.details,a=i.fragments[t-i.startSN];return a||((a=i.fragmentHint)&&a.sn===t?a:t<i.startSN&&n&&n.sn===t?n:null)}(o,a,n);return l?(n&&n!==l&&(l.stats=n.stats),{frag:l,part:s,level:o}):null}},{key:"bufferFragmentData",value:function(e,t,n,i,a){var r;if(e&&this.state===Xo){var o=e.data1,s=e.data2,l=o;if(o&&s&&(l=ha(o,s)),null!=(r=l)&&r.length){var u={type:e.type,frag:t,part:n,chunkMeta:i,parent:t.type,data:l};if(this.hls.trigger(Gn.BUFFER_APPENDING,u),e.dropped&&e.independent&&!n){if(a)return;this.flushBufferGap(t)}}}}},{key:"flushBufferGap",value:function(e){var t=this.media;if(t)if(wo.isBuffered(t,t.currentTime)){var n=t.currentTime,i=wo.bufferInfo(t,n,0),a=e.duration,r=Math.min(2*this.config.maxFragLookUpTolerance,.25*a),o=Math.max(Math.min(e.start-r,i.end-r),n+r);e.start-o>r&&this.flushMainBuffer(o,e.start)}else this.flushMainBuffer(0,e.start)}},{key:"getFwdBufferInfo",value:function(e,t){var n=this.getLoadPosition();return Fn(n)?this.getFwdBufferInfoAtPos(e,n,t):null}},{key:"getFwdBufferInfoAtPos",value:function(e,t,n){var i=this.config.maxBufferHole,a=wo.bufferInfo(e,t,i);if(0===a.len&&void 0!==a.nextStart){var r=this.fragmentTracker.getBufferedFrag(t,n);if(r&&a.nextStart<r.end)return wo.bufferInfo(e,t,Math.max(a.nextStart,i))}return a}},{key:"getMaxBufferLength",value:function(e){var t,n=this.config;return t=e?Math.max(8*n.maxBufferSize/e,n.maxBufferLength):n.maxBufferLength,Math.min(t,n.maxMaxBufferLength)}},{key:"reduceMaxBufferLength",value:function(e,t){var n=this.config,i=Math.max(Math.min(e-t,n.maxBufferLength),t),a=Math.max(e-3*t,n.maxMaxBufferLength/2,i);return a>=i&&(n.maxMaxBufferLength=a,this.warn("Reduce max buffer length to ".concat(a,"s")),!0)}},{key:"getAppendedFrag",value:function(e){var t=this.fragmentTracker.getAppendedFrag(e,nr);return t&&"fragment"in t?t.fragment:t}},{key:"getNextFragment",value:function(e,t){var n=t.fragments,i=n.length;if(!i)return null;var a,r=this.config,o=n[0].start;if(t.live){var s=r.initialLiveManifestSize;if(i<s)return this.warn("Not enough fragments to start playback (have: ".concat(i,", need: ").concat(s,")")),null;(!t.PTSKnown&&!this.startFragRequested&&-1===this.startPosition||e<o)&&(a=this.getInitialLiveFragment(t,n),this.startPosition=this.nextLoadPosition=a?this.hls.liveSyncPosition||a.start:e)}else e<=o&&(a=n[0]);if(!a){var l=r.lowLatencyMode?t.partEnd:t.fragmentEnd;a=this.getFragmentAtPosition(e,l,t)}return this.mapToInitFragWhenRequired(a)}},{key:"isLoopLoading",value:function(e,t){var n=this.fragmentTracker.getState(e);return(n===bo||n===Ao&&!!e.gap)&&this.nextLoadPosition>t}},{key:"getNextFragmentLoopLoading",value:function(e,t,n,i,a){var r=e.gap,o=this.getNextFragment(this.nextLoadPosition,t);if(null===o)return o;if(e=o,r&&e&&!e.gap&&n.nextStart){var s=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,n.nextStart,i);if(null!==s&&n.len+s.len>=a)return this.log('buffer full after gaps in "'.concat(i,'" playlist starting at sn: ').concat(e.sn)),null}return e}},{key:"mapToInitFragWhenRequired",value:function(e){return null==e||!e.initSegment||null!=e&&e.initSegment.data||this.bitrateTest?e:e.initSegment}},{key:"getNextPart",value:function(e,t,n){for(var i=-1,a=!1,r=!0,o=0,s=e.length;o<s;o++){var l=e[o];if(r=r&&!l.independent,i>-1&&n<l.start)break;var u=l.loaded;u?i=-1:(a||l.independent||r)&&l.fragment===t&&(i=o),a=u}return i}},{key:"loadedEndOfParts",value:function(e,t){var n=e[e.length-1];return n&&t>n.start&&n.loaded}},{key:"getInitialLiveFragment",value:function(e,t){var n=this.fragPrevious,i=null;if(n){if(e.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: ".concat(n.programDateTime)),i=function(e,t,n){if(null===t||!Array.isArray(e)||!e.length||!Fn(t))return null;if(t<(e[0].programDateTime||0))return null;if(t>=(e[e.length-1].endProgramDateTime||0))return null;n=n||0;for(var i=0;i<e.length;++i){var a=e[i];if(zr(t,n,a))return a}return null}(t,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!i){var a=n.sn+1;if(a>=e.startSN&&a<=e.endSN){var r=t[a-e.startSN];n.cc===r.cc&&(i=r,this.log("Live playlist, switching playlist, load frag with next SN: ".concat(i.sn)))}i||(i=function(e,t){return Vr(e,(function(e){return e.cc<t?1:e.cc>t?-1:0}))}(t,n.cc),i&&this.log("Live playlist, switching playlist, load frag with same CC: ".concat(i.sn)))}}else{var o=this.hls.liveSyncPosition;null!==o&&(i=this.getFragmentAtPosition(o,this.bitrateTest?e.fragmentEnd:e.edge,e))}return i}},{key:"getFragmentAtPosition",value:function(e,t,n){var i,a=this.config,r=this.fragPrevious,o=n.fragments,s=n.endSN,l=n.fragmentHint,u=a.maxFragLookUpTolerance,c=n.partList,d=!!(a.lowLatencyMode&&null!=c&&c.length&&l);(d&&l&&!this.bitrateTest&&(o=o.concat(l),s=l.sn),e<t)?i=qr(r,o,e,e>t-u?0:u):i=o[o.length-1];if(i){var h=i.sn-n.startSN,f=this.fragmentTracker.getState(i);if((f===bo||f===Ao&&i.gap)&&(r=i),r&&i.sn===r.sn&&(!d||c[0].fragment.sn>i.sn))if(r&&i.level===r.level){var v=o[h+1];i=i.sn<s&&this.fragmentTracker.getState(v)!==bo?v:null}}return i}},{key:"synchronizeToLiveEdge",value:function(e){var t=this.config,n=this.media;if(n){var i=this.hls.liveSyncPosition,a=n.currentTime,r=e.fragments[0].start,o=e.edge,s=a>=r-t.maxFragLookUpTolerance&&a<=o;if(null!==i&&n.duration>i&&(a<i||!s)){var l=void 0!==t.liveMaxLatencyDuration?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!s&&n.readyState<4||a<o-l)&&(this.loadedmetadata||(this.nextLoadPosition=i),n.readyState&&(this.warn("Playback: ".concat(a.toFixed(3)," is located too far from the end of live sliding playlist: ").concat(o,", reset currentTime to : ").concat(i.toFixed(3))),n.currentTime=i))}}}},{key:"alignPlaylists",value:function(e,t,n){var i=e.fragments.length;if(!i)return this.warn("No fragments in live playlist"),0;var a=e.fragments[0].start,r=!t,o=e.alignedSliding&&Fn(a);if(r||!o&&!a){var s=this.fragPrevious;Co(s,n,e);var l=e.fragments[0].start;return this.log("Live playlist sliding: ".concat(l.toFixed(2)," start-sn: ").concat(t?t.startSN:"na","->").concat(e.startSN," prev-sn: ").concat(s?s.sn:"na"," fragments: ").concat(i)),l}return a}},{key:"waitForCdnTuneIn",value:function(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,3*e.partTarget)}},{key:"setStartPosition",value:function(e,t){var n=this.startPosition;if(n<t&&(n=-1),-1===n||-1===this.lastCurrentTime){var i=null!==this.startTimeOffset,a=i?this.startTimeOffset:e.startTimeOffset;null!==a&&Fn(a)?(n=t+a,a<0&&(n+=e.totalduration),n=Math.min(Math.max(t,n),t+e.totalduration),this.log("Start time offset ".concat(a," found in ").concat(i?"multivariant":"media"," playlist, adjust startPosition to ").concat(n)),this.startPosition=n):e.live?n=this.hls.liveSyncPosition||t:this.startPosition=n=0,this.lastCurrentTime=n}this.nextLoadPosition=n}},{key:"getLoadPosition",value:function(){var e=this.media,t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t}},{key:"handleFragLoadAborted",value:function(e,t){this.transmuxer&&"initSegment"!==e.sn&&e.stats.aborted&&(this.warn("Fragment ".concat(e.sn).concat(t?" part "+t.index:""," of level ").concat(e.level," was aborted")),this.resetFragmentLoading(e))}},{key:"resetFragmentLoading",value:function(e){this.fragCurrent&&(this.fragContextChanged(e)||this.state===jo)||(this.state=Vo)}},{key:"onFragmentOrKeyLoadError",value:function(e,t){if(t.chunkMeta&&!t.frag){var n=this.getCurrentContext(t.chunkMeta);n&&(t.frag=n.frag)}var i=t.frag;if(i&&i.type===e&&this.levels)if(this.fragContextChanged(i)){var a;this.warn("Frag load error must match current frag to retry ".concat(i.url," > ").concat(null==(a=this.fragCurrent)?void 0:a.url))}else{var r=t.details===Wn.FRAG_GAP;r&&this.fragmentTracker.fragBuffered(i,!0);var o=t.errorAction,s=o||{},l=s.action,u=s.retryCount,c=void 0===u?0:u,d=s.retryConfig;if(o&&l===Jr&&d){this.resetStartWhenNotLoaded(this.levelLastLoaded);var h=Gr(d,c);this.warn("Fragment ".concat(i.sn," of ").concat(e," ").concat(i.level," errored with ").concat(t.details,", retrying loading ").concat(c+1,"/").concat(d.maxNumRetry," in ").concat(h,"ms")),o.resolved=!0,this.retryDate=self.performance.now()+h,this.state=jo}else if(d&&o){if(this.resetFragmentErrors(e),!(c<d.maxNumRetry))return void Xn.warn("".concat(t.details," reached or exceeded max retry (").concat(c,")"));r||l===Zr||(o.resolved=!0)}else(null==o?void 0:o.action)===Qr?this.state=es:this.state=Jo;this.tickImmediate()}}},{key:"reduceLengthAndFlushBuffer",value:function(e){if(this.state===Xo||this.state===Qo){var t=e.frag,n=e.parent,i=this.getFwdBufferInfo(this.mediaBuffer,n),a=i&&i.len>.5;a&&this.reduceMaxBufferLength(i.len,(null==t?void 0:t.duration)||10);var r=!a;return r&&this.warn("Buffer full error while media.currentTime is not buffered, flush ".concat(n," buffer")),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),r}return!1}},{key:"resetFragmentErrors",value:function(e){e===ir&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==Wo&&(this.state=Vo)}},{key:"afterBufferFlushed",value:function(e,t,n){if(e){var i=wo.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,i,n),this.state===Zo&&this.resetLoadingState()}}},{key:"resetLoadingState",value:function(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=Vo}},{key:"resetStartWhenNotLoaded",value:function(e){if(!this.loadedmetadata){this.startFragRequested=!1;var t=e?e.details:null;null!=t&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}},{key:"resetWhenMissingContext",value:function(e){this.warn("The loading context changed while buffering fragment ".concat(e.sn," of level ").concat(e.level,". This chunk will not be buffered.")),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}},{key:"removeUnbufferedFrags",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}},{key:"updateLevelTiming",value:function(e,t,n,i){var a,r=this,o=n.details;if(o){if(!Object.keys(e.elementaryStreams).reduce((function(t,a){var s=e.elementaryStreams[a];if(s){var l=s.endPTS-s.startPTS;if(l<=0)return r.warn("Could not parse fragment ".concat(e.sn," ").concat(a," duration reliably (").concat(l,")")),t||!1;var u=i?0:xr(o,e,s.startPTS,s.endPTS,s.startDTS,s.endDTS);return r.hls.trigger(Gn.LEVEL_PTS_UPDATED,{details:o,level:n,drift:u,type:a,frag:e,start:s.startPTS,end:s.endPTS}),!0}return t}),!1)&&null===(null==(a=this.transmuxer)?void 0:a.error)){var s=new Error("Found no media in fragment ".concat(e.sn," of level ").concat(e.level," resetting transmuxer to fallback to playlist timing"));if(0===n.fragmentError&&(n.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)),this.warn(s.message),this.hls.trigger(Gn.ERROR,{type:Kn.MEDIA_ERROR,details:Wn.FRAG_PARSING_ERROR,fatal:!1,error:s,frag:e,reason:"Found no media in msn ".concat(e.sn,' of level "').concat(n.url,'"')}),!this.hls)return;this.resetTransmuxer()}this.state=Qo,this.hls.trigger(Gn.FRAG_PARSED,{frag:e,part:t})}else this.warn("level.details undefined")}},{key:"resetTransmuxer",value:function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}},{key:"recoverWorkerError",value:function(e){"demuxerWorker"===e.event&&(this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}},{key:"state",get:function(){return this._state},set:function(e){var t=this._state;t!==e&&(this._state=e,this.log("".concat(t,"->").concat(e)))}}]),n}(go),ns=function(){function e(){(0,m.A)(this,e),this.chunks=[],this.dataLength=0}return(0,v.A)(e,[{key:"push",value:function(e){this.chunks.push(e),this.dataLength+=e.length}},{key:"flush",value:function(){var e,t=this.chunks,n=this.dataLength;return t.length?(e=1===t.length?t[0]:function(e,t){for(var n=new Uint8Array(t),i=0,a=0;a<e.length;a++){var r=e[a];n.set(r,i),i+=r.length}return n}(t,n),this.reset(),e):new Uint8Array(0)}},{key:"reset",value:function(){this.chunks.length=0,this.dataLength=0}}]),e}();function is(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9e4;return{type:e,id:-1,pid:-1,inputTimeScale:t,sequenceNumber:-1,samples:[],dropped:0}}var as=function(){function e(){(0,m.A)(this,e),this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}return(0,v.A)(e,[{key:"resetInitSegment",value:function(e,t,n,i){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}},{key:"resetTimeStamp",value:function(e){this.initPTS=e,this.resetContiguity()}},{key:"resetContiguity",value:function(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}},{key:"canParse",value:function(e,t){return!1}},{key:"appendFrame",value:function(e,t,n){}},{key:"demux",value:function(e,t){this.cachedData&&(e=ha(this.cachedData,e),this.cachedData=null);var n,i=Mi(e,0),a=i?i.length:0,r=this._audioTrack,o=this._id3Track,s=i?Ni(i):void 0,l=e.length;for((null===this.basePTS||0===this.frameIndex&&Fn(s))&&(this.basePTS=rs(s,t,this.initPTS),this.lastPTS=this.basePTS),null===this.lastPTS&&(this.lastPTS=this.basePTS),i&&i.length>0&&o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:fr,duration:Number.POSITIVE_INFINITY});a<l;){if(this.canParse(e,a)){var u=this.appendFrame(r,e,a);u?(this.frameIndex++,this.lastPTS=u.sample.pts,n=a+=u.length):a=l}else Pi(e,a)?(i=Mi(e,a),o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:fr,duration:Number.POSITIVE_INFINITY}),n=a+=i.length):a++;if(a===l&&n!==l){var c=Ii(e,n);this.cachedData?this.cachedData=ha(this.cachedData,c):this.cachedData=c}}return{audioTrack:r,videoTrack:is(),id3Track:o,textTrack:is()}}},{key:"demuxSampleAes",value:function(e,t,n){return Promise.reject(new Error("[".concat(this,"] This demuxer does not support Sample-AES decryption")))}},{key:"flush",value:function(e){var t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:is(),id3Track:this._id3Track,textTrack:is()}}},{key:"destroy",value:function(){}}]),e}(),rs=function(e,t,n){return Fn(e)?90*e:9e4*t+(n?9e4*n.baseTime/n.timescale:0)};function os(e,t){return 255===e[t]&&240===(246&e[t+1])}function ss(e,t){return 1&e[t+1]?7:9}function ls(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function us(e,t){return t+1<e.length&&os(e,t)}function cs(e,t){if(us(e,t)){var n=ss(e,t);if(t+n>=e.length)return!1;var i=ls(e,t);if(i<=n)return!1;var a=t+i;return a===e.length||us(e,a)}return!1}function ds(e,t,n,i,a){if(!e.samplerate){var r=function(e,t,n,i){var a,r,o,s,l=navigator.userAgent.toLowerCase(),u=i,c=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];a=1+((192&t[n+2])>>>6);var d=(60&t[n+2])>>>2;if(!(d>c.length-1))return o=(1&t[n+2])<<2,o|=(192&t[n+3])>>>6,Xn.log("manifest codec:".concat(i,", ADTS type:").concat(a,", samplingIndex:").concat(d)),/firefox/i.test(l)?d>=6?(a=5,s=new Array(4),r=d-3):(a=2,s=new Array(2),r=d):-1!==l.indexOf("android")?(a=2,s=new Array(2),r=d):(a=5,s=new Array(4),i&&(-1!==i.indexOf("mp4a.40.29")||-1!==i.indexOf("mp4a.40.5"))||!i&&d>=6?r=d-3:((i&&-1!==i.indexOf("mp4a.40.2")&&(d>=6&&1===o||/vivaldi/i.test(l))||!i&&1===o)&&(a=2,s=new Array(2)),r=d)),s[0]=a<<3,s[0]|=(14&d)>>1,s[1]|=(1&d)<<7,s[1]|=o<<3,5===a&&(s[1]|=(14&r)>>1,s[2]=(1&r)<<7,s[2]|=8,s[3]=0),{config:s,samplerate:c[d],channelCount:o,codec:"mp4a.40."+a,manifestCodec:u};var h=new Error("invalid ADTS sampling index:".concat(d));e.emit(Gn.ERROR,Gn.ERROR,{type:Kn.MEDIA_ERROR,details:Wn.FRAG_PARSING_ERROR,fatal:!0,error:h,reason:h.message})}(t,n,i,a);if(!r)return;e.config=r.config,e.samplerate=r.samplerate,e.channelCount=r.channelCount,e.codec=r.codec,e.manifestCodec=r.manifestCodec,Xn.log("parsed codec:".concat(e.codec,", rate:").concat(r.samplerate,", channels:").concat(r.channelCount))}}function hs(e){return 9216e4/e}function fs(e,t,n,i,a){var r,o=i+a*hs(e.samplerate),s=function(e,t){var n=ss(e,t);if(t+n<=e.length){var i=ls(e,t)-n;if(i>0)return{headerLength:n,frameLength:i}}}(t,n);if(s){var l=s.frameLength,u=s.headerLength,c=u+l,d=Math.max(0,n+c-t.length);d?(r=new Uint8Array(c-u)).set(t.subarray(n+u,t.length),0):r=t.subarray(n+u,n+c);var h={unit:r,pts:o};return d||e.samples.push(h),{sample:h,length:c,missing:d}}var f=t.length-n;return(r=new Uint8Array(f)).set(t.subarray(n,t.length),0),{sample:{unit:r,pts:o},length:f,missing:-1}}var vs=null,ms=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],ps=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],gs=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],ys=[0,1,1,4];function Es(e,t,n,i,a){if(!(n+24>t.length)){var r=As(t,n);if(r&&n+r.frameLength<=t.length){var o=i+a*(9e4*r.samplesPerFrame/r.sampleRate),s={unit:t.subarray(n,n+r.frameLength),pts:o,dts:o};return e.config=[],e.channelCount=r.channelCount,e.samplerate=r.sampleRate,e.samples.push(s),{sample:s,length:r.frameLength,missing:0}}}}function As(e,t){var n=e[t+1]>>3&3,i=e[t+1]>>1&3,a=e[t+2]>>4&15,r=e[t+2]>>2&3;if(1!==n&&0!==a&&15!==a&&3!==r){var o=e[t+2]>>1&1,s=e[t+3]>>6,l=1e3*ms[14*(3===n?3-i:3===i?3:4)+a-1],u=ps[3*(3===n?0:2===n?1:2)+r],c=3===s?1:2,d=gs[n][i],h=ys[i],f=8*d*h,v=Math.floor(d*l/u+o)*h;if(null===vs){var m=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);vs=m?parseInt(m[1]):0}return!!vs&&vs<=87&&2===i&&l>=224e3&&0===s&&(e[t+3]=128|e[t+3]),{sampleRate:u,channelCount:c,frameLength:v,samplesPerFrame:f}}}function bs(e,t){return 255===e[t]&&224===(224&e[t+1])&&0!==(6&e[t+1])}function ks(e,t){return t+1<e.length&&bs(e,t)}function Ts(e,t){if(t+1<e.length&&bs(e,t)){var n=As(e,t),i=4;null!=n&&n.frameLength&&(i=n.frameLength);var a=t+i;return a===e.length||ks(e,a)}return!1}var _s=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(e,i){var a;return(0,m.A)(this,n),(a=t.call(this)).observer=void 0,a.config=void 0,a.observer=e,a.config=i,a}return(0,v.A)(n,[{key:"resetInitSegment",value:function(e,t,i,a){(0,u.A)((0,c.A)(n.prototype),"resetInitSegment",this).call(this,e,t,i,a),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:a,inputTimeScale:9e4,dropped:0}}},{key:"canParse",value:function(e,t){return function(e,t){return function(e,t){return t+5<e.length}(e,t)&&os(e,t)&&ls(e,t)<=e.length-t}(e,t)}},{key:"appendFrame",value:function(e,t,n){ds(e,this.observer,t,n,e.manifestCodec);var i=fs(e,t,n,this.basePTS,this.frameIndex);if(i&&0===i.missing)return i}}],[{key:"probe",value:function(e){if(!e)return!1;var t=Mi(e,0),n=(null==t?void 0:t.length)||0;if(Ts(e,n))return!1;for(var i=e.length;n<i;n++)if(cs(e,n))return Xn.log("ADTS sync word found !"),!0;return!1}}]),n}(as),Ss=/\/emsg[-/]ID3/i,ws=function(){function e(t,n){(0,m.A)(this,e),this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=n}return(0,v.A)(e,[{key:"resetTimeStamp",value:function(){}},{key:"resetInitSegment",value:function(e,t,n,i){var a=this.videoTrack=is("video",1),r=this.audioTrack=is("audio",1),o=this.txtTrack=is("text",1);if(this.id3Track=is("id3",1),this.timeOffset=0,null!=e&&e.byteLength){var s=ra(e);if(s.video){var l=s.video,u=l.id,c=l.timescale,d=l.codec;a.id=u,a.timescale=o.timescale=c,a.codec=d}if(s.audio){var h=s.audio,f=h.id,v=h.timescale,m=h.codec;r.id=f,r.timescale=v,r.codec=m}o.id=Qi.text,a.sampleDuration=0,a.duration=r.duration=i}}},{key:"resetContiguity",value:function(){this.remainderData=null}},{key:"demux",value:function(e,t){this.timeOffset=t;var n=e,i=this.videoTrack,a=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=ha(this.remainderData,e));var r=function(e){var t={valid:null,remainder:null},n=ia(e,["moof"]);if(n.length<2)return t.remainder=e,t;var i=n[n.length-1];return t.valid=Ii(e,0,i.byteOffset-8),t.remainder=Ii(e,i.byteOffset-8),t}(n);this.remainderData=r.remainder,i.samples=r.valid||new Uint8Array}else i.samples=n;var o=this.extractID3Track(i,t);return a.samples=fa(t,i),{videoTrack:i,audioTrack:this.audioTrack,id3Track:o,textTrack:this.txtTrack}}},{key:"flush",value:function(){var e=this.timeOffset,t=this.videoTrack,n=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;var i=this.extractID3Track(t,this.timeOffset);return n.samples=fa(e,t),{videoTrack:t,audioTrack:is(),id3Track:i,textTrack:is()}}},{key:"extractID3Track",value:function(e,t){var n=this.id3Track;if(e.samples.length){var i=ia(e.samples,["emsg"]);i&&i.forEach((function(e){var i=function(e){var t=e[0],n="",i="",a=0,r=0,o=0,s=0,l=0,u=0;if(0===t){for(;"\0"!==Zi(e.subarray(u,u+1));)n+=Zi(e.subarray(u,u+1)),u+=1;for(n+=Zi(e.subarray(u,u+1)),u+=1;"\0"!==Zi(e.subarray(u,u+1));)i+=Zi(e.subarray(u,u+1)),u+=1;i+=Zi(e.subarray(u,u+1)),u+=1,a=$i(e,12),r=$i(e,16),s=$i(e,20),l=$i(e,24),u=28}else if(1===t){a=$i(e,u+=4);var c=$i(e,u+=4),d=$i(e,u+=4);for(u+=4,o=Math.pow(2,32)*c+d,Bn(o)||(o=Number.MAX_SAFE_INTEGER,Xn.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),s=$i(e,u),l=$i(e,u+=4),u+=4;"\0"!==Zi(e.subarray(u,u+1));)n+=Zi(e.subarray(u,u+1)),u+=1;for(n+=Zi(e.subarray(u,u+1)),u+=1;"\0"!==Zi(e.subarray(u,u+1));)i+=Zi(e.subarray(u,u+1)),u+=1;i+=Zi(e.subarray(u,u+1)),u+=1}return{schemeIdUri:n,value:i,timeScale:a,presentationTime:o,presentationTimeDelta:r,eventDuration:s,id:l,payload:e.subarray(u,e.byteLength)}}(e);if(Ss.test(i.schemeIdUri)){var a=Fn(i.presentationTime)?i.presentationTime/i.timeScale:t+i.presentationTimeDelta/i.timeScale,r=4294967295===i.eventDuration?Number.POSITIVE_INFINITY:i.eventDuration/i.timeScale;r<=.001&&(r=Number.POSITIVE_INFINITY);var o=i.payload;n.samples.push({data:o,len:o.byteLength,dts:a,pts:a,type:mr,duration:r})}}))}return n}},{key:"demuxSampleAes",value:function(e,t,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}},{key:"destroy",value:function(){}}],[{key:"probe",value:function(e){return function(e){for(var t=e.byteLength,n=0;n<t;){var i=$i(e,n);if(i>8&&109===e[n+4]&&111===e[n+5]&&111===e[n+6]&&102===e[n+7])return!0;n=i>1?n+i:t}return!1}(e)}}]),e}(),Rs=function(e,t){var n=0,i=5;t+=i;for(var a=new Uint32Array(1),r=new Uint32Array(1),o=new Uint8Array(1);i>0;){o[0]=e[t];var s=Math.min(i,8),l=8-s;r[0]=4278190080>>>24+l<<l,a[0]=(o[0]&r[0])>>l,n=n?n<<s|a[0]:a[0],t+=1,i-=s}return n},Ls=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(e){var i;return(0,m.A)(this,n),(i=t.call(this)).observer=void 0,i.observer=e,i}return(0,v.A)(n,[{key:"resetInitSegment",value:function(e,t,i,a){(0,u.A)((0,c.A)(n.prototype),"resetInitSegment",this).call(this,e,t,i,a),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:a,inputTimeScale:9e4,dropped:0}}},{key:"canParse",value:function(e,t){return t+64<e.length}},{key:"appendFrame",value:function(e,t,n){var i=Is(e,t,n,this.basePTS,this.frameIndex);if(-1!==i)return{sample:e.samples[e.samples.length-1],length:i,missing:0}}}],[{key:"probe",value:function(e){if(!e)return!1;var t=Mi(e,0);if(!t)return!1;var n=t.length;return 11===e[n]&&119===e[n+1]&&void 0!==Ni(t)&&Rs(e,n)<16}}]),n}(as);function Is(e,t,n,i,a){if(n+8>t.length)return-1;if(11!==t[n]||119!==t[n+1])return-1;var r=t[n+4]>>6;if(r>=3)return-1;var o=[48e3,44100,32e3][r],s=63&t[n+4],l=2*[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][3*s+r];if(n+l>t.length)return-1;var u=t[n+6]>>5,c=0;2===u?c+=2:(1&u&&1!==u&&(c+=2),4&u&&(c+=2));var d=(t[n+6]<<8|t[n+7])>>12-c&1,h=[2,1,2,3,3,4,4,5][u]+d,f=t[n+5]>>3,v=7&t[n+5],m=new Uint8Array([r<<6|f<<1|v>>2,(3&v)<<6|u<<3|d<<2|s>>4,s<<4&224]),p=i+a*(1536/o*9e4),g=t.subarray(n,n+l);return e.config=m,e.channelCount=h,e.samplerate=o,e.samples.push({unit:g,pts:p}),l}var Ds=function(){function e(){(0,m.A)(this,e),this.VideoSample=null}return(0,v.A)(e,[{key:"createVideoSample",value:function(e,t,n,i){return{key:e,frame:!1,pts:t,dts:n,units:[],debug:i,length:0}}},{key:"getLastNalUnit",value:function(e){var t,n,i=this.VideoSample;if(i&&0!==i.units.length||(i=e[e.length-1]),null!=(t=i)&&t.units){var a=i.units;n=a[a.length-1]}return n}},{key:"pushAccessUnit",value:function(e,t){if(e.units.length&&e.frame){if(void 0===e.pts){var n=t.samples,i=n.length;if(!i)return void t.dropped++;var a=n[i-1];e.pts=a.pts,e.dts=a.dts}t.samples.push(e)}e.debug.length&&Xn.log(e.pts+"/"+e.dts+":"+e.debug)}}]),e}(),Cs=function(){function e(t){(0,m.A)(this,e),this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}return(0,v.A)(e,[{key:"loadWord",value:function(){var e=this.data,t=this.bytesAvailable,n=e.byteLength-t,i=new Uint8Array(4),a=Math.min(4,t);if(0===a)throw new Error("no bytes available");i.set(e.subarray(n,n+a)),this.word=new DataView(i.buffer).getUint32(0),this.bitsAvailable=8*a,this.bytesAvailable-=a}},{key:"skipBits",value:function(e){var t;e=Math.min(e,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,e-=(t=e>>3)<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}},{key:"readBits",value:function(e){var t=Math.min(this.bitsAvailable,e),n=this.word>>>32-t;if(e>32&&Xn.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else{if(!(this.bytesAvailable>0))throw new Error("no bits available");this.loadWord()}return(t=e-t)>0&&this.bitsAvailable?n<<t|this.readBits(t):n}},{key:"skipLZ",value:function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!==(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}},{key:"skipUEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"skipEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"readUEG",value:function(){var e=this.skipLZ();return this.readBits(e+1)-1}},{key:"readEG",value:function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}},{key:"readBoolean",value:function(){return 1===this.readBits(1)}},{key:"readUByte",value:function(){return this.readBits(8)}},{key:"readUShort",value:function(){return this.readBits(16)}},{key:"readUInt",value:function(){return this.readBits(32)}},{key:"skipScalingList",value:function(e){for(var t=8,n=8,i=0;i<e;i++)0!==n&&(n=(t+this.readEG()+256)%256),t=0===n?t:n}},{key:"readSPS",value:function(){var e,t,n,i=0,a=0,r=0,o=0,s=this.readUByte.bind(this),l=this.readBits.bind(this),u=this.readUEG.bind(this),c=this.readBoolean.bind(this),d=this.skipBits.bind(this),h=this.skipEG.bind(this),f=this.skipUEG.bind(this),v=this.skipScalingList.bind(this);s();var m=s();if(l(5),d(3),s(),f(),100===m||110===m||122===m||244===m||44===m||83===m||86===m||118===m||128===m){var p=u();if(3===p&&d(1),f(),f(),d(1),c())for(t=3!==p?8:12,n=0;n<t;n++)c()&&v(n<6?16:64)}f();var g=u();if(0===g)u();else if(1===g)for(d(1),h(),h(),e=u(),n=0;n<e;n++)h();f(),d(1);var y=u(),E=u(),A=l(1);0===A&&d(1),d(1),c()&&(i=u(),a=u(),r=u(),o=u());var b=[1,1];if(c()&&c())switch(s()){case 1:b=[1,1];break;case 2:b=[12,11];break;case 3:b=[10,11];break;case 4:b=[16,11];break;case 5:b=[40,33];break;case 6:b=[24,11];break;case 7:b=[20,11];break;case 8:b=[32,11];break;case 9:b=[80,33];break;case 10:b=[18,11];break;case 11:b=[15,11];break;case 12:b=[64,33];break;case 13:b=[160,99];break;case 14:b=[4,3];break;case 15:b=[3,2];break;case 16:b=[2,1];break;case 255:b=[s()<<8|s(),s()<<8|s()]}return{width:Math.ceil(16*(y+1)-2*i-2*a),height:(2-A)*(E+1)*16-(A?2:4)*(r+o),pixelRatio:b}}},{key:"readSliceType",value:function(){return this.readUByte(),this.readUEG(),this.readUEG()}}]),e}(),xs=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){return(0,m.A)(this,n),t.apply(this,arguments)}return(0,v.A)(n,[{key:"parseAVCPES",value:function(e,t,n,i,a){var r,o=this,s=this.parseAVCNALu(e,n.data),l=this.VideoSample,u=!1;n.data=null,l&&s.length&&!e.audFound&&(this.pushAccessUnit(l,e),l=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts,"")),s.forEach((function(i){var s;switch(i.type){case 1:var c=!1;r=!0;var d,h=i.data;if(u&&h.length>4){var f=new Cs(h).readSliceType();2!==f&&4!==f&&7!==f&&9!==f||(c=!0)}if(c)null!=(d=l)&&d.frame&&!l.key&&(o.pushAccessUnit(l,e),l=o.VideoSample=null);l||(l=o.VideoSample=o.createVideoSample(!0,n.pts,n.dts,"")),l.frame=!0,l.key=c;break;case 5:r=!0,null!=(s=l)&&s.frame&&!l.key&&(o.pushAccessUnit(l,e),l=o.VideoSample=null),l||(l=o.VideoSample=o.createVideoSample(!0,n.pts,n.dts,"")),l.key=!0,l.frame=!0;break;case 6:r=!0,ma(i.data,1,n.pts,t.samples);break;case 7:var v,m;r=!0,u=!0;var p=i.data,g=new Cs(p).readSPS();if(!e.sps||e.width!==g.width||e.height!==g.height||(null==(v=e.pixelRatio)?void 0:v[0])!==g.pixelRatio[0]||(null==(m=e.pixelRatio)?void 0:m[1])!==g.pixelRatio[1]){e.width=g.width,e.height=g.height,e.pixelRatio=g.pixelRatio,e.sps=[p],e.duration=a;for(var y=p.subarray(1,4),E="avc1.",A=0;A<3;A++){var b=y[A].toString(16);b.length<2&&(b="0"+b),E+=b}e.codec=E}break;case 8:r=!0,e.pps=[i.data];break;case 9:r=!0,e.audFound=!0,l&&o.pushAccessUnit(l,e),l=o.VideoSample=o.createVideoSample(!1,n.pts,n.dts,"");break;case 12:r=!0;break;default:r=!1,l&&(l.debug+="unknown NAL "+i.type+" ")}l&&r&&l.units.push(i)})),i&&l&&(this.pushAccessUnit(l,e),this.VideoSample=null)}},{key:"parseAVCNALu",value:function(e,t){var n,i,a=t.byteLength,r=e.naluState||0,o=r,s=[],l=0,u=-1,c=0;for(-1===r&&(u=0,c=31&t[0],r=0,l=1);l<a;)if(n=t[l++],r)if(1!==r)if(n)if(1===n){if(i=l-r-1,u>=0){var d={data:t.subarray(u,i),type:c};s.push(d)}else{var h=this.getLastNalUnit(e.samples);h&&(o&&l<=4-o&&h.state&&(h.data=h.data.subarray(0,h.data.byteLength-o)),i>0&&(h.data=ha(h.data,t.subarray(0,i)),h.state=0))}l<a?(u=l,c=31&t[l],r=0):r=-1}else r=0;else r=3;else r=n?0:2;else r=n?0:1;if(u>=0&&r>=0){var f={data:t.subarray(u,a),type:c,state:r};s.push(f)}if(0===s.length){var v=this.getLastNalUnit(e.samples);v&&(v.data=ha(v.data,t))}return e.naluState=r,s}}]),n}(Ds),Ms=function(){function e(t,n,i){(0,m.A)(this,e),this.keyData=void 0,this.decrypter=void 0,this.keyData=i,this.decrypter=new Go(n,{removePKCS7Padding:!1})}return(0,v.A)(e,[{key:"decryptBuffer",value:function(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)}},{key:"decryptAacSample",value:function(e,t,n){var i=this,a=e[t].unit;if(!(a.length<=16)){var r=a.subarray(16,a.length-a.length%16),o=r.buffer.slice(r.byteOffset,r.byteOffset+r.length);this.decryptBuffer(o).then((function(r){var o=new Uint8Array(r);a.set(o,16),i.decrypter.isSync()||i.decryptAacSamples(e,t+1,n)}))}}},{key:"decryptAacSamples",value:function(e,t,n){for(;;t++){if(t>=e.length)return void n();if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,n),!this.decrypter.isSync()))return}}},{key:"getAvcEncryptedData",value:function(e){for(var t=16*Math.floor((e.length-48)/160)+16,n=new Int8Array(t),i=0,a=32;a<e.length-16;a+=160,i+=16)n.set(e.subarray(a,a+16),i);return n}},{key:"getAvcDecryptedUnit",value:function(e,t){for(var n=new Uint8Array(t),i=0,a=32;a<e.length-16;a+=160,i+=16)e.set(n.subarray(i,i+16),a);return e}},{key:"decryptAvcSample",value:function(e,t,n,i,a){var r=this,o=pa(a.data),s=this.getAvcEncryptedData(o);this.decryptBuffer(s.buffer).then((function(s){a.data=r.getAvcDecryptedUnit(o,s),r.decrypter.isSync()||r.decryptAvcSamples(e,t,n+1,i)}))}},{key:"decryptAvcSamples",value:function(e,t,n,i){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,n=0){if(t>=e.length)return void i();for(var a=e[t].units;!(n>=a.length);n++){var r=a[n];if(!(r.data.length<=48||1!==r.type&&5!==r.type)&&(this.decryptAvcSample(e,t,n,i,r),!this.decrypter.isSync()))return}}}}]),e}(),Os=188,Ps=function(){function e(t,n,i){(0,m.A)(this,e),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=t,this.config=n,this.typeSupported=i,this.videoParser=new xs}return(0,v.A)(e,[{key:"resetInitSegment",value:function(t,n,i,a){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=e.createTrack("video"),this._audioTrack=e.createTrack("audio",a),this._id3Track=e.createTrack("id3"),this._txtTrack=e.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=n,this.videoCodec=i,this._duration=a}},{key:"resetTimeStamp",value:function(){}},{key:"resetContiguity",value:function(){var e=this._audioTrack,t=this._videoTrack,n=this._id3Track;e&&(e.pesData=null),t&&(t.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.remainderData=null}},{key:"demux",value:function(t,n){var i,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];a||(this.sampleAes=null);var o=this._videoTrack,s=this._audioTrack,l=this._id3Track,u=this._txtTrack,c=o.pid,d=o.pesData,h=s.pid,f=l.pid,v=s.pesData,m=l.pesData,p=null,g=this.pmtParsed,y=this._pmtId,E=t.length;if(this.remainderData&&(E=(t=ha(this.remainderData,t)).length,this.remainderData=null),E<Os&&!r)return this.remainderData=t,{audioTrack:s,videoTrack:o,id3Track:l,textTrack:u};var A=Math.max(0,e.syncOffset(t));(E-=(E-A)%Os)<t.byteLength&&!r&&(this.remainderData=new Uint8Array(t.buffer,E,t.buffer.byteLength-E));for(var b=0,k=A;k<E;k+=Os)if(71===t[k]){var T=!!(64&t[k+1]),_=Ns(t,k),S=(48&t[k+3])>>4,w=void 0;if(S>1){if((w=k+5+t[k+4])===k+Os)continue}else w=k+4;switch(_){case c:T&&(d&&(i=Gs(d))&&this.videoParser.parseAVCPES(o,u,i,!1,this._duration),d={data:[],size:0}),d&&(d.data.push(t.subarray(w,k+Os)),d.size+=k+Os-w);break;case h:if(T){if(v&&(i=Gs(v)))switch(s.segmentCodec){case"aac":this.parseAACPES(s,i);break;case"mp3":this.parseMPEGPES(s,i);break;case"ac3":this.parseAC3PES(s,i)}v={data:[],size:0}}v&&(v.data.push(t.subarray(w,k+Os)),v.size+=k+Os-w);break;case f:T&&(m&&(i=Gs(m))&&this.parseID3PES(l,i),m={data:[],size:0}),m&&(m.data.push(t.subarray(w,k+Os)),m.size+=k+Os-w);break;case 0:T&&(w+=t[w]+1),y=this._pmtId=Us(t,w);break;case y:T&&(w+=t[w]+1);var R=Fs(t,w,this.typeSupported,a,this.observer);(c=R.videoPid)>0&&(o.pid=c,o.segmentCodec=R.segmentVideoCodec),(h=R.audioPid)>0&&(s.pid=h,s.segmentCodec=R.segmentAudioCodec),(f=R.id3Pid)>0&&(l.pid=f),null===p||g||(Xn.warn("MPEG-TS PMT found at ".concat(k," after unknown PID '").concat(p,"'. Backtracking to sync byte @").concat(A," to parse all TS packets.")),p=null,k=A-188),g=this.pmtParsed=!0;break;case 17:case 8191:break;default:p=_}}else b++;b>0&&Bs(this.observer,new Error("Found ".concat(b," TS packet/s that do not start with 0x47"))),o.pesData=d,s.pesData=v,l.pesData=m;var L={audioTrack:s,videoTrack:o,id3Track:l,textTrack:u};return r&&this.extractRemainingSamples(L),L}},{key:"flush",value:function(){var e,t=this.remainderData;return this.remainderData=null,e=t?this.demux(t,-1,!1,!0):{videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(e),this.sampleAes?this.decrypt(e,this.sampleAes):e}},{key:"extractRemainingSamples",value:function(e){var t,n=e.audioTrack,i=e.videoTrack,a=e.id3Track,r=e.textTrack,o=i.pesData,s=n.pesData,l=a.pesData;if(o&&(t=Gs(o))?(this.videoParser.parseAVCPES(i,r,t,!0,this._duration),i.pesData=null):i.pesData=o,s&&(t=Gs(s))){switch(n.segmentCodec){case"aac":this.parseAACPES(n,t);break;case"mp3":this.parseMPEGPES(n,t);break;case"ac3":this.parseAC3PES(n,t)}n.pesData=null}else null!=s&&s.size&&Xn.log("last AAC PES packet truncated,might overlap between fragments"),n.pesData=s;l&&(t=Gs(l))?(this.parseID3PES(a,t),a.pesData=null):a.pesData=l}},{key:"demuxSampleAes",value:function(e,t,n){var i=this.demux(e,n,!0,!this.config.progressive),a=this.sampleAes=new Ms(this.observer,this.config,t);return this.decrypt(i,a)}},{key:"decrypt",value:function(e,t){return new Promise((function(n){var i=e.audioTrack,a=e.videoTrack;i.samples&&"aac"===i.segmentCodec?t.decryptAacSamples(i.samples,0,(function(){a.samples?t.decryptAvcSamples(a.samples,0,0,(function(){n(e)})):n(e)})):a.samples&&t.decryptAvcSamples(a.samples,0,0,(function(){n(e)}))}))}},{key:"destroy",value:function(){this._duration=0}},{key:"parseAACPES",value:function(e,t){var n,i,a,r=0,o=this.aacOverFlow,s=t.data;if(o){this.aacOverFlow=null;var l=o.missing,u=o.sample.unit.byteLength;if(-1===l)s=ha(o.sample.unit,s);else{var c=u-l;o.sample.unit.set(s.subarray(0,l),c),e.samples.push(o.sample),r=o.missing}}for(n=r,i=s.length;n<i-1&&!us(s,n);n++);if(n!==r){var d,h=n<i-1;if(d=h?"AAC PES did not start with ADTS header,offset:".concat(n):"No ADTS header found in AAC PES",Bs(this.observer,new Error(d),h),!h)return}if(ds(e,this.observer,s,n,this.audioCodec),void 0!==t.pts)a=t.pts;else{if(!o)return void Xn.warn("[tsdemuxer]: AAC PES unknown PTS");var f=hs(e.samplerate);a=o.sample.pts+f}for(var v,m=0;n<i;){if(n+=(v=fs(e,s,n,a,m)).length,v.missing){this.aacOverFlow=v;break}for(m++;n<i-1&&!us(s,n);n++);}}},{key:"parseMPEGPES",value:function(e,t){var n=t.data,i=n.length,a=0,r=0,o=t.pts;if(void 0!==o)for(;r<i;)if(ks(n,r)){var s=Es(e,n,r,o,a);if(!s)break;r+=s.length,a++}else r++;else Xn.warn("[tsdemuxer]: MPEG PES unknown PTS")}},{key:"parseAC3PES",value:function(e,t){var n=t.data,i=t.pts;if(void 0!==i)for(var a,r=n.length,o=0,s=0;s<r&&(a=Is(e,n,s,i,o++))>0;)s+=a;else Xn.warn("[tsdemuxer]: AC3 PES unknown PTS")}},{key:"parseID3PES",value:function(e,t){if(void 0!==t.pts){var n=Un({},t,{type:this._videoTrack?mr:fr,duration:Number.POSITIVE_INFINITY});e.samples.push(n)}else Xn.warn("[tsdemuxer]: ID3 PES unknown PTS")}}],[{key:"probe",value:function(t){var n=e.syncOffset(t);return n>0&&Xn.warn("MPEG2-TS detected but first sync word found @ offset ".concat(n)),-1!==n}},{key:"syncOffset",value:function(e){for(var t=e.length,n=Math.min(940,t-Os)+1,i=0;i<n;){for(var a=!1,r=-1,o=0,s=i;s<t;s+=Os){if(71!==e[s]||t-s!==Os&&71!==e[s+Os]){if(o)return-1;break}if(o++,-1===r&&0!==(r=s)&&(n=Math.min(r+18612,e.length-Os)+1),a||(a=0===Ns(e,s)),a&&o>1&&(0===r&&o>2||s+Os>n))return r}i++}return-1}},{key:"createTrack",value:function(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:Qi[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===e?t:void 0}}}]),e}();function Ns(e,t){return((31&e[t+1])<<8)+e[t+2]}function Us(e,t){return(31&e[t+10])<<8|e[t+11]}function Fs(e,t,n,i,a){var r={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},o=t+3+((15&e[t+1])<<8|e[t+2])-4;for(t+=12+((15&e[t+10])<<8|e[t+11]);t<o;){var s=Ns(e,t),l=(15&e[t+3])<<8|e[t+4];switch(e[t]){case 207:if(!i){Hs("ADTS AAC");break}case 15:-1===r.audioPid&&(r.audioPid=s);break;case 21:-1===r.id3Pid&&(r.id3Pid=s);break;case 219:if(!i){Hs("H.264");break}case 27:-1===r.videoPid&&(r.videoPid=s,r.segmentVideoCodec="avc");break;case 3:case 4:n.mpeg||n.mp3?-1===r.audioPid&&(r.audioPid=s,r.segmentAudioCodec="mp3"):Xn.log("MPEG audio found, not supported in this browser");break;case 193:if(!i){Hs("AC-3");break}case 129:n.ac3?-1===r.audioPid&&(r.audioPid=s,r.segmentAudioCodec="ac3"):Xn.log("AC-3 audio found, not supported in this browser");break;case 6:if(-1===r.audioPid&&l>0)for(var u=t+5,c=l;c>2;){if(106===e[u])!0!==n.ac3?Xn.log("AC-3 audio found, not supported in this browser for now"):(r.audioPid=s,r.segmentAudioCodec="ac3");var d=e[u+1]+2;u+=d,c-=d}break;case 194:case 135:return Bs(a,new Error("Unsupported EC-3 in M2TS found")),r;case 36:return Bs(a,new Error("Unsupported HEVC in M2TS found")),r}t+=l+5}return r}function Bs(e,t,n){Xn.warn("parsing error: ".concat(t.message)),e.emit(Gn.ERROR,Gn.ERROR,{type:Kn.MEDIA_ERROR,details:Wn.FRAG_PARSING_ERROR,fatal:!1,levelRetry:n,error:t,reason:t.message})}function Hs(e){Xn.log("".concat(e," with AES-128-CBC encryption found in unencrypted stream"))}function Gs(e){var t,n,i,a,r,o=0,s=e.data;if(!e||0===e.size)return null;for(;s[0].length<19&&s.length>1;)s[0]=ha(s[0],s[1]),s.splice(1,1);if(1===((t=s[0])[0]<<16)+(t[1]<<8)+t[2]){if((n=(t[4]<<8)+t[5])&&n>e.size-6)return null;var l=t[7];192&l&&(a=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,64&l?a-(r=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2)>54e5&&(Xn.warn("".concat(Math.round((a-r)/9e4),"s delta between PTS and DTS, align them")),a=r):r=a);var u=(i=t[8])+9;if(e.size<=u)return null;e.size-=u;for(var c=new Uint8Array(e.size),d=0,h=s.length;d<h;d++){var f=(t=s[d]).byteLength;if(u){if(u>f){u-=f;continue}t=t.subarray(u),f-=u,u=0}c.set(t,o),o+=f}return n&&(n-=i+3),{data:c,pts:a,dts:r,len:n}}return null}var Ks=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){return(0,m.A)(this,n),t.apply(this,arguments)}return(0,v.A)(n,[{key:"resetInitSegment",value:function(e,t,i,a){(0,u.A)((0,c.A)(n.prototype),"resetInitSegment",this).call(this,e,t,i,a),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:a,inputTimeScale:9e4,dropped:0}}},{key:"canParse",value:function(e,t){return function(e,t){return bs(e,t)&&4<=e.length-t}(e,t)}},{key:"appendFrame",value:function(e,t,n){if(null!==this.basePTS)return Es(e,t,n,this.basePTS,this.frameIndex)}}],[{key:"probe",value:function(e){if(!e)return!1;var t=Mi(e,0),n=(null==t?void 0:t.length)||0;if(t&&11===e[n]&&119===e[n+1]&&void 0!==Ni(t)&&Rs(e,n)<=16)return!1;for(var i=e.length;n<i;n++)if(Ts(e,n))return Xn.log("MPEG Audio sync word found !"),!0;return!1}}]),n}(as),Ws=function(){function e(){(0,m.A)(this,e)}return(0,v.A)(e,null,[{key:"getSilentFrame",value:function(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}}}]),e}(),Vs=Math.pow(2,32)-1,qs=function(){function e(){(0,m.A)(this,e)}return(0,v.A)(e,null,[{key:"init",value:function(){var t;for(t in e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var n=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:n,audio:i};var a=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),r=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=r,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var o=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,o,l,o,s),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,a))}},{key:"box",value:function(e){for(var t=8,n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];for(var r=i.length,o=r;r--;)t+=i[r].byteLength;var s=new Uint8Array(t);for(s[0]=t>>24&255,s[1]=t>>16&255,s[2]=t>>8&255,s[3]=255&t,s.set(e,4),r=0,t=8;r<o;r++)s.set(i[r],t),t+=i[r].byteLength;return s}},{key:"hdlr",value:function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])}},{key:"mdat",value:function(t){return e.box(e.types.mdat,t)}},{key:"mdhd",value:function(t,n){n*=t;var i=Math.floor(n/(Vs+1)),a=Math.floor(n%(Vs+1));return e.box(e.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,i>>24,i>>16&255,i>>8&255,255&i,a>>24,a>>16&255,a>>8&255,255&a,85,196,0,0]))}},{key:"mdia",value:function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))}},{key:"mfhd",value:function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}},{key:"minf",value:function(t){return"audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))}},{key:"moof",value:function(t,n,i){return e.box(e.types.moof,e.mfhd(t),e.traf(i,n))}},{key:"moov",value:function(t){for(var n=t.length,i=[];n--;)i[n]=e.trak(t[n]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(i).concat(e.mvex(t)))}},{key:"mvex",value:function(t){for(var n=t.length,i=[];n--;)i[n]=e.trex(t[n]);return e.box.apply(null,[e.types.mvex].concat(i))}},{key:"mvhd",value:function(t,n){n*=t;var i=Math.floor(n/(Vs+1)),a=Math.floor(n%(Vs+1)),r=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,i>>24,i>>16&255,i>>8&255,255&i,a>>24,a>>16&255,a>>8&255,255&a,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,r)}},{key:"sdtp",value:function(t){var n,i,a=t.samples||[],r=new Uint8Array(4+a.length);for(n=0;n<a.length;n++)i=a[n].flags,r[n+4]=i.dependsOn<<4|i.isDependedOn<<2|i.hasRedundancy;return e.box(e.types.sdtp,r)}},{key:"stbl",value:function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))}},{key:"avc1",value:function(t){var n,i,a,r=[],o=[];for(n=0;n<t.sps.length;n++)a=(i=t.sps[n]).byteLength,r.push(a>>>8&255),r.push(255&a),r=r.concat(Array.prototype.slice.call(i));for(n=0;n<t.pps.length;n++)a=(i=t.pps[n]).byteLength,o.push(a>>>8&255),o.push(255&a),o=o.concat(Array.prototype.slice.call(i));var s=e.box(e.types.avcC,new Uint8Array([1,r[3],r[4],r[5],255,224|t.sps.length].concat(r).concat([t.pps.length]).concat(o))),l=t.width,u=t.height,c=t.pixelRatio[0],d=t.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,u>>8&255,255&u,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,255&c,d>>24,d>>16&255,d>>8&255,255&d])))}},{key:"esds",value:function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}},{key:"audioStsd",value:function(e){var t=e.samplerate;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,255&t,0,0])}},{key:"mp4a",value:function(t){return e.box(e.types.mp4a,e.audioStsd(t),e.box(e.types.esds,e.esds(t)))}},{key:"mp3",value:function(t){return e.box(e.types[".mp3"],e.audioStsd(t))}},{key:"ac3",value:function(t){return e.box(e.types["ac-3"],e.audioStsd(t),e.box(e.types.dac3,t.config))}},{key:"stsd",value:function(t){return"audio"===t.type?"mp3"===t.segmentCodec&&"mp3"===t.codec?e.box(e.types.stsd,e.STSD,e.mp3(t)):"ac3"===t.segmentCodec?e.box(e.types.stsd,e.STSD,e.ac3(t)):e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))}},{key:"tkhd",value:function(t){var n=t.id,i=t.duration*t.timescale,a=t.width,r=t.height,o=Math.floor(i/(Vs+1)),s=Math.floor(i%(Vs+1));return e.box(e.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,n>>24&255,n>>16&255,n>>8&255,255&n,0,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,s>>24,s>>16&255,s>>8&255,255&s,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,a>>8&255,255&a,0,0,r>>8&255,255&r,0,0]))}},{key:"traf",value:function(t,n){var i=e.sdtp(t),a=t.id,r=Math.floor(n/(Vs+1)),o=Math.floor(n%(Vs+1));return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,a>>24,a>>16&255,a>>8&255,255&a])),e.box(e.types.tfdt,new Uint8Array([1,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,o>>24,o>>16&255,o>>8&255,255&o])),e.trun(t,i.length+16+20+8+16+8+8),i)}},{key:"trak",value:function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))}},{key:"trex",value:function(t){var n=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}},{key:"trun",value:function(t,n){var i,a,r,o,s,l,u=t.samples||[],c=u.length,d=12+16*c,h=new Uint8Array(d);for(n+=8+d,h.set(["video"===t.type?1:0,0,15,1,c>>>24&255,c>>>16&255,c>>>8&255,255&c,n>>>24&255,n>>>16&255,n>>>8&255,255&n],0),i=0;i<c;i++)r=(a=u[i]).duration,o=a.size,s=a.flags,l=a.cts,h.set([r>>>24&255,r>>>16&255,r>>>8&255,255&r,o>>>24&255,o>>>16&255,o>>>8&255,255&o,s.isLeading<<2|s.dependsOn,s.isDependedOn<<6|s.hasRedundancy<<4|s.paddingValue<<1|s.isNonSync,61440&s.degradPrio,15&s.degradPrio,l>>>24&255,l>>>16&255,l>>>8&255,255&l],12+16*i);return e.box(e.types.trun,h)}},{key:"initSegment",value:function(t){e.types||e.init();var n=e.moov(t);return ha(e.FTYP,n)}}]),e}();qs.types=void 0,qs.HDLR_TYPES=void 0,qs.STTS=void 0,qs.STSC=void 0,qs.STCO=void 0,qs.STSZ=void 0,qs.VMHD=void 0,qs.SMHD=void 0,qs.STSD=void 0,qs.FTYP=void 0,qs.DINF=void 0;var Ys=9e4;function js(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e*t*n;return i?Math.round(a):a}function zs(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return js(e,1e3,11111111111111112e-21,t)}var Xs=null,Qs=null,Zs=function(){function e(t,n,i){if((0,m.A)(this,e),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=t,this.config=n,this.typeSupported=i,this.ISGenerated=!1,null===Xs){var a=navigator.userAgent||"",r=a.match(/Chrome\/(\d+)/i);Xs=r?parseInt(r[1]):0}if(null===Qs){var o=navigator.userAgent.match(/Safari\/(\d+)/i);Qs=o?parseInt(o[1]):0}}return(0,v.A)(e,[{key:"destroy",value:function(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}},{key:"resetTimeStamp",value:function(e){Xn.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}},{key:"resetNextTimestamp",value:function(){Xn.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}},{key:"resetInitSegment",value:function(){Xn.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}},{key:"getVideoStartPts",value:function(e){var t=!1,n=e[0].pts,i=e.reduce((function(e,i){var a=i.pts,r=a-e;return r<-4294967296&&(t=!0,r=(a=Js(a,n))-e),r>0?e:a}),n);return t&&Xn.debug("PTS rollover detected"),i}},{key:"remux",value:function(e,t,n,i,a,r,o,s){var l,u,c,d,h,f,v=a,m=a,p=e.pid>-1,g=t.pid>-1,y=t.samples.length,E=e.samples.length>0,A=o&&y>0||y>1;if((!p||E)&&(!g||A)||this.ISGenerated||o){if(this.ISGenerated){var b,k,T,_,S=this.videoTrackConfig;!S||t.width===S.width&&t.height===S.height&&(null==(b=t.pixelRatio)?void 0:b[0])===(null==(k=S.pixelRatio)?void 0:k[0])&&(null==(T=t.pixelRatio)?void 0:T[1])===(null==(_=S.pixelRatio)?void 0:_[1])||this.resetInitSegment()}else c=this.generateIS(e,t,a,r);var w,R=this.isVideoContiguous,L=-1;if(A&&(L=function(e){for(var t=0;t<e.length;t++)if(e[t].key)return t;return-1}(t.samples),!R&&this.config.forceKeyFrameOnDiscontinuity))if(f=!0,L>0){Xn.warn("[mp4-remuxer]: Dropped ".concat(L," out of ").concat(y," video samples due to a missing keyframe"));var I=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(L),t.dropped+=L,w=m+=(t.samples[0].pts-I)/t.inputTimeScale}else-1===L&&(Xn.warn("[mp4-remuxer]: No keyframe found out of ".concat(y," video samples")),f=!1);if(this.ISGenerated){if(E&&A){var D=this.getVideoStartPts(t.samples),C=(Js(e.samples[0].pts,D)-D)/t.inputTimeScale;v+=Math.max(0,C),m+=Math.max(0,-C)}if(E){if(e.samplerate||(Xn.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),c=this.generateIS(e,t,a,r)),u=this.remuxAudio(e,v,this.isAudioContiguous,r,g||A||s===ir?m:void 0),A){var x=u?u.endPTS-u.startPTS:0;t.inputTimeScale||(Xn.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),c=this.generateIS(e,t,a,r)),l=this.remuxVideo(t,m,R,x)}}else A&&(l=this.remuxVideo(t,m,R,0));l&&(l.firstKeyFrame=L,l.independent=-1!==L,l.firstKeyFramePTS=w)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(n.samples.length&&(h=$s(n,a,this._initPTS,this._initDTS)),i.samples.length&&(d=el(i,a,this._initPTS))),{audio:u,video:l,initSegment:c,independent:f,text:d,id3:h}}},{key:"generateIS",value:function(e,t,n,i){var a,r,o,s=e.samples,l=t.samples,u=this.typeSupported,c={},d=this._initPTS,h=!d||i,f="audio/mp4";if(h&&(a=r=1/0),e.config&&s.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":u.mpeg?(f="audio/mpeg",e.codec=""):u.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3"}c.audio={id:"audio",container:f,codec:e.codec,initSegment:"mp3"===e.segmentCodec&&u.mpeg?new Uint8Array(0):qs.initSegment([e]),metadata:{channelCount:e.channelCount}},h&&(o=e.inputTimeScale,d&&o===d.timescale?h=!1:a=r=s[0].pts-Math.round(o*n))}if(t.sps&&t.pps&&l.length){if(t.timescale=t.inputTimeScale,c.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:qs.initSegment([t]),metadata:{width:t.width,height:t.height}},h)if(o=t.inputTimeScale,d&&o===d.timescale)h=!1;else{var v=this.getVideoStartPts(l),m=Math.round(o*n);r=Math.min(r,Js(l[0].dts,v)-m),a=Math.min(a,v-m)}this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(c).length)return this.ISGenerated=!0,h?(this._initPTS={baseTime:a,timescale:o},this._initDTS={baseTime:r,timescale:o}):a=o=void 0,{tracks:c,initPTS:a,timescale:o}}},{key:"remuxVideo",value:function(e,t,n,i){var a,r,o=e.inputTimeScale,s=e.samples,l=[],u=s.length,c=this._initPTS,d=this.nextAvcDts,h=8,f=this.videoSampleDuration,v=Number.POSITIVE_INFINITY,m=Number.NEGATIVE_INFINITY,p=!1;if(!n||null===d){var g=t*o,y=s[0].pts-Js(s[0].dts,s[0].pts);Xs&&null!==d&&Math.abs(g-y-d)<15e3?n=!0:d=g-y}for(var E=c.baseTime*o/c.timescale,A=0;A<u;A++){var b=s[A];b.pts=Js(b.pts-E,d),b.dts=Js(b.dts-E,d),b.dts<s[A>0?A-1:A].dts&&(p=!0)}p&&s.sort((function(e,t){var n=e.dts-t.dts,i=e.pts-t.pts;return n||i})),a=s[0].dts;var k=(r=s[s.length-1].dts)-a,T=k?Math.round(k/(u-1)):f||e.inputTimeScale/30;if(n){var _=a-d,S=_>T,w=_<-1;if((S||w)&&(S?Xn.warn("AVC: ".concat(zs(_,!0)," ms (").concat(_,"dts) hole between fragments detected at ").concat(t.toFixed(3))):Xn.warn("AVC: ".concat(zs(-_,!0)," ms (").concat(_,"dts) overlapping between fragments detected at ").concat(t.toFixed(3))),!w||d>=s[0].pts||Xs)){a=d;var R=s[0].pts-_;if(S)s[0].dts=a,s[0].pts=R;else for(var L=0;L<s.length&&!(s[L].dts>R);L++)s[L].dts-=_,s[L].pts-=_;Xn.log("Video: Initial PTS/DTS adjusted: ".concat(zs(R,!0),"/").concat(zs(a,!0),", delta: ").concat(zs(_,!0)," ms"))}}for(var I=0,D=0,C=a=Math.max(0,a),x=0;x<u;x++){for(var M=s[x],O=M.units,P=O.length,N=0,U=0;U<P;U++)N+=O[U].data.length;D+=N,I+=P,M.length=N,M.dts<C?(M.dts=C,C+=T/4|0||1):C=M.dts,v=Math.min(M.pts,v),m=Math.max(M.pts,m)}r=s[u-1].dts;var F,B=D+4*I+8;try{F=new Uint8Array(B)}catch(me){return void this.observer.emit(Gn.ERROR,Gn.ERROR,{type:Kn.MUX_ERROR,details:Wn.REMUX_ALLOC_ERROR,fatal:!1,error:me,bytes:B,reason:"fail allocating video mdat ".concat(B)})}var H=new DataView(F.buffer);H.setUint32(0,B),F.set(qs.types.mdat,4);for(var G=!1,K=Number.POSITIVE_INFINITY,W=Number.POSITIVE_INFINITY,V=Number.NEGATIVE_INFINITY,q=Number.NEGATIVE_INFINITY,Y=0;Y<u;Y++){for(var j=s[Y],z=j.units,X=0,Q=0,Z=z.length;Q<Z;Q++){var J=z[Q],$=J.data,ee=J.data.byteLength;H.setUint32(h,ee),h+=4,F.set($,h),h+=ee,X+=4+ee}var te=void 0;if(Y<u-1)f=s[Y+1].dts-j.dts,te=s[Y+1].pts-j.pts;else{var ne=this.config,ie=Y>0?j.dts-s[Y-1].dts:T;if(te=Y>0?j.pts-s[Y-1].pts:T,ne.stretchShortVideoTrack&&null!==this.nextAudioPts){var ae=Math.floor(ne.maxBufferHole*o),re=(i?v+i*o:this.nextAudioPts)-j.pts;re>ae?((f=re-ie)<0?f=ie:G=!0,Xn.log("[mp4-remuxer]: It is approximately ".concat(re/90," ms to the next segment; using duration ").concat(f/90," ms for the last video frame."))):f=ie}else f=ie}var oe=Math.round(j.pts-j.dts);K=Math.min(K,f),V=Math.max(V,f),W=Math.min(W,te),q=Math.max(q,te),l.push(new nl(j.key,f,X,oe))}if(l.length)if(Xs){if(Xs<70){var se=l[0].flags;se.dependsOn=2,se.isNonSync=0}}else if(Qs&&q-W<V-K&&T/V<.025&&0===l[0].cts){Xn.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");for(var le=a,ue=0,ce=l.length;ue<ce;ue++){var de=le+l[ue].duration,he=le+l[ue].cts;if(ue<ce-1){var fe=de+l[ue+1].cts;l[ue].duration=fe-he}else l[ue].duration=ue?l[ue-1].duration:T;l[ue].cts=0,le=de}}f=G||!f?T:f,this.nextAvcDts=d=r+f,this.videoSampleDuration=f,this.isVideoContiguous=!0;var ve={data1:qs.moof(e.sequenceNumber++,a,Un({},e,{samples:l})),data2:F,startPTS:v/o,endPTS:(m+f)/o,startDTS:a/o,endDTS:d/o,type:"video",hasAudio:!1,hasVideo:!0,nb:l.length,dropped:e.dropped};return e.samples=[],e.dropped=0,ve}},{key:"getSamplesPerFrame",value:function(e){switch(e.segmentCodec){case"mp3":return 1152;case"ac3":return 1536;default:return 1024}}},{key:"remuxAudio",value:function(e,t,n,i,a){var r=e.inputTimeScale,o=r/(e.samplerate?e.samplerate:r),s=this.getSamplesPerFrame(e),l=s*o,u=this._initPTS,c="mp3"===e.segmentCodec&&this.typeSupported.mpeg,d=[],h=void 0!==a,f=e.samples,v=c?0:8,m=this.nextAudioPts||-1,p=t*r,g=u.baseTime*r/u.timescale;if(this.isAudioContiguous=n=n||f.length&&m>0&&(i&&Math.abs(p-m)<9e3||Math.abs(Js(f[0].pts-g,p)-m)<20*l),f.forEach((function(e){e.pts=Js(e.pts-g,p)})),!n||m<0){if(f=f.filter((function(e){return e.pts>=0})),!f.length)return;m=0===a?0:i&&!h?Math.max(0,p):f[0].pts}if("aac"===e.segmentCodec)for(var y=this.config.maxAudioFramesDrift,E=0,A=m;E<f.length;E++){var b=f[E],k=b.pts,T=k-A,_=Math.abs(1e3*T/r);if(T<=-y*l&&h)0===E&&(Xn.warn("Audio frame @ ".concat((k/r).toFixed(3),"s overlaps nextAudioPts by ").concat(Math.round(1e3*T/r)," ms.")),this.nextAudioPts=m=A=k);else if(T>=y*l&&_<1e4&&h){var S=Math.round(T/l);(A=k-S*l)<0&&(S--,A+=l),0===E&&(this.nextAudioPts=m=A),Xn.warn("[mp4-remuxer]: Injecting ".concat(S," audio frame @ ").concat((A/r).toFixed(3),"s due to ").concat(Math.round(1e3*T/r)," ms gap."));for(var w=0;w<S;w++){var R=Math.max(A,0),L=Ws.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);L||(Xn.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),L=b.unit.subarray()),f.splice(E,0,{unit:L,pts:R}),A+=l,E++}}b.pts=A,A+=l}for(var I,D=null,C=null,x=0,M=f.length;M--;)x+=f[M].unit.byteLength;for(var O=0,P=f.length;O<P;O++){var N=f[O],U=N.unit,F=N.pts;if(null!==C){d[O-1].duration=Math.round((F-C)/o)}else{if(n&&"aac"===e.segmentCodec&&(F=m),D=F,!(x>0))return;x+=v;try{I=new Uint8Array(x)}catch(Y){return void this.observer.emit(Gn.ERROR,Gn.ERROR,{type:Kn.MUX_ERROR,details:Wn.REMUX_ALLOC_ERROR,fatal:!1,error:Y,bytes:x,reason:"fail allocating audio mdat ".concat(x)})}c||(new DataView(I.buffer).setUint32(0,x),I.set(qs.types.mdat,4))}I.set(U,v);var B=U.byteLength;v+=B,d.push(new nl(!0,s,B,0)),C=F}var H=d.length;if(H){var G=d[d.length-1];this.nextAudioPts=m=C+o*G.duration;var K=c?new Uint8Array(0):qs.moof(e.sequenceNumber++,D/o,Un({},e,{samples:d}));e.samples=[];var W=D/r,V=m/r,q={data1:K,data2:I,startPTS:W,endPTS:V,startDTS:W,endDTS:V,type:"audio",hasAudio:!0,hasVideo:!1,nb:H};return this.isAudioContiguous=!0,q}}},{key:"remuxEmptyAudio",value:function(e,t,n,i){var a=e.inputTimeScale,r=a/(e.samplerate?e.samplerate:a),o=this.nextAudioPts,s=this._initDTS,l=9e4*s.baseTime/s.timescale,u=(null!==o?o:i.startDTS*a)+l,c=i.endDTS*a+l,d=1024*r,h=Math.ceil((c-u)/d),f=Ws.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(Xn.warn("[mp4-remuxer]: remux empty Audio"),f){for(var v=[],m=0;m<h;m++){var p=u+m*d;v.push({unit:f,pts:p,dts:p})}return e.samples=v,this.remuxAudio(e,t,n,!1)}Xn.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec")}}]),e}();function Js(e,t){var n;if(null===t)return e;for(n=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=n;return e}function $s(e,t,n,i){var a=e.samples.length;if(a){for(var r=e.inputTimeScale,o=0;o<a;o++){var s=e.samples[o];s.pts=Js(s.pts-n.baseTime*r/n.timescale,t*r)/r,s.dts=Js(s.dts-i.baseTime*r/i.timescale,t*r)/r}var l=e.samples;return e.samples=[],{samples:l}}}function el(e,t,n){var i=e.samples.length;if(i){for(var a=e.inputTimeScale,r=0;r<i;r++){var o=e.samples[r];o.pts=Js(o.pts-n.baseTime*a/n.timescale,t*a)/a}e.samples.sort((function(e,t){return e.pts-t.pts}));var s=e.samples;return e.samples=[],{samples:s}}}var tl,nl=(0,v.A)((function e(t,n,i,a){(0,m.A)(this,e),this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=n,this.size=i,this.cts=a,this.flags={isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:t?2:1,isNonSync:t?0:1}})),il=function(){function e(){(0,m.A)(this,e),this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}return(0,v.A)(e,[{key:"destroy",value:function(){}},{key:"resetTimeStamp",value:function(e){this.initPTS=e,this.lastEndTime=null}},{key:"resetNextTimestamp",value:function(){this.lastEndTime=null}},{key:"resetInitSegment",value:function(e,t,n,i){this.audioCodec=t,this.videoCodec=n,this.generateInitSegment(function(e,t){if(!e||!t)return e;var n=t.keyId;return n&&t.isCommonEncryption&&ia(e,["moov","trak"]).forEach((function(e){var t=ia(e,["mdia","minf","stbl","stsd"])[0].subarray(8),i=ia(t,["enca"]),a=i.length>0;a||(i=ia(t,["encv"])),i.forEach((function(e){ia(a?e.subarray(28):e.subarray(78),["sinf"]).forEach((function(e){var t=ca(e);if(t){var i=t.subarray(8,24);i.some((function(e){return 0!==e}))||(Xn.log("[eme] Patching keyId in 'enc".concat(a?"a":"v",">sinf>>tenc' box: ").concat(ji(i)," -> ").concat(ji(n))),t.set(n,8))}}))}))})),e}(e,i)),this.emitInitSegment=!0}},{key:"generateInitSegment",value:function(e){var t=this.audioCodec,n=this.videoCodec;if(null==e||!e.byteLength)return this.initTracks=void 0,void(this.initData=void 0);var i=this.initData=ra(e);i.audio&&(t=al(i.audio,ni)),i.video&&(n=al(i.video,ii));var a={};i.audio&&i.video?a.audiovideo={container:"video/mp4",codec:t+","+n,initSegment:e,id:"main"}:i.audio?a.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:i.video?a.video={container:"video/mp4",codec:n,initSegment:e,id:"main"}:Xn.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=a}},{key:"remux",value:function(e,t,n,i,a,r){var o,s,l=this.initPTS,u=this.lastEndTime,c={audio:void 0,video:void 0,text:i,id3:n,initSegment:void 0};Fn(u)||(u=this.lastEndTime=a||0);var d=t.samples;if(null==d||!d.length)return c;var h={initPTS:void 0,timescale:1},f=this.initData;if(null!=(o=f)&&o.length||(this.generateInitSegment(d),f=this.initData),null==(s=f)||!s.length)return Xn.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),c;this.emitInitSegment&&(h.tracks=this.initTracks,this.emitInitSegment=!1);var v=function(e,t){for(var n=0,i=0,a=0,r=ia(e,["moof","traf"]),o=0;o<r.length;o++){var s=r[o],l=ia(s,["tfhd"])[0],u=t[$i(l,4)];if(u){var c=u.default,d=$i(l,0)|(null==c?void 0:c.flags),h=null==c?void 0:c.duration;8&d&&(h=$i(l,2&d?12:8));for(var f=u.timescale||9e4,v=ia(s,["trun"]),m=0;m<v.length;m++)!(n=da(v[m]))&&h&&(n=h*$i(v[m],4)),u.type===ii?i+=n/f:u.type===ni&&(a+=n/f)}}if(0===i&&0===a){for(var p=1/0,g=0,y=0,E=ia(e,["sidx"]),A=0;A<E.length;A++){var b=aa(E[A]);if(null!=b&&b.references){p=Math.min(p,b.earliestPresentationTime/b.timescale);var k=b.references.reduce((function(e,t){return e+t.info.duration||0}),0);y=(g=Math.max(g,k+b.earliestPresentationTime/b.timescale))-p}}if(y&&Fn(y))return y}return i||a}(d,f),m=function(e,t){return ia(t,["moof","traf"]).reduce((function(t,n){var i=ia(n,["tfdt"])[0],a=i[0],r=ia(n,["tfhd"]).reduce((function(t,n){var r=$i(n,4),o=e[r];if(o){var s=$i(i,4);if(1===a){if(s===zi)return Xn.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),t;s*=zi+1,s+=$i(i,8)}var l=s/(o.timescale||9e4);if(Fn(l)&&(null===t||l<t))return l}return t}),null);return null!==r&&Fn(r)&&(null===t||r<t)?r:t}),null)}(f,d),p=null===m?a:m;(function(e,t,n,i){if(null===e)return!0;var a=Math.max(i,1),r=t-e.baseTime/e.timescale;return Math.abs(r-n)>a}(l,p,a,v)||h.timescale!==l.timescale&&r)&&(h.initPTS=p-a,l&&1===l.timescale&&Xn.warn("Adjusting initPTS by ".concat(h.initPTS-l.baseTime)),this.initPTS=l={baseTime:h.initPTS,timescale:1});var g=e?p-l.baseTime/l.timescale:u,y=g+v;!function(e,t,n){ia(t,["moof","traf"]).forEach((function(t){ia(t,["tfhd"]).forEach((function(i){var a=$i(i,4),r=e[a];if(r){var o=r.timescale||9e4;ia(t,["tfdt"]).forEach((function(e){var t=e[0],i=n*o;if(i){var a=$i(e,4);if(0===t)a-=i,na(e,4,a=Math.max(a,0));else{a*=Math.pow(2,32),a+=$i(e,8),a-=i,a=Math.max(a,0);var r=Math.floor(a/(zi+1)),s=Math.floor(a%(zi+1));na(e,4,r),na(e,8,s)}}}))}}))}))}(f,d,l.baseTime/l.timescale),v>0?this.lastEndTime=y:(Xn.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var E=!!f.audio,A=!!f.video,b="";E&&(b+="audio"),A&&(b+="video");var k={data1:d,startPTS:g,startDTS:g,endPTS:y,endDTS:y,type:b,hasAudio:E,hasVideo:A,nb:1,dropped:0};return c.audio="audio"===k.type?k:void 0,c.video="audio"!==k.type?k:void 0,c.initSegment=h,c.id3=$s(n,a,l,l),i.samples.length&&(c.text=el(i,a,l)),c}}]),e}();function al(e,t){var n=null==e?void 0:e.codec;if(n&&n.length>4)return n;if(t===ni){if("ec-3"===n||"ac-3"===n||"alac"===n)return n;if("fLaC"===n||"Opus"===n){return Ua(n,!1)}var i="mp4a.40.5";return Xn.info('Parsed audio codec "'.concat(n,'" or audio object type not handled. Using "').concat(i,'"')),i}return Xn.warn('Unhandled video codec "'.concat(n,'"')),"hvc1"===n||"hev1"===n?"hvc1.1.6.L120.90":"av01"===n?"av01.0.04M.08":"avc1.42e01e"}try{tl=self.performance.now.bind(self.performance)}catch(BL){Xn.debug("Unable to use Performance API on this environment"),tl=null==hi?void 0:hi.Date.now}var rl=[{demux:ws,remux:il},{demux:Ps,remux:Zs},{demux:_s,remux:Zs},{demux:Ks,remux:Zs}];rl.splice(2,0,{demux:Ls,remux:Zs});var ol=function(){function e(t,n,i,a,r){(0,m.A)(this,e),this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=t,this.typeSupported=n,this.config=i,this.vendor=a,this.id=r}return(0,v.A)(e,[{key:"configure",value:function(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}},{key:"push",value:function(e,t,n,i){var a=this,r=n.transmuxing;r.executeStart=tl();var o=new Uint8Array(e),s=this.currentTransmuxState,l=this.transmuxConfig;i&&(this.currentTransmuxState=i);var u=i||s,c=u.contiguous,d=u.discontinuity,h=u.trackSwitch,f=u.accurateTimeOffset,v=u.timeOffset,m=u.initSegmentChange,p=l.audioCodec,g=l.videoCodec,y=l.defaultInitPts,E=l.duration,A=l.initSegmentData,b=function(e,t){var n=null;e.byteLength>0&&null!=(null==t?void 0:t.key)&&null!==t.iv&&null!=t.method&&(n=t);return n}(o,t);if(b&&"AES-128"===b.method){var k=this.getDecrypter();if(!k.isSync())return this.decryptionPromise=k.webCryptoDecrypt(o,b.key.buffer,b.iv.buffer).then((function(e){var t=a.push(e,null,n);return a.decryptionPromise=null,t})),this.decryptionPromise;var T=k.softwareDecrypt(o,b.key.buffer,b.iv.buffer);if(n.part>-1&&(T=k.flush()),!T)return r.executeEnd=tl(),sl(n);o=new Uint8Array(T)}var _=this.needsProbing(d,h);if(_){var S=this.configureTransmuxer(o);if(S)return Xn.warn("[transmuxer] ".concat(S.message)),this.observer.emit(Gn.ERROR,Gn.ERROR,{type:Kn.MEDIA_ERROR,details:Wn.FRAG_PARSING_ERROR,fatal:!1,error:S,reason:S.message}),r.executeEnd=tl(),sl(n)}(d||h||m||_)&&this.resetInitSegment(A,p,g,E,t),(d||m||_)&&this.resetInitialTimestamp(y),c||this.resetContiguity();var w=this.transmux(o,b,v,f,n),R=this.currentTransmuxState;return R.contiguous=!0,R.discontinuity=!1,R.trackSwitch=!1,r.executeEnd=tl(),w}},{key:"flush",value:function(e){var t=this,n=e.transmuxing;n.executeStart=tl();var i=this.decrypter,a=this.currentTransmuxState,r=this.decryptionPromise;if(r)return r.then((function(){return t.flush(e)}));var o=[],s=a.timeOffset;if(i){var l=i.flush();l&&o.push(this.push(l,null,e))}var u=this.demuxer,c=this.remuxer;if(!u||!c)return n.executeEnd=tl(),[sl(e)];var d=u.flush(s);return ll(d)?d.then((function(n){return t.flushRemux(o,n,e),o})):(this.flushRemux(o,d,e),o)}},{key:"flushRemux",value:function(e,t,n){var i=t.audioTrack,a=t.videoTrack,r=t.id3Track,o=t.textTrack,s=this.currentTransmuxState,l=s.accurateTimeOffset,u=s.timeOffset;Xn.log("[transmuxer.ts]: Flushed fragment ".concat(n.sn).concat(n.part>-1?" p: "+n.part:""," of level ").concat(n.level));var c=this.remuxer.remux(i,a,r,o,u,l,!0,this.id);e.push({remuxResult:c,chunkMeta:n}),n.transmuxing.executeEnd=tl()}},{key:"resetInitialTimestamp",value:function(e){var t=this.demuxer,n=this.remuxer;t&&n&&(t.resetTimeStamp(e),n.resetTimeStamp(e))}},{key:"resetContiguity",value:function(){var e=this.demuxer,t=this.remuxer;e&&t&&(e.resetContiguity(),t.resetNextTimestamp())}},{key:"resetInitSegment",value:function(e,t,n,i,a){var r=this.demuxer,o=this.remuxer;r&&o&&(r.resetInitSegment(e,t,n,i),o.resetInitSegment(e,t,n,a))}},{key:"destroy",value:function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}},{key:"transmux",value:function(e,t,n,i,a){return t&&"SAMPLE-AES"===t.method?this.transmuxSampleAes(e,t,n,i,a):this.transmuxUnencrypted(e,n,i,a)}},{key:"transmuxUnencrypted",value:function(e,t,n,i){var a=this.demuxer.demux(e,t,!1,!this.config.progressive),r=a.audioTrack,o=a.videoTrack,s=a.id3Track,l=a.textTrack;return{remuxResult:this.remuxer.remux(r,o,s,l,t,n,!1,this.id),chunkMeta:i}}},{key:"transmuxSampleAes",value:function(e,t,n,i,a){var r=this;return this.demuxer.demuxSampleAes(e,t,n).then((function(e){return{remuxResult:r.remuxer.remux(e.audioTrack,e.videoTrack,e.id3Track,e.textTrack,n,i,!1,r.id),chunkMeta:a}}))}},{key:"configureTransmuxer",value:function(e){for(var t,n=this.config,i=this.observer,a=this.typeSupported,r=this.vendor,o=0,s=rl.length;o<s;o++){var l;if(null!=(l=rl[o].demux)&&l.probe(e)){t=rl[o];break}}if(!t)return new Error("Failed to find demuxer by probing fragment data");var u=this.demuxer,c=this.remuxer,d=t.remux,h=t.demux;c&&c instanceof d||(this.remuxer=new d(i,n,a,r)),u&&u instanceof h||(this.demuxer=new h(i,n,a),this.probe=h.probe)}},{key:"needsProbing",value:function(e,t){return!this.demuxer||!this.remuxer||e||t}},{key:"getDecrypter",value:function(){var e=this.decrypter;return e||(e=this.decrypter=new Go(this.config)),e}}]),e}();var sl=function(e){return{remuxResult:{},chunkMeta:e}};function ll(e){return"then"in e&&e.then instanceof Function}var ul=(0,v.A)((function e(t,n,i,a,r){(0,m.A)(this,e),this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=t,this.videoCodec=n,this.initSegmentData=i,this.duration=a,this.defaultInitPts=r||null})),cl=(0,v.A)((function e(t,n,i,a,r,o){(0,m.A)(this,e),this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=t,this.contiguous=n,this.accurateTimeOffset=i,this.trackSwitch=a,this.timeOffset=r,this.initSegmentChange=o})),dl={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,n="~";function i(){}function a(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function r(e,t,i,r,o){if("function"!==typeof i)throw new TypeError("The listener must be a function");var s=new a(i,r||e,o),l=n?n+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],s]:e._events[l].push(s):(e._events[l]=s,e._eventsCount++),e}function o(e,t){0===--e._eventsCount?e._events=new i:delete e._events[t]}function s(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(n=!1)),s.prototype.eventNames=function(){var e,i,a=[];if(0===this._eventsCount)return a;for(i in e=this._events)t.call(e,i)&&a.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(e)):a},s.prototype.listeners=function(e){var t=n?n+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var a=0,r=i.length,o=new Array(r);a<r;a++)o[a]=i[a].fn;return o},s.prototype.listenerCount=function(e){var t=n?n+e:e,i=this._events[t];return i?i.fn?1:i.length:0},s.prototype.emit=function(e,t,i,a,r,o){var s=n?n+e:e;if(!this._events[s])return!1;var l,u,c=this._events[s],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,i),!0;case 4:return c.fn.call(c.context,t,i,a),!0;case 5:return c.fn.call(c.context,t,i,a,r),!0;case 6:return c.fn.call(c.context,t,i,a,r,o),!0}for(u=1,l=new Array(d-1);u<d;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var h,f=c.length;for(u=0;u<f;u++)switch(c[u].once&&this.removeListener(e,c[u].fn,void 0,!0),d){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,t);break;case 3:c[u].fn.call(c[u].context,t,i);break;case 4:c[u].fn.call(c[u].context,t,i,a);break;default:if(!l)for(h=1,l=new Array(d-1);h<d;h++)l[h-1]=arguments[h];c[u].fn.apply(c[u].context,l)}}return!0},s.prototype.on=function(e,t,n){return r(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return r(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,i,a){var r=n?n+e:e;if(!this._events[r])return this;if(!t)return o(this,r),this;var s=this._events[r];if(s.fn)s.fn!==t||a&&!s.once||i&&s.context!==i||o(this,r);else{for(var l=0,u=[],c=s.length;l<c;l++)(s[l].fn!==t||a&&!s[l].once||i&&s[l].context!==i)&&u.push(s[l]);u.length?this._events[r]=1===u.length?u[0]:u:o(this,r)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&o(this,t)):(this._events=new i,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s}(dl);var hl=In(dl.exports),fl=function(){function e(t,n,i,a){var r=this;(0,m.A)(this,e),this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;var o=t.config;this.hls=t,this.id=n,this.useWorker=!!o.enableWorker,this.onTransmuxComplete=i,this.onFlush=a;var s=function(e,t){(t=t||{}).frag=r.frag,t.id=r.id,e===Gn.ERROR&&(r.error=t.error),r.hls.trigger(e,t)};this.observer=new hl,this.observer.on(Gn.FRAG_DECRYPTED,s),this.observer.on(Gn.ERROR,s);var l=Ra(o.preferManagedMediaSource)||{isTypeSupported:function(){return!1}},u={mpeg:l.isTypeSupported("audio/mpeg"),mp3:l.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:l.isTypeSupported('audio/mp4; codecs="ac-3"')};if(this.useWorker&&"undefined"!==typeof Worker&&(o.workerPath||"function"===typeof __HLS_WORKER_BUNDLE__)){try{o.workerPath?(Xn.log("loading Web Worker ".concat(o.workerPath,' for "').concat(n,'"')),this.workerContext=function(e){var t=new self.URL(e,self.location.href).href;return{worker:new self.Worker(t),scriptURL:t}}(o.workerPath)):(Xn.log('injecting Web Worker for "'.concat(n,'"')),this.workerContext=function(){var e=new self.Blob(["var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(".concat(__HLS_WORKER_BUNDLE__.toString(),")(true);")],{type:"text/javascript"}),t=self.URL.createObjectURL(e);return{worker:new self.Worker(t),objectURL:t}}()),this.onwmsg=function(e){return r.onWorkerMessage(e)};var c=this.workerContext.worker;c.addEventListener("message",this.onwmsg),c.onerror=function(e){var t=new Error("".concat(e.message,"  (").concat(e.filename,":").concat(e.lineno,")"));o.enableWorker=!1,Xn.warn('Error in "'.concat(n,'" Web Worker, fallback to inline')),r.hls.trigger(Gn.ERROR,{type:Kn.OTHER_ERROR,details:Wn.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:t})},c.postMessage({cmd:"init",typeSupported:u,vendor:"",id:n,config:JSON.stringify(o)})}catch(BL){Xn.warn('Error setting up "'.concat(n,'" Web Worker, fallback to inline'),BL),this.resetWorker(),this.error=null,this.transmuxer=new ol(this.observer,u,o,"",n)}return}this.transmuxer=new ol(this.observer,u,o,"",n)}return(0,v.A)(e,[{key:"resetWorker",value:function(){if(this.workerContext){var e=this.workerContext,t=e.worker,n=e.objectURL;n&&self.URL.revokeObjectURL(n),t.removeEventListener("message",this.onwmsg),t.onerror=null,t.terminate(),this.workerContext=null}}},{key:"destroy",value:function(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{var e=this.transmuxer;e&&(e.destroy(),this.transmuxer=null)}var t=this.observer;t&&t.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}},{key:"push",value:function(e,t,n,i,a,r,o,s,l,u){var c,d,h=this;l.transmuxing.start=self.performance.now();var f=this.transmuxer,v=r?r.start:a.start,m=a.decryptdata,p=this.frag,g=!(p&&a.cc===p.cc),y=!(p&&l.level===p.level),E=p?l.sn-p.sn:-1,A=this.part?l.part-this.part.index:-1,b=0===E&&l.id>1&&l.id===(null==p?void 0:p.stats.chunkCount),k=!y&&(1===E||0===E&&(1===A||b&&A<=0)),T=self.performance.now();(y||E||0===a.stats.parsing.start)&&(a.stats.parsing.start=T),!r||!A&&k||(r.stats.parsing.start=T);var _=!(p&&(null==(c=a.initSegment)?void 0:c.url)===(null==(d=p.initSegment)?void 0:d.url)),S=new cl(g,k,s,y,v,_);if(!k||g||_){Xn.log("[transmuxer-interface, ".concat(a.type,"]: Starting new transmux session for sn: ").concat(l.sn," p: ").concat(l.part," level: ").concat(l.level," id: ").concat(l.id,"\n        discontinuity: ").concat(g,"\n        trackSwitch: ").concat(y,"\n        contiguous: ").concat(k,"\n        accurateTimeOffset: ").concat(s,"\n        timeOffset: ").concat(v,"\n        initSegmentChange: ").concat(_));var w=new ul(n,i,t,o,u);this.configureTransmuxer(w)}if(this.frag=a,this.part=r,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:e,decryptdata:m,chunkMeta:l,state:S},e instanceof ArrayBuffer?[e]:[]);else if(f){var R=f.push(e,m,l,S);ll(R)?(f.async=!0,R.then((function(e){h.handleTransmuxComplete(e)})).catch((function(e){h.transmuxerError(e,l,"transmuxer-interface push error")}))):(f.async=!1,this.handleTransmuxComplete(R))}}},{key:"flush",value:function(e){var t=this;e.transmuxing.start=self.performance.now();var n=this.transmuxer;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(n){var i=n.flush(e);ll(i)||n.async?(ll(i)||(i=Promise.resolve(i)),i.then((function(n){t.handleFlushResult(n,e)})).catch((function(n){t.transmuxerError(n,e,"transmuxer-interface flush error")}))):this.handleFlushResult(i,e)}}},{key:"transmuxerError",value:function(e,t,n){this.hls&&(this.error=e,this.hls.trigger(Gn.ERROR,{type:Kn.MEDIA_ERROR,details:Wn.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,fatal:!1,error:e,err:e,reason:n}))}},{key:"handleFlushResult",value:function(e,t){var n=this;e.forEach((function(e){n.handleTransmuxComplete(e)})),this.onFlush(t)}},{key:"onWorkerMessage",value:function(e){var t=e.data;if(null!=t&&t.event){var n=this.hls;if(this.hls)switch(t.event){case"init":var i,a=null==(i=this.workerContext)?void 0:i.objectURL;a&&self.URL.revokeObjectURL(a);break;case"transmuxComplete":this.handleTransmuxComplete(t.data);break;case"flush":this.onFlush(t.data);break;case"workerLog":Xn[t.data.logType]&&Xn[t.data.logType](t.data.message);break;default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,n.trigger(t.event,t.data)}}else Xn.warn("worker message received with no ".concat(t?"event name":"data"))}},{key:"configureTransmuxer",value:function(e){var t=this.transmuxer;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:e}):t&&t.configure(e)}},{key:"handleTransmuxComplete",value:function(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}]),e}(),vl=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(e,i,a){var r;return(0,m.A)(this,n),(r=t.call(this,e,i,a,"[audio-stream-controller]",ir)).videoBuffer=null,r.videoTrackCC=-1,r.waitingVideoCC=-1,r.bufferedTrack=null,r.switchingTrack=null,r.trackId=-1,r.waitingData=null,r.mainDetails=null,r.flushing=!1,r.bufferFlushed=!1,r.cachedTrackLoadedData=null,r._registerListeners(),r}return(0,v.A)(n,[{key:"onHandlerDestroying",value:function(){this._unregisterListeners(),(0,u.A)((0,c.A)(n.prototype),"onHandlerDestroying",this).call(this),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}},{key:"_registerListeners",value:function(){var e=this.hls;e.on(Gn.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Gn.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Gn.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Gn.LEVEL_LOADED,this.onLevelLoaded,this),e.on(Gn.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(Gn.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(Gn.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(Gn.ERROR,this.onError,this),e.on(Gn.BUFFER_RESET,this.onBufferReset,this),e.on(Gn.BUFFER_CREATED,this.onBufferCreated,this),e.on(Gn.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(Gn.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(Gn.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(Gn.FRAG_BUFFERED,this.onFragBuffered,this)}},{key:"_unregisterListeners",value:function(){var e=this.hls;e.off(Gn.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Gn.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Gn.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Gn.LEVEL_LOADED,this.onLevelLoaded,this),e.off(Gn.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(Gn.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(Gn.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(Gn.ERROR,this.onError,this),e.off(Gn.BUFFER_RESET,this.onBufferReset,this),e.off(Gn.BUFFER_CREATED,this.onBufferCreated,this),e.off(Gn.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(Gn.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(Gn.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(Gn.FRAG_BUFFERED,this.onFragBuffered,this)}},{key:"onInitPtsFound",value:function(e,t){var n=t.frag,i=t.id,a=t.initPTS,r=t.timescale;if("main"===i){var o=n.cc;this.initPTS[n.cc]={baseTime:a,timescale:r},this.log("InitPTS for cc: ".concat(o," found from main: ").concat(a)),this.videoTrackCC=o,this.state===$o&&this.tick()}}},{key:"startLoad",value:function(e){if(!this.levels)return this.startPosition=e,void(this.state=Wo);var t=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),t>0&&-1===e?(this.log("Override startPosition with lastCurrentTime @".concat(t.toFixed(3))),e=t,this.state=Vo):(this.loadedmetadata=!1,this.state=zo),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}},{key:"doTick",value:function(){switch(this.state){case Vo:this.doTickIdle();break;case zo:var e,t=this.levels,i=this.trackId,a=null==t||null==(e=t[i])?void 0:e.details;if(a){if(this.waitForCdnTuneIn(a))break;this.state=$o}break;case jo:var r,o=performance.now(),s=this.retryDate;if(!s||o>=s||null!=(r=this.media)&&r.seeking){var l=this.levels,d=this.trackId;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((null==l?void 0:l[d])||null),this.state=Vo}break;case $o:var h=this.waitingData;if(h){var f=h.frag,v=h.part,m=h.cache,p=h.complete;if(void 0!==this.initPTS[f.cc]){this.waitingData=null,this.waitingVideoCC=-1,this.state=Yo;var g={frag:f,part:v,payload:m.flush(),networkDetails:null};this._handleFragmentLoadProgress(g),p&&(0,u.A)((0,c.A)(n.prototype),"_handleFragmentLoadComplete",this).call(this,g)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log("Waiting fragment cc (".concat(f.cc,") cancelled because video is at cc ").concat(this.videoTrackCC)),this.clearWaitingFragment();else{var y=this.getLoadPosition(),E=wo.bufferInfo(this.mediaBuffer,y,this.config.maxBufferHole);jr(E.end,this.config.maxFragLookUpTolerance,f)<0&&(this.log("Waiting fragment cc (".concat(f.cc,") @ ").concat(f.start," cancelled because another fragment at ").concat(E.end," is needed")),this.clearWaitingFragment())}}else this.state=Vo}this.onTickEnd()}},{key:"clearWaitingFragment",value:function(){var e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=Vo)}},{key:"resetLoadingState",value:function(){this.clearWaitingFragment(),(0,u.A)((0,c.A)(n.prototype),"resetLoadingState",this).call(this)}},{key:"onTickEnd",value:function(){var e=this.media;null!=e&&e.readyState&&(this.lastCurrentTime=e.currentTime)}},{key:"doTickIdle",value:function(){var e=this.hls,t=this.levels,n=this.media,i=this.trackId,a=e.config;if(this.buffering&&(n||!this.startFragRequested&&a.startFragPrefetch)&&null!=t&&t[i]){var r=t[i],o=r.details;if(!o||o.live&&this.levelLastLoaded!==r||this.waitForCdnTuneIn(o))this.state=zo;else{var s=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&s&&(this.bufferFlushed=!1,this.afterBufferFlushed(s,ni,ir));var l=this.getFwdBufferInfo(s,ir);if(null!==l){if(!this.switchingTrack&&this._streamEnded(l,o))return e.trigger(Gn.BUFFER_EOS,{type:"audio"}),void(this.state=Zo);var u=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,nr),c=l.len,d=this.getMaxBufferLength(null==u?void 0:u.len),h=o.fragments,f=h[0].start,v=this.getLoadPosition(),m=this.flushing?v:l.end;if(this.switchingTrack&&n){var p=v;o.PTSKnown&&p<f&&(l.end>f||l.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),n.currentTime=f+.05)}if(!(c>=d&&!this.switchingTrack&&m<h[h.length-1].start)){var g=this.getNextFragment(m,o),y=!1;if(g&&this.isLoopLoading(g,m)&&(y=!!g.gap,g=this.getNextFragmentLoopLoading(g,o,l,nr,d)),g){var E=u&&g.start>u.end+o.targetduration;if(E||(null==u||!u.len)&&l.len){var A=this.getAppendedFrag(g.start,nr);if(null===A)return;if(y||(y=!!A.gap||!!E&&0===u.len),E&&!y||y&&l.nextStart&&l.nextStart<A.end)return}this.loadFragment(g,r,m)}else this.bufferFlushed=!0}}}}}},{key:"getMaxBufferLength",value:function(e){var t=(0,u.A)((0,c.A)(n.prototype),"getMaxBufferLength",this).call(this);return e?Math.min(Math.max(t,e),this.config.maxMaxBufferLength):t}},{key:"onMediaDetaching",value:function(){this.videoBuffer=null,this.bufferFlushed=this.flushing=!1,(0,u.A)((0,c.A)(n.prototype),"onMediaDetaching",this).call(this)}},{key:"onAudioTracksUpdated",value:function(e,t){var n=t.audioTracks;this.resetTransmuxer(),this.levels=n.map((function(e){return new Ir(e)}))}},{key:"onAudioTrackSwitching",value:function(e,t){var n=!!t.url;this.trackId=t.id;var i=this.fragCurrent;i&&(i.abortRequests(),this.removeUnbufferedFrags(i.start)),this.resetLoadingState(),n?this.setInterval(100):this.resetTransmuxer(),n?(this.switchingTrack=t,this.state=Vo,this.flushAudioIfNeeded(t)):(this.switchingTrack=null,this.bufferedTrack=t,this.state=Wo),this.tick()}},{key:"onManifestLoading",value:function(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=this.flushing=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}},{key:"onLevelLoaded",value:function(e,t){this.mainDetails=t.details,null!==this.cachedTrackLoadedData&&(this.hls.trigger(Gn.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}},{key:"onAudioTrackLoaded",value:function(e,t){var n;if(null!=this.mainDetails){var i=this.levels,a=t.details,r=t.id;if(i){this.log("Audio track ".concat(r," loaded [").concat(a.startSN,",").concat(a.endSN,"]").concat(a.lastPartSn?"[part-".concat(a.lastPartSn,"-").concat(a.lastPartIndex,"]"):"",",duration:").concat(a.totalduration));var o=i[r],s=0;if(a.live||null!=(n=o.details)&&n.live){this.checkLiveUpdate(a);var l,u=this.mainDetails;if(a.deltaUpdateFailed||!u)return;if(!o.details&&a.hasProgramDateTime&&u.hasProgramDateTime)xo(a,u),s=a.fragments[0].start;else s=this.alignPlaylists(a,o.details,null==(l=this.levelLastLoaded)?void 0:l.details)}o.details=a,this.levelLastLoaded=o,this.startFragRequested||!this.mainDetails&&a.live||this.setStartPosition(this.mainDetails||a,s),this.state!==zo||this.waitForCdnTuneIn(a)||(this.state=Vo),this.tick()}else this.warn("Audio tracks were reset while loading level ".concat(r))}else this.cachedTrackLoadedData=t}},{key:"_handleFragmentLoadProgress",value:function(e){var t,n=e.frag,i=e.part,a=e.payload,r=this.config,o=this.trackId,s=this.levels;if(s){var l=s[o];if(l){var u=l.details;if(!u)return this.warn("Audio track details undefined on fragment load progress"),void this.removeUnbufferedFrags(n.start);var c=r.defaultAudioCodec||l.audioCodec||"mp4a.40.2",d=this.transmuxer;d||(d=this.transmuxer=new fl(this.hls,ir,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var h=this.initPTS[n.cc],f=null==(t=n.initSegment)?void 0:t.data;if(void 0!==h){var v=i?i.index:-1,m=-1!==v,p=new Ro(n.level,n.sn,n.stats.chunkCount,a.byteLength,v,m);d.push(a,f,c,"",n,i,u.totalduration,!1,p,h)}else{this.log("Unknown video PTS for cc ".concat(n.cc,", waiting for video PTS before demuxing audio frag ").concat(n.sn," of [").concat(u.startSN," ,").concat(u.endSN,"],track ").concat(o)),(this.waitingData=this.waitingData||{frag:n,part:i,cache:new ns,complete:!1}).cache.push(new Uint8Array(a)),this.waitingVideoCC=this.videoTrackCC,this.state=$o}}else this.warn("Audio track is undefined on fragment load progress")}else this.warn("Audio tracks were reset while fragment load was in progress. Fragment ".concat(n.sn," of level ").concat(n.level," will not be buffered"))}},{key:"_handleFragmentLoadComplete",value:function(e){this.waitingData?this.waitingData.complete=!0:(0,u.A)((0,c.A)(n.prototype),"_handleFragmentLoadComplete",this).call(this,e)}},{key:"onBufferReset",value:function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}},{key:"onBufferCreated",value:function(e,t){var n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer||null),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer||null)}},{key:"onFragBuffered",value:function(e,t){var n=t.frag,i=t.part;if(n.type===ir)if(this.fragContextChanged(n))this.warn("Fragment ".concat(n.sn).concat(i?" p: "+i.index:""," of level ").concat(n.level," finished buffering, but was aborted. state: ").concat(this.state,", audioSwitch: ").concat(this.switchingTrack?this.switchingTrack.name:"false"));else{if("initSegment"!==n.sn){this.fragPrevious=n;var a=this.switchingTrack;a&&(this.bufferedTrack=a,this.switchingTrack=null,this.hls.trigger(Gn.AUDIO_TRACK_SWITCHED,On({},a)))}this.fragBufferedComplete(n,i)}else if(!this.loadedmetadata&&n.type===nr){var r=this.videoBuffer||this.media;if(r)wo.getBuffered(r).length&&(this.loadedmetadata=!0)}}},{key:"onError",value:function(e,t){var i;if(t.fatal)this.state=Jo;else switch(t.details){case Wn.FRAG_GAP:case Wn.FRAG_PARSING_ERROR:case Wn.FRAG_DECRYPT_ERROR:case Wn.FRAG_LOAD_ERROR:case Wn.FRAG_LOAD_TIMEOUT:case Wn.KEY_LOAD_ERROR:case Wn.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ir,t);break;case Wn.AUDIO_TRACK_LOAD_ERROR:case Wn.AUDIO_TRACK_LOAD_TIMEOUT:case Wn.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==zo||(null==(i=t.context)?void 0:i.type)!==er||(this.state=Vo);break;case Wn.BUFFER_APPEND_ERROR:case Wn.BUFFER_FULL_ERROR:if(!t.parent||"audio"!==t.parent)return;if(t.details===Wn.BUFFER_APPEND_ERROR)return void this.resetLoadingState();this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,(0,u.A)((0,c.A)(n.prototype),"flushMainBuffer",this).call(this,0,Number.POSITIVE_INFINITY,"audio"));break;case Wn.INTERNAL_EXCEPTION:this.recoverWorkerError(t)}}},{key:"onBufferFlushing",value:function(e,t){t.type!==ii&&(this.flushing=!0)}},{key:"onBufferFlushed",value:function(e,t){var n=t.type;if(n!==ii){this.flushing=!1,this.bufferFlushed=!0,this.state===Zo&&(this.state=Vo);var i=this.mediaBuffer||this.media;i&&(this.afterBufferFlushed(i,n,ir),this.tick())}}},{key:"_handleTransmuxComplete",value:function(e){var t,n="audio",i=this.hls,a=e.remuxResult,r=e.chunkMeta,o=this.getCurrentContext(r);if(o){var s=o.frag,l=o.part,u=o.level,c=u.details,d=a.audio,h=a.text,f=a.id3,v=a.initSegment;if(!this.fragContextChanged(s)&&c){if(this.state=Xo,this.switchingTrack&&d&&this.completeAudioSwitch(this.switchingTrack),null!=v&&v.tracks){var m=s.initSegment||s;this._bufferInitSegment(u,v.tracks,m,r),i.trigger(Gn.FRAG_PARSING_INIT_SEGMENT,{frag:m,id:n,tracks:v.tracks})}if(d){var p=d.startPTS,g=d.endPTS,y=d.startDTS,E=d.endDTS;l&&(l.elementaryStreams[ni]={startPTS:p,endPTS:g,startDTS:y,endDTS:E}),s.setElementaryStreamInfo(ni,p,g,y,E),this.bufferFragmentData(d,s,l,r)}if(null!=f&&null!=(t=f.samples)&&t.length){var A=Un({id:n,frag:s,details:c},f);i.trigger(Gn.FRAG_PARSING_METADATA,A)}if(h){var b=Un({id:n,frag:s,details:c},h);i.trigger(Gn.FRAG_PARSING_USERDATA,b)}}else this.fragmentTracker.removeFragment(s)}else this.resetWhenMissingContext(r)}},{key:"_bufferInitSegment",value:function(e,t,n,i){if(this.state===Xo){t.video&&delete t.video;var a=t.audio;if(a){a.id="audio";var r=e.audioCodec;this.log("Init audio buffer, container:".concat(a.container,", codecs[level/parsed]=[").concat(r,"/").concat(a.codec,"]")),r&&1===r.split(",").length&&(a.levelCodec=r),this.hls.trigger(Gn.BUFFER_CODECS,t);var o=a.initSegment;if(null!=o&&o.byteLength){var s={type:"audio",frag:n,part:null,chunkMeta:i,parent:n.type,data:o};this.hls.trigger(Gn.BUFFER_APPENDING,s)}this.tickImmediate()}}}},{key:"loadFragment",value:function(e,t,i){var a,r=this.fragmentTracker.getState(e);if(this.fragCurrent=e,this.switchingTrack||r===yo||r===Ao)if("initSegment"===e.sn)this._loadInitSegment(e,t);else if(null!=(a=t.details)&&a.live&&!this.initPTS[e.cc]){this.log("Waiting for video PTS in continuity counter ".concat(e.cc," of live stream before loading audio fragment ").concat(e.sn," of level ").concat(this.trackId)),this.state=$o;var o=this.mainDetails;o&&o.fragments[0].start!==t.details.fragments[0].start&&xo(t.details,o)}else this.startFragRequested=!0,(0,u.A)((0,c.A)(n.prototype),"loadFragment",this).call(this,e,t,i);else this.clearTrackerIfNeeded(e)}},{key:"flushAudioIfNeeded",value:function(e){if(this.media&&this.bufferedTrack){var t=this.bufferedTrack;fo({name:t.name,lang:t.lang,assocLang:t.assocLang,characteristics:t.characteristics,audioCodec:t.audioCodec,channels:t.channels},e,vo)||(this.log("Switching audio track : flushing all audio"),(0,u.A)((0,c.A)(n.prototype),"flushMainBuffer",this).call(this,0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null)}}},{key:"completeAudioSwitch",value:function(e){var t=this.hls;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(Gn.AUDIO_TRACK_SWITCHED,On({},e))}}]),n}(ts);function ml(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!pl(e[n].attrs,t[n].attrs))return!1;return!0}function pl(e,t,n){var i=e["STABLE-RENDITION-ID"];return i&&!n?i===t["STABLE-RENDITION-ID"]:!(n||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some((function(n){return e[n]!==t[n]}))}function gl(e,t){return t.label.toLowerCase()===e.name.toLowerCase()&&(!t.language||t.language.toLowerCase()===(e.lang||"").toLowerCase())}var yl=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(e){var i;return(0,m.A)(this,n),(i=t.call(this,e,"[audio-track-controller]")).tracks=[],i.groupIds=null,i.tracksInGroup=[],i.trackId=-1,i.currentTrack=null,i.selectDefaultTrack=!0,i.registerListeners(),i}return(0,v.A)(n,[{key:"registerListeners",value:function(){var e=this.hls;e.on(Gn.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Gn.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Gn.LEVEL_LOADING,this.onLevelLoading,this),e.on(Gn.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(Gn.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(Gn.ERROR,this.onError,this)}},{key:"unregisterListeners",value:function(){var e=this.hls;e.off(Gn.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Gn.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Gn.LEVEL_LOADING,this.onLevelLoading,this),e.off(Gn.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(Gn.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(Gn.ERROR,this.onError,this)}},{key:"destroy",value:function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,(0,u.A)((0,c.A)(n.prototype),"destroy",this).call(this)}},{key:"onManifestLoading",value:function(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}},{key:"onManifestParsed",value:function(e,t){this.tracks=t.audioTracks||[]}},{key:"onAudioTrackLoaded",value:function(e,t){var n=t.id,i=t.groupId,a=t.details,r=this.tracksInGroup[n];if(r&&r.groupId===i){var o=r.details;r.details=t.details,this.log("Audio track ".concat(n,' "').concat(r.name,'" lang:').concat(r.lang," group:").concat(i," loaded [").concat(a.startSN,"-").concat(a.endSN,"]")),n===this.trackId&&this.playlistLoaded(n,t,o)}else this.warn("Audio track with id:".concat(n," and group:").concat(i," not found in active group ").concat(null==r?void 0:r.groupId))}},{key:"onLevelLoading",value:function(e,t){this.switchLevel(t.level)}},{key:"onLevelSwitching",value:function(e,t){this.switchLevel(t.level)}},{key:"switchLevel",value:function(e){var t=this.hls.levels[e];if(t){var n=t.audioGroups||null,i=this.groupIds,a=this.currentTrack;if(!n||(null==i?void 0:i.length)!==(null==n?void 0:n.length)||null!=n&&n.some((function(e){return-1===(null==i?void 0:i.indexOf(e))}))){this.groupIds=n,this.trackId=-1,this.currentTrack=null;var r=this.tracks.filter((function(e){return!n||-1!==n.indexOf(e.groupId)}));if(r.length)this.selectDefaultTrack&&!r.some((function(e){return e.default}))&&(this.selectDefaultTrack=!1),r.forEach((function(e,t){e.id=t}));else if(!a&&!this.tracksInGroup.length)return;this.tracksInGroup=r;var o=this.hls.config.audioPreference;if(!a&&o){var s=ho(o,r,vo);if(s>-1)a=r[s];else{var l=ho(o,this.tracks);a=this.tracks[l]}}var u=this.findTrackId(a);-1===u&&a&&(u=this.findTrackId(null));var c={audioTracks:r};this.log("Updating audio tracks, ".concat(r.length," track(s) found in group(s): ").concat(null==n?void 0:n.join(","))),this.hls.trigger(Gn.AUDIO_TRACKS_UPDATED,c);var d=this.trackId;if(-1!==u&&-1===d)this.setAudioTrack(u);else if(r.length&&-1===d){var h,f=new Error("No audio track selected for current audio group-ID(s): ".concat(null==(h=this.groupIds)?void 0:h.join(",")," track count: ").concat(r.length));this.warn(f.message),this.hls.trigger(Gn.ERROR,{type:Kn.MEDIA_ERROR,details:Wn.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:f})}}else this.shouldReloadPlaylist(a)&&this.setAudioTrack(this.trackId)}}},{key:"onError",value:function(e,t){!t.fatal&&t.context&&(t.context.type!==er||t.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(t.context.groupId)||(this.requestScheduled=-1,this.checkRetry(t)))}},{key:"allAudioTracks",get:function(){return this.tracks}},{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}},{key:"setAudioOption",value:function(e){var t=this.hls;if(t.config.audioPreference=e,e){var n=this.allAudioTracks;if(this.selectDefaultTrack=!1,n.length){var i=this.currentTrack;if(i&&fo(e,i,vo))return i;var a=ho(e,this.tracksInGroup,vo);if(a>-1){var r=this.tracksInGroup[a];return this.setAudioTrack(a),r}if(i){var o=t.loadLevel;-1===o&&(o=t.firstAutoLevel);var s=function(e,t,n,i,a){var r=t[i],o=t.reduce((function(e,t,n){var i=t.uri;return(e[i]||(e[i]=[])).push(n),e}),{})[r.uri];o.length>1&&(i=Math.max.apply(Math,o));var s=r.videoRange,l=r.frameRate,u=r.codecSet.substring(0,4),c=mo(t,i,(function(t){if(t.videoRange!==s||t.frameRate!==l||t.codecSet.substring(0,4)!==u)return!1;var i=t.audioGroups,r=n.filter((function(e){return!i||-1!==i.indexOf(e.groupId)}));return ho(e,r,a)>-1}));return c>-1?c:mo(t,i,(function(t){var i=t.audioGroups,r=n.filter((function(e){return!i||-1!==i.indexOf(e.groupId)}));return ho(e,r,a)>-1}))}(e,t.levels,n,o,vo);if(-1===s)return null;t.nextLoadLevel=s}if(e.channels||e.audioCodec){var l=ho(e,n);if(l>-1)return n[l]}}}return null}},{key:"setAudioTrack",value:function(e){var t=this.tracksInGroup;if(e<0||e>=t.length)this.warn("Invalid audio track id: ".concat(e));else{this.clearTimer(),this.selectDefaultTrack=!1;var n=this.currentTrack,i=t[e],a=i.details&&!i.details.live;if((e!==this.trackId||i!==n||!a)&&(this.log("Switching to audio-track ".concat(e,' "').concat(i.name,'" lang:').concat(i.lang," group:").concat(i.groupId," channels:").concat(i.channels)),this.trackId=e,this.currentTrack=i,this.hls.trigger(Gn.AUDIO_TRACK_SWITCHING,On({},i)),!a)){var r=this.switchParams(i.url,null==n?void 0:n.details,i.details);this.loadPlaylist(r)}}}},{key:"findTrackId",value:function(e){for(var t=this.tracksInGroup,n=0;n<t.length;n++){var i=t[n];if((!this.selectDefaultTrack||i.default)&&(!e||fo(e,i,vo)))return n}if(e){for(var a=e.name,r=e.lang,o=e.assocLang,s=e.characteristics,l=e.audioCodec,u=e.channels,c=0;c<t.length;c++){if(fo({name:a,lang:r,assocLang:o,characteristics:s,audioCodec:l,channels:u},t[c],vo))return c}for(var d=0;d<t.length;d++){var h=t[d];if(pl(e.attrs,h.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return d}for(var f=0;f<t.length;f++){var v=t[f];if(pl(e.attrs,v.attrs,["LANGUAGE"]))return f}}return-1}},{key:"loadPlaylist",value:function(e){var t=this.currentTrack;if(this.shouldLoadPlaylist(t)&&t){(0,u.A)((0,c.A)(n.prototype),"loadPlaylist",this).call(this);var i=t.id,a=t.groupId,r=t.url;if(e)try{r=e.addDirectives(r)}catch(o){this.warn("Could not construct new URL with HLS Delivery Directives: ".concat(o))}this.log("loading audio-track playlist ".concat(i,' "').concat(t.name,'" lang:').concat(t.lang," group:").concat(a)),this.clearTimer(),this.hls.trigger(Gn.AUDIO_TRACK_LOADING,{url:r,id:i,groupId:a,deliveryDirectives:e||null})}}}]),n}(io),El=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(e,i,a){var r;return(0,m.A)(this,n),(r=t.call(this,e,i,a,"[subtitle-stream-controller]",ar)).currentTrackId=-1,r.tracksBuffered=[],r.mainDetails=null,r._registerListeners(),r}return(0,v.A)(n,[{key:"onHandlerDestroying",value:function(){this._unregisterListeners(),(0,u.A)((0,c.A)(n.prototype),"onHandlerDestroying",this).call(this),this.mainDetails=null}},{key:"_registerListeners",value:function(){var e=this.hls;e.on(Gn.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Gn.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Gn.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Gn.LEVEL_LOADED,this.onLevelLoaded,this),e.on(Gn.ERROR,this.onError,this),e.on(Gn.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(Gn.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(Gn.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(Gn.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(Gn.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(Gn.FRAG_BUFFERED,this.onFragBuffered,this)}},{key:"_unregisterListeners",value:function(){var e=this.hls;e.off(Gn.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Gn.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Gn.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Gn.LEVEL_LOADED,this.onLevelLoaded,this),e.off(Gn.ERROR,this.onError,this),e.off(Gn.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(Gn.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(Gn.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(Gn.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(Gn.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(Gn.FRAG_BUFFERED,this.onFragBuffered,this)}},{key:"startLoad",value:function(e){this.stopLoad(),this.state=Vo,this.setInterval(500),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}},{key:"onManifestLoading",value:function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}},{key:"onMediaDetaching",value:function(){this.tracksBuffered=[],(0,u.A)((0,c.A)(n.prototype),"onMediaDetaching",this).call(this)}},{key:"onLevelLoaded",value:function(e,t){this.mainDetails=t.details}},{key:"onSubtitleFragProcessed",value:function(e,t){var n=t.frag,i=t.success;if(this.fragPrevious=n,this.state=Vo,i){var a=this.tracksBuffered[this.currentTrackId];if(a){for(var r,o=n.start,s=0;s<a.length;s++)if(o>=a[s].start&&o<=a[s].end){r=a[s];break}var l=n.start+n.duration;r?r.end=l:(r={start:o,end:l},a.push(r)),this.fragmentTracker.fragBuffered(n),this.fragBufferedComplete(n,null)}}}},{key:"onBufferFlushing",value:function(e,t){var n=t.startOffset,i=t.endOffset;if(0===n&&i!==Number.POSITIVE_INFINITY){var a=i-1;if(a<=0)return;t.endOffsetSubtitles=Math.max(0,a),this.tracksBuffered.forEach((function(e){for(var t=0;t<e.length;)if(e[t].end<=a)e.shift();else{if(!(e[t].start<a))break;e[t].start=a,t++}})),this.fragmentTracker.removeFragmentsInRange(n,a,ar)}}},{key:"onFragBuffered",value:function(e,t){var n;this.loadedmetadata||t.frag.type!==nr||null!=(n=this.media)&&n.buffered.length&&(this.loadedmetadata=!0)}},{key:"onError",value:function(e,t){var n=t.frag;(null==n?void 0:n.type)===ar&&(t.details===Wn.FRAG_GAP&&this.fragmentTracker.fragBuffered(n,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==Wo&&(this.state=Vo))}},{key:"onSubtitleTracksUpdated",value:function(e,t){var n=this,i=t.subtitleTracks;this.levels&&ml(this.levels,i)?this.levels=i.map((function(e){return new Ir(e)})):(this.tracksBuffered=[],this.levels=i.map((function(e){var t=new Ir(e);return n.tracksBuffered[t.id]=[],t})),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,ar),this.fragPrevious=null,this.mediaBuffer=null)}},{key:"onSubtitleTrackSwitch",value:function(e,t){var n;if(this.currentTrackId=t.id,null!=(n=this.levels)&&n.length&&-1!==this.currentTrackId){var i=this.levels[this.currentTrackId];null!=i&&i.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,i&&this.setInterval(500)}else this.clearInterval()}},{key:"onSubtitleTrackLoaded",value:function(e,t){var n,i=this.currentTrackId,a=this.levels,r=t.details,o=t.id;if(a){var s=a[o];if(!(o>=a.length)&&s){this.log("Subtitle track ".concat(o," loaded [").concat(r.startSN,",").concat(r.endSN,"]").concat(r.lastPartSn?"[part-".concat(r.lastPartSn,"-").concat(r.lastPartIndex,"]"):"",",duration:").concat(r.totalduration)),this.mediaBuffer=this.mediaBufferTimeRanges;var l=0;if(r.live||null!=(n=s.details)&&n.live){var u=this.mainDetails;if(r.deltaUpdateFailed||!u)return;var c,d=u.fragments[0];if(s.details)0===(l=this.alignPlaylists(r,s.details,null==(c=this.levelLastLoaded)?void 0:c.details))&&d&&Pr(r,l=d.start);else r.hasProgramDateTime&&u.hasProgramDateTime?(xo(r,u),l=r.fragments[0].start):d&&Pr(r,l=d.start)}if(s.details=r,this.levelLastLoaded=s,o===i)if(this.startFragRequested||!this.mainDetails&&r.live||this.setStartPosition(this.mainDetails||r,l),this.tick(),r.live&&!this.fragCurrent&&this.media&&this.state===Vo)qr(null,r.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),s.details=void 0)}}else this.warn("Subtitle tracks were reset while loading level ".concat(o))}},{key:"_handleFragmentLoadComplete",value:function(e){var t=this,n=e.frag,i=e.payload,a=n.decryptdata,r=this.hls;if(!this.fragContextChanged(n)&&i&&i.byteLength>0&&null!=a&&a.key&&a.iv&&"AES-128"===a.method){var o=performance.now();this.decrypter.decrypt(new Uint8Array(i),a.key.buffer,a.iv.buffer).catch((function(e){throw r.trigger(Gn.ERROR,{type:Kn.MEDIA_ERROR,details:Wn.FRAG_DECRYPT_ERROR,fatal:!1,error:e,reason:e.message,frag:n}),e})).then((function(e){var t=performance.now();r.trigger(Gn.FRAG_DECRYPTED,{frag:n,payload:e,stats:{tstart:o,tdecrypt:t}})})).catch((function(e){t.warn("".concat(e.name,": ").concat(e.message)),t.state=Vo}))}}},{key:"doTick",value:function(){if(this.media){if(this.state===Vo){var e=this.currentTrackId,t=this.levels,n=null==t?void 0:t[e];if(!n||!t.length||!n.details)return;var i=this.config,a=this.getLoadPosition(),r=wo.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],a,i.maxBufferHole),o=r.end,s=r.len,l=this.getFwdBufferInfo(this.media,nr),u=n.details;if(s>this.getMaxBufferLength(null==l?void 0:l.len)+u.levelTargetDuration)return;var c=u.fragments,d=c.length,h=u.edge,f=null,v=this.fragPrevious;if(o<h){var m=i.maxFragLookUpTolerance,p=o>h-m?0:m;!(f=qr(v,c,Math.max(c[0].start,o),p))&&v&&v.start<c[0].start&&(f=c[0])}else f=c[d-1];if(!f)return;if("initSegment"!==(f=this.mapToInitFragWhenRequired(f)).sn){var g=c[f.sn-u.startSN-1];g&&g.cc===f.cc&&this.fragmentTracker.getState(g)===yo&&(f=g)}this.fragmentTracker.getState(f)===yo&&this.loadFragment(f,n,o)}}else this.state=Vo}},{key:"getMaxBufferLength",value:function(e){var t=(0,u.A)((0,c.A)(n.prototype),"getMaxBufferLength",this).call(this);return e?Math.max(t,e):t}},{key:"loadFragment",value:function(e,t,i){this.fragCurrent=e,"initSegment"===e.sn?this._loadInitSegment(e,t):(this.startFragRequested=!0,(0,u.A)((0,c.A)(n.prototype),"loadFragment",this).call(this,e,t,i))}},{key:"mediaBufferTimeRanges",get:function(){return new Al(this.tracksBuffered[this.currentTrackId]||[])}}]),n}(ts),Al=(0,v.A)((function e(t){(0,m.A)(this,e),this.buffered=void 0;var n=function(e,n,i){if((n>>>=0)>i-1)throw new DOMException("Failed to execute '".concat(e,"' on 'TimeRanges': The index provided (").concat(n,") is greater than the maximum bound (").concat(i,")"));return t[n][e]};this.buffered={get length(){return t.length},end:function(e){return n("end",e,t.length)},start:function(e){return n("start",e,t.length)}}})),bl=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(e){var i;return(0,m.A)(this,n),(i=t.call(this,e,"[subtitle-track-controller]")).media=null,i.tracks=[],i.groupIds=null,i.tracksInGroup=[],i.trackId=-1,i.currentTrack=null,i.selectDefaultTrack=!0,i.queuedDefaultTrack=-1,i.asyncPollTrackChange=function(){return i.pollTrackChange(0)},i.useTextTrackPolling=!1,i.subtitlePollingInterval=-1,i._subtitleDisplay=!0,i.onTextTracksChanged=function(){if(i.useTextTrackPolling||self.clearInterval(i.subtitlePollingInterval),i.media&&i.hls.config.renderTextTracksNatively){for(var e=null,t=hr(i.media.textTracks),n=0;n<t.length;n++)if("hidden"===t[n].mode)e=t[n];else if("showing"===t[n].mode){e=t[n];break}var a=i.findTrackForTextTrack(e);i.subtitleTrack!==a&&i.setSubtitleTrack(a)}},i.registerListeners(),i}return(0,v.A)(n,[{key:"destroy",value:function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,(0,u.A)((0,c.A)(n.prototype),"destroy",this).call(this)}},{key:"subtitleDisplay",get:function(){return this._subtitleDisplay},set:function(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}},{key:"registerListeners",value:function(){var e=this.hls;e.on(Gn.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Gn.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Gn.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Gn.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Gn.LEVEL_LOADING,this.onLevelLoading,this),e.on(Gn.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(Gn.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(Gn.ERROR,this.onError,this)}},{key:"unregisterListeners",value:function(){var e=this.hls;e.off(Gn.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Gn.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Gn.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Gn.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Gn.LEVEL_LOADING,this.onLevelLoading,this),e.off(Gn.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(Gn.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(Gn.ERROR,this.onError,this)}},{key:"onMediaAttached",value:function(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}},{key:"pollTrackChange",value:function(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}},{key:"onMediaDetaching",value:function(){this.media&&(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),hr(this.media.textTracks).forEach((function(e){cr(e)})),this.subtitleTrack=-1,this.media=null)}},{key:"onManifestLoading",value:function(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}},{key:"onManifestParsed",value:function(e,t){this.tracks=t.subtitleTracks}},{key:"onSubtitleTrackLoaded",value:function(e,t){var n=t.id,i=t.groupId,a=t.details,r=this.tracksInGroup[n];if(r&&r.groupId===i){var o=r.details;r.details=t.details,this.log("Subtitle track ".concat(n,' "').concat(r.name,'" lang:').concat(r.lang," group:").concat(i," loaded [").concat(a.startSN,"-").concat(a.endSN,"]")),n===this.trackId&&this.playlistLoaded(n,t,o)}else this.warn("Subtitle track with id:".concat(n," and group:").concat(i," not found in active group ").concat(null==r?void 0:r.groupId))}},{key:"onLevelLoading",value:function(e,t){this.switchLevel(t.level)}},{key:"onLevelSwitching",value:function(e,t){this.switchLevel(t.level)}},{key:"switchLevel",value:function(e){var t=this.hls.levels[e];if(t){var n=t.subtitleGroups||null,i=this.groupIds,a=this.currentTrack;if(!n||(null==i?void 0:i.length)!==(null==n?void 0:n.length)||null!=n&&n.some((function(e){return-1===(null==i?void 0:i.indexOf(e))}))){this.groupIds=n,this.trackId=-1,this.currentTrack=null;var r=this.tracks.filter((function(e){return!n||-1!==n.indexOf(e.groupId)}));if(r.length)this.selectDefaultTrack&&!r.some((function(e){return e.default}))&&(this.selectDefaultTrack=!1),r.forEach((function(e,t){e.id=t}));else if(!a&&!this.tracksInGroup.length)return;this.tracksInGroup=r;var o=this.hls.config.subtitlePreference;if(!a&&o){this.selectDefaultTrack=!1;var s=ho(o,r);if(s>-1)a=r[s];else{var l=ho(o,this.tracks);a=this.tracks[l]}}var u=this.findTrackId(a);-1===u&&a&&(u=this.findTrackId(null));var c={subtitleTracks:r};this.log("Updating subtitle tracks, ".concat(r.length,' track(s) found in "').concat(null==n?void 0:n.join(","),'" group-id')),this.hls.trigger(Gn.SUBTITLE_TRACKS_UPDATED,c),-1!==u&&-1===this.trackId&&this.setSubtitleTrack(u)}else this.shouldReloadPlaylist(a)&&this.setSubtitleTrack(this.trackId)}}},{key:"findTrackId",value:function(e){for(var t=this.tracksInGroup,n=this.selectDefaultTrack,i=0;i<t.length;i++){var a=t[i];if((!n||a.default)&&(n||e)&&(!e||fo(a,e)))return i}if(e){for(var r=0;r<t.length;r++){var o=t[r];if(pl(e.attrs,o.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return r}for(var s=0;s<t.length;s++){var l=t[s];if(pl(e.attrs,l.attrs,["LANGUAGE"]))return s}}return-1}},{key:"findTrackForTextTrack",value:function(e){if(e)for(var t=this.tracksInGroup,n=0;n<t.length;n++){if(gl(t[n],e))return n}return-1}},{key:"onError",value:function(e,t){!t.fatal&&t.context&&(t.context.type!==tr||t.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(t.context.groupId)||this.checkRetry(t))}},{key:"allSubtitleTracks",get:function(){return this.tracks}},{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}},{key:"setSubtitleOption",value:function(e){if(this.hls.config.subtitlePreference=e,e){var t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){var n=this.currentTrack;if(n&&fo(e,n))return n;var i=ho(e,this.tracksInGroup);if(i>-1){var a=this.tracksInGroup[i];return this.setSubtitleTrack(i),a}if(n)return null;var r=ho(e,t);if(r>-1)return t[r]}}return null}},{key:"loadPlaylist",value:function(e){(0,u.A)((0,c.A)(n.prototype),"loadPlaylist",this).call(this);var t=this.currentTrack;if(this.shouldLoadPlaylist(t)&&t){var i=t.id,a=t.groupId,r=t.url;if(e)try{r=e.addDirectives(r)}catch(o){this.warn("Could not construct new URL with HLS Delivery Directives: ".concat(o))}this.log("Loading subtitle playlist for id ".concat(i)),this.hls.trigger(Gn.SUBTITLE_TRACK_LOADING,{url:r,id:i,groupId:a,deliveryDirectives:e||null})}}},{key:"toggleTrackModes",value:function(){var e=this.media;if(e){var t,n=hr(e.textTracks),i=this.currentTrack;if(i&&((t=n.filter((function(e){return gl(i,e)}))[0])||this.warn('Unable to find subtitle TextTrack with name "'.concat(i.name,'" and language "').concat(i.lang,'"'))),[].slice.call(n).forEach((function(e){"disabled"!==e.mode&&e!==t&&(e.mode="disabled")})),t){var a=this.subtitleDisplay?"showing":"hidden";t.mode!==a&&(t.mode=a)}}}},{key:"setSubtitleTrack",value:function(e){var t=this.tracksInGroup;if(this.media)if(e<-1||e>=t.length||!Fn(e))this.warn("Invalid subtitle track id: ".concat(e));else{this.clearTimer(),this.selectDefaultTrack=!1;var n=this.currentTrack,i=t[e]||null;if(this.trackId=e,this.currentTrack=i,this.toggleTrackModes(),i){var a=!!i.details&&!i.details.live;if(e!==this.trackId||i!==n||!a){this.log("Switching to subtitle-track ".concat(e)+(i?' "'.concat(i.name,'" lang:').concat(i.lang," group:").concat(i.groupId):""));var r=i.id,o=i.groupId,s=void 0===o?"":o,l=i.name,u=i.type,c=i.url;this.hls.trigger(Gn.SUBTITLE_TRACK_SWITCH,{id:r,groupId:s,name:l,type:u,url:c});var d=this.switchParams(i.url,null==n?void 0:n.details,i.details);this.loadPlaylist(d)}}else this.hls.trigger(Gn.SUBTITLE_TRACK_SWITCH,{id:e})}else this.queuedDefaultTrack=e}}]),n}(io),kl=function(){function e(t){(0,m.A)(this,e),this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=t}return(0,v.A)(e,[{key:"append",value:function(e,t,n){var i=this.queues[t];i.push(e),1!==i.length||n||this.executeNext(t)}},{key:"insertAbort",value:function(e,t){this.queues[t].unshift(e),this.executeNext(t)}},{key:"appendBlocker",value:function(e){var t,n=new Promise((function(e){t=e})),i={execute:t,onStart:function(){},onComplete:function(){},onError:function(){}};return this.append(i,e),n}},{key:"executeNext",value:function(e){var t=this.queues[e];if(t.length){var n=t[0];try{n.execute()}catch(a){Xn.warn('[buffer-operation-queue]: Exception executing "'.concat(e,'" SourceBuffer operation: ').concat(a)),n.onError(a);var i=this.buffers[e];null!=i&&i.updating||this.shiftAndExecuteNext(e)}}}},{key:"shiftAndExecuteNext",value:function(e){this.queues[e].shift(),this.executeNext(e)}},{key:"current",value:function(e){return this.queues[e][0]}}]),e}(),Tl=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,_l=function(){function e(t){var n=this;(0,m.A)(this,e),this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendSource=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this.log=void 0,this.warn=void 0,this.error=void 0,this._onEndStreaming=function(e){n.hls&&n.hls.pauseBuffering()},this._onStartStreaming=function(e){n.hls&&n.hls.resumeBuffering()},this._onMediaSourceOpen=function(){var e=n.media,t=n.mediaSource;n.log("Media source opened"),e&&(e.removeEventListener("emptied",n._onMediaEmptied),n.updateMediaElementDuration(),n.hls.trigger(Gn.MEDIA_ATTACHED,{media:e,mediaSource:t})),t&&t.removeEventListener("sourceopen",n._onMediaSourceOpen),n.checkPendingTracks()},this._onMediaSourceClose=function(){n.log("Media source closed")},this._onMediaSourceEnded=function(){n.log("Media source ended")},this._onMediaEmptied=function(){var e=n.mediaSrc,t=n._objectUrl;e!==t&&Xn.error("Media element src was set while attaching MediaSource (".concat(t," > ").concat(e,")"))},this.hls=t;var i,a="[buffer-controller]";this.appendSource=(i=Ra(t.config.preferManagedMediaSource),"undefined"!==typeof self&&i===self.ManagedMediaSource),this.log=Xn.log.bind(Xn,a),this.warn=Xn.warn.bind(Xn,a),this.error=Xn.error.bind(Xn,a),this._initSourceBuffer(),this.registerListeners()}return(0,v.A)(e,[{key:"hasSourceTypes",value:function(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}},{key:"destroy",value:function(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null,this.hls=null}},{key:"registerListeners",value:function(){var e=this.hls;e.on(Gn.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(Gn.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Gn.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Gn.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Gn.BUFFER_RESET,this.onBufferReset,this),e.on(Gn.BUFFER_APPENDING,this.onBufferAppending,this),e.on(Gn.BUFFER_CODECS,this.onBufferCodecs,this),e.on(Gn.BUFFER_EOS,this.onBufferEos,this),e.on(Gn.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(Gn.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(Gn.FRAG_PARSED,this.onFragParsed,this),e.on(Gn.FRAG_CHANGED,this.onFragChanged,this)}},{key:"unregisterListeners",value:function(){var e=this.hls;e.off(Gn.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(Gn.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Gn.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Gn.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Gn.BUFFER_RESET,this.onBufferReset,this),e.off(Gn.BUFFER_APPENDING,this.onBufferAppending,this),e.off(Gn.BUFFER_CODECS,this.onBufferCodecs,this),e.off(Gn.BUFFER_EOS,this.onBufferEos,this),e.off(Gn.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(Gn.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(Gn.FRAG_PARSED,this.onFragParsed,this),e.off(Gn.FRAG_CHANGED,this.onFragChanged,this)}},{key:"_initSourceBuffer",value:function(){this.sourceBuffer={},this.operationQueue=new kl(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.appendErrors={audio:0,video:0,audiovideo:0},this.lastMpegAudioChunk=null}},{key:"onManifestLoading",value:function(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}},{key:"onManifestParsed",value:function(e,t){var n=2;(t.audio&&!t.video||!t.altAudio)&&(n=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=n,this.log("".concat(this.bufferCodecEventsExpected," bufferCodec event(s) expected"))}},{key:"onMediaAttaching",value:function(e,t){var n=this.media=t.media,i=Ra(this.appendSource);if(n&&i){var a,r=this.mediaSource=new i;this.log("created media source: ".concat(null==(a=r.constructor)?void 0:a.name)),r.addEventListener("sourceopen",this._onMediaSourceOpen),r.addEventListener("sourceended",this._onMediaSourceEnded),r.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(r.addEventListener("startstreaming",this._onStartStreaming),r.addEventListener("endstreaming",this._onEndStreaming));var o=this._objectUrl=self.URL.createObjectURL(r);if(this.appendSource)try{n.removeAttribute("src");var s=self.ManagedMediaSource;n.disableRemotePlayback=n.disableRemotePlayback||s&&r instanceof s,Sl(n),function(e,t){var n=self.document.createElement("source");n.type="video/mp4",n.src=t,e.appendChild(n)}(n,o),n.load()}catch(l){n.src=o}else n.src=o;n.addEventListener("emptied",this._onMediaEmptied)}}},{key:"onMediaDetaching",value:function(){var e=this.media,t=this.mediaSource,n=this._objectUrl;if(t){if(this.log("media source detaching"),"open"===t.readyState)try{t.endOfStream()}catch(BL){this.warn("onMediaDetaching: ".concat(BL.message," while calling endOfStream"))}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(t.removeEventListener("startstreaming",this._onStartStreaming),t.removeEventListener("endstreaming",this._onEndStreaming)),e&&(e.removeEventListener("emptied",this._onMediaEmptied),n&&self.URL.revokeObjectURL(n),this.mediaSrc===n?(e.removeAttribute("src"),this.appendSource&&Sl(e),e.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(Gn.MEDIA_DETACHED,void 0)}},{key:"onBufferReset",value:function(){var e=this;this.getSourceBufferTypes().forEach((function(t){e.resetBuffer(t)})),this._initSourceBuffer(),this.hls.resumeBuffering()}},{key:"resetBuffer",value:function(e){var t=this.sourceBuffer[e];try{var n;if(t)this.removeBufferListeners(e),this.sourceBuffer[e]=void 0,null!=(n=this.mediaSource)&&n.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(t)}catch(BL){this.warn("onBufferReset ".concat(e),BL)}}},{key:"onBufferCodecs",value:function(e,t){var n=this,i=this.getSourceBufferTypes().length,a=Object.keys(t);if(a.forEach((function(e){if(i){var a=n.tracks[e];if(a&&"function"===typeof a.buffer.changeType){var r,o=t[e],s=o.id,l=o.codec,u=o.levelCodec,c=o.container,d=o.metadata,h=Fa(a.codec,a.levelCodec),f=null==h?void 0:h.replace(Tl,"$1"),v=Fa(l,u),m=null==(r=v)?void 0:r.replace(Tl,"$1");if(v&&f!==m){"audio"===e.slice(0,5)&&(v=Ua(v,n.appendSource));var p="".concat(c,";codecs=").concat(v);n.appendChangeType(e,p),n.log("switching codec ".concat(h," to ").concat(v)),n.tracks[e]={buffer:a.buffer,codec:l,container:c,levelCodec:u,metadata:d,id:s}}}}else n.pendingTracks[e]=t[e]})),!i){var r=Math.max(this.bufferCodecEventsExpected-1,0);this.bufferCodecEventsExpected!==r&&(this.log("".concat(r," bufferCodec event(s) expected ").concat(a.join(","))),this.bufferCodecEventsExpected=r),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks()}}},{key:"appendChangeType",value:function(e,t){var n=this,i=this.operationQueue,a={execute:function(){var a=n.sourceBuffer[e];a&&(n.log("changing ".concat(e," sourceBuffer type to ").concat(t)),a.changeType(t)),i.shiftAndExecuteNext(e)},onStart:function(){},onComplete:function(){},onError:function(t){n.warn("Failed to change ".concat(e," SourceBuffer type"),t)}};i.append(a,e,!!this.pendingTracks[e])}},{key:"onBufferAppending",value:function(e,t){var n=this,i=this.hls,a=this.operationQueue,r=this.tracks,o=t.data,s=t.type,l=t.frag,u=t.part,c=t.chunkMeta,d=c.buffering[s],h=self.performance.now();d.start=h;var f=l.stats.buffering,v=u?u.stats.buffering:null;0===f.start&&(f.start=h),v&&0===v.start&&(v.start=h);var m=r.audio,p=!1;"audio"===s&&"audio/mpeg"===(null==m?void 0:m.container)&&(p=!this.lastMpegAudioChunk||1===c.id||this.lastMpegAudioChunk.sn!==c.sn,this.lastMpegAudioChunk=c);var g=l.start,y={execute:function(){if(d.executeStart=self.performance.now(),p){var e=n.sourceBuffer[s];if(e){var t=g-e.timestampOffset;Math.abs(t)>=.1&&(n.log("Updating audio SourceBuffer timestampOffset to ".concat(g," (delta: ").concat(t,") sn: ").concat(l.sn,")")),e.timestampOffset=g)}}n.appendExecutor(o,s)},onStart:function(){},onComplete:function(){var e=self.performance.now();d.executeEnd=d.end=e,0===f.first&&(f.first=e),v&&0===v.first&&(v.first=e);var t=n.sourceBuffer,i={};for(var a in t)i[a]=wo.getBuffered(t[a]);n.appendErrors[s]=0,"audio"===s||"video"===s?n.appendErrors.audiovideo=0:(n.appendErrors.audio=0,n.appendErrors.video=0),n.hls.trigger(Gn.BUFFER_APPENDED,{type:s,frag:l,part:u,chunkMeta:c,parent:l.type,timeRanges:i})},onError:function(e){var t={type:Kn.MEDIA_ERROR,parent:l.type,details:Wn.BUFFER_APPEND_ERROR,sourceBufferName:s,frag:l,part:u,chunkMeta:c,error:e,err:e,fatal:!1};if(e.code===DOMException.QUOTA_EXCEEDED_ERR)t.details=Wn.BUFFER_FULL_ERROR;else{var a=++n.appendErrors[s];t.details=Wn.BUFFER_APPEND_ERROR,n.warn("Failed ".concat(a,"/").concat(i.config.appendErrorMaxRetry,' times to append segment in "').concat(s,'" sourceBuffer')),a>=i.config.appendErrorMaxRetry&&(t.fatal=!0)}i.trigger(Gn.ERROR,t)}};a.append(y,s,!!this.pendingTracks[s])}},{key:"onBufferFlushing",value:function(e,t){var n=this,i=this.operationQueue,a=function(e){return{execute:n.removeExecutor.bind(n,e,t.startOffset,t.endOffset),onStart:function(){},onComplete:function(){n.hls.trigger(Gn.BUFFER_FLUSHED,{type:e})},onError:function(t){n.warn("Failed to remove from ".concat(e," SourceBuffer"),t)}}};t.type?i.append(a(t.type),t.type):this.getSourceBufferTypes().forEach((function(e){i.append(a(e),e)}))}},{key:"onFragParsed",value:function(e,t){var n=this,i=t.frag,a=t.part,r=[],o=a?a.elementaryStreams:i.elementaryStreams;o[ai]?r.push("audiovideo"):(o[ni]&&r.push("audio"),o[ii]&&r.push("video"));0===r.length&&this.warn("Fragments must have at least one ElementaryStreamType set. type: ".concat(i.type," level: ").concat(i.level," sn: ").concat(i.sn)),this.blockBuffers((function(){var e=self.performance.now();i.stats.buffering.end=e,a&&(a.stats.buffering.end=e);var t=a?a.stats:i.stats;n.hls.trigger(Gn.FRAG_BUFFERED,{frag:i,part:a,stats:t,id:i.type})}),r)}},{key:"onFragChanged",value:function(e,t){this.trimBuffers()}},{key:"onBufferEos",value:function(e,t){var n=this;this.getSourceBufferTypes().reduce((function(e,i){var a=n.sourceBuffer[i];return!a||t.type&&t.type!==i||(a.ending=!0,a.ended||(a.ended=!0,n.log("".concat(i," sourceBuffer now EOS")))),e&&!(a&&!a.ended)}),!0)&&(this.log("Queueing mediaSource.endOfStream()"),this.blockBuffers((function(){n.getSourceBufferTypes().forEach((function(e){var t=n.sourceBuffer[e];t&&(t.ending=!1)}));var e=n.mediaSource;e&&"open"===e.readyState?(n.log("Calling mediaSource.endOfStream()"),e.endOfStream()):e&&n.log("Could not call mediaSource.endOfStream(). mediaSource.readyState: ".concat(e.readyState))})))}},{key:"onLevelUpdated",value:function(e,t){var n=t.details;n.fragments.length&&(this.details=n,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}},{key:"trimBuffers",value:function(){var e=this.hls,t=this.details,n=this.media;if(n&&null!==t&&this.getSourceBufferTypes().length){var i=e.config,a=n.currentTime,r=t.levelTargetDuration,o=t.live&&null!==i.liveBackBufferLength?i.liveBackBufferLength:i.backBufferLength;if(Fn(o)&&o>0){var s=Math.max(o,r),l=Math.floor(a/r)*r-s;this.flushBackBuffer(a,r,l)}if(Fn(i.frontBufferFlushThreshold)&&i.frontBufferFlushThreshold>0){var u=Math.max(i.maxBufferLength,i.frontBufferFlushThreshold),c=Math.max(u,r),d=Math.floor(a/r)*r+c;this.flushFrontBuffer(a,r,d)}}}},{key:"flushBackBuffer",value:function(e,t,n){var i=this,a=this.details,r=this.sourceBuffer;this.getSourceBufferTypes().forEach((function(o){var s=r[o];if(s){var l=wo.getBuffered(s);if(l.length>0&&n>l.start(0)){if(i.hls.trigger(Gn.BACK_BUFFER_REACHED,{bufferEnd:n}),null!=a&&a.live)i.hls.trigger(Gn.LIVE_BACK_BUFFER_REACHED,{bufferEnd:n});else if(s.ended&&l.end(l.length-1)-e<2*t)return void i.log("Cannot flush ".concat(o," back buffer while SourceBuffer is in ended state"));i.hls.trigger(Gn.BUFFER_FLUSHING,{startOffset:0,endOffset:n,type:o})}}}))}},{key:"flushFrontBuffer",value:function(e,t,n){var i=this,a=this.sourceBuffer;this.getSourceBufferTypes().forEach((function(r){var o=a[r];if(o){var s=wo.getBuffered(o),l=s.length;if(l<2)return;var u=s.start(l-1),c=s.end(l-1);if(n>u||e>=u&&e<=c)return;if(o.ended&&e-c<2*t)return void i.log("Cannot flush ".concat(r," front buffer while SourceBuffer is in ended state"));i.hls.trigger(Gn.BUFFER_FLUSHING,{startOffset:u,endOffset:1/0,type:r})}}))}},{key:"updateMediaElementDuration",value:function(){if(this.details&&this.media&&this.mediaSource&&"open"===this.mediaSource.readyState){var e=this.details,t=this.hls,n=this.media,i=this.mediaSource,a=e.fragments[0].start+e.totalduration,r=n.duration,o=Fn(i.duration)?i.duration:0;e.live&&t.config.liveDurationInfinity?(i.duration=1/0,this.updateSeekableRange(e)):(a>o&&a>r||!Fn(r))&&(this.log("Updating Media Source duration to ".concat(a.toFixed(3))),i.duration=a)}}},{key:"updateSeekableRange",value:function(e){var t=this.mediaSource,n=e.fragments;if(n.length&&e.live&&null!=t&&t.setLiveSeekableRange){var i=Math.max(0,n[0].start),a=Math.max(i,i+e.totalduration);this.log("Media Source duration is set to ".concat(t.duration,". Setting seekable range to ").concat(i,"-").concat(a,".")),t.setLiveSeekableRange(i,a)}}},{key:"checkPendingTracks",value:function(){var e=this.bufferCodecEventsExpected,t=this.operationQueue,n=this.pendingTracks,i=Object.keys(n).length;if(i&&(!e||2===i||"audiovideo"in n)){this.createSourceBuffers(n),this.pendingTracks={};var a=this.getSourceBufferTypes();if(a.length)this.hls.trigger(Gn.BUFFER_CREATED,{tracks:this.tracks}),a.forEach((function(e){t.executeNext(e)}));else{var r=new Error("could not create source buffer for media codec(s)");this.hls.trigger(Gn.ERROR,{type:Kn.MEDIA_ERROR,details:Wn.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:r,reason:r.message})}}}},{key:"createSourceBuffers",value:function(e){var t=this,n=this.sourceBuffer,i=this.mediaSource;if(!i)throw Error("createSourceBuffers called when mediaSource was null");var a=function(a){if(!n[a]){var r=e[a];if(!r)throw Error("source buffer exists for track ".concat(a,", however track does not"));var s=-1===(null==(o=r.levelCodec)?void 0:o.indexOf(","))?r.levelCodec:r.codec;s&&"audio"===a.slice(0,5)&&(s=Ua(s,t.appendSource));var l="".concat(r.container,";codecs=").concat(s);t.log("creating sourceBuffer(".concat(l,")"));try{var u=n[a]=i.addSourceBuffer(l),c=a;t.addBufferListener(c,"updatestart",t._onSBUpdateStart),t.addBufferListener(c,"updateend",t._onSBUpdateEnd),t.addBufferListener(c,"error",t._onSBUpdateError),t.appendSource&&t.addBufferListener(c,"bufferedchange",(function(e,n){var i=n.removedRanges;null!=i&&i.length&&t.hls.trigger(Gn.BUFFER_FLUSHED,{type:a})})),t.tracks[a]={buffer:u,codec:s,container:r.container,levelCodec:r.levelCodec,metadata:r.metadata,id:r.id}}catch(BL){t.error("error while trying to add sourceBuffer: ".concat(BL.message)),t.hls.trigger(Gn.ERROR,{type:Kn.MEDIA_ERROR,details:Wn.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:BL,sourceBufferName:a,mimeType:l})}}};for(var r in e){var o;a(r)}}},{key:"mediaSrc",get:function(){var e,t,n=(null==(e=this.media)||null==(t=e.querySelector)?void 0:t.call(e,"source"))||this.media;return null==n?void 0:n.src}},{key:"_onSBUpdateStart",value:function(e){this.operationQueue.current(e).onStart()}},{key:"_onSBUpdateEnd",value:function(e){var t;if("closed"!==(null==(t=this.mediaSource)?void 0:t.readyState)){var n=this.operationQueue;n.current(e).onComplete(),n.shiftAndExecuteNext(e)}else this.resetBuffer(e)}},{key:"_onSBUpdateError",value:function(e,t){var n,i=new Error("".concat(e," SourceBuffer error. MediaSource readyState: ").concat(null==(n=this.mediaSource)?void 0:n.readyState));this.error("".concat(i),t),this.hls.trigger(Gn.ERROR,{type:Kn.MEDIA_ERROR,details:Wn.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:i,fatal:!1});var a=this.operationQueue.current(e);a&&a.onError(i)}},{key:"removeExecutor",value:function(e,t,n){var i=this.media,a=this.mediaSource,r=this.operationQueue,o=this.sourceBuffer[e];if(!i||!a||!o)return this.warn("Attempting to remove from the ".concat(e," SourceBuffer, but it does not exist")),void r.shiftAndExecuteNext(e);var s=Fn(i.duration)?i.duration:1/0,l=Fn(a.duration)?a.duration:1/0,u=Math.max(0,t),c=Math.min(n,s,l);c>u&&(!o.ending||o.ended)?(o.ended=!1,this.log("Removing [".concat(u,",").concat(c,"] from the ").concat(e," SourceBuffer")),o.remove(u,c)):r.shiftAndExecuteNext(e)}},{key:"appendExecutor",value:function(e,t){var n=this.sourceBuffer[t];if(n)n.ended=!1,n.appendBuffer(e);else if(!this.pendingTracks[t])throw new Error("Attempting to append to the ".concat(t," SourceBuffer, but it does not exist"))}},{key:"blockBuffers",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getSourceBufferTypes();if(!n.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),void Promise.resolve().then(e);var i=this.operationQueue,a=n.map((function(e){return i.appendBlocker(e)}));Promise.all(a).then((function(){e(),n.forEach((function(e){var n=t.sourceBuffer[e];null!=n&&n.updating||i.shiftAndExecuteNext(e)}))}))}},{key:"getSourceBufferTypes",value:function(){return Object.keys(this.sourceBuffer)}},{key:"addBufferListener",value:function(e,t,n){var i=this.sourceBuffer[e];if(i){var a=n.bind(this,e);this.listeners[e].push({event:t,listener:a}),i.addEventListener(t,a)}}},{key:"removeBufferListeners",value:function(e){var t=this.sourceBuffer[e];t&&this.listeners[e].forEach((function(e){t.removeEventListener(e.event,e.listener)}))}}]),e}();function Sl(e){var t=e.querySelectorAll("source");[].slice.call(t).forEach((function(t){e.removeChild(t)}))}var wl={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},Rl=function(e){return String.fromCharCode(wl[e]||e)},Ll=15,Il=100,Dl={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},Cl={17:2,18:4,21:6,22:8,23:10,19:13,20:15},xl={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},Ml={25:2,26:4,29:6,30:8,31:10,27:13,28:15},Ol=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],Pl=function(){function e(){(0,m.A)(this,e),this.time=null,this.verboseLevel=0}return(0,v.A)(e,[{key:"log",value:function(e,t){if(this.verboseLevel>=e){var n="function"===typeof t?t():t;Xn.log("".concat(this.time," [").concat(e,"] ").concat(n))}}}]),e}(),Nl=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].toString(16));return t},Ul=function(){function e(){(0,m.A)(this,e),this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}return(0,v.A)(e,[{key:"reset",value:function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}},{key:"setStyles",value:function(e){for(var t=["foreground","underline","italics","background","flash"],n=0;n<t.length;n++){var i=t[n];e.hasOwnProperty(i)&&(this[i]=e[i])}}},{key:"isDefault",value:function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}},{key:"equals",value:function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}},{key:"copy",value:function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}},{key:"toString",value:function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}]),e}(),Fl=function(){function e(){(0,m.A)(this,e),this.uchar=" ",this.penState=new Ul}return(0,v.A)(e,[{key:"reset",value:function(){this.uchar=" ",this.penState.reset()}},{key:"setChar",value:function(e,t){this.uchar=e,this.penState.copy(t)}},{key:"setPenState",value:function(e){this.penState.copy(e)}},{key:"equals",value:function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}},{key:"copy",value:function(e){this.uchar=e.uchar,this.penState.copy(e.penState)}},{key:"isEmpty",value:function(){return" "===this.uchar&&this.penState.isDefault()}}]),e}(),Bl=function(){function e(t){(0,m.A)(this,e),this.chars=[],this.pos=0,this.currPenState=new Ul,this.cueStartTime=null,this.logger=void 0;for(var n=0;n<Il;n++)this.chars.push(new Fl);this.logger=t}return(0,v.A)(e,[{key:"equals",value:function(e){for(var t=0;t<Il;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}},{key:"copy",value:function(e){for(var t=0;t<Il;t++)this.chars[t].copy(e.chars[t])}},{key:"isEmpty",value:function(){for(var e=!0,t=0;t<Il;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}},{key:"setCursor",value:function(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>Il&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=Il)}},{key:"moveCursor",value:function(e){var t=this.pos+e;if(e>1)for(var n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)}},{key:"backSpace",value:function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}},{key:"insertChar",value:function(e){var t=this;e>=144&&this.backSpace();var n=Rl(e);this.pos>=Il?this.logger.log(0,(function(){return"Cannot insert "+e.toString(16)+" ("+n+") at position "+t.pos+". Skipping it!"})):(this.chars[this.pos].setChar(n,this.currPenState),this.moveCursor(1))}},{key:"clearFromPos",value:function(e){var t;for(t=e;t<Il;t++)this.chars[t].reset()}},{key:"clear",value:function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}},{key:"clearToEndOfRow",value:function(){this.clearFromPos(this.pos)}},{key:"getTextString",value:function(){for(var e=[],t=!0,n=0;n<Il;n++){var i=this.chars[n].uchar;" "!==i&&(t=!1),e.push(i)}return t?"":e.join("")}},{key:"setPenStyles",value:function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}]),e}(),Hl=function(){function e(t){(0,m.A)(this,e),this.rows=[],this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(var n=0;n<Ll;n++)this.rows.push(new Bl(t));this.logger=t}return(0,v.A)(e,[{key:"reset",value:function(){for(var e=0;e<Ll;e++)this.rows[e].clear();this.currRow=14}},{key:"equals",value:function(e){for(var t=!0,n=0;n<Ll;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t}},{key:"copy",value:function(e){for(var t=0;t<Ll;t++)this.rows[t].copy(e.rows[t])}},{key:"isEmpty",value:function(){for(var e=!0,t=0;t<Ll;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}},{key:"backSpace",value:function(){this.rows[this.currRow].backSpace()}},{key:"clearToEndOfRow",value:function(){this.rows[this.currRow].clearToEndOfRow()}},{key:"insertChar",value:function(e){this.rows[this.currRow].insertChar(e)}},{key:"setPen",value:function(e){this.rows[this.currRow].setPenStyles(e)}},{key:"moveCursor",value:function(e){this.rows[this.currRow].moveCursor(e)}},{key:"setCursor",value:function(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}},{key:"setPAC",value:function(e){this.logger.log(2,(function(){return"pacData = "+JSON.stringify(e)}));var t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(var n=0;n<Ll;n++)this.rows[n].clear();var i=this.currRow+1-this.nrRollUpRows,a=this.lastOutputScreen;if(a){var r=a.rows[i].cueStartTime,o=this.logger.time;if(null!==r&&null!==o&&r<o)for(var s=0;s<this.nrRollUpRows;s++)this.rows[t-this.nrRollUpRows+s+1].copy(a.rows[i+s])}}this.currRow=t;var l=this.rows[this.currRow];if(null!==e.indent){var u=e.indent,c=Math.max(u-1,0);l.setCursor(e.indent),e.color=l.chars[c].penState.foreground}var d={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(d)}},{key:"setBkgData",value:function(e){this.logger.log(2,(function(){return"bkgData = "+JSON.stringify(e)})),this.backSpace(),this.setPen(e),this.insertChar(32)}},{key:"setRollUpRows",value:function(e){this.nrRollUpRows=e}},{key:"rollUp",value:function(){var e=this;if(null!==this.nrRollUpRows){this.logger.log(1,(function(){return e.getDisplayText()}));var t=this.currRow+1-this.nrRollUpRows,n=this.rows.splice(t,1)[0];n.clear(),this.rows.splice(this.currRow,0,n),this.logger.log(2,"Rolling up")}else this.logger.log(3,"roll_up but nrRollUpRows not set yet")}},{key:"getDisplayText",value:function(e){e=e||!1;for(var t=[],n="",i=-1,a=0;a<Ll;a++){var r=this.rows[a].getTextString();r&&(i=a+1,e?t.push("Row "+i+": '"+r+"'"):t.push(r.trim()))}return t.length>0&&(n=e?"["+t.join(" | ")+"]":t.join("\n")),n}},{key:"getTextAndFormat",value:function(){return this.rows}}]),e}(),Gl=function(){function e(t,n,i){(0,m.A)(this,e),this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=t,this.outputFilter=n,this.mode=null,this.verbose=0,this.displayedMemory=new Hl(i),this.nonDisplayedMemory=new Hl(i),this.lastOutputScreen=new Hl(i),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=i}return(0,v.A)(e,[{key:"reset",value:function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}},{key:"getHandler",value:function(){return this.outputFilter}},{key:"setHandler",value:function(e){this.outputFilter=e}},{key:"setPAC",value:function(e){this.writeScreen.setPAC(e)}},{key:"setBkgData",value:function(e){this.writeScreen.setBkgData(e)}},{key:"setMode",value:function(e){e!==this.mode&&(this.mode=e,this.logger.log(2,(function(){return"MODE="+e})),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}},{key:"insertChars",value:function(e){for(var t=this,n=0;n<e.length;n++)this.writeScreen.insertChar(e[n]);var i=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,(function(){return i+": "+t.writeScreen.getDisplayText(!0)})),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(1,(function(){return"DISPLAYED: "+t.displayedMemory.getDisplayText(!0)})),this.outputDataUpdate())}},{key:"ccRCL",value:function(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}},{key:"ccBS",value:function(){this.logger.log(2,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}},{key:"ccAOF",value:function(){}},{key:"ccAON",value:function(){}},{key:"ccDER",value:function(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}},{key:"ccRU",value:function(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}},{key:"ccFON",value:function(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}},{key:"ccRDC",value:function(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}},{key:"ccTR",value:function(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}},{key:"ccRTD",value:function(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}},{key:"ccEDM",value:function(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}},{key:"ccCR",value:function(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}},{key:"ccENM",value:function(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}},{key:"ccEOC",value:function(){var e=this;if(this.logger.log(2,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var t=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=t,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,(function(){return"DISP: "+e.displayedMemory.getDisplayText()}))}this.outputDataUpdate(!0)}},{key:"ccTO",value:function(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}},{key:"ccMIDROW",value:function(e){var t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{var n=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][n]}this.logger.log(2,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}},{key:"outputDataUpdate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.logger.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))}},{key:"cueSplitAtTime",value:function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}]),e}(),Kl=function(){function e(t,n,i){(0,m.A)(this,e),this.channels=void 0,this.currentChannel=0,this.cmdHistory={a:null,b:null},this.logger=void 0;var a=this.logger=new Pl;this.channels=[null,new Gl(t,n,a),new Gl(t+1,i,a)]}return(0,v.A)(e,[{key:"getHandler",value:function(e){return this.channels[e].getHandler()}},{key:"setHandler",value:function(e,t){this.channels[e].setHandler(t)}},{key:"addData",value:function(e,t){var n=this;this.logger.time=e;for(var i=function(e){var i=127&t[e],a=127&t[e+1],r=!1,o=null;if(0===i&&0===a)return"continue";n.logger.log(3,(function(){return"["+Nl([t[e],t[e+1]])+"] -> ("+Nl([i,a])+")"}));var s=n.cmdHistory;if(i>=16&&i<=31){if(function(e,t,n){return n.a===e&&n.b===t}(i,a,s))return Wl(null,null,s),n.logger.log(3,(function(){return"Repeated command ("+Nl([i,a])+") is dropped"})),"continue";Wl(i,a,n.cmdHistory),(r=n.parseCmd(i,a))||(r=n.parseMidrow(i,a)),r||(r=n.parsePAC(i,a)),r||(r=n.parseBackgroundAttributes(i,a))}else Wl(null,null,s);if(!r&&(o=n.parseChars(i,a))){var l=n.currentChannel;if(l&&l>0)n.channels[l].insertChars(o);else n.logger.log(2,"No channel found yet. TEXT-MODE?")}r||o||n.logger.log(2,(function(){return"Couldn't parse cleaned data "+Nl([i,a])+" orig: "+Nl([t[e],t[e+1]])}))},a=0;a<t.length;a+=2)i(a)}},{key:"parseCmd",value:function(e,t){if(!((20===e||28===e||21===e||29===e)&&t>=32&&t<=47)&&!((23===e||31===e)&&t>=33&&t<=35))return!1;var n=20===e||21===e||23===e?1:2,i=this.channels[n];return 20===e||21===e||28===e||29===e?32===t?i.ccRCL():33===t?i.ccBS():34===t?i.ccAOF():35===t?i.ccAON():36===t?i.ccDER():37===t?i.ccRU(2):38===t?i.ccRU(3):39===t?i.ccRU(4):40===t?i.ccFON():41===t?i.ccRDC():42===t?i.ccTR():43===t?i.ccRTD():44===t?i.ccEDM():45===t?i.ccCR():46===t?i.ccENM():47===t&&i.ccEOC():i.ccTO(t-32),this.currentChannel=n,!0}},{key:"parseMidrow",value:function(e,t){var n=0;if((17===e||25===e)&&t>=32&&t<=47){if((n=17===e?1:2)!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;var i=this.channels[n];return!!i&&(i.ccMIDROW(t),this.logger.log(3,(function(){return"MIDROW ("+Nl([e,t])+")"})),!0)}return!1}},{key:"parsePAC",value:function(e,t){var n;if(!((e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127)&&!((16===e||24===e)&&t>=64&&t<=95))return!1;var i=e<=23?1:2;n=t>=64&&t<=95?1===i?Dl[e]:xl[e]:1===i?Cl[e]:Ml[e];var a=this.channels[i];return!!a&&(a.setPAC(this.interpretPAC(n,t)),this.currentChannel=i,!0)}},{key:"interpretPAC",value:function(e,t){var n,i={color:null,italics:!1,indent:null,underline:!1,row:e};return n=t>95?t-96:t-64,i.underline=1===(1&n),n<=13?i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(i.italics=!0,i.color="white"):i.indent=4*Math.floor((n-16)/2),i}},{key:"parseChars",value:function(e,t){var n,i,a=null,r=null;(e>=25?(n=2,r=e-8):(n=1,r=e),r>=17&&r<=19)?(i=17===r?t+80:18===r?t+112:t+144,this.logger.log(2,(function(){return"Special char '"+Rl(i)+"' in channel "+n})),a=[i]):e>=32&&e<=127&&(a=0===t?[e]:[e,t]);return a&&this.logger.log(3,(function(){return"Char codes =  "+Nl(a).join(",")})),a}},{key:"parseBackgroundAttributes",value:function(e,t){var n;if(!((16===e||24===e)&&t>=32&&t<=47)&&!((23===e||31===e)&&t>=45&&t<=47))return!1;var i={};16===e||24===e?(n=Math.floor((t-32)/2),i.background=Ol[n],t%2===1&&(i.background=i.background+"_semi")):45===t?i.background="transparent":(i.foreground="black",47===t&&(i.underline=!0));var a=e<=23?1:2;return this.channels[a].setBkgData(i),!0}},{key:"reset",value:function(){for(var e=0;e<Object.keys(this.channels).length;e++){var t=this.channels[e];t&&t.reset()}Wl(null,null,this.cmdHistory)}},{key:"cueSplitAtTime",value:function(e){for(var t=0;t<this.channels.length;t++){var n=this.channels[t];n&&n.cueSplitAtTime(e)}}}]),e}();function Wl(e,t,n){n.a=e,n.b=t}var Vl=function(){function e(t,n){(0,m.A)(this,e),this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=t,this.trackName=n}return(0,v.A)(e,[{key:"dispatchCue",value:function(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}},{key:"newCue",value:function(e,t,n){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)}},{key:"reset",value:function(){this.cueRanges=[],this.startTime=null}}]),e}(),ql=function(){if(null!=hi&&hi.VTTCue)return self.VTTCue;var e=["","lr","rl"],t=["start","middle","end","left","right"];function n(e,t){if("string"!==typeof t)return!1;if(!Array.isArray(e))return!1;var n=t.toLowerCase();return!!~e.indexOf(n)&&n}function i(e){return n(t,e)}function a(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var o in r)e[o]=r[o]}return e}function r(t,r,o){var s=this,l={enumerable:!0};s.hasBeenReset=!1;var u="",c=!1,d=t,h=r,f=o,v=null,m="",p=!0,g="auto",y="start",E=50,A="middle",b=50,k="middle";Object.defineProperty(s,"id",a({},l,{get:function(){return u},set:function(e){u=""+e}})),Object.defineProperty(s,"pauseOnExit",a({},l,{get:function(){return c},set:function(e){c=!!e}})),Object.defineProperty(s,"startTime",a({},l,{get:function(){return d},set:function(e){if("number"!==typeof e)throw new TypeError("Start time must be set to a number.");d=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"endTime",a({},l,{get:function(){return h},set:function(e){if("number"!==typeof e)throw new TypeError("End time must be set to a number.");h=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"text",a({},l,{get:function(){return f},set:function(e){f=""+e,this.hasBeenReset=!0}})),Object.defineProperty(s,"region",a({},l,{get:function(){return v},set:function(e){v=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"vertical",a({},l,{get:function(){return m},set:function(t){var i=function(t){return n(e,t)}(t);if(!1===i)throw new SyntaxError("An invalid or illegal string was specified.");m=i,this.hasBeenReset=!0}})),Object.defineProperty(s,"snapToLines",a({},l,{get:function(){return p},set:function(e){p=!!e,this.hasBeenReset=!0}})),Object.defineProperty(s,"line",a({},l,{get:function(){return g},set:function(e){if("number"!==typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");g=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"lineAlign",a({},l,{get:function(){return y},set:function(e){var t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");y=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"position",a({},l,{get:function(){return E},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");E=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"positionAlign",a({},l,{get:function(){return A},set:function(e){var t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");A=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"size",a({},l,{get:function(){return b},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");b=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"align",a({},l,{get:function(){return k},set:function(e){var t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");k=t,this.hasBeenReset=!0}})),s.displayState=void 0}return r.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},r}(),Yl=function(){function e(){(0,m.A)(this,e)}return(0,v.A)(e,[{key:"decode",value:function(e,t){if(!e)return"";if("string"!==typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}]),e}();function jl(e){function t(e,t,n,i){return 3600*(0|e)+60*(0|t)+(0|n)+parseFloat(i||0)}var n=e.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return n?parseFloat(n[2])>59?t(n[2],n[3],0,n[4]):t(n[1],n[2],n[3],n[4]):null}var zl=function(){function e(){(0,m.A)(this,e),this.values=Object.create(null)}return(0,v.A)(e,[{key:"set",value:function(e,t){this.get(e)||""===t||(this.values[e]=t)}},{key:"get",value:function(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t}},{key:"has",value:function(e){return e in this.values}},{key:"alt",value:function(e,t,n){for(var i=0;i<n.length;++i)if(t===n[i]){this.set(e,t);break}}},{key:"integer",value:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}},{key:"percent",value:function(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){var n=parseFloat(t);if(n>=0&&n<=100)return this.set(e,n),!0}return!1}}]),e}();function Xl(e,t,n,i){var a=i?e.split(i):[e];for(var r in a)if("string"===typeof a[r]){var o=a[r].split(n);if(2===o.length)t(o[0],o[1])}}var Ql=new ql(0,0,""),Zl="middle"===Ql.align?"middle":"center";function Jl(e,t,n){var i=e;function a(){var t=jl(e);if(null===t)throw new Error("Malformed timestamp: "+i);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function r(){e=e.replace(/^\s+/,"")}if(r(),t.startTime=a(),r(),"--\x3e"!==e.slice(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+i);e=e.slice(3),r(),t.endTime=a(),r(),function(e,t){var i=new zl;Xl(e,(function(e,t){var a;switch(e){case"region":for(var r=n.length-1;r>=0;r--)if(n[r].id===t){i.set(e,n[r].region);break}break;case"vertical":i.alt(e,t,["rl","lr"]);break;case"line":a=t.split(","),i.integer(e,a[0]),i.percent(e,a[0])&&i.set("snapToLines",!1),i.alt(e,a[0],["auto"]),2===a.length&&i.alt("lineAlign",a[1],["start",Zl,"end"]);break;case"position":a=t.split(","),i.percent(e,a[0]),2===a.length&&i.alt("positionAlign",a[1],["start",Zl,"end","line-left","line-right","auto"]);break;case"size":i.percent(e,t);break;case"align":i.alt(e,t,["start",Zl,"end","left","right"])}}),/:/,/\s/),t.region=i.get("region",null),t.vertical=i.get("vertical","");var a=i.get("line","auto");"auto"===a&&-1===Ql.line&&(a=-1),t.line=a,t.lineAlign=i.get("lineAlign","start"),t.snapToLines=i.get("snapToLines",!0),t.size=i.get("size",100),t.align=i.get("align",Zl);var r=i.get("position","auto");"auto"===r&&50===Ql.position&&(r="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=r}(e,t)}function $l(e){return e.replace(/<br(?: \/)?>/gi,"\n")}var eu=function(){function e(){(0,m.A)(this,e),this.state="INITIAL",this.buffer="",this.decoder=new Yl,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}return(0,v.A)(e,[{key:"parse",value:function(e){var t=this;function n(){var e=t.buffer,n=0;for(e=$l(e);n<e.length&&"\r"!==e[n]&&"\n"!==e[n];)++n;var i=e.slice(0,n);return"\r"===e[n]&&++n,"\n"===e[n]&&++n,t.buffer=e.slice(n),i}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var i="";if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;var a=(i=n()).match(/^(\xef\xbb\xbf)?WEBVTT([ \t].*)?$/);if(null==a||!a[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}for(var r=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(r?r=!1:i=n(),t.state){case"HEADER":/:/.test(i)?Xl(i,(function(e,t){}),/:/):i||(t.state="ID");continue;case"NOTE":i||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){t.state="NOTE";break}if(!i)continue;if(t.cue=new ql(0,0,""),t.state="CUE",-1===i.indexOf("--\x3e")){t.cue.id=i;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{Jl(i,t.cue,t.regionList)}catch(Rv){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var o=-1!==i.indexOf("--\x3e");if(!i||o&&(r=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(null===t.cue)continue;t.cue.text&&(t.cue.text+="\n"),t.cue.text+=i;continue;case"BADCUE":i||(t.state="ID")}}}catch(Rv){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this}},{key:"flush",value:function(){var e=this;try{if((e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state||"BADWEBVTT"===e.state)throw new Error("Malformed WebVTT signature.")}catch(Rv){e.onparsingerror&&e.onparsingerror(Rv)}return e.onflush&&e.onflush(),this}}]),e}(),tu=/\r\n|\n\r|\n|\r/g,nu=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e.slice(n,n+t.length)===t},iu=function(e){for(var t=5381,n=e.length;n;)t=33*t^e.charCodeAt(--n);return(t>>>0).toString()};function au(e,t,n){return iu(e.toString())+iu(t.toString())+iu(n)}function ru(e,t,n,i,a,r,o){var s,l=new eu,u=qi(new Uint8Array(e)).trim().replace(tu,"\n").split("\n"),c=[],d=t?function(e){return js(e,Ys,1/(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1))}(t.baseTime,t.timescale):0,h="00:00.000",f=0,v=0,m=!0;l.oncue=function(e){var r=n[i],o=n.ccOffset,l=(f-d)/9e4;if(null!=r&&r.new&&(void 0!==v?o=n.ccOffset=r.start:function(e,t,n){var i=e[t],a=e[i.prevCC];if(!a||!a.new&&i.new)return e.ccOffset=e.presentationOffset=i.start,void(i.new=!1);for(;null!=(r=a)&&r.new;){var r;e.ccOffset+=i.start-a.start,i.new=!1,a=e[(i=a).prevCC]}e.presentationOffset=n}(n,i,l)),l){if(!t)return void(s=new Error("Missing initPTS for VTT MPEGTS"));o=l-n.presentationOffset}var u=e.endTime-e.startTime,h=Js(9e4*(e.startTime+o-v),9e4*a)/9e4;e.startTime=Math.max(h,0),e.endTime=Math.max(h+u,0);var m=e.text.trim();e.text=decodeURIComponent(encodeURIComponent(m)),e.id||(e.id=au(e.startTime,e.endTime,m)),e.endTime>0&&c.push(e)},l.onparsingerror=function(e){s=e},l.onflush=function(){s?o(s):r(c)},u.forEach((function(e){if(m){if(nu(e,"X-TIMESTAMP-MAP=")){m=!1,e.slice(16).split(",").forEach((function(e){nu(e,"LOCAL:")?h=e.slice(6):nu(e,"MPEGTS:")&&(f=parseInt(e.slice(7)))}));try{v=function(e){var t=parseInt(e.slice(-3)),n=parseInt(e.slice(-6,-4)),i=parseInt(e.slice(-9,-7)),a=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!Fn(t)||!Fn(n)||!Fn(i)||!Fn(a))throw Error("Malformed X-TIMESTAMP-MAP: Local:".concat(e));return t+=1e3*n,t+=6e4*i,t+36e5*a}(h)/1e3}catch(t){s=t}return}""===e&&(m=!1)}l.parse(e+"\n")})),l.flush()}var ou="stpp.ttml.im1t",su=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,lu=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,uu={left:"start",center:"center",right:"end",start:"start",end:"end"};function cu(e,t,n,i){var a=ia(new Uint8Array(e),["mdat"]);if(0!==a.length){var r=a.map((function(e){return qi(e)})),o=function(e,t){return js(e,t,1/(arguments.length>2&&void 0!==arguments[2]?arguments[2]:1),arguments.length>3&&void 0!==arguments[3]&&arguments[3])}(t.baseTime,1,t.timescale);try{r.forEach((function(e){return n(function(e,t){var n=(new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("tt")[0];if(!n)throw new Error("Invalid ttml");var i={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},a=Object.keys(i).reduce((function(e,t){return e[t]=n.getAttribute("ttp:".concat(t))||i[t],e}),{}),r="preserve"!==n.getAttribute("xml:space"),o=hu(du(n,"styling","style")),s=hu(du(n,"layout","region")),l=du(n,"body","[begin]");return[].map.call(l,(function(e){var n=fu(e,r);if(!n||!e.hasAttribute("begin"))return null;var i=pu(e.getAttribute("begin"),a),l=pu(e.getAttribute("dur"),a),u=pu(e.getAttribute("end"),a);if(null===i)throw mu(e);if(null===u){if(null===l)throw mu(e);u=i+l}var c=new ql(i-t,u-t,n);c.id=au(c.startTime,c.endTime,c.text);var d=function(e,t,n){var i="http://www.w3.org/ns/ttml#styling",a=null,r=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],o=null!=e&&e.hasAttribute("style")?e.getAttribute("style"):null;o&&n.hasOwnProperty(o)&&(a=n[o]);return r.reduce((function(n,r){var o=vu(t,i,r)||vu(e,i,r)||vu(a,i,r);return o&&(n[r]=o),n}),{})}(s[e.getAttribute("region")],o[e.getAttribute("style")],o),h=d.textAlign;if(h){var f=uu[h];f&&(c.lineAlign=f),c.align=h}return Un(c,d),c})).filter((function(e){return null!==e}))}(e,o))}))}catch(s){i(s)}}else i(new Error("Could not parse IMSC1 mdat"))}function du(e,t,n){var i=e.getElementsByTagName(t)[0];return i?[].slice.call(i.querySelectorAll(n)):[]}function hu(e){return e.reduce((function(e,t){var n=t.getAttribute("xml:id");return n&&(e[n]=t),e}),{})}function fu(e,t){return[].slice.call(e.childNodes).reduce((function(e,n,i){var a;return"br"===n.nodeName&&i?e+"\n":null!=(a=n.childNodes)&&a.length?fu(n,t):t?e+n.textContent.trim().replace(/\s+/g," "):e+n.textContent}),"")}function vu(e,t,n){return e&&e.hasAttributeNS(t,n)?e.getAttributeNS(t,n):null}function mu(e){return new Error("Could not parse ttml timestamp ".concat(e))}function pu(e,t){if(!e)return null;var n=jl(e);return null===n&&(su.test(e)?n=function(e,t){var n=su.exec(e),i=(0|n[4])+(0|n[5])/t.subFrameRate;return 3600*(0|n[1])+60*(0|n[2])+(0|n[3])+i/t.frameRate}(e,t):lu.test(e)&&(n=function(e,t){var n=lu.exec(e),i=Number(n[1]);switch(n[2]){case"h":return 3600*i;case"m":return 60*i;case"ms":return 1e3*i;case"f":return i/t.frameRate;case"t":return i/t.tickRate}return i}(e,t))),n}var gu=function(){function e(t){(0,m.A)(this,e),this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this.captionsProperties=void 0,this.hls=t,this.config=t.config,this.Cues=t.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},t.on(Gn.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(Gn.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(Gn.MANIFEST_LOADING,this.onManifestLoading,this),t.on(Gn.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(Gn.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on(Gn.FRAG_LOADING,this.onFragLoading,this),t.on(Gn.FRAG_LOADED,this.onFragLoaded,this),t.on(Gn.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.on(Gn.FRAG_DECRYPTED,this.onFragDecrypted,this),t.on(Gn.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on(Gn.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.on(Gn.BUFFER_FLUSHING,this.onBufferFlushing,this)}return(0,v.A)(e,[{key:"destroy",value:function(){var e=this.hls;e.off(Gn.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(Gn.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Gn.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Gn.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(Gn.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(Gn.FRAG_LOADING,this.onFragLoading,this),e.off(Gn.FRAG_LOADED,this.onFragLoaded,this),e.off(Gn.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(Gn.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(Gn.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(Gn.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(Gn.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=null,this.cea608Parser1=this.cea608Parser2=void 0}},{key:"initCea608Parsers",value:function(){if(this.config.enableCEA708Captions&&(!this.cea608Parser1||!this.cea608Parser2)){var e=new Vl(this,"textTrack1"),t=new Vl(this,"textTrack2"),n=new Vl(this,"textTrack3"),i=new Vl(this,"textTrack4");this.cea608Parser1=new Kl(1,e,t),this.cea608Parser2=new Kl(3,n,i)}}},{key:"addCues",value:function(e,t,n,i,a){for(var r,o,s,l,u=!1,c=a.length;c--;){var d=a[c],h=(r=d[0],o=d[1],s=t,l=n,Math.min(o,l)-Math.max(r,s));if(h>=0&&(d[0]=Math.min(d[0],t),d[1]=Math.max(d[1],n),u=!0,h/(n-t)>.5))return}if(u||a.push([t,n]),this.config.renderTextTracksNatively){var f=this.captionsTracks[e];this.Cues.newCue(f,t,n,i)}else{var v=this.Cues.newCue(null,t,n,i);this.hls.trigger(Gn.CUES_PARSED,{type:"captions",cues:v,track:e})}}},{key:"onInitPtsFound",value:function(e,t){var n=this,i=t.frag,a=t.id,r=t.initPTS,o=t.timescale,s=this.unparsedVttFrags;"main"===a&&(this.initPTS[i.cc]={baseTime:r,timescale:o}),s.length&&(this.unparsedVttFrags=[],s.forEach((function(e){n.onFragLoaded(Gn.FRAG_LOADED,e)})))}},{key:"getExistingTrack",value:function(e,t){var n=this.media;if(n)for(var i=0;i<n.textTracks.length;i++){var a=n.textTracks[i];if(Eu(a,{name:e,lang:t,attrs:{}}))return a}return null}},{key:"createCaptionsTrack",value:function(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}},{key:"createNativeTrack",value:function(e){if(!this.captionsTracks[e]){var t=this.captionsProperties,n=this.captionsTracks,i=this.media,a=t[e],r=a.label,o=a.languageCode,s=this.getExistingTrack(r,o);if(s)n[e]=s,cr(n[e]),lr(n[e],i);else{var l=this.createTextTrack("captions",r,o);l&&(l[e]=!0,n[e]=l)}}}},{key:"createNonNativeTrack",value:function(e){if(!this.nonNativeCaptionsTracks[e]){var t=this.captionsProperties[e];if(t){var n={_id:e,label:t.label,kind:"captions",default:!!t.media&&!!t.media.default,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=n,this.hls.trigger(Gn.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[n]})}}}},{key:"createTextTrack",value:function(e,t,n){var i=this.media;if(i)return i.addTextTrack(e,t,n)}},{key:"onMediaAttaching",value:function(e,t){this.media=t.media,this._cleanTracks()}},{key:"onMediaDetaching",value:function(){var e=this.captionsTracks;Object.keys(e).forEach((function(t){cr(e[t]),delete e[t]})),this.nonNativeCaptionsTracks={}}},{key:"onManifestLoading",value:function(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}},{key:"_cleanTracks",value:function(){var e=this.media;if(e){var t=e.textTracks;if(t)for(var n=0;n<t.length;n++)cr(t[n])}}},{key:"onSubtitleTracksUpdated",value:function(e,t){var n=this,i=t.subtitleTracks||[],a=i.some((function(e){return e.textCodec===ou}));if(this.config.enableWebVTT||a&&this.config.enableIMSC1){if(ml(this.tracks,i))return void(this.tracks=i);if(this.textTracks=[],this.tracks=i,this.config.renderTextTracksNatively){var r=this.media,o=r?hr(r.textTracks):null;if(this.tracks.forEach((function(e,t){var i;if(o){for(var a=null,r=0;r<o.length;r++)if(o[r]&&Eu(o[r],e)){a=o[r],o[r]=null;break}a&&(i=a)}if(i)cr(i);else{var s=yu(e);(i=n.createTextTrack(s,e.name,e.lang))&&(i.mode="disabled")}i&&n.textTracks.push(i)})),null!=o&&o.length){var s=o.filter((function(e){return null!==e})).map((function(e){return e.label}));s.length&&Xn.warn("Media element contains unused subtitle tracks: ".concat(s.join(", "),". Replace media element for each source to clear TextTracks and captions menu."))}}else if(this.tracks.length){var l=this.tracks.map((function(e){return{label:e.name,kind:e.type.toLowerCase(),default:e.default,subtitleTrack:e}}));this.hls.trigger(Gn.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:l})}}}},{key:"onManifestLoaded",value:function(e,t){var n=this;this.config.enableCEA708Captions&&t.captions&&t.captions.forEach((function(e){var t=/(?:CC|SERVICE)([1-4])/.exec(e.instreamId);if(t){var i="textTrack".concat(t[1]),a=n.captionsProperties[i];a&&(a.label=e.name,e.lang&&(a.languageCode=e.lang),a.media=e)}}))}},{key:"closedCaptionsForLevel",value:function(e){var t=this.hls.levels[e.level];return null==t?void 0:t.attrs["CLOSED-CAPTIONS"]}},{key:"onFragLoading",value:function(e,t){if(this.enabled&&t.frag.type===nr){var n,i,a=this.cea608Parser1,r=this.cea608Parser2,o=this.lastSn,s=t.frag,l=s.cc,u=s.sn,c=null!=(n=null==(i=t.part)?void 0:i.index)?n:-1;a&&r&&(u!==o+1||u===o&&c!==this.lastPartIndex+1||l!==this.lastCc)&&(a.reset(),r.reset()),this.lastCc=l,this.lastSn=u,this.lastPartIndex=c}}},{key:"onFragLoaded",value:function(e,t){var n=t.frag,i=t.payload;if(n.type===ar)if(i.byteLength){var a=n.decryptdata,r="stats"in t;if(null==a||!a.encrypted||r){var o=this.tracks[n.level],s=this.vttCCs;s[n.cc]||(s[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),o&&o.textCodec===ou?this._parseIMSC1(n,i):this._parseVTTs(t)}}else this.hls.trigger(Gn.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})}},{key:"_parseIMSC1",value:function(e,t){var n=this,i=this.hls;cu(t,this.initPTS[e.cc],(function(t){n._appendCues(t,e.level),i.trigger(Gn.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})}),(function(t){Xn.log("Failed to parse IMSC1: ".concat(t)),i.trigger(Gn.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:t})}))}},{key:"_parseVTTs",value:function(e){var t,n=this,i=e.frag,a=e.payload,r=this.initPTS,o=this.unparsedVttFrags,s=r.length-1;if(r[i.cc]||-1!==s){var l=this.hls;ru(null!=(t=i.initSegment)&&t.data?ha(i.initSegment.data,new Uint8Array(a)):a,this.initPTS[i.cc],this.vttCCs,i.cc,i.start,(function(e){n._appendCues(e,i.level),l.trigger(Gn.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:i})}),(function(t){var r="Missing initPTS for VTT MPEGTS"===t.message;r?o.push(e):n._fallbackToIMSC1(i,a),Xn.log("Failed to parse VTT cue: ".concat(t)),r&&s>i.cc||l.trigger(Gn.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:t})}))}else o.push(e)}},{key:"_fallbackToIMSC1",value:function(e,t){var n=this,i=this.tracks[e.level];i.textCodec||cu(t,this.initPTS[e.cc],(function(){i.textCodec=ou,n._parseIMSC1(e,t)}),(function(){i.textCodec="wvtt"}))}},{key:"_appendCues",value:function(e,t){var n=this.hls;if(this.config.renderTextTracksNatively){var i=this.textTracks[t];if(!i||"disabled"===i.mode)return;e.forEach((function(e){return ur(i,e)}))}else{var a=this.tracks[t];if(!a)return;var r=a.default?"default":"subtitles"+t;n.trigger(Gn.CUES_PARSED,{type:"subtitles",cues:e,track:r})}}},{key:"onFragDecrypted",value:function(e,t){t.frag.type===ar&&this.onFragLoaded(Gn.FRAG_LOADED,t)}},{key:"onSubtitleTracksCleared",value:function(){this.tracks=[],this.captionsTracks={}}},{key:"onFragParsingUserdata",value:function(e,t){this.initCea608Parsers();var n=this.cea608Parser1,i=this.cea608Parser2;if(this.enabled&&n&&i){var a=t.frag,r=t.samples;if(a.type!==nr||"NONE"!==this.closedCaptionsForLevel(a))for(var o=0;o<r.length;o++){var s=r[o].bytes;if(s){var l=this.extractCea608Data(s);n.addData(r[o].pts,l[0]),i.addData(r[o].pts,l[1])}}}}},{key:"onBufferFlushing",value:function(e,t){var n=t.startOffset,i=t.endOffset,a=t.endOffsetSubtitles,r=t.type,o=this.media;if(o&&!(o.currentTime<i)){if(!r||"video"===r){var s=this.captionsTracks;Object.keys(s).forEach((function(e){return dr(s[e],n,i)}))}if(this.config.renderTextTracksNatively&&0===n&&void 0!==a){var l=this.textTracks;Object.keys(l).forEach((function(e){return dr(l[e],n,a)}))}}}},{key:"extractCea608Data",value:function(e){for(var t=[[],[]],n=31&e[0],i=2,a=0;a<n;a++){var r=e[i++],o=127&e[i++],s=127&e[i++];if(0!==o||0!==s)if(0!==(4&r)){var l=3&r;0!==l&&1!==l||(t[l].push(o),t[l].push(s))}}return t}}]),e}();function yu(e){return e.characteristics&&/transcribes-spoken-dialog/gi.test(e.characteristics)&&/describes-music-and-sound/gi.test(e.characteristics)?"captions":"subtitles"}function Eu(e,t){return!!e&&e.kind===yu(t)&&gl(t,e)}var Au=function(){function e(t){(0,m.A)(this,e),this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=t,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}return(0,v.A)(e,[{key:"setStreamController",value:function(e){this.streamController=e}},{key:"destroy",value:function(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}},{key:"registerListeners",value:function(){var e=this.hls;e.on(Gn.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(Gn.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(Gn.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Gn.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(Gn.BUFFER_CODECS,this.onBufferCodecs,this),e.on(Gn.MEDIA_DETACHING,this.onMediaDetaching,this)}},{key:"unregisterListener",value:function(){var e=this.hls;e.off(Gn.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(Gn.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(Gn.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Gn.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(Gn.BUFFER_CODECS,this.onBufferCodecs,this),e.off(Gn.MEDIA_DETACHING,this.onMediaDetaching,this)}},{key:"onFpsDropLevelCapping",value:function(e,t){var n=this.hls.levels[t.droppedLevel];this.isLevelAllowed(n)&&this.restrictedLevels.push({bitrate:n.bitrate,height:n.height,width:n.width})}},{key:"onMediaAttaching",value:function(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}},{key:"onManifestParsed",value:function(e,t){var n=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}},{key:"onLevelsUpdated",value:function(e,t){this.timer&&Fn(this.autoLevelCapping)&&this.detectPlayerSize()}},{key:"onBufferCodecs",value:function(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}},{key:"onMediaDetaching",value:function(){this.stopCapping()}},{key:"detectPlayerSize",value:function(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0)return void(this.clientRect=null);var e=this.hls.levels;if(e.length){var t=this.hls,n=this.getMaxLevel(e.length-1);n!==this.autoLevelCapping&&Xn.log("Setting autoLevelCapping to ".concat(n,": ").concat(e[n].height,"p@").concat(e[n].bitrate," for media ").concat(this.mediaWidth,"x").concat(this.mediaHeight)),t.autoLevelCapping=n,t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}},{key:"getMaxLevel",value:function(t){var n=this,i=this.hls.levels;if(!i.length)return-1;var a=i.filter((function(e,i){return n.isLevelAllowed(e)&&i<=t}));return this.clientRect=null,e.getMaxLevelByMediaSize(a,this.mediaWidth,this.mediaHeight)}},{key:"startCapping",value:function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}},{key:"stopCapping",value:function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}},{key:"getDimensions",value:function(){if(this.clientRect)return this.clientRect;var e=this.media,t={width:0,height:0};if(e){var n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,t.width||t.height||(t.width=n.right-n.left||e.width||0,t.height=n.bottom-n.top||e.height||0)}return this.clientRect=t,t}},{key:"mediaWidth",get:function(){return this.getDimensions().width*this.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*this.contentScaleFactor}},{key:"contentScaleFactor",get:function(){var e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch(Rv){}return e}},{key:"isLevelAllowed",value:function(e){return!this.restrictedLevels.some((function(t){return e.bitrate===t.bitrate&&e.width===t.width&&e.height===t.height}))}}],[{key:"getMaxLevelByMediaSize",value:function(e,t,n){if(null==e||!e.length)return-1;for(var i,a,r=e.length-1,o=Math.max(t,n),s=0;s<e.length;s+=1){var l=e[s];if((l.width>=o||l.height>=o)&&(i=l,!(a=e[s+1])||i.width!==a.width||i.height!==a.height)){r=s;break}}return r}}]),e}(),bu=function(){function e(t){(0,m.A)(this,e),this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=t,this.registerListeners()}return(0,v.A)(e,[{key:"setStreamController",value:function(e){this.streamController=e}},{key:"registerListeners",value:function(){this.hls.on(Gn.MEDIA_ATTACHING,this.onMediaAttaching,this)}},{key:"unregisterListeners",value:function(){this.hls.off(Gn.MEDIA_ATTACHING,this.onMediaAttaching,this)}},{key:"destroy",value:function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}},{key:"onMediaAttaching",value:function(e,t){var n=this.hls.config;if(n.capLevelOnFPSDrop){var i=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=i,i&&"function"===typeof i.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}}},{key:"checkFPS",value:function(e,t,n){var i=performance.now();if(t){if(this.lastTime){var a=i-this.lastTime,r=n-this.lastDroppedFrames,o=t-this.lastDecodedFrames,s=1e3*r/a,l=this.hls;if(l.trigger(Gn.FPS_DROP,{currentDropped:r,currentDecoded:o,totalDroppedFrames:n}),s>0&&r>l.config.fpsDroppedMonitoringThreshold*o){var u=l.currentLevel;Xn.warn("drop FPS ratio greater than max allowed value for currentLevel: "+u),u>0&&(-1===l.autoLevelCapping||l.autoLevelCapping>=u)&&(u-=1,l.trigger(Gn.FPS_DROP_LEVEL_CAPPING,{level:u,droppedLevel:l.currentLevel}),l.autoLevelCapping=u,this.streamController.nextLevelSwitch())}}this.lastTime=i,this.lastDroppedFrames=n,this.lastDecodedFrames=t}}},{key:"checkFPSInterval",value:function(){var e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}]),e}(),ku="[eme]",Tu=function(){function e(t){var n=this;(0,m.A)(this,e),this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=e.CDMCleanupPromise?[e.CDMCleanupPromise]:[],this.debug=Xn.debug.bind(Xn,ku),this.log=Xn.log.bind(Xn,ku),this.warn=Xn.warn.bind(Xn,ku),this.error=Xn.error.bind(Xn,ku),this.onMediaEncrypted=function(e){var t=e.initDataType,i=e.initData,a='"'.concat(e.type,'" event: init data type: "').concat(t,'"');if(n.debug(a),null!==i){if(!n.keyFormatPromise){var r=Object.keys(n.keySystemAccessPromises);r.length||(r=Si(n.config));var o=r.map(_i).filter((function(e){return!!e}));n.keyFormatPromise=n.getKeyFormatPromise(o)}n.keyFormatPromise.then((function(r){var o,s,l=yi(r);if("sinf"===t){if(l!==fi.FAIRPLAY)return void n.warn('Ignoring unexpected "'.concat(e.type,'" event with init data type: "').concat(t,'" for selected key-system ').concat(l));var u=Zi(new Uint8Array(i));try{var c=ca(ui(JSON.parse(u).sinf));if(!c)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");o=c.subarray(8,24),s=fi.FAIRPLAY}catch(k){return void n.warn("".concat(a," Failed to parse sinf: ").concat(k))}}else{if(l!==fi.WIDEVINE&&l!==fi.PLAYREADY)return void n.warn('Ignoring unexpected "'.concat(e.type,'" event with init data type: "').concat(t,'" for selected key-system ').concat(l));var d=function(e){var t=[];if(e instanceof ArrayBuffer)for(var n=e.byteLength,i=0;i+32<n;){var a=ya(new DataView(e,i));t.push(a),i+=a.size}return t}(i),h=d.filter((function(e){return!!e.systemId&&Ti(e.systemId)===l}));h.length>1&&n.warn("".concat(a," Using first of ").concat(h.length," pssh found for selected key-system ").concat(l));var f=h[0];if(!f)return void(0===d.length||d.some((function(e){return!e.systemId}))?n.warn("".concat(a," contains incomplete or invalid pssh data")):n.log("ignoring ".concat(a," for ").concat(d.map((function(e){return Ti(e.systemId)})).join(",")," pssh data in favor of playlist keys")));if(s=Ti(f.systemId),0===f.version&&f.data)if(s===fi.WIDEVINE){var v=f.data.length-22;o=f.data.subarray(v,v+16)}else s===fi.PLAYREADY&&(o=Li(f.data))}if(s&&o){for(var m=ji(o),p=n.keyIdToKeySessionPromise,g=n.mediaKeySessions,y=p[m],E=function(e){var a=g[e],r=a.decryptdata;if(!r.keyId)return"continue";var s=ji(r.keyId);return m===s||-1!==r.uri.replace(/-/g,"").indexOf(m)?(y=p[s],r.pssh||(delete p[s],r.pssh=new Uint8Array(i),r.keyId=o,(y=p[m]=y.then((function(){return n.generateRequestWithPreferredKeySession(a,t,i,"encrypted-event-key-match")}))).catch((function(e){return n.handleError(e)}))),"break"):void 0},A=0;A<g.length;A++){var b=E(A);if("continue"!==b&&"break"===b)break}if(!y){if(s!==l)return void n.log('Ignoring "'.concat(a,'" with ').concat(s," init data for selected key-system ").concat(l));y=p[m]=n.getKeySystemSelectionPromise([s]).then((function(e){var a,r=e.keySystem,s=e.mediaKeys;n.throwIfDestroyed();var l=new Aa("ISO-23001-7",m,null!=(a=_i(r))?a:"");return l.pssh=new Uint8Array(i),l.keyId=o,n.attemptSetMediaKeys(r,s).then((function(){n.throwIfDestroyed();var e=n.createMediaKeySessionContext({decryptdata:l,keySystem:r,mediaKeys:s});return n.generateRequestWithPreferredKeySession(e,t,i,"encrypted-event-no-match")}))})),y.catch((function(e){return n.handleError(e)}))}}else n.log("Unable to handle ".concat(a," with key-system ").concat(l))}))}},this.onWaitingForKey=function(e){n.log('"'.concat(e.type,'" event'))},this.hls=t,this.config=t.config,this.registerListeners()}return(0,v.A)(e,[{key:"destroy",value:function(){this.unregisterListeners(),this.onMediaDetached();var e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}},{key:"registerListeners",value:function(){this.hls.on(Gn.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(Gn.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(Gn.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(Gn.MANIFEST_LOADED,this.onManifestLoaded,this)}},{key:"unregisterListeners",value:function(){this.hls.off(Gn.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(Gn.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(Gn.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(Gn.MANIFEST_LOADED,this.onManifestLoaded,this)}},{key:"getLicenseServerUrl",value:function(e){var t=this.config,n=t.drmSystems,i=t.widevineLicenseUrl,a=n[e];return a?a.licenseUrl:e===fi.WIDEVINE&&i?i:void 0}},{key:"getLicenseServerUrlOrThrow",value:function(e){var t=this.getLicenseServerUrl(e);if(void 0===t)throw new Error('no license server URL configured for key-system "'.concat(e,'"'));return t}},{key:"getServerCertificateUrl",value:function(e){var t=this.config.drmSystems[e];if(t)return t.serverCertificateUrl;this.log('No Server Certificate in config.drmSystems["'.concat(e,'"]'))}},{key:"attemptKeySystemAccess",value:function(e){var t=this,n=this.hls.levels,i=function(e,t,n){return!!e&&n.indexOf(e)===t},a=n.map((function(e){return e.audioCodec})).filter(i),r=n.map((function(e){return e.videoCodec})).filter(i);return a.length+r.length===0&&r.push("avc1.42e01e"),new Promise((function(n,i){!function e(o){var s=o.shift();t.getMediaKeysPromise(s,a,r).then((function(e){return n({keySystem:s,mediaKeys:e})})).catch((function(t){o.length?e(o):i(t instanceof Ru?t:new Ru({type:Kn.KEY_SYSTEM_ERROR,details:Wn.KEY_SYSTEM_NO_ACCESS,error:t,fatal:!0},t.message))}))}(e)}))}},{key:"requestMediaKeySystemAccess",value:function(e,t){var n=this.config.requestMediaKeySystemAccessFunc;if("function"!==typeof n){var i="Configured requestMediaKeySystemAccess is not a function ".concat(n);return null===Ri&&"http:"===self.location.protocol&&(i="navigator.requestMediaKeySystemAccess is not available over insecure protocol ".concat(location.protocol)),Promise.reject(new Error(i))}return n(e,t)}},{key:"getMediaKeysPromise",value:function(e,t,n){var i=this,a=function(e,t,n,i){var a;switch(e){case fi.FAIRPLAY:a=["cenc","sinf"];break;case fi.WIDEVINE:case fi.PLAYREADY:a=["cenc"];break;case fi.CLEARKEY:a=["cenc","keyids"];break;default:throw new Error("Unknown key-system: ".concat(e))}return function(e,t,n,i){return[{initDataTypes:e,persistentState:i.persistentState||"optional",distinctiveIdentifier:i.distinctiveIdentifier||"optional",sessionTypes:i.sessionTypes||[i.sessionType||"temporary"],audioCapabilities:t.map((function(e){return{contentType:'audio/mp4; codecs="'.concat(e,'"'),robustness:i.audioRobustness||"",encryptionScheme:i.audioEncryptionScheme||null}})),videoCapabilities:n.map((function(e){return{contentType:'video/mp4; codecs="'.concat(e,'"'),robustness:i.videoRobustness||"",encryptionScheme:i.videoEncryptionScheme||null}}))}]}(a,t,n,i)}(e,t,n,this.config.drmSystemOptions),r=this.keySystemAccessPromises[e],o=null==r?void 0:r.keySystemAccess;if(!o){this.log('Requesting encrypted media "'.concat(e,'" key-system access with config: ').concat(JSON.stringify(a))),o=this.requestMediaKeySystemAccess(e,a);var s=this.keySystemAccessPromises[e]={keySystemAccess:o};return o.catch((function(t){i.log('Failed to obtain access to key-system "'.concat(e,'": ').concat(t))})),o.then((function(t){i.log('Access for key-system "'.concat(t.keySystem,'" obtained'));var n=i.fetchServerCertificate(e);return i.log('Create media-keys for "'.concat(e,'"')),s.mediaKeys=t.createMediaKeys().then((function(t){return i.log('Media-keys created for "'.concat(e,'"')),n.then((function(n){return n?i.setMediaKeysServerCertificate(t,e,n):t}))})),s.mediaKeys.catch((function(t){i.error('Failed to create media-keys for "'.concat(e,'"}: ').concat(t))})),s.mediaKeys}))}return o.then((function(){return r.mediaKeys}))}},{key:"createMediaKeySessionContext",value:function(e){var t=e.decryptdata,n=e.keySystem,i=e.mediaKeys;this.log('Creating key-system session "'.concat(n,'" keyId: ').concat(ji(t.keyId||[])));var a=i.createSession(),r={decryptdata:t,keySystem:n,mediaKeys:i,mediaKeysSession:a,keyStatus:"status-pending"};return this.mediaKeySessions.push(r),r}},{key:"renewKeySession",value:function(e){var t=e.decryptdata;if(t.pssh){var n=this.createMediaKeySessionContext(e),i=this.getKeyIdString(t);this.keyIdToKeySessionPromise[i]=this.generateRequestWithPreferredKeySession(n,"cenc",t.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}},{key:"getKeyIdString",value:function(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(null===e.keyId)throw new Error("keyId is null");return ji(e.keyId)}},{key:"updateKeySession",value:function(e,t){var n,i=e.mediaKeysSession;return this.log('Updating key-session "'.concat(i.sessionId,'" for keyID ').concat(ji((null==(n=e.decryptdata)?void 0:n.keyId)||[]),"\n      } (data length: ").concat(t?t.byteLength:t,")")),i.update(t)}},{key:"selectKeySystemFormat",value:function(e){var t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log("Selecting key-system from fragment (sn: ".concat(e.sn," ").concat(e.type,": ").concat(e.level,") key formats ").concat(t.join(", "))),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}},{key:"getKeyFormatPromise",value:function(e){var t=this;return new Promise((function(n,i){var a=Si(t.config),r=e.map(yi).filter((function(e){return!!e&&-1!==a.indexOf(e)}));return t.getKeySystemSelectionPromise(r).then((function(e){var t=e.keySystem,a=_i(t);a?n(a):i(new Error('Unable to find format for key-system "'.concat(t,'"')))})).catch(i)}))}},{key:"loadKey",value:function(e){var t=this,n=e.keyInfo.decryptdata,i=this.getKeyIdString(n),a="(keyId: ".concat(i,' format: "').concat(n.keyFormat,'" method: ').concat(n.method," uri: ").concat(n.uri,")");this.log("Starting session for key ".concat(a));var r=this.keyIdToKeySessionPromise[i];return r||(r=this.keyIdToKeySessionPromise[i]=this.getKeySystemForKeyPromise(n).then((function(i){var r=i.keySystem,o=i.mediaKeys;return t.throwIfDestroyed(),t.log("Handle encrypted media sn: ".concat(e.frag.sn," ").concat(e.frag.type,": ").concat(e.frag.level," using key ").concat(a)),t.attemptSetMediaKeys(r,o).then((function(){t.throwIfDestroyed();var e=t.createMediaKeySessionContext({keySystem:r,mediaKeys:o,decryptdata:n});return t.generateRequestWithPreferredKeySession(e,"cenc",n.pssh,"playlist-key")}))}))).catch((function(e){return t.handleError(e)})),r}},{key:"throwIfDestroyed",value:function(){if(!this.hls)throw new Error("invalid state")}},{key:"handleError",value:function(e){this.hls&&(this.error(e.message),e instanceof Ru?this.hls.trigger(Gn.ERROR,e.data):this.hls.trigger(Gn.ERROR,{type:Kn.KEY_SYSTEM_ERROR,details:Wn.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}},{key:"getKeySystemForKeyPromise",value:function(e){var t=this.getKeyIdString(e),n=this.keyIdToKeySessionPromise[t];if(!n){var i=yi(e.keyFormat),a=i?[i]:Si(this.config);return this.attemptKeySystemAccess(a)}return n}},{key:"getKeySystemSelectionPromise",value:function(e){if(e.length||(e=Si(this.config)),0===e.length)throw new Ru({type:Kn.KEY_SYSTEM_ERROR,details:Wn.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},"Missing key-system license configuration options ".concat(JSON.stringify({drmSystems:this.config.drmSystems})));return this.attemptKeySystemAccess(e)}},{key:"attemptSetMediaKeys",value:function(e,t){var n=this,i=this.setMediaKeysQueue.slice();this.log('Setting media-keys for "'.concat(e,'"'));var a=Promise.all(i).then((function(){if(!n.media)throw new Error("Attempted to set mediaKeys without media element attached");return n.media.setMediaKeys(t)}));return this.setMediaKeysQueue.push(a),a.then((function(){n.log('Media-keys set for "'.concat(e,'"')),i.push(a),n.setMediaKeysQueue=n.setMediaKeysQueue.filter((function(e){return-1===i.indexOf(e)}))}))}},{key:"generateRequestWithPreferredKeySession",value:function(e,t,n,i){var a,r,o=this,s=null==(a=this.config.drmSystems)||null==(r=a[e.keySystem])?void 0:r.generateRequest;if(s)try{var l=s.call(this.hls,t,n,e);if(!l)throw new Error("Invalid response from configured generateRequest filter");t=l.initDataType,n=e.decryptdata.pssh=l.initData?new Uint8Array(l.initData):null}catch(m){var u;if(this.warn(m.message),null!=(u=this.hls)&&u.config.debug)throw m}if(null===n)return this.log('Skipping key-session request for "'.concat(i,'" (no initData)')),Promise.resolve(e);var c=this.getKeyIdString(e.decryptdata);this.log('Generating key-session request for "'.concat(i,'": ').concat(c," (init data type: ").concat(t," length: ").concat(n?n.byteLength:null,")"));var d=new hl,h=e._onmessage=function(t){var n=e.mediaKeysSession;if(n){var i=t.messageType,a=t.message;o.log('"'.concat(i,'" message event for session "').concat(n.sessionId,'" message size: ').concat(a.byteLength)),"license-request"===i||"license-renewal"===i?o.renewLicense(e,a).catch((function(e){o.handleError(e),d.emit("error",e)})):"license-release"===i?e.keySystem===fi.FAIRPLAY&&(o.updateKeySession(e,di("acknowledged")),o.removeSession(e)):o.warn('unhandled media key message type "'.concat(i,'"'))}else d.emit("error",new Error("invalid state"))},f=e._onkeystatuseschange=function(t){if(e.mediaKeysSession){o.onKeyStatusChange(e);var n=e.keyStatus;d.emit("keyStatus",n),"expired"===n&&(o.warn("".concat(e.keySystem," expired for key ").concat(c)),o.renewKeySession(e))}else d.emit("error",new Error("invalid state"))};e.mediaKeysSession.addEventListener("message",h),e.mediaKeysSession.addEventListener("keystatuseschange",f);var v=new Promise((function(e,t){d.on("error",t),d.on("keyStatus",(function(n){n.startsWith("usable")?e():"output-restricted"===n?t(new Ru({type:Kn.KEY_SYSTEM_ERROR,details:Wn.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):"internal-error"===n?t(new Ru({type:Kn.KEY_SYSTEM_ERROR,details:Wn.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},'key status changed to "'.concat(n,'"'))):"expired"===n?t(new Error("key expired while generating request")):o.warn('unhandled key status change "'.concat(n,'"'))}))}));return e.mediaKeysSession.generateRequest(t,n).then((function(){var t;o.log('Request generated for key-session "'.concat(null==(t=e.mediaKeysSession)?void 0:t.sessionId,'" keyId: ').concat(c))})).catch((function(e){throw new Ru({type:Kn.KEY_SYSTEM_ERROR,details:Wn.KEY_SYSTEM_NO_SESSION,error:e,fatal:!1},"Error generating key-session request: ".concat(e))})).then((function(){return v})).catch((function(t){throw d.removeAllListeners(),o.removeSession(e),t})).then((function(){return d.removeAllListeners(),e}))}},{key:"onKeyStatusChange",value:function(e){var t=this;e.mediaKeysSession.keyStatuses.forEach((function(n,i){t.log('key status change "'.concat(n,'" for keyStatuses keyId: ').concat(ji("buffer"in i?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):new Uint8Array(i))," session keyId: ").concat(ji(new Uint8Array(e.decryptdata.keyId||[]))," uri: ").concat(e.decryptdata.uri)),e.keyStatus=n}))}},{key:"fetchServerCertificate",value:function(e){var t=this.config,n=new(0,t.loader)(t),i=this.getServerCertificateUrl(e);return i?(this.log('Fetching server certificate for "'.concat(e,'"')),new Promise((function(a,r){var o={responseType:"arraybuffer",url:i},s=t.certLoadPolicy.default,l={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},u={onSuccess:function(e,t,n,i){a(e.data)},onError:function(t,n,a,s){r(new Ru({type:Kn.KEY_SYSTEM_ERROR,details:Wn.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:a,response:On({url:o.url,data:void 0},t)},'"'.concat(e,'" certificate request failed (').concat(i,"). Status: ").concat(t.code," (").concat(t.text,")")))},onTimeout:function(t,n,a){r(new Ru({type:Kn.KEY_SYSTEM_ERROR,details:Wn.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:a,response:{url:o.url,data:void 0}},'"'.concat(e,'" certificate request timed out (').concat(i,")")))},onAbort:function(e,t,n){r(new Error("aborted"))}};n.load(o,l,u)}))):Promise.resolve()}},{key:"setMediaKeysServerCertificate",value:function(e,t,n){var i=this;return new Promise((function(a,r){e.setServerCertificate(n).then((function(r){i.log("setServerCertificate ".concat(r?"success":"not supported by CDM"," (").concat(null==n?void 0:n.byteLength,') on "').concat(t,'"')),a(e)})).catch((function(e){r(new Ru({type:Kn.KEY_SYSTEM_ERROR,details:Wn.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:e,fatal:!0},e.message))}))}))}},{key:"renewLicense",value:function(e,t){var n=this;return this.requestLicense(e,new Uint8Array(t)).then((function(t){return n.updateKeySession(e,new Uint8Array(t)).catch((function(e){throw new Ru({type:Kn.KEY_SYSTEM_ERROR,details:Wn.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:e,fatal:!0},e.message)}))}))}},{key:"unpackPlayReadyKeyMessage",value:function(e,t){var n=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!n.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;var i=(new DOMParser).parseFromString(n,"application/xml"),a=i.querySelectorAll("HttpHeader");if(a.length>0)for(var r,o=0,s=a.length;o<s;o++){var l,u,c=null==(l=(r=a[o]).querySelector("name"))?void 0:l.textContent,d=null==(u=r.querySelector("value"))?void 0:u.textContent;c&&d&&e.setRequestHeader(c,d)}var h=i.querySelector("Challenge"),f=null==h?void 0:h.textContent;if(!f)throw new Error("Cannot find <Challenge> in key message");return di(atob(f))}},{key:"setupLicenseXHR",value:function(e,t,n,i){var a=this,r=this.config.licenseXhrSetup;return r?Promise.resolve().then((function(){if(!n.decryptdata)throw new Error("Key removed");return r.call(a.hls,e,t,n,i)})).catch((function(o){if(!n.decryptdata)throw o;return e.open("POST",t,!0),r.call(a.hls,e,t,n,i)})).then((function(n){return e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:n||i}})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:i}))}},{key:"requestLicense",value:function(e,t){var n=this,i=this.config.keyLoadPolicy.default;return new Promise((function(a,r){var o=n.getLicenseServerUrlOrThrow(e.keySystem);n.log("Sending license request to URL: ".concat(o));var s=new XMLHttpRequest;s.responseType="arraybuffer",s.onreadystatechange=function(){if(!n.hls||!e.mediaKeysSession)return r(new Error("invalid state"));if(4===s.readyState)if(200===s.status){n._requestLicenseFailureCount=0;var l=s.response;n.log("License received ".concat(l instanceof ArrayBuffer?l.byteLength:l));var u=n.config.licenseResponseCallback;if(u)try{l=u.call(n.hls,s,o,e)}catch(f){n.error(f)}a(l)}else{var c=i.errorRetry,d=c?c.maxNumRetry:0;if(n._requestLicenseFailureCount++,n._requestLicenseFailureCount>d||s.status>=400&&s.status<500)r(new Ru({type:Kn.KEY_SYSTEM_ERROR,details:Wn.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:s,response:{url:o,data:void 0,code:s.status,text:s.statusText}},"License Request XHR failed (".concat(o,"). Status: ").concat(s.status," (").concat(s.statusText,")")));else{var h=d-n._requestLicenseFailureCount+1;n.warn("Retrying license request, ".concat(h," attempts left")),n.requestLicense(e,t).then(a,r)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=s,n.setupLicenseXHR(s,o,e,t).then((function(t){var i=t.xhr,a=t.licenseChallenge;e.keySystem==fi.PLAYREADY&&(a=n.unpackPlayReadyKeyMessage(i,a)),i.send(a)}))}))}},{key:"onMediaAttached",value:function(e,t){if(this.config.emeEnabled){var n=t.media;this.media=n,n.removeEventListener("encrypted",this.onMediaEncrypted),n.removeEventListener("waitingforkey",this.onWaitingForKey),n.addEventListener("encrypted",this.onMediaEncrypted),n.addEventListener("waitingforkey",this.onWaitingForKey)}}},{key:"onMediaDetached",value:function(){var t=this,n=this.media,i=this.mediaKeySessions;n&&(n.removeEventListener("encrypted",this.onMediaEncrypted),n.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},Aa.clearKeyUriToKeyIdMap();var a=i.length;e.CDMCleanupPromise=Promise.all(i.map((function(e){return t.removeSession(e)})).concat(null==n?void 0:n.setMediaKeys(null).catch((function(e){t.log("Could not clear media keys: ".concat(e))})))).then((function(){a&&(t.log("finished closing key sessions and clearing media keys"),i.length=0)})).catch((function(e){t.log("Could not close sessions and clear media keys: ".concat(e))}))}},{key:"onManifestLoading",value:function(){this.keyFormatPromise=null}},{key:"onManifestLoaded",value:function(e,t){var n=t.sessionKeys;if(n&&this.config.emeEnabled&&!this.keyFormatPromise){var i=n.reduce((function(e,t){return-1===e.indexOf(t.keyFormat)&&e.push(t.keyFormat),e}),[]);this.log("Selecting key-system from session-keys ".concat(i.join(", "))),this.keyFormatPromise=this.getKeyFormatPromise(i)}}},{key:"removeSession",value:function(e){var t=this,n=e.mediaKeysSession,i=e.licenseXhr;if(n){this.log("Remove licenses and keys and close session ".concat(n.sessionId)),e._onmessage&&(n.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(n.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),i&&i.readyState!==XMLHttpRequest.DONE&&i.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;var a=this.mediaKeySessions.indexOf(e);return a>-1&&this.mediaKeySessions.splice(a,1),n.remove().catch((function(e){t.log("Could not remove session: ".concat(e))})).then((function(){return n.close()})).catch((function(e){t.log("Could not close session: ".concat(e))}))}}}]),e}();Tu.CDMCleanupPromise=void 0;var _u,Su,wu,Ru=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(e,i){var a;return(0,m.A)(this,n),(a=t.call(this,i)).data=void 0,e.error||(e.error=new Error(i)),a.data=e,e.err=e.error,a}return(0,v.A)(n)}((0,y.A)(Error));!function(e){e.MANIFEST="m",e.AUDIO="a",e.VIDEO="v",e.MUXED="av",e.INIT="i",e.CAPTION="c",e.TIMED_TEXT="tt",e.KEY="k",e.OTHER="o"}(_u||(_u={})),function(e){e.DASH="d",e.HLS="h",e.SMOOTH="s",e.OTHER="o"}(Su||(Su={})),function(e){e.OBJECT="CMCD-Object",e.REQUEST="CMCD-Request",e.SESSION="CMCD-Session",e.STATUS="CMCD-Status"}(wu||(wu={}));var Lu=(wn={},(0,s.A)(wn,wu.OBJECT,["br","d","ot","tb"]),(0,s.A)(wn,wu.REQUEST,["bl","dl","mtp","nor","nrr","su"]),(0,s.A)(wn,wu.SESSION,["cid","pr","sf","sid","st","v"]),(0,s.A)(wn,wu.STATUS,["bs","rtp"]),wn),Iu=(0,v.A)((function e(t,n){(0,m.A)(this,e),this.value=void 0,this.params=void 0,Array.isArray(t)&&(t=t.map((function(t){return t instanceof e?t:new e(t)}))),this.value=t,this.params=n})),Du=(0,v.A)((function e(t){(0,m.A)(this,e),this.description=void 0,this.description=t})),Cu="Dict";function xu(e,t,n,i){return new Error("failed to ".concat(e,' "').concat((a=t,Array.isArray(a)?JSON.stringify(a):a instanceof Map?"Map{}":a instanceof Set?"Set{}":"object"===typeof a?JSON.stringify(a):String(a)),'" as ').concat(n),{cause:i});var a}var Mu="Bare Item";var Ou=/[\x00-\x1f\x7f]+/;function Pu(e,t,n){return xu("serialize",e,t,n)}function Nu(e){if(!1===ArrayBuffer.isView(e))throw Pu(e,"Byte Sequence");return":".concat((t=e,btoa(String.fromCharCode.apply(String,(0,f.A)(t)))),":");var t}function Uu(e){if(function(e){return e<-999999999999999||999999999999999<e}(e))throw Pu(e,"Integer");return e.toString()}function Fu(e,t){if(e<0)return-Fu(-e,t);var n=Math.pow(10,t);if(Math.abs(e*n%1-.5)<Number.EPSILON){var i=Math.floor(e*n);return(i%2===0?i:i+1)/n}return Math.round(e*n)/n}function Bu(e){var t=Fu(e,3);if(Math.floor(Math.abs(t)).toString().length>12)throw Pu(e,"Decimal");var n=t.toString();return n.includes(".")?n:"".concat(n,".0")}function Hu(e){var t,n=(t=e).description||t.toString().slice(7,-1);if(!1===/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(n))throw Pu(n,"Token");return n}function Gu(e){switch(typeof e){case"number":if(!Fn(e))throw Pu(e,Mu);return Number.isInteger(e)?Uu(e):Bu(e);case"string":return function(e){if(Ou.test(e))throw Pu(e,"String");return'"'.concat(e.replace(/\\/g,"\\\\").replace(/"/g,'\\"'),'"')}(e);case"symbol":return Hu(e);case"boolean":return function(e){if("boolean"!==typeof e)throw Pu(e,"Boolean");return e?"?1":"?0"}(e);case"object":if(e instanceof Date)return function(e){return"@".concat(Uu(e.getTime()/1e3))}(e);if(e instanceof Uint8Array)return Nu(e);if(e instanceof Du)return Hu(e);default:throw Pu(e,Mu)}}function Ku(e){if(!1===/^[a-z*][a-z0-9\-_.*]*$/.test(e))throw Pu(e,"Key");return e}function Wu(e){return null==e?"":Object.entries(e).map((function(e){var t=(0,a.A)(e,2),n=t[0],i=t[1];return!0===i?";".concat(Ku(n)):";".concat(Ku(n),"=").concat(Gu(i))})).join("")}function Vu(e){return e instanceof Iu?"".concat(Gu(e.value)).concat(Wu(e.params)):Gu(e)}function qu(e){return"(".concat(e.value.map(Vu).join(" "),")").concat(Wu(e.params))}function Yu(e,t){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{whitespace:!0};if("object"!==typeof e)throw Pu(e,Cu);var n=e instanceof Map?e.entries():Object.entries(e),i=null!=t&&t.whitespace?" ":"";return Array.from(n).map((function(e){var t=(0,a.A)(e,2),n=t[0],i=t[1];i instanceof Iu===!1&&(i=new Iu(i));var r=Ku(n);return!0===i.value?r+=Wu(i.params):(r+="=",Array.isArray(i.value)?r+=qu(i):r+=Vu(i)),r})).join(",".concat(i))}(e,t)}var ju=function(e){return Math.round(e)},zu=function(e){return 100*ju(e/100)},Xu={br:ju,d:ju,bl:zu,dl:zu,mtp:zu,nor:function(e,t){return null!=t&&t.baseUrl&&(e=function(e,t){var n=new URL(e),i=new URL(t);if(n.origin!==i.origin)return e;for(var a=n.pathname.split("/").slice(1),r=i.pathname.split("/").slice(1,-1);a[0]===r[0];)a.shift(),r.shift();for(;r.length;)r.shift(),a.unshift("..");return a.join("/")}(e,t.baseUrl)),encodeURIComponent(e)},rtp:zu,tb:ju};function Qu(e,t){var n={};if(null==e||"object"!==typeof e)return n;var i=Object.keys(e).sort(),a=Un({},Xu,null==t?void 0:t.formatters),r=null==t?void 0:t.filter;return i.forEach((function(i){if(null==r||!r(i)){var o=e[i],s=a[i];s&&(o=s(o,t)),"v"===i&&1===o||"pr"==i&&1===o||function(e){return"number"===typeof e?Fn(e):null!=e&&""!==e&&!1!==e}(o)&&(function(e){return"ot"===e||"sf"===e||"st"===e}(i)&&"string"===typeof o&&(o=new Du(o)),n[i]=o)}})),n}function Zu(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e?Yu(Qu(e,t),Un({whitespace:!1},t)):""}function Ju(e,t,n){return Un(e,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return{};var n=Object.entries(e),i=Object.entries(Lu).concat(Object.entries((null==t?void 0:t.customHeaderMap)||{})),r=n.reduce((function(e,t){var n,r=(0,a.A)(t,2),o=r[0],s=r[1],l=(null==(n=i.find((function(e){return e[1].includes(o)})))?void 0:n[0])||wu.REQUEST;return null!=e[l]||(e[l]={}),e[l][o]=s,e}),{});return Object.entries(r).reduce((function(e,n){var i=(0,a.A)(n,2),r=i[0],o=i[1];return e[r]=Zu(o,t),e}),{})}(t,n))}var $u="CMCD";var ec=/CMCD=[^&#]+/;function tc(e,t,n){var i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return"";var n=Zu(e,t);return"".concat($u,"=").concat(encodeURIComponent(n))}(t,n);if(!i)return e;if(ec.test(e))return e.replace(ec,i);var a=e.includes("?")?"&":"?";return"".concat(e).concat(a).concat(i)}var nc=function(){function e(t){var n=this;(0,m.A)(this,e),this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=function(){n.initialized&&(n.starved=!0),n.buffering=!0},this.onPlaying=function(){n.initialized||(n.initialized=!0),n.buffering=!1},this.applyPlaylistData=function(e){try{n.apply(e,{ot:_u.MANIFEST,su:!n.initialized})}catch(t){Xn.warn("Could not generate manifest CMCD data.",t)}},this.applyFragmentData=function(e){try{var t=e.frag,i=n.hls.levels[t.level],a=n.getObjectType(t),r={d:1e3*t.duration,ot:a};a!==_u.VIDEO&&a!==_u.AUDIO&&a!=_u.MUXED||(r.br=i.bitrate/1e3,r.tb=n.getTopBandwidth(a)/1e3,r.bl=n.getBufferLength(a)),n.apply(e,r)}catch(o){Xn.warn("Could not generate segment CMCD data.",o)}},this.hls=t;var i=this.config=t.config,a=i.cmcd;null!=a&&(i.pLoader=this.createPlaylistLoader(),i.fLoader=this.createFragmentLoader(),this.sid=a.sessionId||function(){try{return crypto.randomUUID()}catch(a){try{var e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch(a){var n=(new Date).getTime(),i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=(n+16*Math.random())%16|0;return n=Math.floor(n/16),("x"==e?t:3&t|8).toString(16)}));return i}}}(),this.cid=a.contentId,this.useHeaders=!0===a.useHeaders,this.includeKeys=a.includeKeys,this.registerListeners())}return(0,v.A)(e,[{key:"registerListeners",value:function(){var e=this.hls;e.on(Gn.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Gn.MEDIA_DETACHED,this.onMediaDetached,this),e.on(Gn.BUFFER_CREATED,this.onBufferCreated,this)}},{key:"unregisterListeners",value:function(){var e=this.hls;e.off(Gn.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Gn.MEDIA_DETACHED,this.onMediaDetached,this),e.off(Gn.BUFFER_CREATED,this.onBufferCreated,this)}},{key:"destroy",value:function(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=null}},{key:"onMediaAttached",value:function(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}},{key:"onMediaDetached",value:function(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}},{key:"onBufferCreated",value:function(e,t){var n,i;this.audioBuffer=null==(n=t.tracks.audio)?void 0:n.buffer,this.videoBuffer=null==(i=t.tracks.video)?void 0:i.buffer}},{key:"createData",value:function(){var e;return{v:1,sf:Su.HLS,sid:this.sid,cid:this.cid,pr:null==(e=this.media)?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}},{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Un(t,this.createData());var n=t.ot===_u.INIT||t.ot===_u.VIDEO||t.ot===_u.MUXED;this.starved&&n&&(t.bs=!0,t.su=!0,this.starved=!1),null==t.su&&(t.su=this.buffering);var i=this.includeKeys;i&&(t=Object.keys(t).reduce((function(e,n){return i.includes(n)&&(e[n]=t[n]),e}),{})),this.useHeaders?(e.headers||(e.headers={}),Ju(e.headers,t)):e.url=tc(e.url,t)}},{key:"getObjectType",value:function(e){var t=e.type;return"subtitle"===t?_u.TIMED_TEXT:"initSegment"===e.sn?_u.INIT:"audio"===t?_u.AUDIO:"main"===t?this.hls.audioTracks.length?_u.VIDEO:_u.MUXED:void 0}},{key:"getTopBandwidth",value:function(e){var t,n=0,i=this.hls;if(e===_u.AUDIO)t=i.audioTracks;else{var a=i.maxAutoLevel,r=a>-1?a+1:i.levels.length;t=i.levels.slice(0,r)}var o,s=(0,h.A)(t);try{for(s.s();!(o=s.n()).done;){var l=o.value;l.bitrate>n&&(n=l.bitrate)}}catch(BL){s.e(BL)}finally{s.f()}return n>0?n:NaN}},{key:"getBufferLength",value:function(e){var t=this.hls.media,n=e===_u.AUDIO?this.audioBuffer:this.videoBuffer;return n&&t?1e3*wo.bufferInfo(n,t.currentTime,this.config.maxBufferHole).len:NaN}},{key:"createPlaylistLoader",value:function(){var e=this.config.pLoader,t=this.applyPlaylistData,n=e||this.config.loader;return function(){function e(t){(0,m.A)(this,e),this.loader=void 0,this.loader=new n(t)}return(0,v.A)(e,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}},{key:"destroy",value:function(){this.loader.destroy()}},{key:"abort",value:function(){this.loader.abort()}},{key:"load",value:function(e,n,i){t(e),this.loader.load(e,n,i)}}]),e}()}},{key:"createFragmentLoader",value:function(){var e=this.config.fLoader,t=this.applyFragmentData,n=e||this.config.loader;return function(){function e(t){(0,m.A)(this,e),this.loader=void 0,this.loader=new n(t)}return(0,v.A)(e,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}},{key:"destroy",value:function(){this.loader.destroy()}},{key:"abort",value:function(){this.loader.abort()}},{key:"load",value:function(e,n,i){t(e),this.loader.load(e,n,i)}}]),e}()}}]),e}(),ic=function(){function e(t){(0,m.A)(this,e),this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=t,this.log=Xn.log.bind(Xn,"[content-steering]:"),this.registerListeners()}return(0,v.A)(e,[{key:"registerListeners",value:function(){var e=this.hls;e.on(Gn.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Gn.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(Gn.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Gn.ERROR,this.onError,this)}},{key:"unregisterListeners",value:function(){var e=this.hls;e&&(e.off(Gn.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Gn.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(Gn.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Gn.ERROR,this.onError,this))}},{key:"startLoad",value:function(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){var e=1e3*this.timeToLoad-(performance.now()-this.updated);if(e>0)return void this.scheduleRefresh(this.uri,e)}this.loadSteeringManifest(this.uri)}}},{key:"stopLoad",value:function(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}},{key:"clearTimeout",value:function(){-1!==this.reloadTimer&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}},{key:"destroy",value:function(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}},{key:"removeLevel",value:function(e){var t=this.levels;t&&(this.levels=t.filter((function(t){return t!==e})))}},{key:"onManifestLoading",value:function(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}},{key:"onManifestLoaded",value:function(e,t){var n=t.contentSteering;null!==n&&(this.pathwayId=n.pathwayId,this.uri=n.uri,this.started&&this.startLoad())}},{key:"onManifestParsed",value:function(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}},{key:"onError",value:function(e,t){var n=t.errorAction;if((null==n?void 0:n.action)===Qr&&n.flags===eo){var i=this.levels,a=this.pathwayPriority,r=this.pathwayId;if(t.context){var o=t.context,s=o.groupId,l=o.pathwayId,u=o.type;s&&i?r=this.getPathwayForGroupId(s,u,r):l&&(r=l)}r in this.penalizedPathways||(this.penalizedPathways[r]=performance.now()),!a&&i&&(a=i.reduce((function(e,t){return-1===e.indexOf(t.pathwayId)&&e.push(t.pathwayId),e}),[])),a&&a.length>1&&(this.updatePathwayPriority(a),n.resolved=this.pathwayId!==r),n.resolved||Xn.warn("Could not resolve ".concat(t.details,' ("').concat(t.error.message,'") with content-steering for Pathway: ').concat(r," levels: ").concat(i?i.length:i," priorities: ").concat(JSON.stringify(a)," penalized: ").concat(JSON.stringify(this.penalizedPathways)))}}},{key:"filterParsedLevels",value:function(e){this.levels=e;var t=this.getLevelsForPathway(this.pathwayId);if(0===t.length){var n=e[0].pathwayId;this.log("No levels found in Pathway ".concat(this.pathwayId,'. Setting initial Pathway to "').concat(n,'"')),t=this.getLevelsForPathway(n),this.pathwayId=n}return t.length!==e.length&&this.log("Found ".concat(t.length,"/").concat(e.length,' levels in Pathway "').concat(this.pathwayId,'"')),t}},{key:"getLevelsForPathway",value:function(e){return null===this.levels?[]:this.levels.filter((function(t){return e===t.pathwayId}))}},{key:"updatePathwayPriority",value:function(e){var t;this.pathwayPriority=e;var n=this.penalizedPathways,i=performance.now();Object.keys(n).forEach((function(e){i-n[e]>3e5&&delete n[e]}));for(var a=0;a<e.length;a++){var r=e[a];if(!(r in n)){if(r===this.pathwayId)return;var o=this.hls.nextLoadLevel,s=this.hls.levels[o];if((t=this.getLevelsForPathway(r)).length>0){this.log('Setting Pathway to "'.concat(r,'"')),this.pathwayId=r,Fr(t),this.hls.trigger(Gn.LEVELS_UPDATED,{levels:t});var l=this.hls.levels[o];s&&l&&this.levels&&(l.attrs["STABLE-VARIANT-ID"]!==s.attrs["STABLE-VARIANT-ID"]&&l.bitrate!==s.bitrate&&this.log("Unstable Pathways change from bitrate ".concat(s.bitrate," to ").concat(l.bitrate)),this.hls.nextLoadLevel=o);break}}}}},{key:"getPathwayForGroupId",value:function(e,t,n){for(var i=this.getLevelsForPathway(n).concat(this.levels||[]),a=0;a<i.length;a++)if(t===er&&i[a].hasAudioGroup(e)||t===tr&&i[a].hasSubtitleGroup(e))return i[a].pathwayId;return n}},{key:"clonePathways",value:function(e){var t=this,n=this.levels;if(n){var i={},a={};e.forEach((function(e){var r=e.ID,o=e["BASE-ID"],s=e["URI-REPLACEMENT"];if(!n.some((function(e){return e.pathwayId===r}))){var l=t.getLevelsForPathway(o).map((function(e){var t=new Jn(e.attrs);t["PATHWAY-ID"]=r;var n=t.AUDIO&&"".concat(t.AUDIO,"_clone_").concat(r),o=t.SUBTITLES&&"".concat(t.SUBTITLES,"_clone_").concat(r);n&&(i[t.AUDIO]=n,t.AUDIO=n),o&&(a[t.SUBTITLES]=o,t.SUBTITLES=o);var l=rc(e.uri,t["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",s),u=new Ir({attrs:t,audioCodec:e.audioCodec,bitrate:e.bitrate,height:e.height,name:e.name,url:l,videoCodec:e.videoCodec,width:e.width});if(e.audioGroups)for(var c=1;c<e.audioGroups.length;c++)u.addGroupId("audio","".concat(e.audioGroups[c],"_clone_").concat(r));if(e.subtitleGroups)for(var d=1;d<e.subtitleGroups.length;d++)u.addGroupId("text","".concat(e.subtitleGroups[d],"_clone_").concat(r));return u}));n.push.apply(n,(0,f.A)(l)),ac(t.audioTracks,i,s,r),ac(t.subtitleTracks,a,s,r)}}))}}},{key:"loadSteeringManifest",value:function(e){var t,n=this,i=this.hls.config,a=i.loader;this.loader&&this.loader.destroy(),this.loader=new a(i);try{t=new self.URL(e)}catch(d){return this.enabled=!1,void this.log("Failed to parse Steering Manifest URI: ".concat(e))}if("data:"!==t.protocol){var r=0|(this.hls.bandwidthEstimate||i.abrEwmaDefaultEstimate);t.searchParams.set("_HLS_pathway",this.pathwayId),t.searchParams.set("_HLS_throughput",""+r)}var o={responseType:"json",url:t.href},s=i.steeringManifestLoadPolicy.default,l=s.errorRetry||s.timeoutRetry||{},u={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:l.maxNumRetry||0,retryDelay:l.retryDelayMs||0,maxRetryDelay:l.maxRetryDelayMs||0},c={onSuccess:function(e,i,a,r){n.log('Loaded steering manifest: "'.concat(t,'"'));var o=e.data;if(1===o.VERSION){n.updated=performance.now(),n.timeToLoad=o.TTL;var s=o["RELOAD-URI"],l=o["PATHWAY-CLONES"],u=o["PATHWAY-PRIORITY"];if(s)try{n.uri=new self.URL(s,t).href}catch(d){return n.enabled=!1,void n.log("Failed to parse Steering Manifest RELOAD-URI: ".concat(s))}n.scheduleRefresh(n.uri||a.url),l&&n.clonePathways(l);var c={steeringManifest:o,url:t.toString()};n.hls.trigger(Gn.STEERING_MANIFEST_LOADED,c),u&&n.updatePathwayPriority(u)}else n.log("Steering VERSION ".concat(o.VERSION," not supported!"))},onError:function(e,t,i,a){if(n.log("Error loading steering manifest: ".concat(e.code," ").concat(e.text," (").concat(t.url,")")),n.stopLoad(),410===e.code)return n.enabled=!1,void n.log("Steering manifest ".concat(t.url," no longer available"));var r=1e3*n.timeToLoad;if(429!==e.code)n.scheduleRefresh(n.uri||t.url,r);else{var o=n.loader;if("function"===typeof(null==o?void 0:o.getResponseHeader)){var s=o.getResponseHeader("Retry-After");s&&(r=1e3*parseFloat(s))}n.log("Steering manifest ".concat(t.url," rate limited"))}},onTimeout:function(e,t,i){n.log("Timeout loading steering manifest (".concat(t.url,")")),n.scheduleRefresh(n.uri||t.url)}};this.log("Requesting steering manifest: ".concat(t)),this.loader.load(o,u,c)}},{key:"scheduleRefresh",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3*this.timeToLoad;this.clearTimeout(),this.reloadTimer=self.setTimeout((function(){var n,i=null==(n=t.hls)?void 0:n.media;!i||i.ended?t.scheduleRefresh(e,1e3*t.timeToLoad):t.loadSteeringManifest(e)}),n)}}]),e}();function ac(e,t,n,i){e&&Object.keys(t).forEach((function(a){var r=e.filter((function(e){return e.groupId===a})).map((function(e){var r=Un({},e);return r.details=void 0,r.attrs=new Jn(r.attrs),r.url=r.attrs.URI=rc(e.url,e.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",n),r.groupId=r.attrs["GROUP-ID"]=t[a],r.attrs["PATHWAY-ID"]=i,r}));e.push.apply(e,(0,f.A)(r))}))}function rc(e,t,n,i){var a,r=i.HOST,o=i.PARAMS,s=i[n];t&&(a=null==s?void 0:s[t])&&(e=a);var l=new self.URL(e);return r&&!a&&(l.host=r),o&&Object.keys(o).sort().forEach((function(e){e&&l.searchParams.set(e,o[e])})),l.href}var oc=/^age:\s*[\d.]+\s*$/im,sc=function(){function e(t){(0,m.A)(this,e),this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=t&&t.xhrSetup||null,this.stats=new ti,this.retryDelay=0}return(0,v.A)(e,[{key:"destroy",value:function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}},{key:"abortInternal",value:function(){var e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,4!==e.readyState&&(this.stats.aborted=!0,e.abort()))}},{key:"abort",value:function(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}},{key:"load",value:function(e,t,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=n,this.loadInternal()}},{key:"loadInternal",value:function(){var e=this,t=this.config,n=this.context;if(t&&n){var i=this.loader=new self.XMLHttpRequest,a=this.stats;a.loading.first=0,a.loaded=0,a.aborted=!1;var r=this.xhrSetup;r?Promise.resolve().then((function(){if(e.loader===i&&!e.stats.aborted)return r(i,n.url)})).catch((function(t){if(e.loader===i&&!e.stats.aborted)return i.open("GET",n.url,!0),r(i,n.url)})).then((function(){e.loader!==i||e.stats.aborted||e.openAndSendXhr(i,n,t)})).catch((function(t){e.callbacks.onError({code:i.status,text:t.message},n,i,a)})):this.openAndSendXhr(i,n,t)}}},{key:"openAndSendXhr",value:function(e,t,n){e.readyState||e.open("GET",t.url,!0);var i=t.headers,a=n.loadPolicy,r=a.maxTimeToFirstByteMs,o=a.maxLoadTimeMs;if(i)for(var s in i)e.setRequestHeader(s,i[s]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),n.timeout=r&&Fn(r)?r:o,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),e.send()}},{key:"readystatechange",value:function(){var e=this.context,t=this.loader,n=this.stats;if(e&&t){var i=t.readyState,a=this.config;if(!n.aborted&&i>=2&&(0===n.loading.first&&(n.loading.first=Math.max(self.performance.now(),n.loading.start),a.timeout!==a.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),a.timeout=a.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),a.loadPolicy.maxLoadTimeMs-(n.loading.first-n.loading.start)))),4===i)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;var r=t.status,o="text"===t.responseType?t.responseText:null;if(r>=200&&r<300){var s=null!=o?o:t.response;if(null!=s){n.loading.end=Math.max(self.performance.now(),n.loading.first);var l="arraybuffer"===t.responseType?s.byteLength:s.length;if(n.loaded=n.total=l,n.bwEstimate=8e3*n.total/(n.loading.end-n.loading.first),!this.callbacks)return;var u=this.callbacks.onProgress;if(u&&u(n,e,s,t),!this.callbacks)return;var c={url:t.responseURL,data:s,code:r};return void this.callbacks.onSuccess(c,n,e,t)}}var d=a.loadPolicy.errorRetry;Wr(d,n.retry,!1,{url:e.url,data:void 0,code:r})?this.retry(d):(Xn.error("".concat(r," while loading ").concat(e.url)),this.callbacks.onError({code:r,text:t.statusText},e,t,n))}}}},{key:"loadtimeout",value:function(){if(this.config){var e=this.config.loadPolicy.timeoutRetry;if(Wr(e,this.stats.retry,!0))this.retry(e);else{var t;Xn.warn("timeout while loading ".concat(null==(t=this.context)?void 0:t.url));var n=this.callbacks;n&&(this.abortInternal(),n.onTimeout(this.stats,this.context,this.loader))}}}},{key:"retry",value:function(e){var t=this.context,n=this.stats;this.retryDelay=Gr(e,n.retry),n.retry++,Xn.warn("".concat(status?"HTTP Status "+status:"Timeout"," while loading ").concat(null==t?void 0:t.url,", retrying ").concat(n.retry,"/").concat(e.maxNumRetry," in ").concat(this.retryDelay,"ms")),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}},{key:"loadprogress",value:function(e){var t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}},{key:"getCacheAge",value:function(){var e=null;if(this.loader&&oc.test(this.loader.getAllResponseHeaders())){var t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}},{key:"getResponseHeader",value:function(e){return this.loader&&new RegExp("^".concat(e,":\\s*[\\d.]+\\s*$"),"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}]),e}();var lc=/(\d+)-(\d+)\/(\d+)/,uc=function(){function e(t){(0,m.A)(this,e),this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=t.fetchSetup||cc,this.controller=new self.AbortController,this.stats=new ti}return(0,v.A)(e,[{key:"destroy",value:function(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}},{key:"abortInternal",value:function(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}},{key:"abort",value:function(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}},{key:"load",value:function(e,t,n){var i=this,a=this.stats;if(a.loading.start)throw new Error("Loader can only be used once.");a.loading.start=self.performance.now();var r=function(e,t){var n={method:"GET",mode:"cors",credentials:"same-origin",signal:t,headers:new self.Headers(Un({},e.headers))};e.rangeEnd&&n.headers.set("Range","bytes="+e.rangeStart+"-"+String(e.rangeEnd-1));return n}(e,this.controller.signal),o=n.onProgress,s="arraybuffer"===e.responseType,l=s?"byteLength":"length",u=t.loadPolicy,c=u.maxTimeToFirstByteMs,d=u.maxLoadTimeMs;this.context=e,this.config=t,this.callbacks=n,this.request=this.fetchSetup(e,r),self.clearTimeout(this.requestTimeout),t.timeout=c&&Fn(c)?c:d,this.requestTimeout=self.setTimeout((function(){i.abortInternal(),n.onTimeout(a,e,i.response)}),t.timeout),self.fetch(this.request).then((function(r){i.response=i.loader=r;var l=Math.max(self.performance.now(),a.loading.start);if(self.clearTimeout(i.requestTimeout),t.timeout=d,i.requestTimeout=self.setTimeout((function(){i.abortInternal(),n.onTimeout(a,e,i.response)}),d-(l-a.loading.start)),!r.ok){var u=r.status,c=r.statusText;throw new hc(c||"fetch, bad network response",u,r)}return a.loading.first=l,a.total=function(e){var t=e.get("Content-Range");if(t){var n=function(e){var t=lc.exec(e);if(t)return parseInt(t[2])-parseInt(t[1])+1}(t);if(Fn(n))return n}var i=e.get("Content-Length");if(i)return parseInt(i)}(r.headers)||a.total,o&&Fn(t.highWaterMark)?i.loadProgressively(r,a,e,t.highWaterMark,o):s?r.arrayBuffer():"json"===e.responseType?r.json():r.text()})).then((function(r){var s=i.response;if(!s)throw new Error("loader destroyed");self.clearTimeout(i.requestTimeout),a.loading.end=Math.max(self.performance.now(),a.loading.first);var u=r[l];u&&(a.loaded=a.total=u);var c={url:s.url,data:r,code:s.status};o&&!Fn(t.highWaterMark)&&o(a,e,r,s),n.onSuccess(c,a,e,s)})).catch((function(t){if(self.clearTimeout(i.requestTimeout),!a.aborted){var r=t&&t.code||0,o=t?t.message:null;n.onError({code:r,text:o},e,t?t.details:null,a)}}))}},{key:"getCacheAge",value:function(){var e=null;if(this.response){var t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}},{key:"getResponseHeader",value:function(e){return this.response?this.response.headers.get(e):null}},{key:"loadProgressively",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4?arguments[4]:void 0,r=new ns,o=e.body.getReader(),s=function s(){return o.read().then((function(o){if(o.done)return r.dataLength&&a(t,n,r.flush(),e),Promise.resolve(new ArrayBuffer(0));var l=o.value,u=l.length;return t.loaded+=u,u<i||r.dataLength?(r.push(l),r.dataLength>=i&&a(t,n,r.flush(),e)):a(t,n,l,e),s()})).catch((function(){return Promise.reject()}))};return s()}}]),e}();function cc(e,t){return new self.Request(e.url,t)}var dc,hc=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(e,i,a){var r;return(0,m.A)(this,n),(r=t.call(this,e)).code=void 0,r.details=void 0,r.code=i,r.details=a,r}return(0,v.A)(n)}((0,y.A)(Error)),fc=/\s/,vc={newCue:function(e,t,n,i){for(var a,r,o,s,l,u=[],c=self.VTTCue||self.TextTrackCue,d=0;d<i.rows.length;d++)if(o=!0,s=0,l="",!(a=i.rows[d]).isEmpty()){for(var h,f=0;f<a.chars.length;f++)fc.test(a.chars[f].uchar)&&o?s++:(l+=a.chars[f].uchar,o=!1);a.cueStartTime=t,t===n&&(n+=1e-4),s>=16?s--:s++;var v=$l(l.trim()),m=au(t,n,v);null!=e&&null!=(h=e.cues)&&h.getCueById(m)||((r=new c(t,n,v)).id=m,r.line=d+1,r.align="left",r.position=10+Math.min(80,10*Math.floor(8*s/32)),u.push(r))}return e&&u.length&&(u.sort((function(e,t){return"auto"===e.line||"auto"===t.line?0:e.line>8&&t.line>8?t.line-e.line:e.line-t.line})),u.forEach((function(t){return ur(e,t)}))),u}},mc=On(On({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:sc,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:po,bufferController:_l,capLevelController:Au,errorController:no,fpsController:bu,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:Ri,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,useMediaCapabilities:!0,certLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null}},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},{cueHandler:vc,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:El,subtitleTrackController:bl,timelineController:gu,audioStreamController:vl,audioTrackController:yl,emeController:Tu,cmcdController:nc,contentSteeringController:ic});function pc(e,t){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==t.liveMaxLatencyDurationCount&&(void 0===t.liveSyncDurationCount||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==t.liveMaxLatencyDuration&&(void 0===t.liveSyncDuration||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');var n=gc(e),i=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return["manifest","level","frag"].forEach((function(e){var a="".concat("level"===e?"playlist":e,"LoadPolicy"),r=void 0===t[a],o=[];i.forEach((function(i){var s="".concat(e,"Loading").concat(i),l=t[s];if(void 0!==l&&r){o.push(s);var u=n[a].default;switch(t[a]={default:u},i){case"TimeOut":u.maxLoadTimeMs=l,u.maxTimeToFirstByteMs=l;break;case"MaxRetry":u.errorRetry.maxNumRetry=l,u.timeoutRetry.maxNumRetry=l;break;case"RetryDelay":u.errorRetry.retryDelayMs=l,u.timeoutRetry.retryDelayMs=l;break;case"MaxRetryTimeout":u.errorRetry.maxRetryDelayMs=l,u.timeoutRetry.maxRetryDelayMs=l}}})),o.length&&Xn.warn('hls.js config: "'.concat(o.join('", "'),'" setting(s) are deprecated, use "').concat(a,'": ').concat(JSON.stringify(t[a])))})),On(On({},n),t)}function gc(e){return e&&"object"===typeof e?Array.isArray(e)?e.map(gc):Object.keys(e).reduce((function(t,n){return t[n]=gc(e[n]),t}),{}):e}function yc(e){var t=e.loader;t!==uc&&t!==sc?(Xn.log("[config]: Custom loader detected, cannot enable progressive streaming"),e.progressive=!1):function(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(Rv){}return!1}()&&(e.loader=uc,e.progressive=!0,e.enableSoftwareAES=!0,Xn.log("[config]: Progressive streaming enabled, using FetchLoader"))}var Ec=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(e,i){var a;return(0,m.A)(this,n),(a=t.call(this,e,"[level-controller]"))._levels=[],a._firstLevel=-1,a._maxAutoLevel=-1,a._startLevel=void 0,a.currentLevel=null,a.currentLevelIndex=-1,a.manualLevelIndex=-1,a.steering=void 0,a.onParsedComplete=void 0,a.steering=i,a._registerListeners(),a}return(0,v.A)(n,[{key:"_registerListeners",value:function(){var e=this.hls;e.on(Gn.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Gn.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(Gn.LEVEL_LOADED,this.onLevelLoaded,this),e.on(Gn.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(Gn.FRAG_BUFFERED,this.onFragBuffered,this),e.on(Gn.ERROR,this.onError,this)}},{key:"_unregisterListeners",value:function(){var e=this.hls;e.off(Gn.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Gn.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(Gn.LEVEL_LOADED,this.onLevelLoaded,this),e.off(Gn.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(Gn.FRAG_BUFFERED,this.onFragBuffered,this),e.off(Gn.ERROR,this.onError,this)}},{key:"destroy",value:function(){this._unregisterListeners(),this.steering=null,this.resetLevels(),(0,u.A)((0,c.A)(n.prototype),"destroy",this).call(this)}},{key:"stopLoad",value:function(){this._levels.forEach((function(e){e.loadError=0,e.fragmentError=0})),(0,u.A)((0,c.A)(n.prototype),"stopLoad",this).call(this)}},{key:"resetLevels",value:function(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}},{key:"onManifestLoading",value:function(e,t){this.resetLevels()}},{key:"onManifestLoaded",value:function(e,t){var n=this.hls.config.preferManagedMediaSource,i=[],a={},r={},o=!1,s=!1,l=!1;t.levels.forEach((function(e){var t,u,c=e.attrs,d=e.audioCodec,h=e.videoCodec;-1!==(null==(t=d)?void 0:t.indexOf("mp4a.40.34"))&&(dc||(dc=/chrome|firefox/i.test(navigator.userAgent)),dc&&(e.audioCodec=d=void 0)),d&&(e.audioCodec=d=Ua(d,n)),0===(null==(u=h)?void 0:u.indexOf("avc1"))&&(h=e.videoCodec=function(e){for(var t=e.split(","),n=0;n<t.length;n++){var i=t[n].split(".");if(i.length>2){var a=i.shift()+".";a+=parseInt(i.shift()).toString(16),a+=("000"+parseInt(i.shift()).toString(16)).slice(-4),t[n]=a}}return t.join(",")}(h));var f=e.width,v=e.height,m=e.unknownCodecs;if(o||(o=!(!f||!v)),s||(s=!!h),l||(l=!!d),!(null!=m&&m.length||d&&!Ia(d,"audio",n)||h&&!Ia(h,"video",n))){var p=c.CODECS,g=c["FRAME-RATE"],y=c["HDCP-LEVEL"],E=c["PATHWAY-ID"],A=c.RESOLUTION,b=c["VIDEO-RANGE"],k="".concat(E||".","-"),T="".concat(k).concat(e.bitrate,"-").concat(A,"-").concat(g,"-").concat(p,"-").concat(b,"-").concat(y);if(a[T])if(a[T].uri===e.url||e.attrs["PATHWAY-ID"])a[T].addGroupId("audio",c.AUDIO),a[T].addGroupId("text",c.SUBTITLES);else{var _=r[T]+=1;e.attrs["PATHWAY-ID"]=new Array(_+1).join(".");var S=new Ir(e);a[T]=S,i.push(S)}else{var w=new Ir(e);a[T]=w,r[T]=1,i.push(w)}}})),this.filterAndSortMediaOptions(i,t,o,s,l)}},{key:"filterAndSortMediaOptions",value:function(e,t,n,i,a){var r=this,o=[],s=[],l=e;if((n||i)&&a&&(l=l.filter((function(e){var t,n=e.videoCodec,i=e.videoRange,a=e.width,r=e.height;return(!!n||!(!a||!r))&&(!!(t=i)&&Tr.indexOf(t)>-1)}))),0!==l.length){if(t.audioTracks){var u=this.hls.config.preferManagedMediaSource;Ac(o=t.audioTracks.filter((function(e){return!e.audioCodec||Ia(e.audioCodec,"audio",u)})))}t.subtitles&&Ac(s=t.subtitles);var c=l.slice(0);l.sort((function(e,t){if(e.attrs["HDCP-LEVEL"]!==t.attrs["HDCP-LEVEL"])return(e.attrs["HDCP-LEVEL"]||"")>(t.attrs["HDCP-LEVEL"]||"")?1:-1;if(n&&e.height!==t.height)return e.height-t.height;if(e.frameRate!==t.frameRate)return e.frameRate-t.frameRate;if(e.videoRange!==t.videoRange)return Tr.indexOf(e.videoRange)-Tr.indexOf(t.videoRange);if(e.videoCodec!==t.videoCodec){var i=xa(e.videoCodec),a=xa(t.videoCodec);if(i!==a)return a-i}if(e.uri===t.uri&&e.codecSet!==t.codecSet){var r=Ma(e.codecSet),o=Ma(t.codecSet);if(r!==o)return o-r}return e.averageBitrate!==t.averageBitrate?e.averageBitrate-t.averageBitrate:0}));var d=c[0];if(this.steering&&(l=this.steering.filterParsedLevels(l)).length!==c.length)for(var h=0;h<c.length;h++)if(c[h].pathwayId===l[0].pathwayId){d=c[h];break}this._levels=l;for(var f=0;f<l.length;f++)if(l[f]===d){var v;this._firstLevel=f;var m=d.bitrate,p=this.hls.bandwidthEstimate;if(this.log("manifest loaded, ".concat(l.length," level(s) found, first bitrate: ").concat(m)),void 0===(null==(v=this.hls.userConfig)?void 0:v.abrEwmaDefaultEstimate)){var g=Math.min(m,this.hls.config.abrEwmaDefaultEstimateMax);g>p&&p===mc.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=g)}break}var y=a&&!i,E={levels:l,audioTracks:o,subtitleTracks:s,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:a,video:i,altAudio:!y&&o.some((function(e){return!!e.url}))};this.hls.trigger(Gn.MANIFEST_PARSED,E),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else Promise.resolve().then((function(){if(r.hls){t.levels.length&&r.warn("One or more CODECS in variant not supported: ".concat(JSON.stringify(t.levels[0].attrs)));var e=new Error("no level with compatible codecs found in manifest");r.hls.trigger(Gn.ERROR,{type:Kn.MEDIA_ERROR,details:Wn.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:e,reason:e.message})}}))}},{key:"levels",get:function(){return 0===this._levels.length?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(e){var t=this._levels;if(0!==t.length){if(e<0||e>=t.length){var n=new Error("invalid level idx"),i=e<0;if(this.hls.trigger(Gn.ERROR,{type:Kn.OTHER_ERROR,details:Wn.LEVEL_SWITCH_ERROR,level:e,fatal:i,error:n,reason:n.message}),i)return;e=Math.min(e,t.length-1)}var a=this.currentLevelIndex,r=this.currentLevel,o=r?r.attrs["PATHWAY-ID"]:void 0,s=t[e],l=s.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=s,a!==e||!s.details||!r||o!==l){this.log("Switching to level ".concat(e," (").concat(s.height?s.height+"p ":"").concat(s.videoRange?s.videoRange+" ":"").concat(s.codecSet?s.codecSet+" ":"","@").concat(s.bitrate,")").concat(l?" with Pathway "+l:""," from level ").concat(a).concat(o?" with Pathway "+o:""));var u={level:e,attrs:s.attrs,details:s.details,bitrate:s.bitrate,averageBitrate:s.averageBitrate,maxBitrate:s.maxBitrate,realBitrate:s.realBitrate,width:s.width,height:s.height,codecSet:s.codecSet,audioCodec:s.audioCodec,videoCodec:s.videoCodec,audioGroups:s.audioGroups,subtitleGroups:s.subtitleGroups,loaded:s.loaded,loadError:s.loadError,fragmentError:s.fragmentError,name:s.name,id:s.id,uri:s.uri,url:s.url,urlId:0,audioGroupIds:s.audioGroupIds,textGroupIds:s.textGroupIds};this.hls.trigger(Gn.LEVEL_SWITCHING,u);var c=s.details;if(!c||c.live){var d=this.switchParams(s.uri,null==r?void 0:r.details,c);this.loadPlaylist(d)}}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var e=this.hls.config.startLevel;return void 0!==e?e:this.hls.firstAutoLevel}return this._startLevel},set:function(e){this._startLevel=e}},{key:"onError",value:function(e,t){!t.fatal&&t.context&&t.context.type===$a&&t.context.level===this.level&&this.checkRetry(t)}},{key:"onFragBuffered",value:function(e,t){var n=t.frag;if(void 0!==n&&n.type===nr){var i=n.elementaryStreams;if(!Object.keys(i).some((function(e){return!!i[e]})))return;var a=this._levels[n.level];null!=a&&a.loadError&&(this.log("Resetting level error count of ".concat(a.loadError," on frag buffered")),a.loadError=0)}}},{key:"onLevelLoaded",value:function(e,t){var n,i,a=t.level,r=t.details,o=this._levels[a];if(!o)return this.warn("Invalid level index ".concat(a)),void(null!=(i=t.deliveryDirectives)&&i.skip&&(r.deltaUpdateFailed=!0));a===this.currentLevelIndex?(0===o.fragmentError&&(o.loadError=0),this.playlistLoaded(a,t,o.details)):null!=(n=t.deliveryDirectives)&&n.skip&&(r.deltaUpdateFailed=!0)}},{key:"loadPlaylist",value:function(e){(0,u.A)((0,c.A)(n.prototype),"loadPlaylist",this).call(this);var t=this.currentLevelIndex,i=this.currentLevel;if(i&&this.shouldLoadPlaylist(i)){var a=i.uri;if(e)try{a=e.addDirectives(a)}catch(o){this.warn("Could not construct new URL with HLS Delivery Directives: ".concat(o))}var r=i.attrs["PATHWAY-ID"];this.log("Loading level index ".concat(t).concat(void 0!==(null==e?void 0:e.msn)?" at sn "+e.msn+" part "+e.part:""," with").concat(r?" Pathway "+r:""," ").concat(a)),this.clearTimer(),this.hls.trigger(Gn.LEVEL_LOADING,{url:a,level:t,pathwayId:i.attrs["PATHWAY-ID"],id:0,deliveryDirectives:e||null})}}},{key:"nextLoadLevel",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}},{key:"removeLevel",value:function(e){var t,n=this,i=this._levels.filter((function(t,i){return i!==e||(n.steering&&n.steering.removeLevel(t),t===n.currentLevel&&(n.currentLevel=null,n.currentLevelIndex=-1,t.details&&t.details.fragments.forEach((function(e){return e.level=-1}))),!1)}));Fr(i),this._levels=i,this.currentLevelIndex>-1&&null!=(t=this.currentLevel)&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.hls.trigger(Gn.LEVELS_UPDATED,{levels:i})}},{key:"onLevelsUpdated",value:function(e,t){var n=t.levels;this._levels=n}},{key:"checkMaxAutoUpdated",value:function(){var e=this.hls,t=e.autoLevelCapping,n=e.maxAutoLevel,i=e.maxHdcpLevel;this._maxAutoLevel!==n&&(this._maxAutoLevel=n,this.hls.trigger(Gn.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:t,levels:this.levels,maxAutoLevel:n,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:i}))}}]),n}(io);function Ac(e){var t={};e.forEach((function(e){var n=e.groupId||"";e.id=t[n]=t[n]||0,t[n]++}))}var bc=function(){function e(t){(0,m.A)(this,e),this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=t}return(0,v.A)(e,[{key:"abort",value:function(e){for(var t in this.keyUriToKeyInfo){var n=this.keyUriToKeyInfo[t].loader;if(n){var i;if(e&&e!==(null==(i=n.context)?void 0:i.frag.type))return;n.abort()}}}},{key:"detach",value:function(){for(var e in this.keyUriToKeyInfo){var t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}},{key:"destroy",value:function(){for(var e in this.detach(),this.keyUriToKeyInfo){var t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}},{key:"createKeyLoadError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wn.KEY_LOAD_ERROR,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;return new Uo({type:Kn.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:a,error:n,networkDetails:i})}},{key:"loadClear",value:function(e,t){var n=this;if(this.emeController&&this.config.emeEnabled)for(var i=e.sn,a=e.cc,r=function(e){var r=t[e];if(a<=r.cc&&("initSegment"===i||"initSegment"===r.sn||i<r.sn))return n.emeController.selectKeySystemFormat(r).then((function(e){r.setKeyFormat(e)})),"break"},o=0;o<t.length;o++){if("break"===r(o))break}}},{key:"load",value:function(e){var t=this;return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then((function(n){return t.loadInternal(e,n)})):this.loadInternal(e)}},{key:"loadInternal",value:function(e,t){var n,i;t&&e.setKeyFormat(t);var a=e.decryptdata;if(!a){var r=new Error(t?"Expected frag.decryptdata to be defined after setting format ".concat(t):"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,Wn.KEY_LOAD_ERROR,r))}var o=a.uri;if(!o)return Promise.reject(this.createKeyLoadError(e,Wn.KEY_LOAD_ERROR,new Error('Invalid key URI: "'.concat(o,'"'))));var s,l=this.keyUriToKeyInfo[o];if(null!=(n=l)&&n.decryptdata.key)return a.key=l.decryptdata.key,Promise.resolve({frag:e,keyInfo:l});if(null!=(i=l)&&i.keyLoadPromise)switch(null==(s=l.mediaKeySessionContext)?void 0:s.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return l.keyLoadPromise.then((function(t){return a.key=t.keyInfo.decryptdata.key,{frag:e,keyInfo:l}}))}switch(l=this.keyUriToKeyInfo[o]={decryptdata:a,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},a.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return"identity"===a.keyFormat?this.loadKeyHTTP(l,e):this.loadKeyEME(l,e);case"AES-128":return this.loadKeyHTTP(l,e);default:return Promise.reject(this.createKeyLoadError(e,Wn.KEY_LOAD_ERROR,new Error('Key supplied with unsupported METHOD: "'.concat(a.method,'"'))))}}},{key:"loadKeyEME",value:function(e,t){var n={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){var i=this.emeController.loadKey(n);if(i)return(e.keyLoadPromise=i.then((function(t){return e.mediaKeySessionContext=t,n}))).catch((function(t){throw e.keyLoadPromise=null,t}))}return Promise.resolve(n)}},{key:"loadKeyHTTP",value:function(e,t){var n=this,i=this.config,a=new(0,i.loader)(i);return t.keyLoader=e.loader=a,e.keyLoadPromise=new Promise((function(r,o){var s={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},l=i.keyLoadPolicy.default,u={loadPolicy:l,timeout:l.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},c={onSuccess:function(e,t,i,a){var s=i.frag,l=i.keyInfo,u=i.url;if(!s.decryptdata||l!==n.keyUriToKeyInfo[u])return o(n.createKeyLoadError(s,Wn.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),a));l.decryptdata.key=s.decryptdata.key=new Uint8Array(e.data),s.keyLoader=null,l.loader=null,r({frag:s,keyInfo:l})},onError:function(e,i,a,r){n.resetLoader(i),o(n.createKeyLoadError(t,Wn.KEY_LOAD_ERROR,new Error("HTTP Error ".concat(e.code," loading key ").concat(e.text)),a,On({url:s.url,data:void 0},e)))},onTimeout:function(e,i,a){n.resetLoader(i),o(n.createKeyLoadError(t,Wn.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),a))},onAbort:function(e,i,a){n.resetLoader(i),o(n.createKeyLoadError(t,Wn.INTERNAL_ABORTED,new Error("key loading aborted"),a))}};a.load(s,u,c)}))}},{key:"resetLoader",value:function(e){var t=e.frag,n=e.keyInfo,i=e.url,a=n.loader;t.keyLoader===a&&(t.keyLoader=null,n.loader=null),delete this.keyUriToKeyInfo[i],a&&a.destroy()}}]),e}();function kc(){return self.SourceBuffer||self.WebKitSourceBuffer}function Tc(){if(!Ra())return!1;var e=kc();return!e||e.prototype&&"function"===typeof e.prototype.appendBuffer&&"function"===typeof e.prototype.remove}var _c=function(){function e(t,n,i,a){(0,m.A)(this,e),this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=t,this.media=n,this.fragmentTracker=i,this.hls=a}return(0,v.A)(e,[{key:"destroy",value:function(){this.media=null,this.hls=this.fragmentTracker=null}},{key:"poll",value:function(e,t){var n=this.config,i=this.media,a=this.stalled;if(null!==i){var r=i.currentTime,o=i.seeking,s=this.seeking&&!o,l=!this.seeking&&o;if(this.seeking=o,r===e)if(l||s)this.stalled=null;else if(i.paused&&!o||i.ended||0===i.playbackRate||!wo.getBuffered(i).length)this.nudgeRetry=0;else{var u=wo.bufferInfo(i,r,0),c=u.nextStart||0;if(o){var d=u.len>2,h=!c||t&&t.start<=r||c-r>2&&!this.fragmentTracker.getPartialFragment(r);if(d||h)return;this.moved=!1}if(!this.moved&&null!==this.stalled){var f;if(!(u.len>0)&&!c)return;var v=Math.max(c,u.start||0)-r,m=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,p=(null==m||null==(f=m.details)?void 0:f.live)?2*m.details.targetduration:2,g=this.fragmentTracker.getPartialFragment(r);if(v>0&&(v<=p||g))return void(i.paused||this._trySkipBufferHole(g))}var y=self.performance.now();if(null!==a){var E=y-a;if(o||!(E>=250)||(this._reportStall(u),this.media)){var A=wo.bufferInfo(i,r,n.maxBufferHole);this._tryFixBufferStall(A,E)}}else this.stalled=y}else if(this.moved=!0,o||(this.nudgeRetry=0),null!==a){if(this.stallReported){var b=self.performance.now()-a;Xn.warn("playback not stuck anymore @".concat(r,", after ").concat(Math.round(b),"ms")),this.stallReported=!1}this.stalled=null}}}},{key:"_tryFixBufferStall",value:function(e,t){var n=this.config,i=this.fragmentTracker,a=this.media;if(null!==a){var r=a.currentTime,o=i.getPartialFragment(r);if(o)if(this._trySkipBufferHole(o)||!this.media)return;(e.len>n.maxBufferHole||e.nextStart&&e.nextStart-r<n.maxBufferHole)&&t>1e3*n.highBufferWatchdogPeriod&&(Xn.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}}},{key:"_reportStall",value:function(e){var t=this.hls,n=this.media;if(!this.stallReported&&n){this.stallReported=!0;var i=new Error("Playback stalling at @".concat(n.currentTime," due to low buffer (").concat(JSON.stringify(e),")"));Xn.warn(i.message),t.trigger(Gn.ERROR,{type:Kn.MEDIA_ERROR,details:Wn.BUFFER_STALLED_ERROR,fatal:!1,error:i,buffer:e.len})}}},{key:"_trySkipBufferHole",value:function(e){var t=this.config,n=this.hls,i=this.media;if(null===i)return 0;var a=i.currentTime,r=wo.bufferInfo(i,a,0),o=a<r.start?r.start:r.nextStart;if(o){var s=r.len<=t.maxBufferHole,l=r.len>0&&r.len<1&&i.readyState<3,u=o-a;if(u>0&&(s||l)){if(u>t.maxBufferHole){var c=this.fragmentTracker,d=!1;if(0===a){var h=c.getAppendedFrag(0,nr);h&&o<h.end&&(d=!0)}if(!d){var f=e||c.getAppendedFrag(a,nr);if(f){for(var v=!1,m=f.end;m<o;){var p=c.getPartialFragment(m);if(!p){v=!0;break}m+=p.duration}if(v)return 0}}}var g=Math.max(o+.05,a+.1);if(Xn.warn("skipping hole, adjusting currentTime from ".concat(a," to ").concat(g)),this.moved=!0,this.stalled=null,i.currentTime=g,e&&!e.gap){var y=new Error("fragment loaded with buffer holes, seeking from ".concat(a," to ").concat(g));n.trigger(Gn.ERROR,{type:Kn.MEDIA_ERROR,details:Wn.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:y,reason:y.message,frag:e})}return g}}return 0}},{key:"_tryNudgeBuffer",value:function(){var e=this.config,t=this.hls,n=this.media,i=this.nudgeRetry;if(null!==n){var a=n.currentTime;if(this.nudgeRetry++,i<e.nudgeMaxRetry){var r=a+(i+1)*e.nudgeOffset,o=new Error("Nudging 'currentTime' from ".concat(a," to ").concat(r));Xn.warn(o.message),n.currentTime=r,t.trigger(Gn.ERROR,{type:Kn.MEDIA_ERROR,details:Wn.BUFFER_NUDGE_ON_STALL,error:o,fatal:!1})}else{var s=new Error("Playhead still not moving while enough data buffered @".concat(a," after ").concat(e.nudgeMaxRetry," nudges"));Xn.error(s.message),t.trigger(Gn.ERROR,{type:Kn.MEDIA_ERROR,details:Wn.BUFFER_STALLED_ERROR,error:s,fatal:!0})}}}}]),e}(),Sc=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(e,i,a){var r;return(0,m.A)(this,n),(r=t.call(this,e,i,a,"[stream-controller]",nr)).audioCodecSwap=!1,r.gapController=null,r.level=-1,r._forceStartLoad=!1,r.altAudio=!1,r.audioOnly=!1,r.fragPlaying=null,r.onvplaying=null,r.onvseeked=null,r.fragLastKbps=0,r.couldBacktrack=!1,r.backtrackFragment=null,r.audioCodecSwitch=!1,r.videoBuffer=null,r._registerListeners(),r}return(0,v.A)(n,[{key:"_registerListeners",value:function(){var e=this.hls;e.on(Gn.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Gn.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Gn.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Gn.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Gn.LEVEL_LOADING,this.onLevelLoading,this),e.on(Gn.LEVEL_LOADED,this.onLevelLoaded,this),e.on(Gn.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(Gn.ERROR,this.onError,this),e.on(Gn.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(Gn.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(Gn.BUFFER_CREATED,this.onBufferCreated,this),e.on(Gn.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(Gn.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(Gn.FRAG_BUFFERED,this.onFragBuffered,this)}},{key:"_unregisterListeners",value:function(){var e=this.hls;e.off(Gn.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Gn.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Gn.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Gn.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Gn.LEVEL_LOADED,this.onLevelLoaded,this),e.off(Gn.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(Gn.ERROR,this.onError,this),e.off(Gn.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(Gn.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(Gn.BUFFER_CREATED,this.onBufferCreated,this),e.off(Gn.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(Gn.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(Gn.FRAG_BUFFERED,this.onFragBuffered,this)}},{key:"onHandlerDestroying",value:function(){this._unregisterListeners(),(0,u.A)((0,c.A)(n.prototype),"onHandlerDestroying",this).call(this)}},{key:"startLoad",value:function(e){if(this.levels){var t=this.lastCurrentTime,n=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,!this.startFragRequested){var i=n.startLevel;-1===i&&(n.config.testBandwidth&&this.levels.length>1?(i=0,this.bitrateTest=!0):i=n.firstAutoLevel),n.nextLoadLevel=i,this.level=n.loadLevel,this.loadedmetadata=!1}t>0&&-1===e&&(this.log("Override startPosition with lastCurrentTime @".concat(t.toFixed(3))),e=t),this.state=Vo,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=Wo}},{key:"stopLoad",value:function(){this._forceStartLoad=!1,(0,u.A)((0,c.A)(n.prototype),"stopLoad",this).call(this)}},{key:"doTick",value:function(){switch(this.state){case es:var e=this.levels,t=this.level,n=null==e?void 0:e[t],i=null==n?void 0:n.details;if(i&&(!i.live||this.levelLastLoaded===n)){if(this.waitForCdnTuneIn(i))break;this.state=Vo;break}if(this.hls.nextLoadLevel!==this.level){this.state=Vo;break}break;case jo:var a,r=self.performance.now(),o=this.retryDate;if(!o||r>=o||null!=(a=this.media)&&a.seeking){var s=this.levels,l=this.level,u=null==s?void 0:s[l];this.resetStartWhenNotLoaded(u||null),this.state=Vo}}this.state===Vo&&this.doTickIdle(),this.onTickEnd()}},{key:"onTickEnd",value:function(){(0,u.A)((0,c.A)(n.prototype),"onTickEnd",this).call(this),this.checkBuffer(),this.checkFragmentChanged()}},{key:"doTickIdle",value:function(){var e=this.hls,t=this.levelLastLoaded,n=this.levels,i=this.media;if(null!==t&&(i||!this.startFragRequested&&e.config.startFragPrefetch)&&(!this.altAudio||!this.audioOnly)){var a=this.buffering?e.nextLoadLevel:e.loadLevel;if(null!=n&&n[a]){var r=n[a],o=this.getMainFwdBufferInfo();if(null!==o){var s=this.getLevelDetails();if(s&&this._streamEnded(o,s)){var l={};return this.altAudio&&(l.type="video"),this.hls.trigger(Gn.BUFFER_EOS,l),void(this.state=Zo)}if(this.buffering){e.loadLevel!==a&&-1===e.manualLevel&&this.log("Adapting to level ".concat(a," from level ").concat(this.level)),this.level=e.nextLoadLevel=a;var u=r.details;if(!u||this.state===es||u.live&&this.levelLastLoaded!==r)return this.level=a,void(this.state=es);var c=o.len,d=this.getMaxBufferLength(r.maxBitrate);if(!(c>=d)){this.backtrackFragment&&this.backtrackFragment.start>o.end&&(this.backtrackFragment=null);var h=this.backtrackFragment?this.backtrackFragment.start:o.end,f=this.getNextFragment(h,u);if(this.couldBacktrack&&!this.fragPrevious&&f&&"initSegment"!==f.sn&&this.fragmentTracker.getState(f)!==bo){var v,m=(null!=(v=this.backtrackFragment)?v:f).sn-u.startSN,p=u.fragments[m-1];p&&f.cc===p.cc&&(f=p,this.fragmentTracker.removeFragment(p))}else this.backtrackFragment&&o.len&&(this.backtrackFragment=null);if(f&&this.isLoopLoading(f,h)){if(!f.gap){var g=this.audioOnly&&!this.altAudio?ni:ii,y=(g===ii?this.videoBuffer:this.mediaBuffer)||this.media;y&&this.afterBufferFlushed(y,g,nr)}f=this.getNextFragmentLoopLoading(f,u,o,nr,d)}f&&(!f.initSegment||f.initSegment.data||this.bitrateTest||(f=f.initSegment),this.loadFragment(f,r,h))}}}}}}},{key:"loadFragment",value:function(e,t,i){var a=this.fragmentTracker.getState(e);this.fragCurrent=e,a===yo||a===Ao?"initSegment"===e.sn?this._loadInitSegment(e,t):this.bitrateTest?(this.log("Fragment ".concat(e.sn," of level ").concat(e.level," is being downloaded to test bitrate and will not be buffered")),this._loadBitrateTestFrag(e,t)):(this.startFragRequested=!0,(0,u.A)((0,c.A)(n.prototype),"loadFragment",this).call(this,e,t,i)):this.clearTrackerIfNeeded(e)}},{key:"getBufferedFrag",value:function(e){return this.fragmentTracker.getBufferedFrag(e,nr)}},{key:"followingBufferedFrag",value:function(e){return e?this.getBufferedFrag(e.end+.5):null}},{key:"immediateLevelSwitch",value:function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}},{key:"nextLevelSwitch",value:function(){var e=this.levels,t=this.media;if(null!=t&&t.readyState){var n,i=this.getAppendedFrag(t.currentTime);i&&i.start>1&&this.flushMainBuffer(0,i.start-1);var a=this.getLevelDetails();if(null!=a&&a.live){var r=this.getMainFwdBufferInfo();if(!r||r.len<2*a.targetduration)return}if(!t.paused&&e){var o=e[this.hls.nextLoadLevel],s=this.fragLastKbps;n=s&&this.fragCurrent?this.fragCurrent.duration*o.maxBitrate/(1e3*s)+1:0}else n=0;var l=this.getBufferedFrag(t.currentTime+n);if(l){var u=this.followingBufferedFrag(l);if(u){this.abortCurrentFrag();var c=u.maxStartPTS?u.maxStartPTS:u.start,d=u.duration,h=Math.max(l.end,c+Math.min(Math.max(d-this.config.maxFragLookUpTolerance,d*(this.couldBacktrack?.5:.125)),d*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(h,Number.POSITIVE_INFINITY)}}}}},{key:"abortCurrentFrag",value:function(){var e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case qo:case Yo:case jo:case Xo:case Qo:this.state=Vo}this.nextLoadPosition=this.getLoadPosition()}},{key:"flushMainBuffer",value:function(e,t){(0,u.A)((0,c.A)(n.prototype),"flushMainBuffer",this).call(this,e,t,this.altAudio?"video":null)}},{key:"onMediaAttached",value:function(e,t){(0,u.A)((0,c.A)(n.prototype),"onMediaAttached",this).call(this,e,t);var i=t.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),i.addEventListener("playing",this.onvplaying),i.addEventListener("seeked",this.onvseeked),this.gapController=new _c(this.config,i,this.fragmentTracker,this.hls)}},{key:"onMediaDetaching",value:function(){var e=this.media;e&&this.onvplaying&&this.onvseeked&&(e.removeEventListener("playing",this.onvplaying),e.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),(0,u.A)((0,c.A)(n.prototype),"onMediaDetaching",this).call(this)}},{key:"onMediaPlaying",value:function(){this.tick()}},{key:"onMediaSeeked",value:function(){var e=this.media,t=e?e.currentTime:null;Fn(t)&&this.log("Media seeked to ".concat(t.toFixed(3)));var n=this.getMainFwdBufferInfo();null!==n&&0!==n.len?this.tick():this.warn('Main forward buffer length on "seeked" event '.concat(n?n.len:"empty",")"))}},{key:"onManifestLoading",value:function(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(Gn.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=this.fragLastKbps=0,this.levels=this.fragPlaying=this.backtrackFragment=this.levelLastLoaded=null,this.altAudio=this.audioOnly=this.startFragRequested=!1}},{key:"onManifestParsed",value:function(e,t){var n=!1,i=!1;t.levels.forEach((function(e){var t=e.audioCodec;t&&(n=n||-1!==t.indexOf("mp4a.40.2"),i=i||-1!==t.indexOf("mp4a.40.5"))})),this.audioCodecSwitch=n&&i&&!function(){var e,t=kc();return"function"===typeof(null==t||null==(e=t.prototype)?void 0:e.changeType)}(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}},{key:"onLevelLoading",value:function(e,t){var n=this.levels;if(n&&this.state===Vo){var i=n[t.level];(!i.details||i.details.live&&this.levelLastLoaded!==i||this.waitForCdnTuneIn(i.details))&&(this.state=es)}}},{key:"onLevelLoaded",value:function(e,t){var n,i=this.levels,a=t.level,r=t.details,o=r.totalduration;if(i){this.log("Level ".concat(a," loaded [").concat(r.startSN,",").concat(r.endSN,"]").concat(r.lastPartSn?"[part-".concat(r.lastPartSn,"-").concat(r.lastPartIndex,"]"):"",", cc [").concat(r.startCC,", ").concat(r.endCC,"] duration:").concat(o));var s=i[a],l=this.fragCurrent;!l||this.state!==Yo&&this.state!==jo||l.level!==t.level&&l.loader&&this.abortCurrentFrag();var u=0;if(r.live||null!=(n=s.details)&&n.live){var c;if(this.checkLiveUpdate(r),r.deltaUpdateFailed)return;u=this.alignPlaylists(r,s.details,null==(c=this.levelLastLoaded)?void 0:c.details)}if(s.details=r,this.levelLastLoaded=s,this.hls.trigger(Gn.LEVEL_UPDATED,{details:r,level:a}),this.state===es){if(this.waitForCdnTuneIn(r))return;this.state=Vo}this.startFragRequested?r.live&&this.synchronizeToLiveEdge(r):this.setStartPosition(r,u),this.tick()}else this.warn("Levels were reset while loading level ".concat(a))}},{key:"_handleFragmentLoadProgress",value:function(e){var t,n=e.frag,i=e.part,a=e.payload,r=this.levels;if(r){var o=r[n.level],s=o.details;if(!s)return this.warn("Dropping fragment ".concat(n.sn," of level ").concat(n.level," after level details were reset")),void this.fragmentTracker.removeFragment(n);var l=o.videoCodec,u=s.PTSKnown||!s.live,c=null==(t=n.initSegment)?void 0:t.data,d=this._getAudioCodec(o),h=this.transmuxer=this.transmuxer||new fl(this.hls,nr,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),f=i?i.index:-1,v=-1!==f,m=new Ro(n.level,n.sn,n.stats.chunkCount,a.byteLength,f,v),p=this.initPTS[n.cc];h.push(a,c,d,l,n,i,s.totalduration,u,m,p)}else this.warn("Levels were reset while fragment load was in progress. Fragment ".concat(n.sn," of level ").concat(n.level," will not be buffered"))}},{key:"onAudioTrackSwitching",value:function(e,t){var n=this.altAudio;if(!!!t.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var i=this.fragCurrent;i&&(this.log("Switching to main audio track, cancel main fragment load"),i.abortRequests(),this.fragmentTracker.removeFragment(i)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();var a=this.hls;n&&(a.trigger(Gn.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),a.trigger(Gn.AUDIO_TRACK_SWITCHED,t)}}},{key:"onAudioTrackSwitched",value:function(e,t){var n=t.id,i=!!this.hls.audioTracks[n].url;if(i){var a=this.videoBuffer;a&&this.mediaBuffer!==a&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=a)}this.altAudio=i,this.tick()}},{key:"onBufferCreated",value:function(e,t){var n,i,a=t.tracks,r=!1;for(var o in a){var s=a[o];if("main"===s.id){if(i=o,n=s,"video"===o){var l=a[o];l&&(this.videoBuffer=l.buffer)}}else r=!0}r&&n?(this.log("Alternate track found, use ".concat(i,".buffered to schedule main fragment loading")),this.mediaBuffer=n.buffer):this.mediaBuffer=this.media}},{key:"onFragBuffered",value:function(e,t){var n=t.frag,i=t.part;if(!n||n.type===nr){if(this.fragContextChanged(n))return this.warn("Fragment ".concat(n.sn).concat(i?" p: "+i.index:""," of level ").concat(n.level," finished buffering, but was aborted. state: ").concat(this.state)),void(this.state===Qo&&(this.state=Vo));var a=i?i.stats:n.stats;this.fragLastKbps=Math.round(8*a.total/(a.buffering.end-a.loading.first)),"initSegment"!==n.sn&&(this.fragPrevious=n),this.fragBufferedComplete(n,i)}}},{key:"onError",value:function(e,t){var n;if(t.fatal)this.state=Jo;else switch(t.details){case Wn.FRAG_GAP:case Wn.FRAG_PARSING_ERROR:case Wn.FRAG_DECRYPT_ERROR:case Wn.FRAG_LOAD_ERROR:case Wn.FRAG_LOAD_TIMEOUT:case Wn.KEY_LOAD_ERROR:case Wn.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(nr,t);break;case Wn.LEVEL_LOAD_ERROR:case Wn.LEVEL_LOAD_TIMEOUT:case Wn.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==es||(null==(n=t.context)?void 0:n.type)!==$a||(this.state=Vo);break;case Wn.BUFFER_APPEND_ERROR:case Wn.BUFFER_FULL_ERROR:if(!t.parent||"main"!==t.parent)return;if(t.details===Wn.BUFFER_APPEND_ERROR)return void this.resetLoadingState();this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case Wn.INTERNAL_EXCEPTION:this.recoverWorkerError(t)}}},{key:"checkBuffer",value:function(){var e=this.media,t=this.gapController;if(e&&t&&e.readyState){if(this.loadedmetadata||!wo.getBuffered(e).length){var n=this.state!==Vo?this.fragCurrent:null;t.poll(this.lastCurrentTime,n)}this.lastCurrentTime=e.currentTime}}},{key:"onFragLoadEmergencyAborted",value:function(){this.state=Vo,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}},{key:"onBufferFlushed",value:function(e,t){var n=t.type;if(n!==ni||this.audioOnly&&!this.altAudio){var i=(n===ii?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(i,n,nr),this.tick()}}},{key:"onLevelsUpdated",value:function(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level),this.levels=t.levels}},{key:"swapAudioCodec",value:function(){this.audioCodecSwap=!this.audioCodecSwap}},{key:"seekToStartPos",value:function(){var e=this.media;if(e){var t=e.currentTime,n=this.startPosition;if(n>=0&&t<n){if(e.seeking)return void this.log("could not seek to ".concat(n,", already seeking at ").concat(t));var i=wo.getBuffered(e),a=(i.length?i.start(0):0)-n;a>0&&(a<this.config.maxBufferHole||a<this.config.maxFragLookUpTolerance)&&(this.log("adjusting start position by ".concat(a," to match buffer start")),n+=a,this.startPosition=n),this.log("seek to target start position ".concat(n," from current time ").concat(t)),e.currentTime=n}}}},{key:"_getAudioCodec",value:function(e){var t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),t}},{key:"_loadBitrateTestFrag",value:function(e,t){var n=this;e.bitrateTest=!0,this._doFragLoad(e,t).then((function(i){var a=n.hls;if(i&&!n.fragContextChanged(e)){t.fragmentError=0,n.state=Vo,n.startFragRequested=!1,n.bitrateTest=!1;var r=e.stats;r.parsing.start=r.parsing.end=r.buffering.start=r.buffering.end=self.performance.now(),a.trigger(Gn.FRAG_LOADED,i),e.bitrateTest=!1}}))}},{key:"_handleTransmuxComplete",value:function(e){var t,n="main",i=this.hls,a=e.remuxResult,r=e.chunkMeta,o=this.getCurrentContext(r);if(o){var s=o.frag,l=o.part,u=o.level,c=a.video,d=a.text,h=a.id3,f=a.initSegment,v=u.details,m=this.altAudio?void 0:a.audio;if(this.fragContextChanged(s))this.fragmentTracker.removeFragment(s);else{if(this.state=Xo,f){if(null!=f&&f.tracks){var p=s.initSegment||s;this._bufferInitSegment(u,f.tracks,p,r),i.trigger(Gn.FRAG_PARSING_INIT_SEGMENT,{frag:p,id:n,tracks:f.tracks})}var g=f.initPTS,y=f.timescale;Fn(g)&&(this.initPTS[s.cc]={baseTime:g,timescale:y},i.trigger(Gn.INIT_PTS_FOUND,{frag:s,id:n,initPTS:g,timescale:y}))}if(c&&v&&"initSegment"!==s.sn){var E=v.fragments[s.sn-1-v.startSN],A=s.sn===v.startSN,b=!E||s.cc>E.cc;if(!1!==a.independent){var k=c.startPTS,T=c.endPTS,_=c.startDTS,S=c.endDTS;if(l)l.elementaryStreams[c.type]={startPTS:k,endPTS:T,startDTS:_,endDTS:S};else if(c.firstKeyFrame&&c.independent&&1===r.id&&!b&&(this.couldBacktrack=!0),c.dropped&&c.independent){var w=this.getMainFwdBufferInfo(),R=(w?w.end:this.getLoadPosition())+this.config.maxBufferHole,L=c.firstKeyFramePTS?c.firstKeyFramePTS:k;if(!A&&R<L-this.config.maxBufferHole&&!b)return void this.backtrack(s);b&&(s.gap=!0),s.setElementaryStreamInfo(c.type,s.start,T,s.start,S,!0)}else A&&k>2&&(s.gap=!0);s.setElementaryStreamInfo(c.type,k,T,_,S),this.backtrackFragment&&(this.backtrackFragment=s),this.bufferFragmentData(c,s,l,r,A||b)}else{if(!A&&!b)return void this.backtrack(s);s.gap=!0}}if(m){var I=m.startPTS,D=m.endPTS,C=m.startDTS,x=m.endDTS;l&&(l.elementaryStreams[ni]={startPTS:I,endPTS:D,startDTS:C,endDTS:x}),s.setElementaryStreamInfo(ni,I,D,C,x),this.bufferFragmentData(m,s,l,r)}if(v&&null!=h&&null!=(t=h.samples)&&t.length){var M={id:n,frag:s,details:v,samples:h.samples};i.trigger(Gn.FRAG_PARSING_METADATA,M)}if(v&&d){var O={id:n,frag:s,details:v,samples:d.samples};i.trigger(Gn.FRAG_PARSING_USERDATA,O)}}}else this.resetWhenMissingContext(r)}},{key:"_bufferInitSegment",value:function(e,t,n,i){var a=this;if(this.state===Xo){this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;var r=t.audio,o=t.video,s=t.audiovideo;if(r){var l=e.audioCodec,u=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){l&&(l=-1!==l.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5");var c=r.metadata;c&&"channelCount"in c&&1!==(c.channelCount||1)&&-1===u.indexOf("firefox")&&(l="mp4a.40.5")}l&&-1!==l.indexOf("mp4a.40.5")&&-1!==u.indexOf("android")&&"audio/mpeg"!==r.container&&(l="mp4a.40.2",this.log("Android: force audio codec to ".concat(l))),e.audioCodec&&e.audioCodec!==l&&this.log('Swapping manifest audio codec "'.concat(e.audioCodec,'" for "').concat(l,'"')),r.levelCodec=l,r.id="main",this.log("Init audio buffer, container:".concat(r.container,", codecs[selected/level/parsed]=[").concat(l||"","/").concat(e.audioCodec||"","/").concat(r.codec,"]"))}o&&(o.levelCodec=e.videoCodec,o.id="main",this.log("Init video buffer, container:".concat(o.container,", codecs[level/parsed]=[").concat(e.videoCodec||"","/").concat(o.codec,"]"))),s&&this.log("Init audiovideo buffer, container:".concat(s.container,", codecs[level/parsed]=[").concat(e.codecs,"/").concat(s.codec,"]")),this.hls.trigger(Gn.BUFFER_CODECS,t),Object.keys(t).forEach((function(e){var r=t[e].initSegment;null!=r&&r.byteLength&&a.hls.trigger(Gn.BUFFER_APPENDING,{type:e,data:r,frag:n,part:null,chunkMeta:i,parent:n.type})})),this.tickImmediate()}}},{key:"getMainFwdBufferInfo",value:function(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,nr)}},{key:"backtrack",value:function(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=Vo}},{key:"checkFragmentChanged",value:function(){var e=this.media,t=null;if(e&&e.readyState>1&&!1===e.seeking){var n=e.currentTime;if(wo.isBuffered(e,n)?t=this.getAppendedFrag(n):wo.isBuffered(e,n+.1)&&(t=this.getAppendedFrag(n+.1)),t){this.backtrackFragment=null;var i=this.fragPlaying,a=t.level;i&&t.sn===i.sn&&i.level===a||(this.fragPlaying=t,this.hls.trigger(Gn.FRAG_CHANGED,{frag:t}),i&&i.level===a||this.hls.trigger(Gn.LEVEL_SWITCHED,{level:a}))}}}},{key:"nextLevel",get:function(){var e=this.nextBufferedFrag;return e?e.level:-1}},{key:"currentFrag",get:function(){var e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}},{key:"currentProgramDateTime",get:function(){var e=this.media;if(e){var t=e.currentTime,n=this.currentFrag;if(n&&Fn(t)&&Fn(n.programDateTime)){var i=n.programDateTime+1e3*(t-n.start);return new Date(i)}}return null}},{key:"currentLevel",get:function(){var e=this.currentFrag;return e?e.level:-1}},{key:"nextBufferedFrag",get:function(){var e=this.currentFrag;return e?this.followingBufferedFrag(e):null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}]),n}(ts),wc=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,m.A)(this,e),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this.started=!1,this._emitter=new hl,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,this.triggeringException=void 0,zn(t.debug||!1,"Hls instance");var n=this.config=pc(e.DefaultConfig,t);this.userConfig=t,n.progressive&&yc(n);var i=n.abrController,a=n.bufferController,r=n.capLevelController,o=n.errorController,s=n.fpsController,l=new o(this),u=this.abrController=new i(this),c=this.bufferController=new a(this),d=this.capLevelController=new r(this),h=new s(this),f=new sr(this),v=new Ar(this),p=n.contentSteeringController,g=p?new p(this):null,y=this.levelController=new Ec(this,g),E=new ko(this),A=new bc(this.config),b=this.streamController=new Sc(this,E,A);d.setStreamController(b),h.setStreamController(b);var k=[f,y,b];g&&k.splice(1,0,g),this.networkControllers=k;var T=[u,c,d,h,v,E];this.audioTrackController=this.createController(n.audioTrackController,k);var _=n.audioStreamController;_&&k.push(new _(this,E,A)),this.subtitleTrackController=this.createController(n.subtitleTrackController,k);var S=n.subtitleStreamController;S&&k.push(new S(this,E,A)),this.createController(n.timelineController,T),A.emeController=this.emeController=this.createController(n.emeController,T),this.cmcdController=this.createController(n.cmcdController,T),this.latencyController=this.createController(br,T),this.coreComponents=T,k.push(l);var w=l.onErrorOut;"function"===typeof w&&this.on(Gn.ERROR,w,l)}return(0,v.A)(e,[{key:"createController",value:function(e,t){if(e){var n=new e(this);return t&&t.push(n),n}return null}},{key:"on",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this;this._emitter.on(e,t,n)}},{key:"once",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this;this._emitter.once(e,t,n)}},{key:"removeAllListeners",value:function(e){this._emitter.removeAllListeners(e)}},{key:"off",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this,i=arguments.length>3?arguments[3]:void 0;this._emitter.off(e,t,n,i)}},{key:"listeners",value:function(e){return this._emitter.listeners(e)}},{key:"emit",value:function(e,t,n){return this._emitter.emit(e,t,n)}},{key:"trigger",value:function(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(i){if(Xn.error("An internal error happened while handling event "+e+'. Error message: "'+i.message+'". Here is a stacktrace:',i),!this.triggeringException){this.triggeringException=!0;var n=e===Gn.ERROR;this.trigger(Gn.ERROR,{type:Kn.OTHER_ERROR,details:Wn.INTERNAL_EXCEPTION,fatal:n,event:e,error:i}),this.triggeringException=!1}}return!1}},{key:"listenerCount",value:function(e){return this._emitter.listenerCount(e)}},{key:"destroy",value:function(){Xn.log("destroy"),this.trigger(Gn.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach((function(e){return e.destroy()})),this.networkControllers.length=0,this.coreComponents.forEach((function(e){return e.destroy()})),this.coreComponents.length=0;var e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}},{key:"attachMedia",value:function(e){Xn.log("attachMedia"),this._media=e,this.trigger(Gn.MEDIA_ATTACHING,{media:e})}},{key:"detachMedia",value:function(){Xn.log("detachMedia"),this.trigger(Gn.MEDIA_DETACHING,void 0),this._media=null}},{key:"loadSource",value:function(e){this.stopLoad();var t=this.media,n=this.url,i=this.url=xn.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,Xn.log("loadSource:".concat(i)),t&&n&&(n!==i||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(Gn.MANIFEST_LOADING,{url:e})}},{key:"startLoad",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;Xn.log("startLoad(".concat(e,")")),this.started=!0,this.resumeBuffering();for(var t=0;t<this.networkControllers.length&&(this.networkControllers[t].startLoad(e),this.started&&this.networkControllers);t++);}},{key:"stopLoad",value:function(){Xn.log("stopLoad"),this.started=!1;for(var e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!this.started&&this.networkControllers);e++);}},{key:"resumeBuffering",value:function(){Xn.log("resume buffering"),this.networkControllers.forEach((function(e){e.resumeBuffering&&e.resumeBuffering()}))}},{key:"pauseBuffering",value:function(){Xn.log("pause buffering"),this.networkControllers.forEach((function(e){e.pauseBuffering&&e.pauseBuffering()}))}},{key:"swapAudioCodec",value:function(){Xn.log("swapAudioCodec"),this.streamController.swapAudioCodec()}},{key:"recoverMediaError",value:function(){Xn.log("recoverMediaError");var e=this._media;this.detachMedia(),e&&this.attachMedia(e)}},{key:"removeLevel",value:function(e){this.levelController.removeLevel(e)}},{key:"levels",get:function(){var e=this.levelController.levels;return e||[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){Xn.log("set currentLevel:".concat(e)),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){Xn.log("set nextLevel:".concat(e)),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){Xn.log("set loadLevel:".concat(e)),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){Xn.log("set firstLevel:".concat(e)),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){var e=this.levelController.startLevel;return-1===e&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e},set:function(e){Xn.log("set startLevel:".concat(e)),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(e){var t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){this._autoLevelCapping!==e&&(Xn.log("set autoLevelCapping:".concat(e)),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}},{key:"bandwidthEstimate",get:function(){var e=this.abrController.bwEstimator;return e?e.getEstimate():NaN},set:function(e){this.abrController.resetEstimator(e)}},{key:"ttfbEstimate",get:function(){var e=this.abrController.bwEstimator;return e?e.getEstimateTTFB():NaN}},{key:"maxHdcpLevel",get:function(){return this._maxHdcpLevel},set:function(e){(function(e){return kr.indexOf(e)>-1})(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var e=this.levels,t=this.config.minAutoBitrate;if(!e)return 0;for(var n=e.length,i=0;i<n;i++)if(e[i].maxBitrate>=t)return i;return 0}},{key:"maxAutoLevel",get:function(){var e,t=this.levels,n=this.autoLevelCapping,i=this.maxHdcpLevel;if(e=-1===n&&null!=t&&t.length?t.length-1:n,i)for(var a=e;a--;){var r=t[a].attrs["HDCP-LEVEL"];if(r&&r<=i)return a}return e}},{key:"firstAutoLevel",get:function(){return this.abrController.firstAutoLevel}},{key:"nextAutoLevel",get:function(){return this.abrController.nextAutoLevel},set:function(e){this.abrController.nextAutoLevel=e}},{key:"playingDate",get:function(){return this.streamController.currentProgramDateTime}},{key:"mainForwardBufferInfo",get:function(){return this.streamController.getMainFwdBufferInfo()}},{key:"setAudioOption",value:function(e){var t;return null==(t=this.audioTrackController)?void 0:t.setAudioOption(e)}},{key:"setSubtitleOption",value:function(e){var t;return null==(t=this.subtitleTrackController)||t.setSubtitleOption(e),null}},{key:"allAudioTracks",get:function(){var e=this.audioTrackController;return e?e.allAudioTracks:[]}},{key:"audioTracks",get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]}},{key:"audioTrack",get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)}},{key:"allSubtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}},{key:"subtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var e=this.subtitleTrackController;return!!e&&e.subtitleDisplay},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(e){this.config.lowLatencyMode=e}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}],[{key:"version",get:function(){return"1.5.20"}},{key:"isMSESupported",value:function(){return Tc()}},{key:"isSupported",value:function(){return function(){if(!Tc())return!1;var e=Ra();return"function"===typeof(null==e?void 0:e.isTypeSupported)&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some((function(t){return e.isTypeSupported(Ca(t,"video"))}))||["mp4a.40.2","fLaC"].some((function(t){return e.isTypeSupported(Ca(t,"audio"))})))}()}},{key:"getMediaSource",value:function(){return Ra()}},{key:"Events",get:function(){return Gn}},{key:"ErrorTypes",get:function(){return Kn}},{key:"ErrorDetails",get:function(){return Wn}},{key:"DefaultConfig",get:function(){return e.defaultConfig?e.defaultConfig:mc},set:function(t){e.defaultConfig=t}}]),e}();wc.defaultConfig=void 0;var Rc=wc,Lc="video",Ic="drm",Dc={NOT_AN_ERROR:0,NETWORK_OFFLINE:2000002,NETWORK_UNKNOWN_ERROR:2e6,NETWORK_NO_STATUS:2000001,NETWORK_INVALID_URL:24e5,NETWORK_NOT_FOUND:2404e3,NETWORK_NOT_READY:2412e3,NETWORK_GENERIC_SERVER_FAIL:25e5,NETWORK_TOKEN_MISSING:2403201,NETWORK_TOKEN_MALFORMED:2412202,NETWORK_TOKEN_EXPIRED:2403210,NETWORK_TOKEN_AUD_MISSING:2403221,NETWORK_TOKEN_AUD_MISMATCH:2403222,NETWORK_TOKEN_SUB_MISMATCH:2403232,ENCRYPTED_ERROR:5e6,ENCRYPTED_UNSUPPORTED_KEY_SYSTEM:5000001,ENCRYPTED_GENERATE_REQUEST_FAILED:5000002,ENCRYPTED_UPDATE_LICENSE_FAILED:5000003,ENCRYPTED_UPDATE_SERVER_CERT_FAILED:5000004,ENCRYPTED_CDM_ERROR:5000005,ENCRYPTED_OUTPUT_RESTRICTED:5000006,ENCRYPTED_MISSING_TOKEN:5000002},Cc=function(e){return e===Lc?"playback":e},xc=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(e){var i,a,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.MEDIA_ERR_CUSTOM,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,m.A)(this,n),(i=t.call(this,e)).name="MediaError",i.code=r,i.context=s,i.fatal=null!=o?o:r>=n.MEDIA_ERR_NETWORK&&r<=n.MEDIA_ERR_ENCRYPTED,i.message||(i.message=null!=(a=n.defaultMessages[i.code])?a:""),i}return(0,v.A)(n)}((0,y.A)(Error));xc.MEDIA_ERR_ABORTED=1,xc.MEDIA_ERR_NETWORK=2,xc.MEDIA_ERR_DECODE=3,xc.MEDIA_ERR_SRC_NOT_SUPPORTED=4,xc.MEDIA_ERR_ENCRYPTED=5,xc.MEDIA_ERR_CUSTOM=100,xc.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail.",3:"A media error caused playback to be aborted. The media could be corrupt or your browser does not support this format.",4:"An unsupported error occurred. The server or network failed, or your browser does not support this format.",5:"The media is encrypted and there are no keys to decrypt it."};var Mc=xc,Oc=function(e,t){return!function(e){return null==e}(t)&&e in t},Pc={ANY:"any",MUTED:"muted"},Nc={ON_DEMAND:"on-demand",LIVE:"live",UNKNOWN:"unknown"},Uc="mse",Fc="native",Bc={HEADER:"header",QUERY:"query",NONE:"none"},Hc=Object.values(Bc),Gc={M3U8:"application/vnd.apple.mpegurl",MP4:"video/mp4"},Kc={HLS:Gc.M3U8},Wc=(Object.keys(Kc),[].concat((0,f.A)(Object.values(Gc)),["hls","HLS"]),{upTo720p:"720p",upTo1080p:"1080p",upTo1440p:"1440p",upTo2160p:"2160p"}),Vc={noLessThan480p:"480p",noLessThan540p:"540p",noLessThan720p:"720p",noLessThan1080p:"1080p",noLessThan1440p:"1440p",noLessThan2160p:"2160p"},qc={DESCENDING:"desc"},Yc={code:"en"},jc=function(e,t,n,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e;a.addEventListener(t,n,i),e.addEventListener("teardown",(function(){a.removeEventListener(t,n)}),{once:!0})};var zc=function(e){var t=e.indexOf("?");return t<0?[e]:[e.slice(0,t),e.slice(t)]},Xc=function(e){var t=e.type;if(t){var n=t.toUpperCase();return Oc(n,Kc)?Kc[n]:t}return Jc(e)},Qc=function(e){return"VOD"===e?Nc.ON_DEMAND:Nc.LIVE},Zc=function(e){return"EVENT"===e?Number.POSITIVE_INFINITY:"VOD"===e?Number.NaN:0},Jc=function(e){var t=e.src;if(!t)return"";var n="";try{n=new URL(t).pathname}catch(r){console.error("invalid url")}var i=n.lastIndexOf(".");if(i<0)return $c(e)?Gc.M3U8:"";var a=n.slice(i+1).toUpperCase();return Oc(a,Gc)?Gc[a]:""},$c=function(e){var t,n=e.src,i=e.customDomain,a=void 0===i?"mux.com":i;try{t=new URL("".concat(n))}catch(c){return!1}var r="https:"===t.protocol,o=t.hostname==="stream.".concat(a).toLowerCase(),s=t.pathname.split("/"),l=2===s.length,u=!(null!=s&&s[1].includes("."));return r&&o&&l&&u},ed=function(e){var t=(null!=e?e:"").split(".")[1];if(t)try{var n=t.replace(/-/g,"+").replace(/_/g,"/"),i=decodeURIComponent(atob(n).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""));return JSON.parse(i)}catch(a){return}},td=function(e){var t=e.exp,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();return!t||1e3*t<n},nd=function(e,t){return e.sub!==t},id=function(e,t){return!e.aud},ad=function(e,t){return e.aud!==t},rd="en";function od(e){var t,n,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=i&&null!=(n=null==(t=Yc)?void 0:t[e])?n:e,r=i?Yc.code:rd;return new sd(a,r)}var sd=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return null!=(e=Yc)?e:rd}();(0,m.A)(this,e),this.message=t,this.locale=n}return(0,v.A)(e,[{key:"format",value:function(e){return this.message.replace(/\{(\w+)\}/g,(function(t,n){var i;return null!=(i=e[n])?i:""}))}},{key:"toString",value:function(){return this.message}}]),e}(),ld=Object.values(Pc),ud=function(e){return"boolean"==typeof e||"string"==typeof e&&ld.includes(e)},cd=function(e,t){if(t){var n=e.muted,i=function(){return e.muted=n};switch(t){case Pc.ANY:e.play().catch((function(){e.muted=!0,e.play().catch(i)}));break;case Pc.MUTED:e.muted=!0,e.play().catch(i);break;default:e.play().catch((function(){}))}}};function dd(e,t){var n;if("videoTracks"in e){var i=new WeakMap;t.on(Rc.Events.MANIFEST_PARSED,(function(t,n){s();var r=e.addVideoTrack("main");r.selected=!0;var o,l=(0,h.A)(n.levels.entries());try{for(l.s();!(o=l.n()).done;){var u=(0,a.A)(o.value,2),c=u[0],d=u[1],f=r.addRendition(d.url[0],d.width,d.height,d.videoCodec,d.bitrate);i.set(d,"".concat(c)),f.id="".concat(c)}}catch(BL){l.e(BL)}finally{l.f()}})),t.on(Rc.Events.AUDIO_TRACKS_UPDATED,(function(t,n){o();var i,a=(0,h.A)(n.audioTracks);try{for(a.s();!(i=a.n()).done;){var r=i.value,s=r.default?"main":"alternative",l=e.addAudioTrack(s,r.name,r.lang);l.id="".concat(r.id),r.default&&(l.enabled=!0)}}catch(BL){a.e(BL)}finally{a.f()}})),e.audioTracks.addEventListener("change",(function(){var n,i=+(null==(n=(0,f.A)(e.audioTracks).find((function(e){return e.enabled})))?void 0:n.id),a=t.audioTracks.map((function(e){return e.id}));i!=t.audioTrack&&a.includes(i)&&(t.audioTrack=i)})),t.on(Rc.Events.LEVELS_UPDATED,(function(t,n){var a,r=e.videoTracks[null!=(a=e.videoTracks.selectedIndex)?a:0];if(r){var o,s=n.levels.map((function(e){return i.get(e)})),l=(0,h.A)(e.videoRenditions);try{for(l.s();!(o=l.n()).done;){var u=o.value;u.id&&!s.includes(u.id)&&r.removeRendition(u)}}catch(BL){l.e(BL)}finally{l.f()}}}));var r=function(n){var i=e.currentTime,a=!1,r=function(e,t){a||(a=!Number.isFinite(t.endOffset))};t.on(Rc.Events.BUFFER_FLUSHING,r),t.nextLevel=n,t.off(Rc.Events.BUFFER_FLUSHING,r),a||t.trigger(Rc.Events.BUFFER_FLUSHING,{startOffset:i+10,endOffset:1/0,type:"video"})};null==(n=e.videoRenditions)||n.addEventListener("change",(function(e){var n=e.target.selectedIndex;n!=t.nextLevel&&r(n)}));var o=function(){var t,n=(0,h.A)(e.audioTracks);try{for(n.s();!(t=n.n()).done;){var i=t.value;e.removeAudioTrack(i)}}catch(BL){n.e(BL)}finally{n.f()}},s=function(){(function(){var t,n=(0,h.A)(e.videoTracks);try{for(n.s();!(t=n.n()).done;){var i=t.value;e.removeVideoTrack(i)}}catch(BL){n.e(BL)}finally{n.f()}})(),o()};t.once(Rc.Events.DESTROYING,s)}}var hd=function(e){return"time"in e?e.time:e.startTime};function fd(e,t,n,i,a,r){var o=document.createElement("track");return o.kind=t,o.label=n,i&&(o.srclang=i),a&&(o.id=a),r&&(o.default=!0),o.track.mode=["subtitles","captions"].includes(t)?"disabled":"hidden",o.setAttribute("data-removeondestroy",""),e.append(o),o.track}function vd(e,t,n){var i;return null==(i=Array.from(e.querySelectorAll("track")).find((function(e){return e.track.label===t&&e.track.kind===n})))?void 0:i.track}function md(e,t,n,i){return pd.apply(this,arguments)}function pd(){return pd=(0,d.A)((0,l.A)().mark((function e(t,n,i,a){var r;return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=vd(t,i,a),e.t0=r,e.t0){e.next=7;break}return(r=fd(t,a,i)).mode="hidden",e.next=7,new Promise((function(e){return setTimeout((function(){return e(void 0)}),0)}));case 7:return"hidden"!==r.mode&&(r.mode="hidden"),(0,f.A)(n).sort((function(e,t){return hd(t)-hd(e)})).forEach((function(e){var n,i,o=e.value,s=hd(e);if("endTime"in e&&null!=e.endTime)null==r||r.addCue(new VTTCue(s,e.endTime,"chapters"===a?o:JSON.stringify(null!=o?o:null)));else{var l=Array.prototype.findIndex.call(null==r?void 0:r.cues,(function(e){return e.startTime>=s})),u=null==(n=null==r?void 0:r.cues)?void 0:n[l],c=u?u.startTime:Number.isFinite(t.duration)?t.duration:Number.MAX_SAFE_INTEGER,d=null==(i=null==r?void 0:r.cues)?void 0:i[l-1];d&&(d.endTime=s),null==r||r.addCue(new VTTCue(s,c,"chapters"===a?o:JSON.stringify(null!=o?o:null)))}})),t.textTracks.dispatchEvent(new Event("change",{bubbles:!0,composed:!0})),e.abrupt("return",r);case 11:case"end":return e.stop()}}),e)}))),pd.apply(this,arguments)}var gd="cuepoints",yd=Object.freeze({label:gd});function Ed(e,t){return Ad.apply(this,arguments)}function Ad(){return Ad=(0,d.A)((0,l.A)().mark((function e(t,n){var i,a=arguments;return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=a.length>2&&void 0!==a[2]?a[2]:yd,e.abrupt("return",md(t,n,i.label,"metadata"));case 2:case"end":return e.stop()}}),e)}))),Ad.apply(this,arguments)}var bd=function(e){return{time:e.startTime,value:JSON.parse(e.text)}};function kd(e){var t,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{label:gd},a=vd(e,i.label,"metadata");if(null!=(t=null==a?void 0:a.activeCues)&&t.length){if(1===a.activeCues.length)return bd(a.activeCues[0]);var r=e.currentTime,o=Array.prototype.find.call(null!=(n=a.activeCues)?n:[],(function(e){var t=e.startTime,n=e.endTime;return t<=r&&n>r}));return bd(o||a.activeCues[0])}}function Td(){return Td=(0,d.A)((0,l.A)().mark((function e(t){var n,i=arguments;return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:yd,e.abrupt("return",new Promise((function(e){jc(t,"loadstart",(0,d.A)((0,l.A)().mark((function i(){var a;return(0,l.A)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Ed(t,[],n);case 2:a=i.sent,jc(t,"cuechange",(function(){var e=kd(t);if(e){var n=new CustomEvent("cuepointchange",{composed:!0,bubbles:!0,detail:e});t.dispatchEvent(n)}}),{},a),e(a);case 4:case"end":return i.stop()}}),i)}))))})));case 2:case"end":return e.stop()}}),e)}))),Td.apply(this,arguments)}var _d="chapters",Sd=Object.freeze({label:_d}),wd=function(e){return{startTime:e.startTime,endTime:e.endTime,value:e.text}};function Rd(e,t){return Ld.apply(this,arguments)}function Ld(){return Ld=(0,d.A)((0,l.A)().mark((function e(t,n){var i,a=arguments;return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=a.length>2&&void 0!==a[2]?a[2]:Sd,e.abrupt("return",md(t,n,i.label,"chapters"));case 2:case"end":return e.stop()}}),e)}))),Ld.apply(this,arguments)}function Id(e){var t,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{label:_d},a=vd(e,i.label,"chapters");if(null!=(t=null==a?void 0:a.activeCues)&&t.length){if(1===a.activeCues.length)return wd(a.activeCues[0]);var r=e.currentTime,o=Array.prototype.find.call(null!=(n=a.activeCues)?n:[],(function(e){var t=e.startTime,n=e.endTime;return t<=r&&n>r}));return wd(o||a.activeCues[0])}}function Dd(){return Dd=(0,d.A)((0,l.A)().mark((function e(t){var n,i=arguments;return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:Sd,e.abrupt("return",new Promise((function(e){jc(t,"loadstart",(0,d.A)((0,l.A)().mark((function i(){var a;return(0,l.A)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Rd(t,[],n);case 2:a=i.sent,jc(t,"cuechange",(function(){var e=Id(t);if(e){var n=new CustomEvent("chapterchange",{composed:!0,bubbles:!0,detail:e});t.dispatchEvent(n)}}),{},a),e(a);case 4:case"end":return i.stop()}}),i)}))))})));case 2:case"end":return e.stop()}}),e)}))),Dd.apply(this,arguments)}var Cd="v",xd="t",Md="s",Od="d",Pd=function(e){return e===Lc?Cd:e===Ic?Od:void 0},Nd=function(e,t){var n,i,a=Cc(e),r="".concat(a,"Token");return null!=(n=t.tokens)&&n[a]?null==(i=t.tokens)?void 0:i[a]:Oc(r,t)?t[r]:void 0},Ud=function(e,t,n,i){var r,o,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:!function(e){return null==(e=globalThis.navigator)?void 0:e.onLine}();if(l){var u=od("Your device appears to be offline",s),c=void 0,d=Mc.MEDIA_ERR_NETWORK;return(w=new Mc(u,d,!1,c)).errorCategory=t,w.muxCode=Dc.NETWORK_OFFLINE,w.data=e,w}var h="status"in e?e.status:e.code,f=Date.now(),v=Mc.MEDIA_ERR_NETWORK;if(200!==h){var m=Cc(t),p=Nd(t,n),g=Pd(t),y=zc(null!=(r=n.playbackId)?r:""),E=(0,a.A)(y,1),A=E[0];if(h&&A){var b=ed(p);if(p&&!b){u=od("The {tokenNamePrefix}-token provided is invalid or malformed.",s).format({tokenNamePrefix:m}),c=od("Compact JWT string: {token}",s).format({token:p});return(d=new Mc(u,v,!0,c)).errorCategory=t,d.muxCode=Dc.NETWORK_TOKEN_MALFORMED,d.data=e,d}if(h>=500){var k=new Mc("",v,null==i||i);return k.errorCategory=t,k.muxCode=Dc.NETWORK_UNKNOWN_ERROR,k}if(403===h){if(!b){var T=od("Authorization error trying to access this {category} URL. If this is a signed URL, you might need to provide a {tokenNamePrefix}-token.",s).format({tokenNamePrefix:m,category:t}),_=od("Specified playback ID: {playbackId}",s).format({playbackId:A}),S=new Mc(T,v,null==i||i,_);return S.errorCategory=t,S.muxCode=Dc.NETWORK_TOKEN_MISSING,S.data=e,S}if(td(b,f)){var w,R={timeStyle:"medium",dateStyle:"medium"},L=od("The video\u2019s secured {tokenNamePrefix}-token has expired.",s).format({tokenNamePrefix:m}),I=od("Expired at: {expiredDate}. Current time: {currentDate}.",s).format({expiredDate:new Intl.DateTimeFormat("en",R).format(null!=(o=b.exp)?o:0),currentDate:new Intl.DateTimeFormat("en",R).format(f)});return(w=new Mc(L,v,!0,I)).errorCategory=t,w.muxCode=Dc.NETWORK_TOKEN_EXPIRED,w.data=e,w}if(nd(b,A)){var D=od("The video\u2019s playback ID does not match the one encoded in the {tokenNamePrefix}-token.",s).format({tokenNamePrefix:m}),C=od("Specified playback ID: {playbackId} and the playback ID encoded in the {tokenNamePrefix}-token: {tokenPlaybackId}",s).format({tokenNamePrefix:m,playbackId:A,tokenPlaybackId:b.sub}),x=new Mc(D,v,!0,C);return x.errorCategory=t,x.muxCode=Dc.NETWORK_TOKEN_SUB_MISMATCH,x.data=e,x}if(id(b)){var M=od("The {tokenNamePrefix}-token is formatted with incorrect information.",s).format({tokenNamePrefix:m}),O=od("The {tokenNamePrefix}-token has no aud value. aud value should be {expectedAud}.",s).format({tokenNamePrefix:m,expectedAud:g}),P=new Mc(M,v,!0,O);return P.errorCategory=t,P.muxCode=Dc.NETWORK_TOKEN_AUD_MISSING,P.data=e,P}if(ad(b,g)){var N=od("The {tokenNamePrefix}-token is formatted with incorrect information.",s).format({tokenNamePrefix:m}),U=od("The {tokenNamePrefix}-token has an incorrect aud value: {aud}. aud value should be {expectedAud}.",s).format({tokenNamePrefix:m,expectedAud:g,aud:b.aud}),F=new Mc(N,v,!0,U);return F.errorCategory=t,F.muxCode=Dc.NETWORK_TOKEN_AUD_MISMATCH,F.data=e,F}}if(412===h){var B=od("This playback-id may belong to a live stream that is not currently active or an asset that is not ready.",s),H=od("Specified playback ID: {playbackId}",s).format({playbackId:A}),G=new Mc(B,v,null==i||i,H);return G.errorCategory=t,G.muxCode=Dc.NETWORK_NOT_READY,G.streamType=n.streamType===Nc.LIVE?"live":n.streamType===Nc.ON_DEMAND?"on-demand":"unknown",G.data=e,G}if(404===h){var K=od("This URL or playback-id does not exist. You may have used an Asset ID or an ID from a different resource.",s),W=od("Specified playback ID: {playbackId}",s).format({playbackId:A}),V=new Mc(K,v,null==i||i,W);return V.errorCategory=t,V.muxCode=Dc.NETWORK_NOT_FOUND,V.data=e,V}if(400===h){var q=od("The URL or playback-id was invalid. You may have used an invalid value as a playback-id."),Y=od("Specified playback ID: {playbackId}",s).format({playbackId:A}),j=new Mc(q,v,null==i||i,Y);return j.errorCategory=t,j.muxCode=Dc.NETWORK_INVALID_URL,j.data=e,j}var z=new Mc("",v,null==i||i);return z.errorCategory=t,z.muxCode=Dc.NETWORK_UNKNOWN_ERROR,z.data=e,z}}},Fd=Rc.DefaultConfig.capLevelController,Bd=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(e){return(0,m.A)(this,n),t.call(this,e)}return(0,v.A)(n,[{key:"levels",get:function(){var e;return null!=(e=this.hls.levels)?e:[]}},{key:"getValidLevels",value:function(e){var t=this;return this.levels.filter((function(n,i){return t.isLevelAllowed(n)&&i<=e}))}},{key:"getMaxLevel",value:function(e){var t=(0,u.A)((0,c.A)(n.prototype),"getMaxLevel",this).call(this,e),i=this.getValidLevels(e);if(!i[t])return t;var a=Math.min(i[t].width,i[t].height),r=n.minMaxResolution;return a>=r?t:Fd.getMaxLevelByMediaSize(i,r*(16/9),r)}}]),n}(Fd);Bd.minMaxResolution=720;var Hd=Bd,Gd="fairplay",Kd="playready",Wd="widevine",Vd=function(e){var t=e.split("\n").find((function(e,t,n){return t&&n[t-1].startsWith("#EXT-X-STREAM-INF")}));return fetch(t).then((function(e){return 200!==e.status?Promise.reject(e):e.text()}))},qd=function(e){var t=e.split("\n").filter((function(e){return e.startsWith("#EXT-X-SESSION-DATA")}));if(!t.length)return{};var n,a={},r=(0,h.A)(t);try{for(r.s();!(n=r.n()).done;){var o=jd(n.value),s=o["DATA-ID"];s&&(a[s]=(0,i.A)({},o))}}catch(BL){r.e(BL)}finally{r.f()}return{sessionData:a}},Yd=/([A-Z0-9-]+)="?(.*?)"?(?:,|$)/g;function jd(e){var t=(0,f.A)(e.matchAll(Yd));return Object.fromEntries(t.map((function(e){var t=(0,a.A)(e,3);return[t[1],t[2]]})))}var zd,Xd,Qd,Zd,Jd,$d,eh,th=function(e){var t,n,i,a,r=e.split("\n"),o=null==(n=(null!=(t=r.find((function(e){return e.startsWith("#EXT-X-PLAYLIST-TYPE")})))?t:"").split(":")[1])?void 0:n.trim(),s=Qc(o),l=Zc(o);if(s===Nc.LIVE){var u=r.find((function(e){return e.startsWith("#EXT-X-PART-INF")}));if(u)a=2*+u.split(":")[1].split("=")[1];else{var c=r.find((function(e){return e.startsWith("#EXT-X-TARGETDURATION")})),d=null==(i=null==c?void 0:c.split(":"))?void 0:i[1];a=3*+(null!=d?d:6)}}return{streamType:s,targetLiveWindow:l,liveEdgeStartOffset:a}},nh=function(){var e=(0,d.A)((0,l.A)().mark((function e(t,n){var a,r,o;return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n!==Gc.MP4){e.next=2;break}return e.abrupt("return",{streamType:Nc.ON_DEMAND,targetLiveWindow:Number.NaN,liveEdgeStartOffset:void 0,sessionData:void 0});case 2:if(n!==Gc.M3U8){e.next=15;break}return e.next=5,fetch(t);case 5:if((a=e.sent).ok){e.next=8;break}return e.abrupt("return",Promise.reject(a));case 8:return e.next=10,a.text();case 10:return r=e.sent,e.next=13,Vd(r);case 13:return o=e.sent,e.abrupt("return",(0,i.A)((0,i.A)({},qd(r)),th(o)));case 15:return e.abrupt("return",(console.error("Media type ".concat(n," is an unrecognized or unsupported type for src ").concat(t,".")),{streamType:void 0,targetLiveWindow:void 0,liveEdgeStartOffset:void 0,sessionData:void 0}));case 16:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ih=function(){var e=(0,d.A)((0,l.A)().mark((function e(t,n){var i,a,r,o,s,u,c,d,h,f,v,m=arguments;return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=m.length>2&&void 0!==m[2]?m[2]:Xc({src:t}),e.next=3,nh(t,i);case 3:u=e.sent,c=u.streamType,d=u.targetLiveWindow,h=u.liveEdgeStartOffset,f=u.sessionData,(null!=(v=null==f?void 0:f["com.apple.hls.chapters"])&&v.URI||null!=v&&v.VALUE.toLocaleLowerCase().startsWith("http"))&&ah(null!=(a=v.URI)?a:v.VALUE,n),(null!=(r=uh.get(n))?r:{}).liveEdgeStartOffset=h,(null!=(o=uh.get(n))?o:{}).targetLiveWindow=d,n.dispatchEvent(new CustomEvent("targetlivewindowchange",{composed:!0,bubbles:!0})),(null!=(s=uh.get(n))?s:{}).streamType=c,n.dispatchEvent(new CustomEvent("streamtypechange",{composed:!0,bubbles:!0}));case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ah=function(){var e=(0,d.A)((0,l.A)().mark((function e(t,n){var i,a,r,o,s,u,c,d;return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t);case 3:if((a=e.sent).ok){e.next=6;break}throw new Error("Failed to fetch Mux metadata: ".concat(a.status," ").concat(a.statusText));case 6:return e.next=8,a.json();case 8:r=e.sent,o={},s=(0,h.A)(r[0].metadata);try{for(s.s();!(u=s.n()).done;)(c=u.value).key&&c.value&&(o[c.key]=c.value)}catch(BL){s.e(BL)}finally{s.f()}(null!=(i=uh.get(n))?i:{}).metadata=o,d=new CustomEvent("muxmetadata"),n.dispatchEvent(d),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),console.error(e.t0);case 20:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(t,n){return e.apply(this,arguments)}}(),rh=function(e,t,n){var i,a,r,o,s,l,u,c,d=function(e){var t,n,i=e.type,a=Qc(i),r=Zc(i),o=!(null==(t=e.partList)||!t.length);return a===Nc.LIVE&&(n=o?2*e.partTarget:3*e.targetduration),{streamType:a,targetLiveWindow:r,liveEdgeStartOffset:n,lowLatency:o}}(e),h=d.streamType,f=d.targetLiveWindow,v=d.liveEdgeStartOffset,m=d.lowLatency;if(h===Nc.LIVE){m?(n.config.backBufferLength=null!=(i=n.userConfig.backBufferLength)?i:4,n.config.maxFragLookUpTolerance=null!=(a=n.userConfig.maxFragLookUpTolerance)?a:.001,n.config.abrBandWidthUpFactor=null!=(r=n.userConfig.abrBandWidthUpFactor)?r:n.config.abrBandWidthFactor):n.config.backBufferLength=null!=(o=n.userConfig.backBufferLength)?o:8;var p=Object.freeze({get length(){return t.seekable.length},start:function(e){return t.seekable.start(e)},end:function(e){var i;return e>this.length||e<0||Number.isFinite(t.duration)?t.seekable.end(e):null!=(i=n.liveSyncPosition)?i:t.seekable.end(e)}});(null!=(s=uh.get(t))?s:{}).seekable=p}(null!=(l=uh.get(t))?l:{}).liveEdgeStartOffset=v,(null!=(u=uh.get(t))?u:{}).targetLiveWindow=f,t.dispatchEvent(new CustomEvent("targetlivewindowchange",{composed:!0,bubbles:!0})),(null!=(c=uh.get(t))?c:{}).streamType=h,t.dispatchEvent(new CustomEvent("streamtypechange",{composed:!0,bubbles:!0}))},oh=null!=(Xd=null==(zd=null==globalThis?void 0:globalThis.navigator)?void 0:zd.userAgent)?Xd:"",sh=null!=(Jd=null==(Zd=null==(Qd=null==globalThis?void 0:globalThis.navigator)?void 0:Qd.userAgentData)?void 0:Zd.platform)?Jd:"",lh=oh.toLowerCase().includes("android")||["x11","android"].some((function(e){return sh.toLowerCase().includes(e)})),uh=new WeakMap,ch="mux.com",dh=null==(eh=($d=Rc).isSupported)?void 0:eh.call($d),hh=lh,fh=function(){return Rn.utils.now()},vh=Rn.utils.generateUUID,mh=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.playbackId,n=e.customDomain,i=void 0===n?ch:n,r=e.maxResolution,o=e.minResolution,s=e.renditionOrder,l=e.programStartTime,u=e.programEndTime,c=e.assetStartTime,d=e.assetEndTime,h=e.playbackToken,f=e.tokens,v=(f=void 0===f?{}:f).playback,m=void 0===v?h:v,p=e.extraSourceParams,g=void 0===p?{}:p;if(t){var y=zc(t),E=(0,a.A)(y,2),A=E[0],b=E[1],k=void 0===b?"":b,T=new URL("https://stream.".concat(i,"/").concat(A,".m3u8").concat(k));return m||T.searchParams.has("token")?(T.searchParams.forEach((function(e,t){"token"!=t&&T.searchParams.delete(t)})),m&&T.searchParams.set("token",m)):(r&&T.searchParams.set("max_resolution",r),o&&(T.searchParams.set("min_resolution",o),r&&+r.slice(0,-1)<+o.slice(0,-1)&&console.error("minResolution must be <= maxResolution","minResolution",o,"maxResolution",r)),s&&T.searchParams.set("rendition_order",s),l&&T.searchParams.set("program_start_time","".concat(l)),u&&T.searchParams.set("program_end_time","".concat(u)),c&&T.searchParams.set("asset_start_time","".concat(c)),d&&T.searchParams.set("asset_end_time","".concat(d)),Object.entries(g).forEach((function(e){var t=(0,a.A)(e,2),n=t[0],i=t[1];null!=i&&T.searchParams.set(n,i)}))),T.toString()}},ph=function(e){if(e){var t=e.split("?");return(0,a.A)(t,1)[0]||void 0}},gh=function(e){if(e&&e.startsWith("https://stream.")){var t=new URL(e).pathname.slice(1).split(/\.m3u8|\//);return(0,a.A)(t,1)[0]||void 0}},yh=function(e){var t;return null==(t=uh.get(e))?void 0:t.error},Eh=function(e){var t,n;return null!=(n=null==(t=uh.get(e))?void 0:t.streamType)?n:Nc.UNKNOWN},Ah=function(e){var t,n;return null!=(n=null==(t=uh.get(e))?void 0:t.seekable)?n:e.seekable},bh=.034,kh=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:bh;return Math.abs(e-t)<=n},Th=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:bh;return e>t||kh(e,t,n)},_h=function(e,t){var n,i,a;if(t&&e.buffered.length){if(e.readyState>2)return!1;var r=t.currentLevel>=0?null==(i=null==(n=t.levels)?void 0:n[t.currentLevel])?void 0:i.details:null==(a=t.levels.find((function(e){return!!e.details})))?void 0:a.details;if(r&&!r.live){var o=r.fragments;if(null!=o&&o.length){if(e.currentTime<e.duration-(r.targetduration+.5))return!1;var s=o[o.length-1];if(e.currentTime<=s.start)return!1;var l=s.start+s.duration/2,u=e.buffered.start(e.buffered.length-1),c=e.buffered.end(e.buffered.length-1);return l>u&&l<c}}}},Sh=function(e,t){return e.ended||e.loop?e.ended:!(!t||!_h(e,t))||function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:bh;return e.paused&&Th(e.currentTime,e.duration,t)}(e)},wh=function(e,t,n){Rh(t,n,e);var i=e.metadata,a=void 0===i?{}:i,r=a.view_session_id,o=void 0===r?vh():r,s=function(e){var t,n,i;return null!=(t=null==e?void 0:e.metadata)&&t.video_id?e.metadata.video_id:Nh(e)&&null!=(i=null!=(n=ph(e.playbackId))?n:gh(e.src))?i:e.src}(e);a.view_session_id=o,a.video_id=s,e.metadata=a;e.drmTypeCb=function(e){var n;null==(n=t.mux)||n.emit("hb",{view_drm_type:e})},uh.set(t,{retryCount:0});var l=Ih(e,t),u=function(e,t,n){var i=e.preload,a=e.src,r=function(e){null!=e&&["","none","metadata","auto"].includes(e)?t.setAttribute("preload",e):t.removeAttribute("preload")};if(!n)return r(i),r;var o=!1,s=!1,l=n.config.maxBufferLength,u=n.config.maxBufferSize,c=function(e){r(e);var i=null!=e?e:t.preload;s||"none"===i||("metadata"===i?(n.config.maxBufferLength=1,n.config.maxBufferSize=1):(n.config.maxBufferLength=l,n.config.maxBufferSize=u),d())},d=function(){!o&&a&&(o=!0,n.loadSource(a))};return jc(t,"play",(function(){s=!0,n.config.maxBufferLength=l,n.config.maxBufferSize=u,d()}),{once:!0}),c(i),c}(e,t,l);null!=e&&e.muxDataKeepSession&&null!=t&&t.mux&&!t.mux.deleted?l&&t.mux.addHLSJS({hlsjs:l,Hls:l?Rc:void 0}):Uh(e,t,l),Fh(e,t,l),function(e){Td.apply(this,arguments)}(t),function(e){Dd.apply(this,arguments)}(t);var c=function(e,t,n){var i=e.autoplay,a=!1,r=!1,o=ud(i)?i:!!i,s=function(){a||jc(t,"playing",(function(){a=!0}),{once:!0})};if(s(),jc(t,"loadstart",(function(){a=!1,s(),cd(t,o)}),{once:!0}),jc(t,"loadstart",(function(){n||(r=e.streamType&&e.streamType!==Nc.UNKNOWN?e.streamType===Nc.LIVE:!Number.isFinite(t.duration)),cd(t,o)}),{once:!0}),n&&n.once(Rc.Events.LEVEL_LOADED,(function(t,n){var i;r=e.streamType&&e.streamType!==Nc.UNKNOWN?e.streamType===Nc.LIVE:null!=(i=n.details.live)&&i})),!o){var l=function(){!r||Number.isFinite(e.startTime)||(null!=n&&n.liveSyncPosition?t.currentTime=n.liveSyncPosition:Number.isFinite(t.seekable.end(0))&&(t.currentTime=t.seekable.end(0)))};n&&jc(t,"play",(function(){"metadata"===t.preload?n.once(Rc.Events.LEVEL_UPDATED,l):l()}),{once:!0})}return function(e){a||(o=ud(e)?e:!!e,cd(t,o))}}(e,t,l);return{engine:l,setAutoplay:c,setPreload:u}},Rh=function(e,t,n){var i=null==t?void 0:t.engine;null!=e&&e.mux&&!e.mux.deleted&&(null!=n&&n.muxDataKeepSession?i&&e.mux.removeHLSJS():(e.mux.destroy(),delete e.mux)),i&&(i.detachMedia(),i.destroy()),e&&(e.hasAttribute("src")&&(e.removeAttribute("src"),e.load()),e.removeEventListener("error",Hh),e.removeEventListener("error",Wh),e.removeEventListener("durationchange",Bh),uh.delete(e),e.dispatchEvent(new Event("teardown")))};function Lh(e,t){var n,i=Xc(e);if(i!==Gc.M3U8)return!0;var a=!i||null==(n=t.canPlayType(i))||n,r=e.preferPlayback;return a&&(r===Fc||!(dh&&(r===Uc||hh)))}var Ih=function(e,t){var n=e.debug,a=e.streamType,r=e.startTime,o=void 0===r?-1:r,s=e.metadata,u=e.preferCmcd,c=e._hlsConfig,h=void 0===c?{}:c,f=Xc(e)===Gc.M3U8,v=Lh(e,t);if(f&&!v&&dh){var m=Dh(a),p=Ch(e),g=[Bc.QUERY,Bc.HEADER].includes(u)?{useHeaders:u===Bc.HEADER,sessionId:null==s?void 0:s.view_session_id,contentId:null==s?void 0:s.video_id}:void 0,y=new Rc((0,i.A)((0,i.A)((0,i.A)((0,i.A)({debug:n,startPosition:o,cmcd:g,xhrSetup:function(e,t){var n,i;if(!u||u===Bc.QUERY){var a=new URL(t);if(a.searchParams.has("CMCD")){var r=(null!=(i=null==(n=a.searchParams.get("CMCD"))?void 0:n.split(","))?i:[]).filter((function(e){return e.startsWith("sid")||e.startsWith("cid")})).join(",");a.searchParams.set("CMCD",r),e.open("GET",a)}}},capLevelController:Hd},{backBufferLength:30,renderTextTracksNatively:!1,liveDurationInfinity:!0,capLevelToPlayerSize:!0,capLevelOnFPSDrop:!0}),m),p),h));return y.on(Rc.Events.MANIFEST_PARSED,function(){var e=(0,d.A)((0,l.A)().mark((function e(n,i){var a,r,o;return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(null!=(o=null==(a=i.sessionData)?void 0:a["com.apple.hls.chapters"])&&o.URI||null!=o&&o.VALUE.toLocaleLowerCase().startsWith("http"))&&ah(null!=(r=null==o?void 0:o.URI)?r:null==o?void 0:o.VALUE,t);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),y}},Dh=function(e){return e===Nc.LIVE?{backBufferLength:8}:{}},Ch=function(e){var t=e.tokens,n=(t=void 0===t?{}:t).drm,a=e.playbackId,r=e.drmTypeCb,o=ph(a);return n&&o?{emeEnabled:!0,drmSystems:{"com.apple.fps":{licenseUrl:Oh(e,"fairplay"),serverCertificateUrl:Ph(e,"fairplay")},"com.widevine.alpha":{licenseUrl:Oh(e,"widevine")},"com.microsoft.playready":{licenseUrl:Oh(e,"playready")}},requestMediaKeySystemAccessFunc:function(e,t){return"com.widevine.alpha"===e&&(t=[].concat((0,f.A)(t.map((function(e){var t,n=null==(t=e.videoCapabilities)?void 0:t.map((function(e){return(0,i.A)((0,i.A)({},e),{},{robustness:"HW_SECURE_ALL"})}));return(0,i.A)((0,i.A)({},e),{},{videoCapabilities:n})}))),(0,f.A)(t))),navigator.requestMediaKeySystemAccess(e,t).then((function(t){var n=function(e){return e.includes("fps")?Gd:e.includes("playready")?Kd:e.includes("widevine")?Wd:void 0}(e);return null==r||r(n),t}))}}:{}},xh=function(){var e=(0,d.A)((0,l.A)().mark((function e(t){var n;return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:if(200===(n=e.sent).status){e.next=7;break}e.t0=Promise.reject(n),e.next=10;break;case 7:return e.next=9,n.arrayBuffer();case 9:e.t0=e.sent;case 10:return e.abrupt("return",e.t0);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Mh=function(){var e=(0,d.A)((0,l.A)().mark((function e(t,n){var i,a;return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(n,{method:"POST",headers:{"Content-type":"application/octet-stream"},body:t});case 2:if(200===(i=e.sent).status){e.next=5;break}return e.abrupt("return",Promise.reject(i));case 5:return e.next=7,i.arrayBuffer();case 7:return a=e.sent,e.abrupt("return",new Uint8Array(a));case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Oh=function(e,t){var n=e.playbackId,i=e.tokens,a=(i=void 0===i?{}:i).drm,r=e.customDomain,o=void 0===r?ch:r,s=ph(n);return"https://license.".concat(o.toLocaleLowerCase().endsWith(ch)?o:ch,"/license/").concat(t,"/").concat(s,"?token=").concat(a)},Ph=function(e,t){var n=e.playbackId,i=e.tokens,a=(i=void 0===i?{}:i).drm,r=e.customDomain,o=void 0===r?ch:r,s=ph(n);return"https://license.".concat(o.toLocaleLowerCase().endsWith(ch)?o:ch,"/appcert/").concat(t,"/").concat(s,"?token=").concat(a)},Nh=function(e){var t=e.playbackId,n=e.src,i=e.customDomain;if(t)return!0;if("string"!=typeof n)return!1;var a=null==window?void 0:window.location.href,r=new URL(n,a).hostname.toLocaleLowerCase();return r.includes(ch)||!!i&&r.includes(i.toLocaleLowerCase())},Uh=function(e,t,n){var a,r=e.envKey,o=e.disableTracking,s=e.muxDataSDK,l=void 0===s?Rn:s,u=e.muxDataSDKOptions,c=void 0===u?{}:u,d=Nh(e);if(!o&&(r||d)){var h=e.playerInitTime,f=e.playerSoftwareName,v=e.playerSoftwareVersion,m=e.beaconCollectionDomain,p=e.debug,g=e.disableCookies,y=(0,i.A)((0,i.A)({},e.metadata),{},{video_title:(null==(a=null==e?void 0:e.metadata)?void 0:a.video_title)||void 0});l.monitor(t,(0,i.A)((0,i.A)({debug:p,beaconCollectionDomain:m,hlsjs:n,Hls:n?Rc:void 0,automaticErrorTracking:!1,errorTranslator:function(t){return"string"!=typeof t.player_error_code&&("function"==typeof e.errorTranslator?e.errorTranslator(t):t)},disableCookies:g},c),{},{data:(0,i.A)((0,i.A)({},r?{env_key:r}:{}),{},{player_software_name:f,player_software:f,player_software_version:v,player_init_time:h},y)}))}},Fh=function(e,t,n){var i,r,o,s,u=Lh(e,t),c=e.src,h=e.customDomain,f=void 0===h?ch:h,v=function(){t.ended||!Sh(t,n)||(_h(t,n)?t.currentTime=t.buffered.end(t.buffered.length-1):t.dispatchEvent(new Event("ended")))},m=function(){var e,n,i=Ah(t);i.length>0&&(e=i.start(0),n=i.end(0)),(s!==n||o!==e)&&t.dispatchEvent(new CustomEvent("seekablechange",{composed:!0})),o=e,s=n};if(jc(t,"durationchange",m),t&&u){var p=Xc(e);if("string"==typeof c){if(c.endsWith(".mp4")&&c.includes(f)){var g=gh(c),y=new URL("https://stream.".concat(f,"/").concat(g,"/metadata.json"));ah(y.toString(),t)}var E=function(){if(Eh(t)===Nc.LIVE&&!Number.isFinite(t.duration)){var e=setInterval(m,1e3);t.addEventListener("teardown",(function(){clearInterval(e)}),{once:!0}),jc(t,"durationchange",(function(){Number.isFinite(t.duration)&&clearInterval(e)}))}},A=function(){var n=(0,d.A)((0,l.A)().mark((function n(){return(0,l.A)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ih(c,t,p).then(E).catch((function(n){if(n instanceof Response){var i=Ud(n,Lc,e);if(i)return void Kh(t,i)}else Error})));case 1:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();if("none"===t.preload){var b=function(){A(),t.removeEventListener("loadedmetadata",k)},k=function(){A(),t.removeEventListener("play",b)};jc(t,"play",b,{once:!0}),jc(t,"loadedmetadata",k,{once:!0})}else A();null!=(i=e.tokens)&&i.drm?function(e,t){jc(t,"encrypted",function(){var n=(0,d.A)((0,l.A)().mark((function n(i){var r,o,s,u,c,d,h,f;return(0,l.A)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,"skd"===(r=i.initDataType)){n.next=5;break}return console.error('Received unexpected initialization data type "'.concat(r,'"')),n.abrupt("return");case 5:if(t.mediaKeys){n.next=28;break}return n.next=8,navigator.requestMediaKeySystemAccess("com.apple.fps",[{initDataTypes:[r],videoCapabilities:[{contentType:"application/vnd.apple.mpegurl",robustness:""}],distinctiveIdentifier:"not-allowed",persistentState:"not-allowed",sessionTypes:["temporary"]}]).then((function(t){var n;return null==(n=e.drmTypeCb)||n.call(e,Gd),t})).catch((function(){var e=od("Cannot play DRM-protected content with current security configuration on this browser. Try playing in another browser."),n=new Mc(e,Mc.MEDIA_ERR_ENCRYPTED,!0);n.errorCategory=Ic,n.muxCode=Dc.ENCRYPTED_UNSUPPORTED_KEY_SYSTEM,Kh(t,n)}));case 8:if(o=n.sent){n.next=11;break}return n.abrupt("return");case 11:return n.next=13,o.createMediaKeys();case 13:return s=n.sent,n.prev=14,n.next=17,xh(Ph(e,"fairplay")).catch((function(t){if(t instanceof Response){var n=Ud(t,Ic,e);return console.error("mediaError",null==n?void 0:n.message,null==n?void 0:n.context),n?Promise.reject(n):Promise.reject(new Error("Unexpected error in app cert request"))}return Promise.reject(t)}));case 17:return u=n.sent,n.next=20,s.setServerCertificate(u).catch((function(){var e=od("Your server certificate failed when attempting to set it. This may be an issue with a no longer valid certificate."),t=new Mc(e,Mc.MEDIA_ERR_ENCRYPTED,!0);return t.errorCategory=Ic,t.muxCode=Dc.ENCRYPTED_UPDATE_SERVER_CERT_FAILED,Promise.reject(t)}));case 20:n.next=26;break;case 22:return n.prev=22,n.t0=n.catch(14),Kh(t,n.t0),n.abrupt("return");case 26:return n.next=28,t.setMediaKeys(s);case 28:if(null!=(c=i.initData)){n.next=32;break}return console.error("Could not start encrypted playback due to missing initData in ".concat(i.type," event")),n.abrupt("return");case 32:return(d=t.mediaKeys.createSession()).addEventListener("keystatuseschange",(function(){d.keyStatuses.forEach((function(e){var n;if("internal-error"===e){var i=od("The DRM Content Decryption Module system had an internal failure. Try reloading the page, upading your browser, or playing in another browser.");(n=new Mc(i,Mc.MEDIA_ERR_ENCRYPTED,!0)).errorCategory=Ic,n.muxCode=Dc.ENCRYPTED_CDM_ERROR}else if("output-restricted"===e||"output-downscaled"===e){var a=od("DRM playback is being attempted in an environment that is not sufficiently secure. User may see black screen.");(n=new Mc(a,Mc.MEDIA_ERR_ENCRYPTED,!1)).errorCategory=Ic,n.muxCode=Dc.ENCRYPTED_OUTPUT_RESTRICTED}n&&Kh(t,n)}))})),n.next=36,Promise.all([d.generateRequest(r,c).catch((function(){var e=od("Failed to generate a DRM license request. This may be an issue with the player or your protected content."),n=new Mc(e,Mc.MEDIA_ERR_ENCRYPTED,!0);n.errorCategory=Ic,n.muxCode=Dc.ENCRYPTED_GENERATE_REQUEST_FAILED,Kh(t,n)})),new Promise((function(e){d.addEventListener("message",(function(t){e(t.message)}),{once:!0})}))]).then((function(e){return(0,a.A)(e,2)[1]}));case 36:return h=n.sent,n.next=39,Mh(h,Oh(e,"fairplay")).catch((function(t){if(t instanceof Response){var n=Ud(t,Ic,e);return console.error("mediaError",null==n?void 0:n.message,null==n?void 0:n.context),n?Promise.reject(n):Promise.reject(new Error("Unexpected error in license key request"))}return Promise.reject(t)}));case 39:return f=n.sent,n.next=42,d.update(f).catch((function(){var e=od("Failed to update DRM license. This may be an issue with the player or your protected content."),t=new Mc(e,Mc.MEDIA_ERR_ENCRYPTED,!0);return t.errorCategory=Ic,t.muxCode=Dc.ENCRYPTED_UPDATE_LICENSE_FAILED,Promise.reject(t)}));case 42:n.next=48;break;case 44:return n.prev=44,n.t1=n.catch(0),Kh(t,n.t1),n.abrupt("return");case 48:case"end":return n.stop()}}),n,null,[[0,44],[14,22]])})));return function(e){return n.apply(this,arguments)}}())}(e,t):jc(t,"encrypted",(function(){var e=od("Attempting to play DRM-protected content without providing a DRM token."),n=new Mc(e,Mc.MEDIA_ERR_ENCRYPTED,!0);n.errorCategory=Ic,n.muxCode=Dc.ENCRYPTED_MISSING_TOKEN,Kh(t,n)}),{once:!0}),t.setAttribute("src",c),e.startTime&&((null!=(r=uh.get(t))?r:{}).startTime=e.startTime,t.addEventListener("durationchange",Bh,{once:!0}))}else t.removeAttribute("src");t.addEventListener("error",Hh),t.addEventListener("error",Wh),t.addEventListener("emptied",(function(){t.querySelectorAll("track[data-removeondestroy]").forEach((function(e){e.remove()}))}),{once:!0}),jc(t,"pause",v),jc(t,"seeked",v),jc(t,"play",(function(){t.ended||Th(t.currentTime,t.duration)&&(t.currentTime=t.seekable.length?t.seekable.start(0):0)}))}else n&&c?(n.once(Rc.Events.LEVEL_LOADED,(function(e,i){rh(i.details,t,n),m(),Eh(t)===Nc.LIVE&&!Number.isFinite(t.duration)&&(n.on(Rc.Events.LEVEL_UPDATED,m),jc(t,"durationchange",(function(){Number.isFinite(t.duration)&&n.off(Rc.Events.LEVELS_UPDATED,m)})))})),n.on(Rc.Events.ERROR,(function(i,a){var r,o,s=nf(a,e);if(s.muxCode===Dc.NETWORK_NOT_READY){var l=null!=(r=uh.get(t))?r:{},u=null!=(o=l.retryCount)?o:0;if(u<6){var c=0===u?5e3:6e4,d=new Mc("Retrying in ".concat(c/1e3," seconds..."),s.code,s.fatal);return Object.assign(d,s),Kh(t,d),void setTimeout((function(){l.retryCount=u+1,"manifestLoadError"===a.details&&a.url&&n.loadSource(a.url)}),c)}l.retryCount=0;var h=new Mc('Try again later or <a href="#" onclick="window.location.reload(); return false;" style="color: #4a90e2;">click here to retry</a>',s.code,s.fatal);return Object.assign(h,s),void Kh(t,h)}Kh(t,s)})),n.on(Rc.Events.MANIFEST_LOADED,(function(){var e=uh.get(t);e&&e.error&&(e.error=null,e.retryCount=0,t.dispatchEvent(new Event("emptied")),t.dispatchEvent(new Event("loadstart")))})),t.addEventListener("error",Wh),jc(t,"waiting",v),dd(e,n),function(e,t){t.on(Rc.Events.NON_NATIVE_TEXT_TRACKS_FOUND,(function(n,i){i.tracks.forEach((function(n){var i,a,r=null!=(i=n.subtitleTrack)?i:n.closedCaptions,o=t.subtitleTracks.findIndex((function(e){var t=e.lang,i=e.name,a=e.type;return t==(null==r?void 0:r.lang)&&i===n.label&&a.toLowerCase()===n.kind})),s=(null!=(a=n._id)?a:n.default)?"default":"".concat(n.kind).concat(o);fd(e,n.kind,n.label,null==r?void 0:r.lang,s,n.default)}))}));var n=function(){if(t.subtitleTracks.length){var n=Array.from(e.textTracks).find((function(e){return e.id&&"showing"===e.mode&&["subtitles","captions"].includes(e.kind)}));if(n){var i=t.subtitleTracks[t.subtitleTrack],a=i?i.default?"default":"".concat(t.subtitleTracks[t.subtitleTrack].type.toLowerCase()).concat(t.subtitleTrack):void 0;if(t.subtitleTrack<0||(null==n?void 0:n.id)!==a){var r=t.subtitleTracks.findIndex((function(e){var t=e.lang,i=e.name,a=e.type,r=e.default;return"default"===n.id&&r||t==n.language&&i===n.label&&a.toLowerCase()===n.kind}));t.subtitleTrack=r}(null==n?void 0:n.id)===a&&n.cues&&Array.from(n.cues).forEach((function(e){n.addCue(e)}))}}};e.textTracks.addEventListener("change",n),t.on(Rc.Events.CUES_PARSED,(function(t,n){var i=n.track,a=n.cues,r=e.textTracks.getTrackById(i);if(r){var o="disabled"===r.mode;o&&(r.mode="hidden"),a.forEach((function(e){var t;null!=(t=r.cues)&&t.getCueById(e.id)||r.addCue(e)})),o&&(r.mode="disabled")}})),t.once(Rc.Events.DESTROYING,(function(){e.textTracks.removeEventListener("change",n),e.querySelectorAll("track[data-removeondestroy]").forEach((function(e){e.remove()}))}));var i=function(){Array.from(e.textTracks).forEach((function(t){var n,i;if(!["subtitles","caption"].includes(t.kind)&&("thumbnails"===t.label||"chapters"===t.kind)){if(null==(n=t.cues)||!n.length){var a="track";t.kind&&(a+='[kind="'.concat(t.kind,'"]')),t.label&&(a+='[label="'.concat(t.label,'"]'));var r=e.querySelector(a),o=null!=(i=null==r?void 0:r.getAttribute("src"))?i:"";null==r||r.removeAttribute("src"),setTimeout((function(){null==r||r.setAttribute("src",o)}),0)}"hidden"!==t.mode&&(t.mode="hidden")}}))};t.once(Rc.Events.MANIFEST_LOADED,i),t.once(Rc.Events.MEDIA_ATTACHED,i)}(t,n),n.attachMedia(t)):console.error("It looks like the video you're trying to play will not work on this system! If possible, try upgrading to the newest versions of your browser or software.")};function Bh(e){var t,n=e.target,i=null==(t=uh.get(n))?void 0:t.startTime;if(i&&function(e,t,n){t&&n>t&&(n=t);for(var i=0;i<e.length;i++)if(e.start(i)<=n&&e.end(i)>=n)return!0;return!1}(n.seekable,n.duration,i)){var a="auto"===n.preload;a&&(n.preload="none"),n.currentTime=i,a&&(n.preload="auto")}}function Hh(e){return Gh.apply(this,arguments)}function Gh(){return Gh=(0,d.A)((0,l.A)().mark((function e(t){var n,i,a,r,o,s,u;return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isTrusted){e.next=2;break}return e.abrupt("return");case 2:if(t.stopImmediatePropagation(),null!=(n=t.target)&&n.error){e.next=6;break}return e.abrupt("return");case 6:if(i=n.error,a=i.message,r=i.code,o=new Mc(a,r),!n.src||r!==Mc.MEDIA_ERR_SRC_NOT_SUPPORTED||n.readyState!==HTMLMediaElement.HAVE_NOTHING){e.next=10;break}return setTimeout((function(){var e,t=null!=(e=yh(n))?e:n.error;(null==t?void 0:t.code)===Mc.MEDIA_ERR_SRC_NOT_SUPPORTED&&Kh(n,o)}),500),e.abrupt("return");case 10:if(!n.src||r===Mc.MEDIA_ERR_DECODE&&void 0===r){e.next=21;break}return e.prev=11,e.next=14,fetch(n.src);case 14:s=e.sent,u=s.status,o.data={response:{code:u}},e.next=21;break;case 19:e.prev=19,e.t0=e.catch(11);case 21:Kh(n,o);case 22:case"end":return e.stop()}}),e,null,[[11,19]])}))),Gh.apply(this,arguments)}function Kh(e,t){var n;t.fatal&&((null!=(n=uh.get(e))?n:{}).error=t,e.dispatchEvent(new CustomEvent("error",{detail:t})))}function Wh(e){var t,n;if(e instanceof CustomEvent&&e.detail instanceof Mc){var i=e.target,a=e.detail;!a||!a.fatal||((null!=(t=uh.get(i))?t:{}).error=a,null==(n=i.mux)||n.emit("error",{player_error_code:a.code,player_error_message:a.message,player_error_context:a.context}))}}var Vh,qh,Yh,jh,zh,Xh,Qh,Zh,Jh,$h,ef,tf,nf=function(e,t){var n,i,a,r;console.error("getErrorFromHlsErrorData()",e);var o,l=(n={},(0,s.A)(n,Rc.ErrorTypes.NETWORK_ERROR,Mc.MEDIA_ERR_NETWORK),(0,s.A)(n,Rc.ErrorTypes.MEDIA_ERROR,Mc.MEDIA_ERR_DECODE),(0,s.A)(n,Rc.ErrorTypes.KEY_SYSTEM_ERROR,Mc.MEDIA_ERR_ENCRYPTED),n),u=function(e){return[Rc.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,Rc.ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED].includes(e.details)?Mc.MEDIA_ERR_NETWORK:l[e.type]}(e);if(u===Mc.MEDIA_ERR_NETWORK&&e.response){var c=null!=(i=function(e){return e.type===Rc.ErrorTypes.KEY_SYSTEM_ERROR?Ic:e.type===Rc.ErrorTypes.NETWORK_ERROR?Lc:void 0}(e))?i:Lc;o=null!=(a=Ud(e.response,c,t,e.fatal))?a:new Mc("",u,e.fatal)}else if(u===Mc.MEDIA_ERR_ENCRYPTED)if(e.details===Rc.ErrorDetails.KEY_SYSTEM_NO_CONFIGURED_LICENSE){var d=od("Attempting to play DRM-protected content without providing a DRM token.");(o=new Mc(d,Mc.MEDIA_ERR_ENCRYPTED,e.fatal)).errorCategory=Ic,o.muxCode=Dc.ENCRYPTED_MISSING_TOKEN}else if(e.details===Rc.ErrorDetails.KEY_SYSTEM_NO_ACCESS){var h=od("Cannot play DRM-protected content with current security configuration on this browser. Try playing in another browser.");(o=new Mc(h,Mc.MEDIA_ERR_ENCRYPTED,e.fatal)).errorCategory=Ic,o.muxCode=Dc.ENCRYPTED_UNSUPPORTED_KEY_SYSTEM}else if(e.details===Rc.ErrorDetails.KEY_SYSTEM_NO_SESSION){var f=od("Failed to generate a DRM license request. This may be an issue with the player or your protected content.");(o=new Mc(f,Mc.MEDIA_ERR_ENCRYPTED,!0)).errorCategory=Ic,o.muxCode=Dc.ENCRYPTED_GENERATE_REQUEST_FAILED}else if(e.details===Rc.ErrorDetails.KEY_SYSTEM_SESSION_UPDATE_FAILED){var v=od("Failed to update DRM license. This may be an issue with the player or your protected content.");(o=new Mc(v,Mc.MEDIA_ERR_ENCRYPTED,e.fatal)).errorCategory=Ic,o.muxCode=Dc.ENCRYPTED_UPDATE_LICENSE_FAILED}else if(e.details===Rc.ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED){var m=od("Your server certificate failed when attempting to set it. This may be an issue with a no longer valid certificate.");(o=new Mc(m,Mc.MEDIA_ERR_ENCRYPTED,e.fatal)).errorCategory=Ic,o.muxCode=Dc.ENCRYPTED_UPDATE_SERVER_CERT_FAILED}else if(e.details===Rc.ErrorDetails.KEY_SYSTEM_STATUS_INTERNAL_ERROR){var p=od("The DRM Content Decryption Module system had an internal failure. Try reloading the page, upading your browser, or playing in another browser.");(o=new Mc(p,Mc.MEDIA_ERR_ENCRYPTED,e.fatal)).errorCategory=Ic,o.muxCode=Dc.ENCRYPTED_CDM_ERROR}else if(e.details===Rc.ErrorDetails.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED){var g=od("DRM playback is being attempted in an environment that is not sufficiently secure. User may see black screen.");(o=new Mc(g,Mc.MEDIA_ERR_ENCRYPTED,!1)).errorCategory=Ic,o.muxCode=Dc.ENCRYPTED_OUTPUT_RESTRICTED}else(o=new Mc(e.error.message,Mc.MEDIA_ERR_ENCRYPTED,e.fatal)).errorCategory=Ic,o.muxCode=Dc.ENCRYPTED_ERROR;else o=new Mc("",u,e.fatal);return o.context||(o.context="".concat(e.url?"url: ".concat(e.url,"\n"):"").concat(e.response&&(e.response.code||e.response.text)?"response: ".concat(e.response.code,", ").concat(e.response.text,"\n"):"").concat(e.reason?"failure reason: ".concat(e.reason,"\n"):"").concat(e.level?"level: ".concat(e.level,"\n"):"").concat(e.parent?"parent stream controller: ".concat(e.parent,"\n"):"").concat(e.buffer?"buffer length: ".concat(e.buffer,"\n"):"").concat(e.error?"error: ".concat(e.error,"\n"):"").concat(e.event?"event: ".concat(e.event,"\n"):"").concat(e.err?"error message: ".concat(null==(r=e.err)?void 0:r.message,"\n"):"")),o.data=e,o},af=n(8068),rf=function(e){throw TypeError(e)},of=function(e,t,n){return t.has(e)||rf("Cannot "+n)},sf=function(e,t,n){return of(e,t,"read from private field"),n?n.call(e):t.get(e)},lf=function(e,t,n){return t.has(e)?rf("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n)},uf=function(e,t,n,i){return of(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n},cf=function(e,t,n){return of(e,t,"access private method"),n},df=function(){try{return"0.26.0"}catch(e){}return"UNKNOWN"}(),hf={BEACON_COLLECTION_DOMAIN:"beacon-collection-domain",CUSTOM_DOMAIN:"custom-domain",DEBUG:"debug",DISABLE_TRACKING:"disable-tracking",DISABLE_COOKIES:"disable-cookies",DRM_TOKEN:"drm-token",PLAYBACK_TOKEN:"playback-token",ENV_KEY:"env-key",MAX_RESOLUTION:"max-resolution",MIN_RESOLUTION:"min-resolution",RENDITION_ORDER:"rendition-order",PROGRAM_START_TIME:"program-start-time",PROGRAM_END_TIME:"program-end-time",ASSET_START_TIME:"asset-start-time",ASSET_END_TIME:"asset-end-time",METADATA_URL:"metadata-url",PLAYBACK_ID:"playback-id",PLAYER_SOFTWARE_NAME:"player-software-name",PLAYER_SOFTWARE_VERSION:"player-software-version",PLAYER_INIT_TIME:"player-init-time",PREFER_CMCD:"prefer-cmcd",PREFER_PLAYBACK:"prefer-playback",START_TIME:"start-time",STREAM_TYPE:"stream-type",TARGET_LIVE_WINDOW:"target-live-window",LIVE_EDGE_OFFSET:"live-edge-offset",TYPE:"type",LOGO:"logo"},ff=Object.values(hf),vf=df,mf="mux-video",pf=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){var e;return(0,m.A)(this,n),e=t.call(this),lf((0,Ln.A)(e),ef),lf((0,Ln.A)(e),Vh),lf((0,Ln.A)(e),qh),lf((0,Ln.A)(e),Yh),lf((0,Ln.A)(e),jh,{}),lf((0,Ln.A)(e),zh,{}),lf((0,Ln.A)(e),Xh),lf((0,Ln.A)(e),Qh),lf((0,Ln.A)(e),Zh),lf((0,Ln.A)(e),Jh),lf((0,Ln.A)(e),$h,""),uf((0,Ln.A)(e),Yh,fh()),e.nativeEl.addEventListener("muxmetadata",(function(t){var n,a=function(e){var t;return null==(t=uh.get(e))?void 0:t.metadata}(e.nativeEl),r=null!=(n=e.metadata)?n:{};e.metadata=(0,i.A)((0,i.A)({},a),r),"mux-free-plan"===(null==a?void 0:a["com.mux.video.branding"])&&(uf((0,Ln.A)(e),$h,"default"),e.updateLogo())})),e}return(0,v.A)(n,[{key:"preferCmcd",get:function(){var e;return null!=(e=this.getAttribute(hf.PREFER_CMCD))?e:void 0},set:function(e){e!==this.preferCmcd&&(e?Hc.includes(e)?this.setAttribute(hf.PREFER_CMCD,e):console.warn("Invalid value for preferCmcd. Must be one of ".concat(Hc.join())):this.removeAttribute(hf.PREFER_CMCD))}},{key:"playerInitTime",get:function(){return this.hasAttribute(hf.PLAYER_INIT_TIME)?+this.getAttribute(hf.PLAYER_INIT_TIME):sf(this,Yh)},set:function(e){e!=this.playerInitTime&&(null==e?this.removeAttribute(hf.PLAYER_INIT_TIME):this.setAttribute(hf.PLAYER_INIT_TIME,"".concat(+e)))}},{key:"playerSoftwareName",get:function(){var e;return null!=(e=sf(this,Zh))?e:mf},set:function(e){uf(this,Zh,e)}},{key:"playerSoftwareVersion",get:function(){var e;return null!=(e=sf(this,Qh))?e:vf},set:function(e){uf(this,Qh,e)}},{key:"_hls",get:function(){var e;return null==(e=sf(this,Vh))?void 0:e.engine}},{key:"mux",get:function(){var e;return null==(e=this.nativeEl)?void 0:e.mux}},{key:"error",get:function(){var e;return null!=(e=yh(this.nativeEl))?e:null}},{key:"errorTranslator",get:function(){return sf(this,Jh)},set:function(e){uf(this,Jh,e)}},{key:"src",get:function(){return this.getAttribute("src")},set:function(e){e!==this.src&&(null==e?this.removeAttribute("src"):this.setAttribute("src",e))}},{key:"type",get:function(){var e;return null!=(e=this.getAttribute(hf.TYPE))?e:void 0},set:function(e){e!==this.type&&(e?this.setAttribute(hf.TYPE,e):this.removeAttribute(hf.TYPE))}},{key:"preload",get:function(){var e=this.getAttribute("preload");return""===e?"auto":["none","metadata","auto"].includes(e)?e:(0,u.A)((0,c.A)(n.prototype),"preload",this)},set:function(e){e!=this.getAttribute("preload")&&(["","none","metadata","auto"].includes(e)?this.setAttribute("preload",e):this.removeAttribute("preload"))}},{key:"debug",get:function(){return null!=this.getAttribute(hf.DEBUG)},set:function(e){e!==this.debug&&(e?this.setAttribute(hf.DEBUG,""):this.removeAttribute(hf.DEBUG))}},{key:"disableTracking",get:function(){return this.hasAttribute(hf.DISABLE_TRACKING)},set:function(e){e!==this.disableTracking&&this.toggleAttribute(hf.DISABLE_TRACKING,!!e)}},{key:"disableCookies",get:function(){return this.hasAttribute(hf.DISABLE_COOKIES)},set:function(e){e!==this.disableCookies&&(e?this.setAttribute(hf.DISABLE_COOKIES,""):this.removeAttribute(hf.DISABLE_COOKIES))}},{key:"startTime",get:function(){var e=this.getAttribute(hf.START_TIME);if(null!=e){var t=+e;return Number.isNaN(t)?void 0:t}},set:function(e){e!==this.startTime&&(null==e?this.removeAttribute(hf.START_TIME):this.setAttribute(hf.START_TIME,"".concat(e)))}},{key:"playbackId",get:function(){var e;return this.hasAttribute(hf.PLAYBACK_ID)?this.getAttribute(hf.PLAYBACK_ID):null!=(e=gh(this.src))?e:void 0},set:function(e){e!==this.playbackId&&(e?this.setAttribute(hf.PLAYBACK_ID,e):this.removeAttribute(hf.PLAYBACK_ID))}},{key:"maxResolution",get:function(){var e;return null!=(e=this.getAttribute(hf.MAX_RESOLUTION))?e:void 0},set:function(e){e!==this.maxResolution&&(e?this.setAttribute(hf.MAX_RESOLUTION,e):this.removeAttribute(hf.MAX_RESOLUTION))}},{key:"minResolution",get:function(){var e;return null!=(e=this.getAttribute(hf.MIN_RESOLUTION))?e:void 0},set:function(e){e!==this.minResolution&&(e?this.setAttribute(hf.MIN_RESOLUTION,e):this.removeAttribute(hf.MIN_RESOLUTION))}},{key:"renditionOrder",get:function(){var e;return null!=(e=this.getAttribute(hf.RENDITION_ORDER))?e:void 0},set:function(e){e!==this.renditionOrder&&(e?this.setAttribute(hf.RENDITION_ORDER,e):this.removeAttribute(hf.RENDITION_ORDER))}},{key:"programStartTime",get:function(){var e=this.getAttribute(hf.PROGRAM_START_TIME);if(null!=e){var t=+e;return Number.isNaN(t)?void 0:t}},set:function(e){null==e?this.removeAttribute(hf.PROGRAM_START_TIME):this.setAttribute(hf.PROGRAM_START_TIME,"".concat(e))}},{key:"programEndTime",get:function(){var e=this.getAttribute(hf.PROGRAM_END_TIME);if(null!=e){var t=+e;return Number.isNaN(t)?void 0:t}},set:function(e){null==e?this.removeAttribute(hf.PROGRAM_END_TIME):this.setAttribute(hf.PROGRAM_END_TIME,"".concat(e))}},{key:"assetStartTime",get:function(){var e=this.getAttribute(hf.ASSET_START_TIME);if(null!=e){var t=+e;return Number.isNaN(t)?void 0:t}},set:function(e){null==e?this.removeAttribute(hf.ASSET_START_TIME):this.setAttribute(hf.ASSET_START_TIME,"".concat(e))}},{key:"assetEndTime",get:function(){var e=this.getAttribute(hf.ASSET_END_TIME);if(null!=e){var t=+e;return Number.isNaN(t)?void 0:t}},set:function(e){null==e?this.removeAttribute(hf.ASSET_END_TIME):this.setAttribute(hf.ASSET_END_TIME,"".concat(e))}},{key:"customDomain",get:function(){var e;return null!=(e=this.getAttribute(hf.CUSTOM_DOMAIN))?e:void 0},set:function(e){e!==this.customDomain&&(e?this.setAttribute(hf.CUSTOM_DOMAIN,e):this.removeAttribute(hf.CUSTOM_DOMAIN))}},{key:"drmToken",get:function(){var e;return null!=(e=this.getAttribute(hf.DRM_TOKEN))?e:void 0},set:function(e){e!==this.drmToken&&(e?this.setAttribute(hf.DRM_TOKEN,e):this.removeAttribute(hf.DRM_TOKEN))}},{key:"playbackToken",get:function(){var e,t,n,i;if(this.hasAttribute(hf.PLAYBACK_TOKEN))return null!=(e=this.getAttribute(hf.PLAYBACK_TOKEN))?e:void 0;if(this.hasAttribute(hf.PLAYBACK_ID)){var r=zc(null!=(t=this.playbackId)?t:""),o=(0,a.A)(r,2)[1];return null!=(n=new URLSearchParams(o).get("token"))?n:void 0}return this.src&&null!=(i=new URLSearchParams(this.src).get("token"))?i:void 0},set:function(e){e!==this.playbackToken&&(e?this.setAttribute(hf.PLAYBACK_TOKEN,e):this.removeAttribute(hf.PLAYBACK_TOKEN))}},{key:"tokens",get:function(){var e=this.getAttribute(hf.PLAYBACK_TOKEN),t=this.getAttribute(hf.DRM_TOKEN);return(0,i.A)((0,i.A)((0,i.A)({},sf(this,zh)),null!=e?{playback:e}:{}),null!=t?{drm:t}:{})},set:function(e){uf(this,zh,null!=e?e:{})}},{key:"ended",get:function(){return Sh(this.nativeEl,this._hls)}},{key:"envKey",get:function(){var e;return null!=(e=this.getAttribute(hf.ENV_KEY))?e:void 0},set:function(e){e!==this.envKey&&(e?this.setAttribute(hf.ENV_KEY,e):this.removeAttribute(hf.ENV_KEY))}},{key:"beaconCollectionDomain",get:function(){var e;return null!=(e=this.getAttribute(hf.BEACON_COLLECTION_DOMAIN))?e:void 0},set:function(e){e!==this.beaconCollectionDomain&&(e?this.setAttribute(hf.BEACON_COLLECTION_DOMAIN,e):this.removeAttribute(hf.BEACON_COLLECTION_DOMAIN))}},{key:"streamType",get:function(){var e;return null!=(e=this.getAttribute(hf.STREAM_TYPE))?e:Eh(this.nativeEl)},set:function(e){e!==this.streamType&&(e?this.setAttribute(hf.STREAM_TYPE,e):this.removeAttribute(hf.STREAM_TYPE))}},{key:"targetLiveWindow",get:function(){return this.hasAttribute(hf.TARGET_LIVE_WINDOW)?+this.getAttribute(hf.TARGET_LIVE_WINDOW):function(e){var t,n;return null!=(n=null==(t=uh.get(e))?void 0:t.targetLiveWindow)?n:Number.NaN}(this.nativeEl)},set:function(e){e!=this.targetLiveWindow&&(null==e?this.removeAttribute(hf.TARGET_LIVE_WINDOW):this.setAttribute(hf.TARGET_LIVE_WINDOW,"".concat(+e)))}},{key:"liveEdgeStart",get:function(){var e,t;if(this.hasAttribute(hf.LIVE_EDGE_OFFSET)){var n=this.liveEdgeOffset,i=null!=(e=this.nativeEl.seekable.end(0))?e:0,a=null!=(t=this.nativeEl.seekable.start(0))?t:0;return Math.max(a,i-n)}return function(e){var t,n=null==(t=uh.get(e))?void 0:t.liveEdgeStartOffset;if("number"!=typeof n)return Number.NaN;var i=Ah(e);return i.length?i.end(i.length-1)-n:Number.NaN}(this.nativeEl)}},{key:"liveEdgeOffset",get:function(){if(this.hasAttribute(hf.LIVE_EDGE_OFFSET))return+this.getAttribute(hf.LIVE_EDGE_OFFSET)},set:function(e){e!=this.liveEdgeOffset&&(null==e?this.removeAttribute(hf.LIVE_EDGE_OFFSET):this.setAttribute(hf.LIVE_EDGE_OFFSET,"".concat(+e)))}},{key:"seekable",get:function(){return Ah(this.nativeEl)}},{key:"addCuePoints",value:function(){var e=(0,d.A)((0,l.A)().mark((function e(t){return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ed(this.nativeEl,t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"activeCuePoint",get:function(){return kd(this.nativeEl)}},{key:"cuePoints",get:function(){return function(e){var t=vd(e,(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{label:gd}).label,"metadata");return null!=t&&t.cues?Array.from(t.cues,(function(e){return bd(e)})):[]}(this.nativeEl)}},{key:"addChapters",value:function(){var e=(0,d.A)((0,l.A)().mark((function e(t){return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Rd(this.nativeEl,t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"activeChapter",get:function(){return Id(this.nativeEl)}},{key:"chapters",get:function(){return function(e){var t,n=vd(e,(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{label:_d}).label,"chapters");return null!=(t=null==n?void 0:n.cues)&&t.length?Array.from(n.cues,(function(e){return wd(e)})):[]}(this.nativeEl)}},{key:"getStartDate",value:function(){return function(e,t){if(t){var n=t.playingDate;if(null!=n)return new Date(n.getTime()-1e3*e.currentTime)}return"function"==typeof e.getStartDate?e.getStartDate():new Date(NaN)}(this.nativeEl,this._hls)}},{key:"currentPdt",get:function(){return function(e,t){if(t&&t.playingDate)return t.playingDate;if("function"==typeof e.getStartDate){var n=e.getStartDate();return new Date(n.getTime()+1e3*e.currentTime)}return new Date(NaN)}(this.nativeEl,this._hls)}},{key:"preferPlayback",get:function(){var e=this.getAttribute(hf.PREFER_PLAYBACK);if(e===Uc||e===Fc)return e},set:function(e){e!==this.preferPlayback&&(e===Uc||e===Fc?this.setAttribute(hf.PREFER_PLAYBACK,e):this.removeAttribute(hf.PREFER_PLAYBACK))}},{key:"metadata",get:function(){var e=this;return(0,i.A)((0,i.A)({},this.getAttributeNames().filter((function(e){return e.startsWith("metadata-")&&![hf.METADATA_URL].includes(e)})).reduce((function(t,n){var i=e.getAttribute(n);return null!=i&&(t[n.replace(/^metadata-/,"").replace(/-/g,"_")]=i),t}),{})),sf(this,jh))},set:function(e){uf(this,jh,null!=e?e:{}),this.mux&&this.mux.emit("hb",sf(this,jh))}},{key:"_hlsConfig",get:function(){return sf(this,Xh)},set:function(e){uf(this,Xh,e)}},{key:"logo",get:function(){var e;return null!=(e=this.getAttribute(hf.LOGO))?e:sf(this,$h)},set:function(e){e?this.setAttribute(hf.LOGO,e):this.removeAttribute(hf.LOGO)}},{key:"load",value:function(){uf(this,Vh,wh(this,this.nativeEl,sf(this,Vh)))}},{key:"unload",value:function(){Rh(this.nativeEl,sf(this,Vh),this),uf(this,Vh,void 0)}},{key:"attributeChangedCallback",value:function(e,t,i){var a,r,o=this;switch(af.lB.observedAttributes.includes(e)&&!["src","autoplay","preload"].includes(e)&&(0,u.A)((0,c.A)(n.prototype),"attributeChangedCallback",this).call(this,e,t,i),e){case hf.PLAYER_SOFTWARE_NAME:this.playerSoftwareName=null!=i?i:void 0;break;case hf.PLAYER_SOFTWARE_VERSION:this.playerSoftwareVersion=null!=i?i:void 0;break;case"src":var s=!!t,l=!!i;!s&&l?cf(this,ef,tf).call(this):s&&!l?this.unload():s&&l&&(this.unload(),cf(this,ef,tf).call(this));break;case"autoplay":if(i===t)break;null==(a=sf(this,Vh))||a.setAutoplay(this.autoplay);break;case"preload":if(i===t)break;null==(r=sf(this,Vh))||r.setPreload(i);break;case hf.PLAYBACK_ID:this.src=mh(this);break;case hf.DEBUG:var d=this.debug;this.mux&&console.info("Cannot toggle debug mode of mux data after initialization. Make sure you set all metadata to override before setting the src."),this._hls&&(this._hls.config.debug=d);break;case hf.METADATA_URL:i&&fetch(i).then((function(e){return e.json()})).then((function(e){return o.metadata=e})).catch((function(){return console.error("Unable to load or parse metadata JSON from metadata-url ".concat(i,"!"))}));break;case hf.STREAM_TYPE:(null==i||i!==t)&&this.dispatchEvent(new CustomEvent("streamtypechange",{composed:!0,bubbles:!0}));break;case hf.TARGET_LIVE_WINDOW:(null==i||i!==t)&&this.dispatchEvent(new CustomEvent("targetlivewindowchange",{composed:!0,bubbles:!0,detail:this.targetLiveWindow}));break;case hf.LOGO:(null==i||i!==t)&&this.updateLogo()}}},{key:"updateLogo",value:function(){if(this.shadowRoot){var e=this.shadowRoot.querySelector('slot[name="logo"]');if(e){var t=this.constructor.getLogoHTML(sf(this,$h)||this.logo);e.innerHTML=t}}}},{key:"connectedCallback",value:function(){var e;null==(e=(0,u.A)((0,c.A)(n.prototype),"connectedCallback",this))||e.call(this),this.nativeEl&&this.src&&!sf(this,Vh)&&cf(this,ef,tf).call(this)}},{key:"disconnectedCallback",value:function(){this.unload()}},{key:"handleEvent",value:function(e){e.target===this.nativeEl&&this.dispatchEvent(new CustomEvent(e.type,{composed:!0,detail:e.detail}))}}],[{key:"NAME",get:function(){return mf}},{key:"VERSION",get:function(){return vf}},{key:"observedAttributes",get:function(){var e;return[].concat(ff,(0,f.A)(null!=(e=af.lB.observedAttributes)?e:[]))}},{key:"getLogoHTML",value:function(e){return e&&"false"!==e?"default"===e?'\n<svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" part="logo" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2" viewBox="0 0 1600 500"><g fill="#fff"><path d="M994.287 93.486c-17.121 0-31-13.879-31-31 0-17.121 13.879-31 31-31 17.121 0 31 13.879 31 31 0 17.121-13.879 31-31 31m0-93.486c-34.509 0-62.484 27.976-62.484 62.486v187.511c0 68.943-56.09 125.033-125.032 125.033s-125.03-56.09-125.03-125.033V62.486C681.741 27.976 653.765 0 619.256 0s-62.484 27.976-62.484 62.486v187.511C556.772 387.85 668.921 500 806.771 500c137.851 0 250.001-112.15 250.001-250.003V62.486c0-34.51-27.976-62.486-62.485-62.486M1537.51 468.511c-17.121 0-31-13.879-31-31 0-17.121 13.879-31 31-31 17.121 0 31 13.879 31 31 0 17.121-13.879 31-31 31m-275.883-218.509-143.33 143.329c-24.402 24.402-24.402 63.966 0 88.368 24.402 24.402 63.967 24.402 88.369 0l143.33-143.329 143.328 143.329c24.402 24.4 63.967 24.402 88.369 0 24.403-24.402 24.403-63.966.001-88.368l-143.33-143.329.001-.004 143.329-143.329c24.402-24.402 24.402-63.965 0-88.367s-63.967-24.402-88.369 0L1349.996 161.63 1206.667 18.302c-24.402-24.401-63.967-24.402-88.369 0s-24.402 63.965 0 88.367l143.329 143.329v.004ZM437.511 468.521c-17.121 0-31-13.879-31-31 0-17.121 13.879-31 31-31 17.121 0 31 13.879 31 31 0 17.121-13.879 31-31 31M461.426 4.759C438.078-4.913 411.2.432 393.33 18.303L249.999 161.632 106.669 18.303C88.798.432 61.922-4.913 38.573 4.759 15.224 14.43-.001 37.214-.001 62.488v375.026c0 34.51 27.977 62.486 62.487 62.486 34.51 0 62.486-27.976 62.486-62.486V213.341l80.843 80.844c24.404 24.402 63.965 24.402 88.369 0l80.843-80.844v224.173c0 34.51 27.976 62.486 62.486 62.486s62.486-27.976 62.486-62.486V62.488c0-25.274-15.224-48.058-38.573-57.729" style="fill-rule:nonzero"/></g></svg>':'<img part="logo" src="'.concat(e,'" />'):""}},{key:"getTemplateHTML",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return"\n      ".concat(af.lB.getTemplateHTML(t),'\n      <style>\n        :host {\n          position: relative;\n        }\n        slot[name="logo"] {\n          display: flex;\n          justify-content: end;\n          position: absolute;\n          top: 1rem;\n          right: 1rem;\n          opacity: 0;\n          transition: opacity 0.25s ease-in-out;\n          z-index: 1;\n        }\n        slot[name="logo"]:has([part="logo"]) {\n          opacity: 1;\n        }\n        slot[name="logo"] [part="logo"] {\n          width: 5rem;\n          pointer-events: none;\n          user-select: none;\n        }\n      </style>\n      <slot name="logo">\n        ').concat(this.getLogoHTML(null!=(e=t[hf.LOGO])?e:""),"\n      </slot>\n    ")}}]),n}(af.lB);Vh=new WeakMap,qh=new WeakMap,Yh=new WeakMap,jh=new WeakMap,zh=new WeakMap,Xh=new WeakMap,Qh=new WeakMap,Zh=new WeakMap,Jh=new WeakMap,$h=new WeakMap,ef=new WeakSet,tf=function(){var e=(0,d.A)((0,l.A)().mark((function e(){return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=sf(this,qh),e.t0){e.next=6;break}return e.next=4,uf(this,qh,Promise.resolve());case 4:uf(this,qh,null),this.load();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}();var gf=n(966);function yf(e,t,n,i){return yf="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(e,t,n,i){var a,r=(0,gf.A)(e,t);if(r){if((a=Object.getOwnPropertyDescriptor(r,t)).set)return a.set.call(i,n),!0;if(!a.writable)return!1}if(a=Object.getOwnPropertyDescriptor(i,t)){if(!a.writable)return!1;a.value=n,Object.defineProperty(i,t,a)}else(0,s.A)(i,t,n);return!0},yf(e,t,n,i)}function Ef(e,t,n,i,a){if(!yf(e,t,n,i||e)&&a)throw new TypeError("failed to set property");return n}var Af=n(9790),bf=n(5149),kf=n(806),Tf=n(1187),_f=n(1114),Sf=new WeakMap,wf=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){return(0,m.A)(this,n),t.apply(this,arguments)}return(0,v.A)(n)}((0,y.A)(Error)),Rf=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){return(0,m.A)(this,n),t.apply(this,arguments)}return(0,v.A)(n)}((0,y.A)(Error)),Lf=["application/x-mpegURL","application/vnd.apple.mpegurl","audio/mpegurl"];function If(){var e,t;return null===(e=globalThis.cast)||void 0===e||null===(t=e.framework)||void 0===t?void 0:t.CastContext.getInstance()}function Df(){var e;return null===(e=If())||void 0===e?void 0:e.getCurrentSession()}function Cf(){var e;return null===(e=Df())||void 0===e?void 0:e.getSessionObj().media[0]}function xf(e){return new Promise((function(t,n){Cf().editTracksInfo(e,t,n)}))}function Mf(e){return new Promise((function(t,n){Cf().getStatus(e,t,n)}))}function Of(e){return If().setOptions((0,i.A)((0,i.A)({},{receiverApplicationId:"CC1AD845",autoJoinPolicy:"origin_scoped",androidReceiverCompatible:!1,language:"en-US",resumeSavedSession:!0}),e))}function Pf(e){if(e){var t=e.match(/\.([a-zA-Z0-9]+)(?:\?.*)?$/);return t?t[1]:null}}function Nf(e){for(var t=e.split("\n"),n=[],i=0;i<t.length;i++){if(t[i].trim().startsWith("#EXT-X-STREAM-INF")){var a=t[i+1]?t[i+1].trim():"";a&&!a.startsWith("#")&&n.push(a)}}return n}function Uf(e){return e.split("\n").find((function(e){return!e.trim().startsWith("#")&&""!==e.trim()}))}function Ff(e){return Bf.apply(this,arguments)}function Bf(){return(Bf=(0,d.A)((0,l.A)().mark((function e(t){var n,i;return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t,{method:"HEAD"});case 3:return n=e.sent,i=n.headers.get("Content-Type"),e.abrupt("return",Lf.some((function(e){return i===e})));case 8:return e.prev=8,e.t0=e.catch(0),console.error("Error while trying to get the Content-Type of the manifest",e.t0),e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function Hf(e){return Gf.apply(this,arguments)}function Gf(){return Gf=(0,d.A)((0,l.A)().mark((function e(t){var n,i,a,r,o,s;return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t);case 3:return e.next=5,e.sent.text();case 5:if(n=e.sent,i=n,!((a=Nf(n)).length>0)){e.next=15;break}return r=new URL(a[0],t).toString(),e.next=12,fetch(r);case 12:return e.next=14,e.sent.text();case 14:i=e.sent;case 15:return o=Uf(i),s=Pf(o),e.abrupt("return",s);case 20:return e.prev=20,e.t0=e.catch(0),console.error("Error while trying to parse the manifest playlist",e.t0),e.abrupt("return",void 0);case 24:case"end":return e.stop()}}),e,null,[[0,20]])}))),Gf.apply(this,arguments)}var Kf,Wf=new(globalThis.WeakRef?function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){return(0,m.A)(this,n),t.apply(this,arguments)}return(0,v.A)(n,[{key:"add",value:function(e){(0,u.A)((0,c.A)(n.prototype),"add",this).call(this,new WeakRef(e))}},{key:"forEach",value:function(e){(0,u.A)((0,c.A)(n.prototype),"forEach",this).call(this,(function(t){var n=t.deref();n&&e(n)}))}}]),n}((0,y.A)(Set)):Set),Vf=new WeakSet;!function(e){var t,n,i;null!==(t=globalThis.chrome)&&void 0!==t&&null!==(n=t.cast)&&void 0!==n&&n.isAvailable?null!==(i=globalThis.cast)&&void 0!==i&&i.framework?e():customElements.whenDefined("google-cast-button").then(e):globalThis.__onGCastApiAvailable=function(){customElements.whenDefined("google-cast-button").then(e)}}((function(){var e,t,n,i;null!==(e=globalThis.chrome)&&void 0!==e&&null!==(t=e.cast)&&void 0!==t&&t.isAvailable?Kf||(Kf=cast.framework,If().addEventListener(Kf.CastContextEventType.CAST_STATE_CHANGED,(function(e){Wf.forEach((function(t){var n,i;return null===(n=(i=Sf.get(t)).onCastStateChanged)||void 0===n?void 0:n.call(i,e)}))})),If().addEventListener(Kf.CastContextEventType.SESSION_STATE_CHANGED,(function(e){Wf.forEach((function(t){var n,i;return null===(n=(i=Sf.get(t)).onSessionStateChanged)||void 0===n?void 0:n.call(i,e)}))})),Wf.forEach((function(e){var t,n;return null===(t=(n=Sf.get(e)).init)||void 0===t?void 0:t.call(n)}))):console.debug("chrome.cast.isAvailable",null===(n=globalThis.chrome)||void 0===n||null===(i=n.cast)||void 0===i?void 0:i.isAvailable)}));var qf=0,Yf=new WeakMap,jf=new WeakMap,zf=new WeakMap,Xf=new WeakMap,Qf=new WeakMap,Zf=new WeakMap,Jf=new WeakMap,$f=new WeakMap,ev=new WeakMap,tv=new WeakSet,nv=new WeakSet,iv=new WeakSet,av=new WeakSet,rv=new WeakSet,ov=new WeakSet,sv=new WeakSet,lv=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(e){var i;return(0,m.A)(this,n),i=t.call(this),(0,Af.A)((0,Ln.A)(i),sv),(0,Af.A)((0,Ln.A)(i),ov),(0,Af.A)((0,Ln.A)(i),rv),(0,Af.A)((0,Ln.A)(i),av),(0,Af.A)((0,Ln.A)(i),iv),(0,Af.A)((0,Ln.A)(i),nv),(0,Af.A)((0,Ln.A)(i),tv),(0,bf.A)((0,Ln.A)(i),ev,{get:uv,set:void 0}),(0,bf.A)((0,Ln.A)(i),Yf,{writable:!0,value:void 0}),(0,bf.A)((0,Ln.A)(i),jf,{writable:!0,value:void 0}),(0,bf.A)((0,Ln.A)(i),zf,{writable:!0,value:void 0}),(0,bf.A)((0,Ln.A)(i),Xf,{writable:!0,value:void 0}),(0,bf.A)((0,Ln.A)(i),Qf,{writable:!0,value:"disconnected"}),(0,bf.A)((0,Ln.A)(i),Zf,{writable:!0,value:!1}),(0,bf.A)((0,Ln.A)(i),Jf,{writable:!0,value:new Set}),(0,bf.A)((0,Ln.A)(i),$f,{writable:!0,value:new WeakMap}),(0,kf.A)((0,Ln.A)(i),Yf,e),Wf.add((0,Ln.A)(i)),Sf.set((0,Ln.A)(i),{init:function(){return(0,Tf.A)((0,Ln.A)(i),rv,mv).call((0,Ln.A)(i))},onCastStateChanged:function(){return(0,Tf.A)((0,Ln.A)(i),iv,hv).call((0,Ln.A)(i))},onSessionStateChanged:function(){return(0,Tf.A)((0,Ln.A)(i),av,fv).call((0,Ln.A)(i))},getCastPlayer:function(){return(0,_f.A)((0,Ln.A)(i),ev)}}),(0,Tf.A)((0,Ln.A)(i),rv,mv).call((0,Ln.A)(i)),i}return(0,v.A)(n,[{key:"state",get:function(){return(0,_f.A)(this,Qf)}},{key:"watchAvailability",value:function(){var e=(0,d.A)((0,l.A)().mark((function e(t){var n=this;return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,_f.A)(this,Yf).disableRemotePlayback){e.next=2;break}throw new wf("disableRemotePlayback attribute is present.");case 2:return(0,_f.A)(this,$f).set(t,++qf),(0,_f.A)(this,Jf).add(t),queueMicrotask((function(){return t((0,Tf.A)(n,nv,dv).call(n))})),e.abrupt("return",qf);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"cancelWatchAvailability",value:function(){var e=(0,d.A)((0,l.A)().mark((function e(t){return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,_f.A)(this,Yf).disableRemotePlayback){e.next=2;break}throw new wf("disableRemotePlayback attribute is present.");case 2:t?(0,_f.A)(this,Jf).delete(t):(0,_f.A)(this,Jf).clear();case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"prompt",value:function(){var e=(0,d.A)((0,l.A)().mark((function e(){var t,n,i,r,o,s=this;return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,_f.A)(this,Yf).disableRemotePlayback){e.next=2;break}throw new wf("disableRemotePlayback attribute is present.");case 2:if(null!==(t=globalThis.chrome)&&void 0!==t&&null!==(n=t.cast)&&void 0!==n&&n.isAvailable){e.next=4;break}throw new Rf("The RemotePlayback API is disabled on this platform.");case 4:return o=Vf.has((0,_f.A)(this,Yf)),Vf.add((0,_f.A)(this,Yf)),Of((0,_f.A)(this,Yf).castOptions),Object.entries((0,_f.A)(this,Xf)).forEach((function(e){var t=(0,a.A)(e,2),n=t[0],i=t[1];(0,_f.A)(s,zf).controller.addEventListener(n,i)})),e.prev=8,e.next=11,If().requestSession();case 11:e.next=19;break;case 13:if(e.prev=13,e.t0=e.catch(8),o||Vf.delete((0,_f.A)(this,Yf)),"cancel"!==e.t0){e.next=18;break}return e.abrupt("return");case 18:throw new Error(e.t0);case 19:null===(i=Sf.get((0,_f.A)(this,Yf)))||void 0===i||null===(r=i.loadOnPrompt)||void 0===r||r.call(i);case 20:case"end":return e.stop()}}),e,this,[[8,13]])})));return function(){return e.apply(this,arguments)}}()}]),n}((0,y.A)(EventTarget));function uv(){if(Vf.has((0,_f.A)(this,Yf)))return(0,_f.A)(this,zf)}function cv(){var e=this;Vf.has((0,_f.A)(this,Yf))&&(Object.entries((0,_f.A)(this,Xf)).forEach((function(t){var n=(0,a.A)(t,2),i=n[0],r=n[1];(0,_f.A)(e,zf).controller.removeEventListener(i,r)})),Vf.delete((0,_f.A)(this,Yf)),(0,_f.A)(this,Yf).muted=(0,_f.A)(this,zf).isMuted,(0,_f.A)(this,Yf).currentTime=(0,_f.A)(this,zf).savedPlayerState.currentTime,!1===(0,_f.A)(this,zf).savedPlayerState.isPaused&&(0,_f.A)(this,Yf).play())}function dv(){var e,t=null===(e=If())||void 0===e?void 0:e.getCastState();return t&&"NO_DEVICES_AVAILABLE"!==t}function hv(){var e=If().getCastState();if(Vf.has((0,_f.A)(this,Yf))&&"CONNECTING"===e&&((0,kf.A)(this,Qf,"connecting"),this.dispatchEvent(new Event("connecting"))),!(0,_f.A)(this,Zf)&&null!==e&&void 0!==e&&e.includes("CONNECT")){(0,kf.A)(this,Zf,!0);var t,n=(0,h.A)((0,_f.A)(this,Jf));try{for(n.s();!(t=n.n()).done;){(0,t.value)(!0)}}catch(BL){n.e(BL)}finally{n.f()}}else if((0,_f.A)(this,Zf)&&(!e||"NO_DEVICES_AVAILABLE"===e)){(0,kf.A)(this,Zf,!1);var i,a=(0,h.A)((0,_f.A)(this,Jf));try{for(a.s();!(i=a.n()).done;){(0,i.value)(!1)}}catch(BL){a.e(BL)}finally{a.f()}}}function fv(){return vv.apply(this,arguments)}function vv(){return vv=(0,d.A)((0,l.A)().mark((function e(){var t,n,i=this;return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Kf.SessionState.SESSION_RESUMED,If().getSessionState()!==t){e.next=15;break}if((0,_f.A)(this,Yf).castSrc!==(null===(n=Cf())||void 0===n?void 0:n.media.contentId)){e.next=15;break}return Vf.add((0,_f.A)(this,Yf)),Object.entries((0,_f.A)(this,Xf)).forEach((function(e){var t=(0,a.A)(e,2),n=t[0],r=t[1];(0,_f.A)(i,zf).controller.addEventListener(n,r)})),e.prev=5,e.next=8,Mf(new chrome.cast.media.GetStatusRequest);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(5),console.error(e.t0);case 13:(0,_f.A)(this,Xf)[Kf.RemotePlayerEventType.IS_PAUSED_CHANGED](),(0,_f.A)(this,Xf)[Kf.RemotePlayerEventType.PLAYER_STATE_CHANGED]();case 15:case"end":return e.stop()}}),e,this,[[5,10]])}))),vv.apply(this,arguments)}function mv(){var e,t=this;Kf&&!(0,_f.A)(this,jf)&&((0,kf.A)(this,jf,!0),Of((0,_f.A)(this,Yf).castOptions),(0,_f.A)(this,Yf).textTracks.addEventListener("change",(function(){return(0,Tf.A)(t,sv,gv).call(t)})),(0,Tf.A)(this,iv,hv).call(this),(0,kf.A)(this,zf,new Kf.RemotePlayer),new Kf.RemotePlayerController((0,_f.A)(this,zf)),(0,kf.A)(this,Xf,(e={},(0,s.A)(e,Kf.RemotePlayerEventType.IS_CONNECTED_CHANGED,(function(e){!0===e.value?((0,kf.A)(t,Qf,"connected"),t.dispatchEvent(new Event("connect"))):((0,Tf.A)(t,tv,cv).call(t),(0,kf.A)(t,Qf,"disconnected"),t.dispatchEvent(new Event("disconnect")))})),(0,s.A)(e,Kf.RemotePlayerEventType.DURATION_CHANGED,(function(){(0,_f.A)(t,Yf).dispatchEvent(new Event("durationchange"))})),(0,s.A)(e,Kf.RemotePlayerEventType.VOLUME_LEVEL_CHANGED,(function(){(0,_f.A)(t,Yf).dispatchEvent(new Event("volumechange"))})),(0,s.A)(e,Kf.RemotePlayerEventType.IS_MUTED_CHANGED,(function(){(0,_f.A)(t,Yf).dispatchEvent(new Event("volumechange"))})),(0,s.A)(e,Kf.RemotePlayerEventType.CURRENT_TIME_CHANGED,(function(){var e;null!==(e=(0,_f.A)(t,ev))&&void 0!==e&&e.isMediaLoaded&&(0,_f.A)(t,Yf).dispatchEvent(new Event("timeupdate"))})),(0,s.A)(e,Kf.RemotePlayerEventType.VIDEO_INFO_CHANGED,(function(){(0,_f.A)(t,Yf).dispatchEvent(new Event("resize"))})),(0,s.A)(e,Kf.RemotePlayerEventType.IS_PAUSED_CHANGED,(function(){(0,_f.A)(t,Yf).dispatchEvent(new Event(t.paused?"pause":"play"))})),(0,s.A)(e,Kf.RemotePlayerEventType.PLAYER_STATE_CHANGED,(function(){var e,n,i;(null===(e=(0,_f.A)(t,ev))||void 0===e?void 0:e.playerState)!==chrome.cast.media.PlayerState.PAUSED&&(0,_f.A)(t,Yf).dispatchEvent(new Event((n={},(0,s.A)(n,chrome.cast.media.PlayerState.PLAYING,"playing"),(0,s.A)(n,chrome.cast.media.PlayerState.BUFFERING,"waiting"),(0,s.A)(n,chrome.cast.media.PlayerState.IDLE,"emptied"),n)[null===(i=(0,_f.A)(t,ev))||void 0===i?void 0:i.playerState]))})),(0,s.A)(e,Kf.RemotePlayerEventType.IS_MEDIA_LOADED_CHANGED,(0,d.A)((0,l.A)().mark((function e(){var n;return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(n=(0,_f.A)(t,ev))&&void 0!==n&&n.isMediaLoaded){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Promise.resolve();case 4:(0,Tf.A)(t,ov,pv).call(t);case 5:case"end":return e.stop()}}),e)})))),e)))}function pv(){(0,Tf.A)(this,sv,gv).call(this)}function gv(){return yv.apply(this,arguments)}function yv(){return yv=(0,d.A)((0,l.A)().mark((function e(){var t,n,i,a,r,o,s,u,c,d,h,v,m,p,g,y;return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,_f.A)(this,ev)){e.next=2;break}return e.abrupt("return");case 2:if(o=null!==(t=null===(n=(0,_f.A)(this,zf).mediaInfo)||void 0===n?void 0:n.tracks)&&void 0!==t?t:[],s=o.filter((function(e){return e.type===chrome.cast.media.TrackType.TEXT})),u=(0,f.A)((0,_f.A)(this,Yf).textTracks).filter((function(e){var t=e.kind;return"subtitles"===t||"captions"===t})),c=s.map((function(e){var t,n=e.language,i=e.name,a=e.trackId,r=(null!==(t=u.find((function(e){return e.language===n&&e.label===i})))&&void 0!==t?t:{}).mode;return!!r&&{mode:r,trackId:a}})).filter(Boolean),d=c.filter((function(e){return"showing"!==e.mode})),h=d.map((function(e){return e.trackId})),v=c.find((function(e){return"showing"===e.mode})),m=null!==(i=null===(a=Df())||void 0===a||null===(r=a.getSessionObj().media[0])||void 0===r?void 0:r.activeTrackIds)&&void 0!==i?i:[],p=m,m.length&&(p=p.filter((function(e){return!h.includes(e)}))),null!==v&&void 0!==v&&v.trackId&&(p=[].concat((0,f.A)(p),[v.trackId])),p=(0,f.A)(new Set(p)),g=function(e,t){return e.length===t.length&&e.every((function(e){return t.includes(e)}))},g(m,p)){e.next=25;break}return e.prev=16,y=new chrome.cast.media.EditTracksInfoRequest(p),e.next=20,xf(y);case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(16),console.error(e.t0);case 25:case"end":return e.stop()}}),e,this,[[16,22]])}))),yv.apply(this,arguments)}var Ev=function(e){var t,n,i,a,r,o,h,y;return n=new WeakMap,i=new WeakMap,a=new WeakMap,r=new WeakMap,o=new WeakMap,h=new WeakSet,t=function(e){(0,p.A)(s,e);var t=(0,g.A)(s);function s(){var e;(0,m.A)(this,s);for(var l=arguments.length,u=new Array(l),c=0;c<l;c++)u[c]=arguments[c];return e=t.call.apply(t,[this].concat(u)),(0,Af.A)((0,Ln.A)(e),h),(0,bf.A)((0,Ln.A)(e),o,{get:E,set:void 0}),(0,bf.A)((0,Ln.A)(e),n,{writable:!0,value:{paused:!1}}),(0,bf.A)((0,Ln.A)(e),i,{writable:!0,value:{receiverApplicationId:"CC1AD845",autoJoinPolicy:"origin_scoped",androidReceiverCompatible:!1,language:"en-US",resumeSavedSession:!0}}),(0,bf.A)((0,Ln.A)(e),a,{writable:!0,value:void 0}),(0,bf.A)((0,Ln.A)(e),r,{writable:!0,value:void 0}),e}return(0,v.A)(s,[{key:"remote",get:function(){var e=this;return(0,_f.A)(this,r)?(0,_f.A)(this,r):globalThis.chrome?(this.disableRemotePlayback||function(){var e,t="https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1";if(!(null!==(e=globalThis.chrome)&&void 0!==e&&e.cast||document.querySelector('script[src="'.concat(t,'"]')))){var n=document.createElement("script");n.src=t,document.head.append(n)}}(),Sf.set(this,{loadOnPrompt:function(){return(0,Tf.A)(e,h,A).call(e)}}),(0,kf.A)(this,r,new lv(this))):(0,u.A)((0,c.A)(s.prototype),"remote",this)}},{key:"attributeChangedCallback",value:function(e,t,n){if((0,u.A)((0,c.A)(s.prototype),"attributeChangedCallback",this).call(this,e,t,n),"cast-receiver"===e&&n)(0,_f.A)(this,i).receiverApplicationId=n;else if((0,_f.A)(this,o))switch(e){case"cast-stream-type":case"cast-src":this.load()}}},{key:"load",value:function(){var e=(0,d.A)((0,l.A)().mark((function e(){var t,i,a,r,d,h,v,m;return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,_f.A)(this,o)){e.next=2;break}return e.abrupt("return",(0,u.A)((0,c.A)(s.prototype),"load",this).call(this));case 2:if((a=new chrome.cast.media.MediaInfo(this.castSrc,this.castContentType)).customData=this.castCustomData,r=(0,f.A)(this.querySelectorAll("track")).filter((function(e){var t=e.kind;return e.src&&("subtitles"===t||"captions"===t)})),d=[],h=0,r.length&&(a.tracks=r.map((function(e){var t=++h;0===d.length&&"showing"===e.track.mode&&d.push(t);var n=new chrome.cast.media.Track(t,chrome.cast.media.TrackType.TEXT);return n.trackContentId=e.src,n.trackContentType="text/vtt",n.subtype="captions"===e.kind?chrome.cast.media.TextTrackType.CAPTIONS:chrome.cast.media.TextTrackType.SUBTITLES,n.name=e.label,n.language=e.srclang,n}))),"live"===this.castStreamType?a.streamType=chrome.cast.media.StreamType.LIVE:a.streamType=chrome.cast.media.StreamType.BUFFERED,a.metadata=new chrome.cast.media.GenericMediaMetadata,a.metadata.title=this.title,a.metadata.images=[{url:this.poster}],!Ff(this.castSrc)){e.next=18;break}return e.next=15,Hf(this.castSrc);case 15:v=e.sent,((null===v||void 0===v?void 0:v.includes("m4s"))||(null===v||void 0===v?void 0:v.includes("mp4")))&&(a.hlsSegmentFormat=chrome.cast.media.HlsSegmentFormat.FMP4,a.hlsVideoSegmentFormat=chrome.cast.media.HlsVideoSegmentFormat.FMP4);case 18:return(m=new chrome.cast.media.LoadRequest(a)).currentTime=null!==(t=(0,u.A)((0,c.A)(s.prototype),"currentTime",this))&&void 0!==t?t:0,m.autoplay=!(0,_f.A)(this,n).paused,m.activeTrackIds=d,e.next=24,null===(i=Df())||void 0===i?void 0:i.loadMedia(m);case 24:this.dispatchEvent(new Event("volumechange"));case 25:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"play",value:function(){if(!(0,_f.A)(this,o))return(0,u.A)((0,c.A)(s.prototype),"play",this).call(this);var e;(0,_f.A)(this,o).isPaused&&(null===(e=(0,_f.A)(this,o).controller)||void 0===e||e.playOrPause())}},{key:"pause",value:function(){var e;(0,_f.A)(this,o)?(0,_f.A)(this,o).isPaused||null===(e=(0,_f.A)(this,o).controller)||void 0===e||e.playOrPause():(0,u.A)((0,c.A)(s.prototype),"pause",this).call(this)}},{key:"castOptions",get:function(){return(0,_f.A)(this,i)}},{key:"castReceiver",get:function(){var e;return null!==(e=this.getAttribute("cast-receiver"))&&void 0!==e?e:void 0},set:function(e){this.castReceiver!=e&&this.setAttribute("cast-receiver","".concat(e))}},{key:"castSrc",get:function(){var e,t,n;return null!==(e=null!==(t=this.getAttribute("cast-src"))&&void 0!==t?t:null===(n=this.querySelector("source"))||void 0===n?void 0:n.src)&&void 0!==e?e:this.currentSrc},set:function(e){this.castSrc!=e&&this.setAttribute("cast-src","".concat(e))}},{key:"castContentType",get:function(){var e;return null!==(e=this.getAttribute("cast-content-type"))&&void 0!==e?e:void 0},set:function(e){this.setAttribute("cast-content-type","".concat(e))}},{key:"castStreamType",get:function(){var e,t;return null!==(e=null!==(t=this.getAttribute("cast-stream-type"))&&void 0!==t?t:this.streamType)&&void 0!==e?e:void 0},set:function(e){this.setAttribute("cast-stream-type","".concat(e))}},{key:"castCustomData",get:function(){return(0,_f.A)(this,a)},set:function(e){var t=typeof e;["object","undefined"].includes(t)?(0,kf.A)(this,a,e):console.error("castCustomData must be nullish or an object but value was of type ".concat(t))}},{key:"readyState",get:function(){if((0,_f.A)(this,o))switch((0,_f.A)(this,o).playerState){case chrome.cast.media.PlayerState.IDLE:return 0;case chrome.cast.media.PlayerState.BUFFERING:return 2;default:return 3}return(0,u.A)((0,c.A)(s.prototype),"readyState",this)}},{key:"paused",get:function(){return(0,_f.A)(this,o)?(0,_f.A)(this,o).isPaused:(0,u.A)((0,c.A)(s.prototype),"paused",this)}},{key:"muted",get:function(){var e;return(0,_f.A)(this,o)?null===(e=(0,_f.A)(this,o))||void 0===e?void 0:e.isMuted:(0,u.A)((0,c.A)(s.prototype),"muted",this)},set:function(e){var t;(0,_f.A)(this,o)?(e&&!(0,_f.A)(this,o).isMuted||!e&&(0,_f.A)(this,o).isMuted)&&(null===(t=(0,_f.A)(this,o).controller)||void 0===t||t.muteOrUnmute()):Ef((0,c.A)(s.prototype),"muted",e,this,!0)}},{key:"volume",get:function(){var e,t;return(0,_f.A)(this,o)?null!==(e=null===(t=(0,_f.A)(this,o))||void 0===t?void 0:t.volumeLevel)&&void 0!==e?e:1:(0,u.A)((0,c.A)(s.prototype),"volume",this)},set:function(e){var t;if((0,_f.A)(this,o))return(0,_f.A)(this,o).volumeLevel=+e,void(null===(t=(0,_f.A)(this,o).controller)||void 0===t||t.setVolumeLevel());Ef((0,c.A)(s.prototype),"volume",e,this,!0)}},{key:"duration",get:function(){var e,t,n;return(0,_f.A)(this,o)&&null!==(e=(0,_f.A)(this,o))&&void 0!==e&&e.isMediaLoaded?null!==(t=null===(n=(0,_f.A)(this,o))||void 0===n?void 0:n.duration)&&void 0!==t?t:NaN:(0,u.A)((0,c.A)(s.prototype),"duration",this)}},{key:"currentTime",get:function(){var e,t,n;return(0,_f.A)(this,o)&&null!==(e=(0,_f.A)(this,o))&&void 0!==e&&e.isMediaLoaded?null!==(t=null===(n=(0,_f.A)(this,o))||void 0===n?void 0:n.currentTime)&&void 0!==t?t:0:(0,u.A)((0,c.A)(s.prototype),"currentTime",this)},set:function(e){var t;if((0,_f.A)(this,o))return(0,_f.A)(this,o).currentTime=e,void(null===(t=(0,_f.A)(this,o).controller)||void 0===t||t.seek());Ef((0,c.A)(s.prototype),"currentTime",e,this,!0)}}]),s}(e),(0,s.A)(t,"observedAttributes",[].concat((0,f.A)(null!==(y=e.observedAttributes)&&void 0!==y?y:[]),["cast-src","cast-content-type","cast-stream-type","cast-receiver"])),t;function E(){var e,t;return null===(e=Sf.get(this.remote))||void 0===e||null===(t=e.getCastPlayer)||void 0===t?void 0:t.call(e)}function A(){return b.apply(this,arguments)}function b(){return(b=(0,d.A)((0,l.A)().mark((function e(){return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,_f.A)(this,n).paused=(0,u.A)((0,c.A)(t.prototype),"paused",this),(0,u.A)((0,c.A)(t.prototype),"pause",this).call(this),this.muted=(0,u.A)((0,c.A)(t.prototype),"muted",this),e.prev=3,e.next=6,this.load();case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),console.error(e.t0);case 11:case"end":return e.stop()}}),e,this,[[3,8]])})))).apply(this,arguments)}},Av=n(9769),bv=function(e){throw TypeError(e)},kv=function(e,t,n){return t.has(e)||bv("Cannot "+n)},Tv=function(e,t,n){return kv(e,t,"read from private field"),n?n.call(e):t.get(e)},_v=function(e,t,n){return t.has(e)?bv("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n)},Sv=function(e,t,n,i){return kv(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n},wv=function(){function e(){(0,m.A)(this,e)}return(0,v.A)(e,[{key:"addEventListener",value:function(){}},{key:"removeEventListener",value:function(){}},{key:"dispatchEvent",value:function(e){return!0}}]),e}();if("undefined"==typeof DocumentFragment){var Rv=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){return(0,m.A)(this,n),t.apply(this,arguments)}return(0,v.A)(n)}(wv);globalThis.DocumentFragment=Rv}var Lv,Iv=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){return(0,m.A)(this,n),t.apply(this,arguments)}return(0,v.A)(n)}(wv),Dv=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){return(0,m.A)(this,n),t.apply(this,arguments)}return(0,v.A)(n)}(wv),Cv={get:function(e){},define:function(e,t,n){},getName:function(e){return null},upgrade:function(e){},whenDefined:function(e){return Promise.resolve(Iv)}},xv=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,m.A)(this,e),_v(this,Lv),Sv(this,Lv,null==n?void 0:n.detail)}return(0,v.A)(e,[{key:"detail",get:function(){return Tv(this,Lv)}},{key:"initCustomEvent",value:function(){}}]),e}();Lv=new WeakMap;var Mv,Ov={document:{createElement:function(e,t){return new Iv}},DocumentFragment:DocumentFragment,customElements:Cv,CustomEvent:xv,EventTarget:wv,HTMLElement:Iv,HTMLVideoElement:Dv},Pv="undefined"==typeof window||"undefined"==typeof globalThis.customElements,Nv=Pv?Ov:globalThis,Uv=(Pv||globalThis.document,function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){var e;return(0,m.A)(this,n),e=t.apply(this,arguments),_v((0,Ln.A)(e),Mv),e}return(0,v.A)(n,[{key:"autoplay",get:function(){var e=this.getAttribute("autoplay");return null!==e&&(""===e||e)},set:function(e){e!==this.autoplay&&(e?this.setAttribute("autoplay","string"==typeof e?e:""):this.removeAttribute("autoplay"))}},{key:"muxCastCustomData",get:function(){return{mux:{playbackId:this.playbackId,minResolution:this.minResolution,maxResolution:this.maxResolution,renditionOrder:this.renditionOrder,customDomain:this.customDomain,tokens:{drm:this.drmToken},envKey:this.envKey,metadata:this.metadata,disableCookies:this.disableCookies,disableTracking:this.disableTracking,beaconCollectionDomain:this.beaconCollectionDomain,startTime:this.startTime,preferCmcd:this.preferCmcd}}}},{key:"castCustomData",get:function(){var e;return null!=(e=Tv(this,Mv))?e:this.muxCastCustomData},set:function(e){Sv(this,Mv,e)}}]),n}(Ev((0,Av.u6)(pf))));Mv=new WeakMap,Nv.customElements.get("mux-video")||(Nv.customElements.define("mux-video",Uv),Nv.MuxVideoElement=Uv);function Fv(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var Bv={MEDIA_PLAY_REQUEST:"mediaplayrequest",MEDIA_PAUSE_REQUEST:"mediapauserequest",MEDIA_MUTE_REQUEST:"mediamuterequest",MEDIA_UNMUTE_REQUEST:"mediaunmuterequest",MEDIA_VOLUME_REQUEST:"mediavolumerequest",MEDIA_SEEK_REQUEST:"mediaseekrequest",MEDIA_AIRPLAY_REQUEST:"mediaairplayrequest",MEDIA_ENTER_FULLSCREEN_REQUEST:"mediaenterfullscreenrequest",MEDIA_EXIT_FULLSCREEN_REQUEST:"mediaexitfullscreenrequest",MEDIA_PREVIEW_REQUEST:"mediapreviewrequest",MEDIA_ENTER_PIP_REQUEST:"mediaenterpiprequest",MEDIA_EXIT_PIP_REQUEST:"mediaexitpiprequest",MEDIA_ENTER_CAST_REQUEST:"mediaentercastrequest",MEDIA_EXIT_CAST_REQUEST:"mediaexitcastrequest",MEDIA_SHOW_TEXT_TRACKS_REQUEST:"mediashowtexttracksrequest",MEDIA_HIDE_TEXT_TRACKS_REQUEST:"mediahidetexttracksrequest",MEDIA_SHOW_SUBTITLES_REQUEST:"mediashowsubtitlesrequest",MEDIA_DISABLE_SUBTITLES_REQUEST:"mediadisablesubtitlesrequest",MEDIA_TOGGLE_SUBTITLES_REQUEST:"mediatogglesubtitlesrequest",MEDIA_PLAYBACK_RATE_REQUEST:"mediaplaybackraterequest",MEDIA_RENDITION_REQUEST:"mediarenditionrequest",MEDIA_AUDIO_TRACK_REQUEST:"mediaaudiotrackrequest",MEDIA_SEEK_TO_LIVE_REQUEST:"mediaseektoliverequest",REGISTER_MEDIA_STATE_RECEIVER:"registermediastatereceiver",UNREGISTER_MEDIA_STATE_RECEIVER:"unregistermediastatereceiver"},Hv="mediachromeattributes",Gv="mediacontroller",Kv={MEDIA_AIRPLAY_UNAVAILABLE:"mediaAirplayUnavailable",MEDIA_AUDIO_TRACK_ENABLED:"mediaAudioTrackEnabled",MEDIA_AUDIO_TRACK_LIST:"mediaAudioTrackList",MEDIA_AUDIO_TRACK_UNAVAILABLE:"mediaAudioTrackUnavailable",MEDIA_BUFFERED:"mediaBuffered",MEDIA_CAST_UNAVAILABLE:"mediaCastUnavailable",MEDIA_CHAPTERS_CUES:"mediaChaptersCues",MEDIA_CURRENT_TIME:"mediaCurrentTime",MEDIA_DURATION:"mediaDuration",MEDIA_ENDED:"mediaEnded",MEDIA_ERROR:"mediaError",MEDIA_ERROR_CODE:"mediaErrorCode",MEDIA_ERROR_MESSAGE:"mediaErrorMessage",MEDIA_FULLSCREEN_UNAVAILABLE:"mediaFullscreenUnavailable",MEDIA_HAS_PLAYED:"mediaHasPlayed",MEDIA_HEIGHT:"mediaHeight",MEDIA_IS_AIRPLAYING:"mediaIsAirplaying",MEDIA_IS_CASTING:"mediaIsCasting",MEDIA_IS_FULLSCREEN:"mediaIsFullscreen",MEDIA_IS_PIP:"mediaIsPip",MEDIA_LOADING:"mediaLoading",MEDIA_MUTED:"mediaMuted",MEDIA_PAUSED:"mediaPaused",MEDIA_PIP_UNAVAILABLE:"mediaPipUnavailable",MEDIA_PLAYBACK_RATE:"mediaPlaybackRate",MEDIA_PREVIEW_CHAPTER:"mediaPreviewChapter",MEDIA_PREVIEW_COORDS:"mediaPreviewCoords",MEDIA_PREVIEW_IMAGE:"mediaPreviewImage",MEDIA_PREVIEW_TIME:"mediaPreviewTime",MEDIA_RENDITION_LIST:"mediaRenditionList",MEDIA_RENDITION_SELECTED:"mediaRenditionSelected",MEDIA_RENDITION_UNAVAILABLE:"mediaRenditionUnavailable",MEDIA_SEEKABLE:"mediaSeekable",MEDIA_STREAM_TYPE:"mediaStreamType",MEDIA_SUBTITLES_LIST:"mediaSubtitlesList",MEDIA_SUBTITLES_SHOWING:"mediaSubtitlesShowing",MEDIA_TARGET_LIVE_WINDOW:"mediaTargetLiveWindow",MEDIA_TIME_IS_LIVE:"mediaTimeIsLive",MEDIA_VOLUME:"mediaVolume",MEDIA_VOLUME_LEVEL:"mediaVolumeLevel",MEDIA_VOLUME_UNAVAILABLE:"mediaVolumeUnavailable",MEDIA_WIDTH:"mediaWidth"},Wv=Object.entries(Kv),Vv=Wv.reduce((function(e,t){var n=(0,a.A)(t,2),i=n[0],r=n[1];return e[i]=r.toLowerCase(),e}),{}),qv=Wv.reduce((function(e,t){var n=(0,a.A)(t,2),i=n[0],r=n[1];return e[i]=r.toLowerCase(),e}),(0,i.A)({},{USER_INACTIVE_CHANGE:"userinactivechange",BREAKPOINTS_CHANGE:"breakpointchange",BREAKPOINTS_COMPUTED:"breakpointscomputed"})),Yv=(Object.entries(qv).reduce((function(e,t){var n=(0,a.A)(t,2),i=n[0],r=n[1],o=Vv[i];return o&&(e[r]=o),e}),{userinactivechange:"userinactive"}),Object.entries(Vv).reduce((function(e,t){var n=(0,a.A)(t,2),i=n[0],r=n[1],o=qv[i];return o&&(e[r]=o),e}),{userinactive:"userinactivechange"})),jv={SUBTITLES:"subtitles",CAPTIONS:"captions",DESCRIPTIONS:"descriptions",CHAPTERS:"chapters",METADATA:"metadata"},zv="disabled",Xv="showing",Qv="mouse",Zv="touch",Jv="unavailable",$v="unsupported",em={LIVE:"live",ON_DEMAND:"on-demand",UNKNOWN:"unknown"},tm="fullscreen";function nm(e){if(e)return[e.id,e.width,e.height].filter((function(e){return null!=e})).join(":")}function im(e){if(e){var t=e.split(":"),n=(0,a.A)(t,3);return{id:n[0],width:+n[1],height:+n[2]}}}function am(e){if(e)return[e.id,e.kind,e.language,e.label].filter((function(e){return null!=e})).join(":")}function rm(e){if(e){var t=e.split(":"),n=(0,a.A)(t,4);return{id:n[0],kind:n[1],language:n[2],label:n[3]}}}function om(e){return e.replace(/[-_]([a-z])/g,(function(e,t){return t.toUpperCase()}))}function sm(e){return"number"===typeof e&&!Number.isNaN(e)&&Number.isFinite(e)}function lm(e){return"string"==typeof e&&(!isNaN(e)&&!isNaN(parseFloat(e)))}var um=function(e){return new Promise((function(t){return setTimeout(t,e)}))},cm=[{singular:"hour",plural:"hours"},{singular:"minute",plural:"minutes"},{singular:"second",plural:"seconds"}],dm=function(e){if(!sm(e))return"";var t=Math.abs(e),n=t!==e,i=new Date(0,0,0,0,0,t,0),a=[i.getHours(),i.getMinutes(),i.getSeconds()].map((function(e,t){return e&&function(e,t){var n=1===e?cm[t].singular:cm[t].plural;return"".concat(e," ").concat(n)}(e,t)})).filter((function(e){return e})).join(", "),r=n?" remaining":"";return"".concat(a).concat(r)};function hm(e,t){var n=!1;e<0&&(n=!0,e=0-e),e=e<0?0:e;var i=Math.floor(e%60),a=Math.floor(e/60%60),r=Math.floor(e/3600),o=Math.floor(t/60%60),s=Math.floor(t/3600);return(isNaN(e)||e===1/0)&&(r=a=i="0"),(n?"-":"")+(r=r>0||s>0?r+":":"")+(a=((r||o>=10)&&a<10?"0"+a:a)+":")+(i=i<10?"0"+i:i)}Object.freeze({length:0,start:function(e){var t=e>>>0;if(t>=this.length)throw new DOMException("Failed to execute 'start' on 'TimeRanges': The index provided (".concat(t,") is greater than or equal to the maximum bound (").concat(this.length,")."));return 0},end:function(e){var t=e>>>0;if(t>=this.length)throw new DOMException("Failed to execute 'end' on 'TimeRanges': The index provided (".concat(t,") is greater than or equal to the maximum bound (").concat(this.length,")."));return 0}});var fm,vm={en:{"Start airplay":"Start airplay","Stop airplay":"Stop airplay",Audio:"Audio",Captions:"Captions","Enable captions":"Enable captions","Disable captions":"Disable captions","Start casting":"Start casting","Stop casting":"Stop casting","Enter fullscreen mode":"Enter fullscreen mode","Exit fullscreen mode":"Exit fullscreen mode",Mute:"Mute",Unmute:"Unmute","Enter picture in picture mode":"Enter picture in picture mode","Exit picture in picture mode":"Exit picture in picture mode",Play:"Play",Pause:"Pause","Playback rate":"Playback rate","Playback rate {playbackRate}":"Playback rate {playbackRate}",Quality:"Quality","Seek backward":"Seek backward","Seek forward":"Seek forward",Settings:"Settings",Auto:"Auto","audio player":"audio player","video player":"video player",volume:"volume",seek:"seek","closed captions":"closed captions","current playback rate":"current playback rate","playback time":"playback time","media loading":"media loading",settings:"settings","audio tracks":"audio tracks",quality:"quality",play:"play",pause:"pause",mute:"mute",unmute:"unmute",live:"live",Off:"Off","start airplay":"start airplay","stop airplay":"stop airplay","start casting":"start casting","stop casting":"stop casting","enter fullscreen mode":"enter fullscreen mode","exit fullscreen mode":"exit fullscreen mode","enter picture in picture mode":"enter picture in picture mode","exit picture in picture mode":"exit picture in picture mode","seek to live":"seek to live","playing live":"playing live","seek back {seekOffset} seconds":"seek back {seekOffset} seconds","seek forward {seekOffset} seconds":"seek forward {seekOffset} seconds","Network Error":"Network Error","Decode Error":"Decode Error","Source Not Supported":"Source Not Supported","Encryption Error":"Encryption Error","A network error caused the media download to fail.":"A network error caused the media download to fail.","A media error caused playback to be aborted. The media could be corrupt or your browser does not support this format.":"A media error caused playback to be aborted. The media could be corrupt or your browser does not support this format.","An unsupported error occurred. The server or network failed, or your browser does not support this format.":"An unsupported error occurred. The server or network failed, or your browser does not support this format.","The media is encrypted and there are no keys to decrypt it.":"The media is encrypted and there are no keys to decrypt it."}},mm=(null==(fm=globalThis.navigator)?void 0:fm.language)||"en",pm=function(e){var t,n,i,r=mm.split("-"),o=(0,a.A)(r,1)[0];return(null==(t=vm[mm])?void 0:t[e])||(null==(n=vm[o])?void 0:n[e])||(null==(i=vm.en)?void 0:i[e])||e},gm=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return pm(e).replace(/\{(\w+)\}/g,(function(e,n){return n in t?String(t[n]):"{".concat(n,"}")}))},ym=function(){function e(){(0,m.A)(this,e)}return(0,v.A)(e,[{key:"addEventListener",value:function(){}},{key:"removeEventListener",value:function(){}},{key:"dispatchEvent",value:function(){return!0}}]),e}(),Em=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){return(0,m.A)(this,n),t.apply(this,arguments)}return(0,v.A)(n)}(ym),Am=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){var e;return(0,m.A)(this,n),(e=t.apply(this,arguments)).role=null,e}return(0,v.A)(n)}(Em),bm={createElement:function(){return new km.HTMLElement},createElementNS:function(){return new km.HTMLElement},addEventListener:function(){},removeEventListener:function(){},dispatchEvent:function(e){return!1}},km={ResizeObserver:function(){function e(){(0,m.A)(this,e)}return(0,v.A)(e,[{key:"observe",value:function(){}},{key:"unobserve",value:function(){}},{key:"disconnect",value:function(){}}]),e}(),document:bm,Node:Em,Element:Am,HTMLElement:function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){var e;return(0,m.A)(this,n),(e=t.apply(this,arguments)).innerHTML="",e}return(0,v.A)(n,[{key:"content",get:function(){return new km.DocumentFragment}}]),n}(Am),DocumentFragment:function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){return(0,m.A)(this,n),t.apply(this,arguments)}return(0,v.A)(n)}(ym),customElements:{get:function(){},define:function(){},whenDefined:function(){}},localStorage:{getItem:function(e){return null},setItem:function(e,t){},removeItem:function(e){}},CustomEvent:function(){},getComputedStyle:function(){},navigator:{languages:[],get userAgent(){return""}},matchMedia:function(e){return{matches:!1,media:e}},DOMParser:function(){function e(){(0,m.A)(this,e)}return(0,v.A)(e,[{key:"parseFromString",value:function(e,t){return{body:{textContent:e}}}}]),e}()},Tm="undefined"===typeof window||"undefined"===typeof window.customElements,_m=Object.keys(km).every((function(e){return e in globalThis})),Sm=Tm&&!_m?km:globalThis,wm=Tm&&!_m?bm:globalThis.document,Rm=new WeakMap,Lm=function(e){var t=Rm.get(e);return t||Rm.set(e,t=new Set),t},Im=new Sm.ResizeObserver((function(e){var t,n=(0,h.A)(e);try{for(n.s();!(t=n.n()).done;){var i,a=t.value,r=(0,h.A)(Lm(a.target));try{for(r.s();!(i=r.n()).done;){(0,i.value)(a)}}catch(BL){r.e(BL)}finally{r.f()}}}catch(BL){n.e(BL)}finally{n.f()}}));function Dm(e,t){Lm(e).add(t),Im.observe(e)}function Cm(e,t){var n=Lm(e);n.delete(t),n.size||Im.unobserve(e)}function xm(e){var t,n={},i=(0,h.A)(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;n[a.name]=a.value}}catch(BL){i.e(BL)}finally{i.f()}return n}function Mm(e){var t;return null!=(t=Om(e))?t:Fm(e,"media-controller")}function Om(e){var t,n=Gv,i=e.getAttribute(n);if(i)return null==(t=Hm(e))?void 0:t.getElementById(i)}var Pm=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".value",i=e.querySelector(n);i&&(i.textContent=t)},Nm=function(e,t){return function(e,t){var n='slot[name="'.concat(t,'"]'),i=e.shadowRoot.querySelector(n);return i?i.children:[]}(e,t)[0]},Um=function e(t,n){return!(!t||!n)&&(!!(null==t?void 0:t.contains(n))||e(t,n.getRootNode().host))},Fm=function e(t,n){if(!t)return null;var i=t.closest(n);return i||e(t.getRootNode().host,n)};function Bm(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,n=null==t?void 0:t.activeElement;return n?null!=(e=Bm(n.shadowRoot))?e:n:null}function Hm(e){var t,n=null==(t=null==e?void 0:e.getRootNode)?void 0:t.call(e);return n instanceof ShadowRoot||n instanceof Document?n:null}function Gm(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.depth,i=void 0===n?3:n,a=t.checkOpacity,r=void 0===a||a,o=t.checkVisibilityCSS,s=void 0===o||o;if(e.checkVisibility)return e.checkVisibility({checkOpacity:r,checkVisibilityCSS:s});for(var l=e;l&&i>0;){var u=getComputedStyle(l);if(r&&"0"===u.opacity||s&&"hidden"===u.visibility||"none"===u.display)return!1;l=l.parentElement,i--}return!0}function Km(e,t){var n=function(e,t){var n,i,a,r,o=(0,h.A)(null!=(n=e.querySelectorAll("style:not([media])"))?n:[]);try{for(o.s();!(r=o.n()).done;){a=r.value;var s=void 0;try{s=null==(i=a.sheet)?void 0:i.cssRules}catch(d){continue}var l,u=(0,h.A)(null!=s?s:[]);try{for(u.s();!(l=u.n()).done;){var c=l.value;if(t(c.selectorText))return c}}catch(BL){u.e(BL)}finally{u.f()}}}catch(BL){o.e(BL)}finally{o.f()}}(e,(function(e){return e===t}));return n||Wm(e,t)}function Wm(e,t){var n,i,a=null!=(n=e.querySelectorAll("style:not([media])"))?n:[],r=null==a?void 0:a[a.length-1];return(null==r?void 0:r.sheet)?(null==r||r.sheet.insertRule("".concat(t,"{}"),r.sheet.cssRules.length),null==(i=r.sheet.cssRules)?void 0:i[r.sheet.cssRules.length-1]):(console.warn("Media Chrome: No style sheet found on style tag of",e),{style:{setProperty:function(){},removeProperty:function(){return""},getPropertyValue:function(){return""}}})}function Vm(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.NaN,i=e.getAttribute(t);return null!=i?+i:n}function qm(e,t,n){var i=+n;null==n||Number.isNaN(i)?e.hasAttribute(t)&&e.removeAttribute(t):Vm(e,t,void 0)!==i&&e.setAttribute(t,"".concat(i))}function Ym(e,t){return e.hasAttribute(t)}function jm(e,t,n){null!=n?Ym(e,t)!=n&&e.toggleAttribute(t,n):e.hasAttribute(t)&&e.removeAttribute(t)}function zm(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return null!=(n=e.getAttribute(t))?n:i}function Xm(e,t,n){if(null!=n){var i="".concat(n);zm(e,t,void 0)!==i&&e.setAttribute(t,i)}else e.hasAttribute(t)&&e.removeAttribute(t)}var Qm,Zm=function(e,t,n){if(!t.has(e))throw TypeError("Cannot "+n)},Jm=function(e,t,n){return Zm(e,t,"read from private field"),n?n.call(e):t.get(e)},$m=function(e,t,n,i){return Zm(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n};var ep=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){var e;if((0,m.A)(this,n),e=t.call(this),function(e,t,n){if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)}((0,Ln.A)(e),Qm,void 0),!e.shadowRoot){e.attachShadow(e.constructor.shadowRootOptions);var i=xm(e.attributes);e.shadowRoot.innerHTML=e.constructor.getTemplateHTML(i)}return e}return(0,v.A)(n,[{key:"attributeChangedCallback",value:function(e,t,n){var i,a,r,o,s;e===Gv&&(t&&(null==(a=null==(i=Jm(this,Qm))?void 0:i.unassociateElement)||a.call(i,this),$m(this,Qm,null)),n&&this.isConnected&&($m(this,Qm,null==(r=this.getRootNode())?void 0:r.getElementById(n)),null==(s=null==(o=Jm(this,Qm))?void 0:o.associateElement)||s.call(o,this)))}},{key:"connectedCallback",value:function(){var e,t,n,i;this.tabIndex=-1,this.setAttribute("aria-hidden","true"),$m(this,Qm,function(e){var t,n=e.getAttribute(Gv);if(n)return null==(t=e.getRootNode())?void 0:t.getElementById(n);return Fm(e,"media-controller")}(this)),this.getAttribute(Gv)&&(null==(t=null==(e=Jm(this,Qm))?void 0:e.associateElement)||t.call(e,this)),null==(n=Jm(this,Qm))||n.addEventListener("pointerdown",this),null==(i=Jm(this,Qm))||i.addEventListener("click",this)}},{key:"disconnectedCallback",value:function(){var e,t,n,i;this.getAttribute(Gv)&&(null==(t=null==(e=Jm(this,Qm))?void 0:e.unassociateElement)||t.call(e,this)),null==(n=Jm(this,Qm))||n.removeEventListener("pointerdown",this),null==(i=Jm(this,Qm))||i.removeEventListener("click",this),$m(this,Qm,null)}},{key:"handleEvent",value:function(e){var t,n=null==(t=e.composedPath())?void 0:t[0];if(["video","media-controller"].includes(null==n?void 0:n.localName))if("pointerdown"===e.type)this._pointerType=e.pointerType;else if("click"===e.type){var i=e.clientX,a=e.clientY,r=this.getBoundingClientRect(),o=r.left,s=r.top,l=r.width,u=r.height,c=i-o,d=a-s;if(c<0||d<0||c>l||d>u||0===l&&0===u)return;var h=e.pointerType,f=void 0===h?this._pointerType:h;if(this._pointerType=void 0,f===Zv)return void this.handleTap(e);if(f===Qv)return void this.handleMouseClick(e)}}},{key:"mediaPaused",get:function(){return Ym(this,Vv.MEDIA_PAUSED)},set:function(e){jm(this,Vv.MEDIA_PAUSED,e)}},{key:"handleTap",value:function(e){}},{key:"handleMouseClick",value:function(e){var t=this.mediaPaused?Bv.MEDIA_PLAY_REQUEST:Bv.MEDIA_PAUSE_REQUEST;this.dispatchEvent(new Sm.CustomEvent(t,{composed:!0,bubbles:!0}))}}],[{key:"observedAttributes",get:function(){return[Gv,Vv.MEDIA_PAUSED]}}]),n}(Sm.HTMLElement);Qm=new WeakMap,ep.shadowRootOptions={mode:"open"},ep.getTemplateHTML=function(e){return"\n    <style>\n      :host {\n        display: var(--media-control-display, var(--media-gesture-receiver-display, inline-block));\n        box-sizing: border-box;\n      }\n    </style>\n  "},Sm.customElements.get("media-gesture-receiver")||Sm.customElements.define("media-gesture-receiver",ep);var tp,np,ip,ap,rp,op,sp,lp,up,cp,dp,hp,fp,vp,mp,pp,gp,yp,Ep,Ap=ep,bp=function(e,t,n){if(!t.has(e))throw TypeError("Cannot "+n)},kp=function(e,t,n){return bp(e,t,"read from private field"),n?n.call(e):t.get(e)},Tp=function(e,t,n){if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},_p=function(e,t,n,i){return bp(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n},Sp=function(e,t,n){return bp(e,t,"access private method"),n},wp={AUDIO:"audio",AUTOHIDE:"autohide",BREAKPOINTS:"breakpoints",GESTURES_DISABLED:"gesturesdisabled",KEYBOARD_CONTROL:"keyboardcontrol",NO_AUTOHIDE:"noautohide",USER_INACTIVE:"userinactive",AUTOHIDE_OVER_CONTROLS:"autohideovercontrols"};var Rp=Object.values(Vv);function Lp(e,t){var n;if(e.isConnected){var i=function(e){var t=e.split(/\s+/);return Object.fromEntries(t.map((function(e){return e.split(":")})))}(null!=(n=e.getAttribute(wp.BREAKPOINTS))?n:"sm:384 md:576 lg:768 xl:960"),a=function(e,t){return Object.keys(e).filter((function(n){return t>=parseInt(e[n])}))}(i,t),r=!1;if(Object.keys(i).forEach((function(t){a.includes(t)?e.hasAttribute("breakpoint".concat(t))||(e.setAttribute("breakpoint".concat(t),""),r=!0):e.hasAttribute("breakpoint".concat(t))&&(e.removeAttribute("breakpoint".concat(t)),r=!0)})),r){var o=new CustomEvent(qv.BREAKPOINTS_CHANGE,{detail:a});e.dispatchEvent(o)}e.breakpointsComputed||(e.breakpointsComputed=!0,e.dispatchEvent(new CustomEvent(qv.BREAKPOINTS_COMPUTED,{bubbles:!0,composed:!0})))}}var Ip=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){var e;if((0,m.A)(this,n),e=t.call(this),Tp((0,Ln.A)(e),op),Tp((0,Ln.A)(e),cp),Tp((0,Ln.A)(e),hp),Tp((0,Ln.A)(e),vp),Tp((0,Ln.A)(e),pp),Tp((0,Ln.A)(e),yp),Tp((0,Ln.A)(e),tp,0),Tp((0,Ln.A)(e),np,null),Tp((0,Ln.A)(e),ip,null),Tp((0,Ln.A)(e),ap,void 0),e.breakpointsComputed=!1,Tp((0,Ln.A)(e),rp,new MutationObserver(Sp((0,Ln.A)(e),op,sp).bind((0,Ln.A)(e)))),Tp((0,Ln.A)(e),lp,!1),Tp((0,Ln.A)(e),up,(function(t){kp((0,Ln.A)(e),lp)||(setTimeout((function(){!function(e){Lp(e.target,e.contentRect.width)}(t),_p((0,Ln.A)(e),lp,!1)}),0),_p((0,Ln.A)(e),lp,!0))})),!e.shadowRoot){e.attachShadow(e.constructor.shadowRootOptions);var i=xm(e.attributes),a=e.constructor.getTemplateHTML(i);e.shadowRoot.setHTMLUnsafe?e.shadowRoot.setHTMLUnsafe(a):e.shadowRoot.innerHTML=a}var r=e.querySelector(":scope > slot[slot=media]");return r&&r.addEventListener("slotchange",(function(){r.assignedElements({flatten:!0}).length?e.handleMediaUpdated(e.media):kp((0,Ln.A)(e),np)&&e.mediaUnsetCallback(kp((0,Ln.A)(e),np))})),e}return(0,v.A)(n,[{key:"attributeChangedCallback",value:function(e,t,n){e.toLowerCase()==wp.AUTOHIDE&&(this.autohide=n)}},{key:"media",get:function(){var e=this.querySelector(":scope > [slot=media]");return"SLOT"==(null==e?void 0:e.nodeName)&&(e=e.assignedElements({flatten:!0})[0]),e}},{key:"handleMediaUpdated",value:function(){var e=(0,d.A)((0,l.A)().mark((function e(t){return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(_p(this,np,t),!t.localName.includes("-")){e.next=6;break}return e.next=6,Sm.customElements.whenDefined(t.localName);case 6:this.mediaSetCallback(t);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"connectedCallback",value:function(){var e;kp(this,rp).observe(this,{childList:!0,subtree:!0}),Dm(this,kp(this,up));var t=null!=this.getAttribute(wp.AUDIO),n=gm(t?"audio player":"video player");this.setAttribute("role","region"),this.setAttribute("aria-label",n),this.handleMediaUpdated(this.media),this.setAttribute(wp.USER_INACTIVE,""),Lp(this,this.getBoundingClientRect().width),this.addEventListener("pointerdown",this),this.addEventListener("pointermove",this),this.addEventListener("pointerup",this),this.addEventListener("mouseleave",this),this.addEventListener("keyup",this),null==(e=Sm.window)||e.addEventListener("mouseup",this)}},{key:"disconnectedCallback",value:function(){var e;kp(this,rp).disconnect(),Cm(this,kp(this,up)),this.media&&this.mediaUnsetCallback(this.media),null==(e=Sm.window)||e.removeEventListener("mouseup",this)}},{key:"mediaSetCallback",value:function(e){}},{key:"mediaUnsetCallback",value:function(e){_p(this,np,null)}},{key:"handleEvent",value:function(e){switch(e.type){case"pointerdown":_p(this,tp,e.timeStamp);break;case"pointermove":Sp(this,cp,dp).call(this,e);break;case"pointerup":Sp(this,hp,fp).call(this,e);break;case"mouseleave":Sp(this,vp,mp).call(this);break;case"mouseup":this.removeAttribute(wp.KEYBOARD_CONTROL);break;case"keyup":Sp(this,yp,Ep).call(this),this.setAttribute(wp.KEYBOARD_CONTROL,"")}}},{key:"autohide",get:function(){return(void 0===kp(this,ap)?2:kp(this,ap)).toString()},set:function(e){var t=Number(e);_p(this,ap,isNaN(t)?0:t)}},{key:"breakpoints",get:function(){return zm(this,wp.BREAKPOINTS)},set:function(e){Xm(this,wp.BREAKPOINTS,e)}},{key:"audio",get:function(){return Ym(this,wp.AUDIO)},set:function(e){jm(this,wp.AUDIO,e)}},{key:"gesturesDisabled",get:function(){return Ym(this,wp.GESTURES_DISABLED)},set:function(e){jm(this,wp.GESTURES_DISABLED,e)}},{key:"keyboardControl",get:function(){return Ym(this,wp.KEYBOARD_CONTROL)},set:function(e){jm(this,wp.KEYBOARD_CONTROL,e)}},{key:"noAutohide",get:function(){return Ym(this,wp.NO_AUTOHIDE)},set:function(e){jm(this,wp.NO_AUTOHIDE,e)}},{key:"autohideOverControls",get:function(){return Ym(this,wp.AUTOHIDE_OVER_CONTROLS)},set:function(e){jm(this,wp.AUTOHIDE_OVER_CONTROLS,e)}},{key:"userInteractive",get:function(){return Ym(this,wp.USER_INACTIVE)},set:function(e){jm(this,wp.USER_INACTIVE,e)}}],[{key:"observedAttributes",get:function(){return[wp.AUTOHIDE,wp.GESTURES_DISABLED].concat(Rp).filter((function(e){return![Vv.MEDIA_RENDITION_LIST,Vv.MEDIA_AUDIO_TRACK_LIST,Vv.MEDIA_CHAPTERS_CUES,Vv.MEDIA_WIDTH,Vv.MEDIA_HEIGHT,Vv.MEDIA_ERROR,Vv.MEDIA_ERROR_MESSAGE].includes(e)}))}}]),n}(Sm.HTMLElement);tp=new WeakMap,np=new WeakMap,ip=new WeakMap,ap=new WeakMap,rp=new WeakMap,op=new WeakSet,sp=function(e){var t,n=this.media,i=(0,h.A)(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;if("childList"===a.type){var r,o=a.removedNodes,s=(0,h.A)(o);try{for(s.s();!(r=s.n()).done;){var l=r.value;if("media"==l.slot&&a.target==this){var u=a.previousSibling&&a.previousSibling.previousElementSibling;if(u&&n){for(var c="media"!==u.slot;null!==(u=u.previousSibling);)"media"==u.slot&&(c=!1);c&&this.mediaUnsetCallback(l)}else this.mediaUnsetCallback(l)}}}catch(BL){s.e(BL)}finally{s.f()}if(n){var d,f=(0,h.A)(a.addedNodes);try{for(f.s();!(d=f.n()).done;){d.value===n&&this.handleMediaUpdated(n)}}catch(BL){f.e(BL)}finally{f.f()}}}}}catch(BL){i.e(BL)}finally{i.f()}},lp=new WeakMap,up=new WeakMap,cp=new WeakSet,dp=function(e){if("mouse"!==e.pointerType){if(e.timeStamp-kp(this,tp)<250)return}Sp(this,pp,gp).call(this),clearTimeout(kp(this,ip));var t=this.hasAttribute(wp.AUTOHIDE_OVER_CONTROLS);([this,this.media].includes(e.target)||t)&&Sp(this,yp,Ep).call(this)},hp=new WeakSet,fp=function(e){if("touch"===e.pointerType){var t=!this.hasAttribute(wp.USER_INACTIVE);[this,this.media].includes(e.target)&&t?Sp(this,vp,mp).call(this):Sp(this,yp,Ep).call(this)}else e.composedPath().some((function(e){return["media-play-button","media-fullscreen-button"].includes(null==e?void 0:e.localName)}))&&Sp(this,yp,Ep).call(this)},vp=new WeakSet,mp=function(){if(!(kp(this,ap)<0)&&!this.hasAttribute(wp.USER_INACTIVE)){this.setAttribute(wp.USER_INACTIVE,"");var e=new Sm.CustomEvent(qv.USER_INACTIVE_CHANGE,{composed:!0,bubbles:!0,detail:!0});this.dispatchEvent(e)}},pp=new WeakSet,gp=function(){if(this.hasAttribute(wp.USER_INACTIVE)){this.removeAttribute(wp.USER_INACTIVE);var e=new Sm.CustomEvent(qv.USER_INACTIVE_CHANGE,{composed:!0,bubbles:!0,detail:!1});this.dispatchEvent(e)}},yp=new WeakSet,Ep=function(){var e=this;Sp(this,pp,gp).call(this),clearTimeout(kp(this,ip));var t=parseInt(this.autohide);t<0||_p(this,ip,setTimeout((function(){Sp(e,vp,mp).call(e)}),1e3*t))},Ip.shadowRootOptions={mode:"open"},Ip.getTemplateHTML=function(e){return"\n    <style>\n      ".concat("\n      :host([",Vv.MEDIA_IS_FULLSCREEN,"]) ::slotted([slot=media]) {\n        outline: none;\n      }\n\n      :host {\n        box-sizing: border-box;\n        position: relative;\n        display: inline-block;\n        line-height: 0;\n        background-color: var(--media-background-color, #000);\n      }\n\n      :host(:not([").concat(wp.AUDIO,"])) [part~=layer]:not([part~=media-layer]) {\n        position: absolute;\n        top: 0;\n        left: 0;\n        bottom: 0;\n        right: 0;\n        display: flex;\n        flex-flow: column nowrap;\n        align-items: start;\n        pointer-events: none;\n        background: none;\n      }\n\n      slot[name=media] {\n        display: var(--media-slot-display, contents);\n      }\n\n      ","\n      :host([").concat(wp.AUDIO,"]) slot[name=media] {\n        display: var(--media-slot-display, none);\n      }\n\n      ","\n      :host([").concat(wp.AUDIO,"]) [part~=layer][part~=gesture-layer] {\n        height: 0;\n        display: block;\n      }\n\n      ","\n      :host(:not([").concat(wp.AUDIO,"])[").concat(wp.GESTURES_DISABLED,"]) ::slotted([slot=gestures-chrome]),\n          :host(:not([").concat(wp.AUDIO,"])[").concat(wp.GESTURES_DISABLED,"]) media-gesture-receiver[slot=gestures-chrome] {\n        display: none;\n      }\n\n      ","\n      ::slotted(:not([slot=media]):not([slot=poster]):not(media-loading-indicator):not([role=dialog]):not([hidden])) {\n        pointer-events: auto;\n      }\n\n      :host(:not([").concat(wp.AUDIO,"])) *[part~=layer][part~=centered-layer] {\n        align-items: center;\n        justify-content: center;\n      }\n\n      :host(:not([").concat(wp.AUDIO,"])) ::slotted(media-gesture-receiver[slot=gestures-chrome]),\n      :host(:not([").concat(wp.AUDIO,"])) media-gesture-receiver[slot=gestures-chrome] {\n        align-self: stretch;\n        flex-grow: 1;\n      }\n\n      slot[name=middle-chrome] {\n        display: inline;\n        flex-grow: 1;\n        pointer-events: none;\n        background: none;\n      }\n\n      ","\n      ::slotted([slot=media]),\n      ::slotted([slot=poster]) {\n        width: 100%;\n        height: 100%;\n      }\n\n      ","\n      :host(:not([").concat(wp.AUDIO,"])) .spacer {\n        flex-grow: 1;\n      }\n\n      ","\n      :host(:-webkit-full-screen) {\n        ","\n        width: 100% !important;\n        height: 100% !important;\n      }\n\n      ","\n      ::slotted(:not([slot=media]):not([slot=poster]):not([").concat(wp.NO_AUTOHIDE,"]):not([hidden]):not([role=dialog])) {\n        opacity: 1;\n        transition: var(--media-control-transition-in, opacity 0.25s);\n      }\n\n      ","\n      :host([").concat(wp.USER_INACTIVE,"]:not([").concat(Vv.MEDIA_PAUSED,"]):not([").concat(Vv.MEDIA_IS_AIRPLAYING,"]):not([").concat(Vv.MEDIA_IS_CASTING,"]):not([").concat(wp.AUDIO,"])) ::slotted(:not([slot=media]):not([slot=poster]):not([").concat(wp.NO_AUTOHIDE,"]):not([role=dialog])) {\n        opacity: 0;\n        transition: var(--media-control-transition-out, opacity 1s);\n      }\n\n      :host([").concat(wp.USER_INACTIVE,"]:not([").concat(wp.NO_AUTOHIDE,"]):not([").concat(Vv.MEDIA_PAUSED,"]):not([").concat(Vv.MEDIA_IS_CASTING,"]):not([").concat(wp.AUDIO,"])) ::slotted([slot=media]) {\n        cursor: none;\n      }\n\n      :host([").concat(wp.USER_INACTIVE,"][").concat(wp.AUTOHIDE_OVER_CONTROLS,"]:not([").concat(wp.NO_AUTOHIDE,"]):not([").concat(Vv.MEDIA_PAUSED,"]):not([").concat(Vv.MEDIA_IS_CASTING,"]):not([").concat(wp.AUDIO,"])) * {\n        --media-cursor: none;\n        cursor: none;\n      }\n\n\n      ::slotted(media-control-bar)  {\n        align-self: stretch;\n      }\n\n      ","\n      :host(:not([").concat(wp.AUDIO,"])[").concat(Vv.MEDIA_HAS_PLAYED,']) slot[name=poster] {\n        display: none;\n      }\n\n      ::slotted([role=dialog]) {\n        width: 100%;\n        height: 100%;\n        align-self: center;\n      }\n\n      ::slotted([role=menu]) {\n        align-self: end;\n      }\n    </style>\n\n    <slot name="media" part="layer media-layer"></slot>\n    <slot name="poster" part="layer poster-layer"></slot>\n    <slot name="gestures-chrome" part="layer gesture-layer">\n      <media-gesture-receiver slot="gestures-chrome">\n        <template shadowrootmode="').concat(Ap.shadowRootOptions.mode,'">\n          ').concat(Ap.getTemplateHTML({}),'\n        </template>\n      </media-gesture-receiver>\n    </slot>\n    <span part="layer vertical-layer">\n      <slot name="top-chrome" part="top chrome"></slot>\n      <slot name="middle-chrome" part="middle chrome"></slot>\n      <slot name="centered-chrome" part="layer centered-layer center centered chrome"></slot>\n      ','\n      <slot part="bottom chrome"></slot>\n    </span>\n    <slot name="dialog" part="layer dialog-layer"></slot>\n  ')},Sm.customElements.get("media-container")||Sm.customElements.define("media-container",Ip);var Dp,Cp,xp,Mp,Op,Pp,Np=function(e,t,n){if(!t.has(e))throw TypeError("Cannot "+n)},Up=function(e,t,n){return Np(e,t,"read from private field"),n?n.call(e):t.get(e)},Fp=function(e,t,n){if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},Bp=function(e,t,n,i){return Np(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n},Hp=function(e){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{defaultValue:void 0},a=i.defaultValue;(0,m.A)(this,t),Fp(this,Op),Fp(this,Dp,void 0),Fp(this,Cp,void 0),Fp(this,xp,void 0),Fp(this,Mp,new Set),Bp(this,Dp,e),Bp(this,Cp,n),Bp(this,xp,new Set(a))}return(0,v.A)(t,[{key:e,value:function(){return Up(this,Op,Pp).values()}},{key:"length",get:function(){return Up(this,Op,Pp).size}},{key:"value",get:function(){var e;return null!=(e=(0,f.A)(Up(this,Op,Pp)).join(" "))?e:""}},{key:"value",set:function(e){var t;e!==this.value&&(Bp(this,Mp,new Set),this.add.apply(this,(0,f.A)(null!=(t=null==e?void 0:e.split(" "))?t:[])))}},{key:"toString",value:function(){return this.value}},{key:"item",value:function(e){return(0,f.A)(Up(this,Op,Pp))[e]}},{key:"values",value:function(){return Up(this,Op,Pp).values()}},{key:"forEach",value:function(e,t){Up(this,Op,Pp).forEach(e,t)}},{key:"add",value:function(){for(var e,t,n=this,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];a.forEach((function(e){return Up(n,Mp).add(e)})),(""!==this.value||(null==(e=Up(this,Dp))?void 0:e.hasAttribute("".concat(Up(this,Cp)))))&&(null==(t=Up(this,Dp))||t.setAttribute("".concat(Up(this,Cp)),"".concat(this.value)))}},{key:"remove",value:function(){for(var e,t=this,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];i.forEach((function(e){return Up(t,Mp).delete(e)})),null==(e=Up(this,Dp))||e.setAttribute("".concat(Up(this,Cp)),"".concat(this.value))}},{key:"contains",value:function(e){return Up(this,Op,Pp).has(e)}},{key:"toggle",value:function(e,t){return"undefined"!==typeof t?t?(this.add(e),!0):(this.remove(e),!1):this.contains(e)?(this.remove(e),!1):(this.add(e),!0)}},{key:"replace",value:function(e,t){return this.remove(e),this.add(t),e===t}}]),t}(Symbol.iterator);Dp=new WeakMap,Cp=new WeakMap,xp=new WeakMap,Mp=new WeakMap,Op=new WeakSet,Pp=function(){return Up(this,Mp).size?Up(this,Mp):Up(this,xp)};var Gp,Kp,Wp,Vp,qp,Yp,jp,zp,Xp,Qp,Zp,Jp,$p,eg,tg,ng,ig=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.split(/\s+/)},ag=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.split(":"),n=(0,a.A)(t,3),i=n[0],r=n[1],o=n[2],s=o?decodeURIComponent(o):void 0;return{kind:"cc"===i?jv.CAPTIONS:jv.SUBTITLES,language:r,label:s}},rg=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ig(e).map((function(e){var n=ag(e);return(0,i.A)((0,i.A)({},t),n)}))},og=function(e){return e?Array.isArray(e)?e.map((function(e){return"string"===typeof e?ag(e):e})):"string"===typeof e?rg(e):[e]:[]},sg=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{kind:"subtitles"},t=e.kind,n=e.label,i=e.language;return n?"".concat("captions"===t?"cc":"sb",":").concat(i,":").concat(encodeURIComponent(n)):i},lg=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.prototype.map.call(e,sg).join(" ")},ug=function(e){var t=Object.entries(e).map((function(e){var t=(0,a.A)(e,2);return function(e,t){return function(n){return n[e]===t}}(t[0],t[1])}));return function(e){return t.every((function(t){return t(e)}))}},cg=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=og(n).map(ug),a=function(e){return i.some((function(t){return t(e)}))};Array.from(t).filter(a).forEach((function(t){t.mode=e}))},dg=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0};if(!(null==e?void 0:e.textTracks))return[];var n="function"===typeof t?t:ug(t);return Array.from(e.textTracks).filter(n)},hg=function(e){var t;return!!(null==(t=e.mediaSubtitlesShowing)?void 0:t.length)||e.hasAttribute(Vv.MEDIA_SUBTITLES_SHOWING)},fg="exitFullscreen"in wm?"exitFullscreen":"webkitExitFullscreen"in wm?"webkitExitFullscreen":"webkitCancelFullScreen"in wm?"webkitCancelFullScreen":void 0,vg="fullscreenElement"in wm?"fullscreenElement":"webkitFullscreenElement"in wm?"webkitFullscreenElement":void 0,mg=function(e){var t,n=e.media,i=e.documentElement,a=e.fullscreenElement,r=void 0===a?n:a;if(!n||!i)return!1;var o=function(e){var t=e.documentElement,n=e.media,i=null==t?void 0:t[vg];return!i&&"webkitDisplayingFullscreen"in n&&"webkitPresentationMode"in n&&n.webkitDisplayingFullscreen&&n.webkitPresentationMode===tm?n:i}(e);if(!o)return!1;if(o===r||o===n)return!0;if(o.localName.includes("-")){var s=o.shadowRoot;if(!(vg in s))return Um(o,r);for(;null==s?void 0:s[vg];){if(s[vg]===r)return!0;s=null==(t=s[vg])?void 0:t.shadowRoot}}return!1},pg="fullscreenEnabled"in wm?"fullscreenEnabled":"webkitFullscreenEnabled"in wm?"webkitFullscreenEnabled":void 0,gg=function(e){var t=e.documentElement,n=e.media;return!!(null==t?void 0:t[pg])||n&&"webkitSupportsFullscreen"in n},yg=function(){var e,t;return Gp||(Gp=null==(t=null==(e=wm)?void 0:e.createElement)?void 0:t.call(e,"video"))},Eg=function(){var e=(0,d.A)((0,l.A)().mark((function e(){var t,n,i,a,r=arguments;return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.length>0&&void 0!==r[0]?r[0]:yg()){e.next=3;break}return e.abrupt("return",!1);case 3:return n=t.volume,t.volume=n/2+.1,i=new AbortController,e.next=8,Promise.race([Ag(t,i.signal),bg(t,n)]);case 8:return a=e.sent,i.abort(),e.abrupt("return",a);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ag=function(e,t){return new Promise((function(n){e.addEventListener("volumechange",(function(){return n(!0)}),{signal:t})}))},bg=function(){var e=(0,d.A)((0,l.A)().mark((function e(t,n){var i;return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=0;case 1:if(!(i<10)){e.next=9;break}if(t.volume!==n){e.next=4;break}return e.abrupt("return",!1);case 4:return e.next=6,um(10);case 6:i++,e.next=1;break;case 9:return e.abrupt("return",t.volume!==n);case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),kg=/.*Version\/.*Safari\/.*/.test(Sm.navigator.userAgent),Tg=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yg();return(!Sm.matchMedia("(display-mode: standalone)").matches||!kg)&&"function"===typeof(null==e?void 0:e.requestPictureInPicture)},_g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yg();return gg({documentElement:wm,media:e})},Sg=_g(),wg=Tg(),Rg=!!Sm.WebKitPlaybackTargetAvailabilityEvent,Lg=!!Sm.chrome,Ig=function(e){return dg(e.media,(function(e){return[jv.SUBTITLES,jv.CAPTIONS].includes(e.kind)})).sort((function(e,t){return e.kind>=t.kind?1:-1}))},Dg=function(e){return dg(e.media,(function(e){return e.mode===Xv&&[jv.SUBTITLES,jv.CAPTIONS].includes(e.kind)}))},Cg=function(e,t){var n=Ig(e),i=Dg(e),a=!!i.length;if(n.length)if(!1===t||a&&!0!==t)cg(zv,n,i);else if(!0===t||!a&&!1!==t){var r=n[0],o=e.options;if(!(null==o?void 0:o.noSubtitlesLangPref)){var s=globalThis.localStorage.getItem("media-chrome-pref-subtitles-lang"),l=s?[s].concat((0,f.A)(globalThis.navigator.languages)):globalThis.navigator.languages,u=n.filter((function(e){return l.some((function(t){return e.language.toLowerCase().startsWith(t.split("-")[0])}))})).sort((function(e,t){return l.findIndex((function(t){return e.language.toLowerCase().startsWith(t.split("-")[0])}))-l.findIndex((function(e){return t.language.toLowerCase().startsWith(e.split("-")[0])}))}));u[0]&&(r=u[0])}var c=r,d=c.language,h=c.label,v=c.kind;cg(zv,n,i),cg(Xv,n,[{language:d,label:h,kind:v}])}},xg=function e(t,n){return t===n||null!=t&&null!=n&&(typeof t===typeof n&&(!("number"!==typeof t||!Number.isNaN(t)||!Number.isNaN(n))||"object"===typeof t&&(Array.isArray(t)?Mg(t,n):Object.entries(t).every((function(t){var i=(0,a.A)(t,2),r=i[0],o=i[1];return r in n&&e(o,n[r])})))))},Mg=function(e,t){var n=Array.isArray(e),i=Array.isArray(t);return n===i&&(!n&&!i||e.length===t.length&&e.every((function(e,n){return xg(e,t[n])})))},Og=Object.values(em),Pg=Eg().then((function(e){return Kp=e})),Ng=function(){var e=(0,d.A)((0,l.A)().mark((function e(){var t,n,i,a=arguments;return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=a.length,n=new Array(t),i=0;i<t;i++)n[i]=a[i];return e.next=3,Promise.all(n.filter((function(e){return e})).map(function(){var e=(0,d.A)((0,l.A)().mark((function e(t){var n,i;return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("localName"in t&&t instanceof Sm.HTMLElement){e.next=2;break}return e.abrupt("return");case 2:if((n=t.localName).includes("-")){e.next=5;break}return e.abrupt("return");case 5:if(!((i=Sm.customElements.get(n))&&t instanceof i)){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,Sm.customElements.whenDefined(n);case 10:Sm.customElements.upgrade(t);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ug=new Sm.DOMParser,Fg=function(e){return e&&Ug.parseFromString(e,"text/html").body.textContent||e},Bg={mediaError:{get:function(e,t){var n=e.media;if("playing"!==(null==t?void 0:t.type))return null==n?void 0:n.error},mediaEvents:["emptied","error","playing"]},mediaErrorCode:{get:function(e,t){var n,i=e.media;if("playing"!==(null==t?void 0:t.type))return null==(n=null==i?void 0:i.error)?void 0:n.code},mediaEvents:["emptied","error","playing"]},mediaErrorMessage:{get:function(e,t){var n,i,a=e.media;if("playing"!==(null==t?void 0:t.type))return null!=(i=null==(n=null==a?void 0:a.error)?void 0:n.message)?i:""},mediaEvents:["emptied","error","playing"]},mediaWidth:{get:function(e){var t,n=e.media;return null!=(t=null==n?void 0:n.videoWidth)?t:0},mediaEvents:["resize"]},mediaHeight:{get:function(e){var t,n=e.media;return null!=(t=null==n?void 0:n.videoHeight)?t:0},mediaEvents:["resize"]},mediaPaused:{get:function(e){var t,n=e.media;return null==(t=null==n?void 0:n.paused)||t},set:function(e,t){var n,i=t.media;i&&(e?i.pause():null==(n=i.play())||n.catch((function(){})))},mediaEvents:["play","playing","pause","emptied"]},mediaHasPlayed:{get:function(e,t){var n=e.media;return!!n&&(t?"playing"===t.type:!n.paused)},mediaEvents:["playing","emptied"]},mediaEnded:{get:function(e){var t,n=e.media;return null!=(t=null==n?void 0:n.ended)&&t},mediaEvents:["seeked","ended","emptied"]},mediaPlaybackRate:{get:function(e){var t,n=e.media;return null!=(t=null==n?void 0:n.playbackRate)?t:1},set:function(e,t){var n=t.media;n&&Number.isFinite(+e)&&(n.playbackRate=+e)},mediaEvents:["ratechange","loadstart"]},mediaMuted:{get:function(e){var t,n=e.media;return null!=(t=null==n?void 0:n.muted)&&t},set:function(e,t){var n=t.media;if(n){try{Sm.localStorage.setItem("media-chrome-pref-muted",e?"true":"false")}catch(Rv){console.debug("Error setting muted pref",Rv)}n.muted=e}},mediaEvents:["volumechange"],stateOwnersUpdateHandlers:[function(e,t){var n=t.options.noMutedPref,i=t.media;if(i&&!i.muted&&!n)try{var a="true"===Sm.localStorage.getItem("media-chrome-pref-muted");Bg.mediaMuted.set(a,t),e(a)}catch(Rv){console.debug("Error getting muted pref",Rv)}}]},mediaVolume:{get:function(e){var t,n=e.media;return null!=(t=null==n?void 0:n.volume)?t:1},set:function(e,t){var n=t.media;if(n){try{null==e?Sm.localStorage.removeItem("media-chrome-pref-volume"):Sm.localStorage.setItem("media-chrome-pref-volume",e.toString())}catch(Rv){console.debug("Error setting volume pref",Rv)}Number.isFinite(+e)&&(n.volume=+e)}},mediaEvents:["volumechange"],stateOwnersUpdateHandlers:[function(e,t){if(!t.options.noVolumePref)try{if(!t.media)return;var n=Sm.localStorage.getItem("media-chrome-pref-volume");if(null==n)return;Bg.mediaVolume.set(+n,t),e(+n)}catch(Rv){console.debug("Error getting volume pref",Rv)}}]},mediaVolumeLevel:{get:function(e){var t=e.media;return"undefined"==typeof(null==t?void 0:t.volume)?"high":t.muted||0===t.volume?"off":t.volume<.5?"low":t.volume<.75?"medium":"high"},mediaEvents:["volumechange"]},mediaCurrentTime:{get:function(e){var t,n=e.media;return null!=(t=null==n?void 0:n.currentTime)?t:0},set:function(e,t){var n=t.media;n&&sm(e)&&(n.currentTime=e)},mediaEvents:["timeupdate","loadedmetadata"]},mediaDuration:{get:function(e){var t=e.media,n=e.options,i=(n=void 0===n?{}:n).defaultDuration;return!i||t&&t.duration&&!Number.isNaN(t.duration)&&Number.isFinite(t.duration)?Number.isFinite(null==t?void 0:t.duration)?t.duration:Number.NaN:i},mediaEvents:["durationchange","loadedmetadata","emptied"]},mediaLoading:{get:function(e){var t=e.media;return(null==t?void 0:t.readyState)<3},mediaEvents:["waiting","playing","emptied"]},mediaSeekable:{get:function(e){var t,n=e.media;if(null==(t=null==n?void 0:n.seekable)?void 0:t.length){var i=n.seekable.start(0),a=n.seekable.end(n.seekable.length-1);if(i||a)return[Number(i.toFixed(3)),Number(a.toFixed(3))]}},mediaEvents:["loadedmetadata","emptied","progress","seekablechange"]},mediaBuffered:{get:function(e){var t,n=e.media,i=null!=(t=null==n?void 0:n.buffered)?t:[];return Array.from(i).map((function(e,t){return[Number(i.start(t).toFixed(3)),Number(i.end(t).toFixed(3))]}))},mediaEvents:["progress","emptied"]},mediaStreamType:{get:function(e){var t=e.media,n=e.options,i=(n=void 0===n?{}:n).defaultStreamType,a=[em.LIVE,em.ON_DEMAND].includes(i)?i:void 0;if(!t)return a;var r=t.streamType;if(Og.includes(r))return r===em.UNKNOWN?a:r;var o=t.duration;return o===1/0?em.LIVE:Number.isFinite(o)?em.ON_DEMAND:a},mediaEvents:["emptied","durationchange","loadedmetadata","streamtypechange"]},mediaTargetLiveWindow:{get:function(e){var t=e.media;if(!t)return Number.NaN;var n=t.targetLiveWindow,i=Bg.mediaStreamType.get(e);return null!=n&&!Number.isNaN(n)||i!==em.LIVE?n:0},mediaEvents:["emptied","durationchange","loadedmetadata","streamtypechange","targetlivewindowchange"]},mediaTimeIsLive:{get:function(e){var t=e.media,n=e.options,i=(n=void 0===n?{}:n).liveEdgeOffset,a=void 0===i?10:i;if(!t)return!1;if("number"===typeof t.liveEdgeStart)return!Number.isNaN(t.liveEdgeStart)&&t.currentTime>=t.liveEdgeStart;if(!(Bg.mediaStreamType.get(e)===em.LIVE))return!1;var r=t.seekable;if(!r)return!0;if(!r.length)return!1;var o=r.end(r.length-1)-a;return t.currentTime>=o},mediaEvents:["playing","timeupdate","progress","waiting","emptied"]},mediaSubtitlesList:{get:function(e){return Ig(e).map((function(e){return{kind:e.kind,label:e.label,language:e.language}}))},mediaEvents:["loadstart"],textTracksEvents:["addtrack","removetrack"]},mediaSubtitlesShowing:{get:function(e){return Dg(e).map((function(e){return{kind:e.kind,label:e.label,language:e.language}}))},mediaEvents:["loadstart"],textTracksEvents:["addtrack","removetrack","change"],stateOwnersUpdateHandlers:[function(e,t){var n,i,a=t.media,r=t.options;if(a){var o=function(e){var n;r.defaultSubtitles&&(e&&![jv.CAPTIONS,jv.SUBTITLES].includes(null==(n=null==e?void 0:e.track)?void 0:n.kind)||Cg(t,!0))};return a.addEventListener("loadstart",o),null==(n=a.textTracks)||n.addEventListener("addtrack",o),null==(i=a.textTracks)||i.addEventListener("removetrack",o),function(){var e,t;a.removeEventListener("loadstart",o),null==(e=a.textTracks)||e.removeEventListener("addtrack",o),null==(t=a.textTracks)||t.removeEventListener("removetrack",o)}}}]},mediaChaptersCues:{get:function(e){var t,n=e.media;if(!n)return[];var i=dg(n,{kind:jv.CHAPTERS}),r=(0,a.A)(i,1)[0];return Array.from(null!=(t=null==r?void 0:r.cues)?t:[]).map((function(e){var t=e.text,n=e.startTime,i=e.endTime;return{text:Fg(t),startTime:n,endTime:i}}))},mediaEvents:["loadstart","loadedmetadata"],textTracksEvents:["addtrack","removetrack","change"],stateOwnersUpdateHandlers:[function(e,t){var n,i=t.media;if(i){var a=i.querySelector('track[kind="chapters"][default][src]'),r=null==(n=i.shadowRoot)?void 0:n.querySelector(':is(video,audio) > track[kind="chapters"][default][src]');return null==a||a.addEventListener("load",e),null==r||r.addEventListener("load",e),function(){null==a||a.removeEventListener("load",e),null==r||r.removeEventListener("load",e)}}}]},mediaIsPip:{get:function(e){var t,n,i=e.media,a=e.documentElement;if(!i||!a)return!1;if(!a.pictureInPictureElement)return!1;if(a.pictureInPictureElement===i)return!0;if(a.pictureInPictureElement instanceof HTMLMediaElement)return!!(null==(t=i.localName)?void 0:t.includes("-"))&&Um(i,a.pictureInPictureElement);if(a.pictureInPictureElement.localName.includes("-"))for(var r=a.pictureInPictureElement.shadowRoot;null==r?void 0:r.pictureInPictureElement;){if(r.pictureInPictureElement===i)return!0;r=null==(n=r.pictureInPictureElement)?void 0:n.shadowRoot}return!1},set:function(e,t){var n=t.media;if(n)if(e){if(!wm.pictureInPictureEnabled)return void console.warn("MediaChrome: Picture-in-picture is not enabled");if(!n.requestPictureInPicture)return void console.warn("MediaChrome: The current media does not support picture-in-picture");var i=function(){console.warn("MediaChrome: The media is not ready for picture-in-picture. It must have a readyState > 0.")};n.requestPictureInPicture().catch((function(e){if(11!==e.code)throw e;if(n.src){if(0!==n.readyState||"none"!==n.preload)throw e;var t=function(){n.removeEventListener("loadedmetadata",a),n.preload="none"},a=function(){n.requestPictureInPicture().catch(i),t()};n.addEventListener("loadedmetadata",a),n.preload="metadata",setTimeout((function(){0===n.readyState&&i(),t()}),1e3)}else console.warn("MediaChrome: The media is not ready for picture-in-picture. It must have a src set.")}))}else wm.pictureInPictureElement&&wm.exitPictureInPicture()},mediaEvents:["enterpictureinpicture","leavepictureinpicture"]},mediaRenditionList:{get:function(e){var t,n=e.media;return(0,f.A)(null!=(t=null==n?void 0:n.videoRenditions)?t:[]).map((function(e){return(0,i.A)({},e)}))},mediaEvents:["emptied","loadstart"],videoRenditionsEvents:["addrendition","removerendition"]},mediaRenditionSelected:{get:function(e){var t,n,i,a=e.media;return null==(i=null==(n=null==a?void 0:a.videoRenditions)?void 0:n[null==(t=a.videoRenditions)?void 0:t.selectedIndex])?void 0:i.id},set:function(e,t){var n=t.media;if(null==n?void 0:n.videoRenditions){var i=e,a=Array.prototype.findIndex.call(n.videoRenditions,(function(e){return e.id==i}));n.videoRenditions.selectedIndex!=a&&(n.videoRenditions.selectedIndex=a)}else console.warn("MediaController: Rendition selection not supported by this media.")},mediaEvents:["emptied"],videoRenditionsEvents:["addrendition","removerendition","change"]},mediaAudioTrackList:{get:function(e){var t,n=e.media;return(0,f.A)(null!=(t=null==n?void 0:n.audioTracks)?t:[])},mediaEvents:["emptied","loadstart"],audioTracksEvents:["addtrack","removetrack"]},mediaAudioTrackEnabled:{get:function(e){var t,n,i=e.media;return null==(n=(0,f.A)(null!=(t=null==i?void 0:i.audioTracks)?t:[]).find((function(e){return e.enabled})))?void 0:n.id},set:function(e,t){var n=t.media;if(null==n?void 0:n.audioTracks){var i,a=e,r=(0,h.A)(n.audioTracks);try{for(r.s();!(i=r.n()).done;){var o=i.value;o.enabled=a==o.id}}catch(BL){r.e(BL)}finally{r.f()}}else console.warn("MediaChrome: Audio track selection not supported by this media.")},mediaEvents:["emptied"],audioTracksEvents:["addtrack","removetrack","change"]},mediaIsFullscreen:{get:function(e){return mg(e)},set:function(e,t){e?function(e){var t,n=e.media,i=e.fullscreenElement;try{var a=i&&"requestFullscreen"in i?"requestFullscreen":i&&"webkitRequestFullScreen"in i?"webkitRequestFullScreen":void 0;if(a){var r=null==(t=i[a])?void 0:t.call(i);if(r instanceof Promise)r.catch((function(){}))}else(null==n?void 0:n.webkitEnterFullscreen)?n.webkitEnterFullscreen():(null==n?void 0:n.requestFullscreen)&&n.requestFullscreen()}catch(Rv){console.error(Rv)}}(t):function(e){var t,n=e.documentElement;if(fg){var i=null==(t=null==n?void 0:n[fg])?void 0:t.call(n);if(i instanceof Promise)i.catch((function(){}))}}(t)},rootEvents:["fullscreenchange","webkitfullscreenchange"],mediaEvents:["webkitbeginfullscreen","webkitendfullscreen","webkitpresentationmodechanged"]},mediaIsCasting:{get:function(e){var t,n=e.media;return!(!(null==n?void 0:n.remote)||"disconnected"===(null==(t=n.remote)?void 0:t.state))&&!!n.remote.state},set:function(e,t){var n,i,a=t.media;a&&(e&&"disconnected"!==(null==(n=a.remote)?void 0:n.state)||(e||"connected"===(null==(i=a.remote)?void 0:i.state))&&("function"===typeof a.remote.prompt?a.remote.prompt().catch((function(){})):console.warn("MediaChrome: Casting is not supported in this environment")))},remoteEvents:["connect","connecting","disconnect"]},mediaIsAirplaying:{get:function(){return!1},set:function(e,t){var n=t.media;n&&(n.webkitShowPlaybackTargetPicker&&Sm.WebKitPlaybackTargetAvailabilityEvent?n.webkitShowPlaybackTargetPicker():console.error("MediaChrome: received a request to select AirPlay but AirPlay is not supported in this environment"))},mediaEvents:["webkitcurrentplaybacktargetiswirelesschanged"]},mediaFullscreenUnavailable:{get:function(e){var t=e.media;if(!Sg||!_g(t))return $v}},mediaPipUnavailable:{get:function(e){var t=e.media;if(!wg||!Tg(t))return $v}},mediaVolumeUnavailable:{get:function(e){var t=e.media;if(!1===Kp||void 0==(null==t?void 0:t.volume))return $v},stateOwnersUpdateHandlers:[function(e){null==Kp&&Pg.then((function(t){return e(t?void 0:$v)}))}]},mediaCastUnavailable:{get:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.availability,a=void 0===i?"not-available":i,r=e.media;return Lg&&(null==(t=null==r?void 0:r.remote)?void 0:t.state)?null!=a&&"available"!==a?Jv:void 0:$v},stateOwnersUpdateHandlers:[function(e,t){var n,i=t.media;if(i)return i.disableRemotePlayback||i.hasAttribute("disableremoteplayback")||null==(n=null==i?void 0:i.remote)||n.watchAvailability((function(t){e({availability:t?"available":"not-available"})})).catch((function(t){"NotSupportedError"===t.name?e({availability:null}):e({availability:"not-available"})})),function(){var e;null==(e=null==i?void 0:i.remote)||e.cancelWatchAvailability().catch((function(){}))}}]},mediaAirplayUnavailable:{get:function(e,t){return Rg?"not-available"===(null==t?void 0:t.availability)?Jv:void 0:$v},mediaEvents:["webkitplaybacktargetavailabilitychanged"],stateOwnersUpdateHandlers:[function(e,t){var n,i=t.media;if(i)return i.disableRemotePlayback||i.hasAttribute("disableremoteplayback")||null==(n=null==i?void 0:i.remote)||n.watchAvailability((function(t){e({availability:t?"available":"not-available"})})).catch((function(t){"NotSupportedError"===t.name?e({availability:null}):e({availability:"not-available"})})),function(){var e;null==(e=null==i?void 0:i.remote)||e.cancelWatchAvailability().catch((function(){}))}}]},mediaRenditionUnavailable:{get:function(e){var t,n=e.media;return(null==n?void 0:n.videoRenditions)?(null==(t=n.videoRenditions)?void 0:t.length)?void 0:Jv:$v},mediaEvents:["emptied","loadstart"],videoRenditionsEvents:["addrendition","removerendition"]},mediaAudioTrackUnavailable:{get:function(e){var t,n,i=e.media;return(null==i?void 0:i.audioTracks)?(null!=(n=null==(t=i.audioTracks)?void 0:t.length)?n:0)<=1?Jv:void 0:$v},mediaEvents:["emptied","loadstart"],audioTracksEvents:["addtrack","removetrack"]}},Hg=(Wp={},(0,s.A)(Wp,Bv.MEDIA_PREVIEW_REQUEST,(function(e,t,n){var i,r,o,s=n.detail,l=t.media,u=null!=s?s:void 0,c=void 0,d=void 0;if(l&&null!=u){var h=dg(l,{kind:jv.METADATA,label:"thumbnails"}),f=(0,a.A)(h,1)[0],v=Array.prototype.find.call(null!=(i=null==f?void 0:f.cues)?i:[],(function(e,t,n){return 0===t?e.endTime>u:t===n.length-1?e.startTime<=u:e.startTime<=u&&e.endTime>u}));if(v){var m=/'^(?:[a-z]+:)?\/\//i.test(v.text)||null==(r=null==l?void 0:l.querySelector('track[label="thumbnails"]'))?void 0:r.src,p=new URL(v.text,m);d=new URLSearchParams(p.hash).get("#xywh").split(",").map((function(e){return+e})),c=p.href}}var g=e.mediaDuration.get(t),y=null==(o=e.mediaChaptersCues.get(t).find((function(e,t,n){return t===n.length-1&&g===e.endTime?e.startTime<=u&&e.endTime>=u:e.startTime<=u&&e.endTime>u})))?void 0:o.text;return null!=s&&null==y&&(y=""),{mediaPreviewTime:u,mediaPreviewImage:c,mediaPreviewCoords:d,mediaPreviewChapter:y}})),(0,s.A)(Wp,Bv.MEDIA_PAUSE_REQUEST,(function(e,t){e.mediaPaused.set(!0,t)})),(0,s.A)(Wp,Bv.MEDIA_PLAY_REQUEST,(function(e,t){var n,i,a,r,o=e.mediaStreamType.get(t)===em.LIVE,s=!(null==(n=t.options)?void 0:n.noAutoSeekToLive),l=e.mediaTargetLiveWindow.get(t)>0;if(o&&s&&!l){var u=null==(i=e.mediaSeekable.get(t))?void 0:i[1];if(u){var c=u-(null!=(r=null==(a=t.options)?void 0:a.seekToLiveOffset)?r:0);e.mediaCurrentTime.set(c,t)}}e.mediaPaused.set(!1,t)})),(0,s.A)(Wp,Bv.MEDIA_PLAYBACK_RATE_REQUEST,(function(e,t,n){var i=n.detail;e.mediaPlaybackRate.set(i,t)})),(0,s.A)(Wp,Bv.MEDIA_MUTE_REQUEST,(function(e,t){e.mediaMuted.set(!0,t)})),(0,s.A)(Wp,Bv.MEDIA_UNMUTE_REQUEST,(function(e,t){e.mediaVolume.get(t)||e.mediaVolume.set(.25,t),e.mediaMuted.set(!1,t)})),(0,s.A)(Wp,Bv.MEDIA_VOLUME_REQUEST,(function(e,t,n){var i=n.detail;i&&e.mediaMuted.get(t)&&e.mediaMuted.set(!1,t),e.mediaVolume.set(i,t)})),(0,s.A)(Wp,Bv.MEDIA_SEEK_REQUEST,(function(e,t,n){var i=n.detail;e.mediaCurrentTime.set(i,t)})),(0,s.A)(Wp,Bv.MEDIA_SEEK_TO_LIVE_REQUEST,(function(e,t){var n,i,a,r=null==(n=e.mediaSeekable.get(t))?void 0:n[1];if(!Number.isNaN(Number(r))){var o=r-(null!=(a=null==(i=t.options)?void 0:i.seekToLiveOffset)?a:0);e.mediaCurrentTime.set(o,t)}})),(0,s.A)(Wp,Bv.MEDIA_SHOW_SUBTITLES_REQUEST,(function(e,t,n){var i,a=n.detail,r=t.options,o=Ig(t),s=og(a),l=null==(i=s[0])?void 0:i.language;l&&!r.noSubtitlesLangPref&&Sm.localStorage.setItem("media-chrome-pref-subtitles-lang",l),cg(Xv,o,s)})),(0,s.A)(Wp,Bv.MEDIA_DISABLE_SUBTITLES_REQUEST,(function(e,t,n){var i=n.detail,a=Ig(t);cg(zv,a,null!=i?i:[])})),(0,s.A)(Wp,Bv.MEDIA_TOGGLE_SUBTITLES_REQUEST,(function(e,t,n){var i=n.detail;Cg(t,i)})),(0,s.A)(Wp,Bv.MEDIA_RENDITION_REQUEST,(function(e,t,n){var i=n.detail;e.mediaRenditionSelected.set(i,t)})),(0,s.A)(Wp,Bv.MEDIA_AUDIO_TRACK_REQUEST,(function(e,t,n){var i=n.detail;e.mediaAudioTrackEnabled.set(i,t)})),(0,s.A)(Wp,Bv.MEDIA_ENTER_PIP_REQUEST,(function(e,t){e.mediaIsFullscreen.get(t)&&e.mediaIsFullscreen.set(!1,t),e.mediaIsPip.set(!0,t)})),(0,s.A)(Wp,Bv.MEDIA_EXIT_PIP_REQUEST,(function(e,t){e.mediaIsPip.set(!1,t)})),(0,s.A)(Wp,Bv.MEDIA_ENTER_FULLSCREEN_REQUEST,(function(e,t){e.mediaIsPip.get(t)&&e.mediaIsPip.set(!1,t),e.mediaIsFullscreen.set(!0,t)})),(0,s.A)(Wp,Bv.MEDIA_EXIT_FULLSCREEN_REQUEST,(function(e,t){e.mediaIsFullscreen.set(!1,t)})),(0,s.A)(Wp,Bv.MEDIA_ENTER_CAST_REQUEST,(function(e,t){e.mediaIsFullscreen.get(t)&&e.mediaIsFullscreen.set(!1,t),e.mediaIsCasting.set(!0,t)})),(0,s.A)(Wp,Bv.MEDIA_EXIT_CAST_REQUEST,(function(e,t){e.mediaIsCasting.set(!1,t)})),(0,s.A)(Wp,Bv.MEDIA_AIRPLAY_REQUEST,(function(e,t){e.mediaIsAirplaying.set(!0,t)})),Wp),Gg=function(e){var t=e.media,n=e.fullscreenElement,r=e.documentElement,o=e.stateMediator,u=void 0===o?Bg:o,c=e.requestMap,h=void 0===c?Hg:c,v=e.options,m=void 0===v?{}:v,p=e.monitorStateOwnersOnlyWithSubscriptions,g=void 0===p||p,y=[],E={options:(0,i.A)({},m)},A=Object.freeze({mediaPreviewTime:void 0,mediaPreviewImage:void 0,mediaPreviewCoords:void 0,mediaPreviewChapter:void 0}),b=function(e){void 0!=e&&(xg(e,A)||(A=Object.freeze((0,i.A)((0,i.A)({},A),e)),y.forEach((function(e){return e(A)}))))},k=function(){var e=Object.entries(u).reduce((function(e,t){var n=(0,a.A)(t,2),i=n[0],r=n[1].get;return e[i]=r(E),e}),{});b(e)},T={},_=void 0,S=function(){var e=(0,d.A)((0,l.A)().mark((function e(t,n){var r,o,c,d,h,v,m,p,A,S,w,R,L,I,D,C,x,M,O,P,N,U,F,B,H,G,K,W,V,q,Y,j,z,X,Q,Z,J,$,ee;return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x=!!_,_=(0,i.A)((0,i.A)((0,i.A)({},E),null!=_?_:{}),t),!x){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,Ng.apply(void 0,(0,f.A)(Object.values(t)));case 6:if(M=y.length>0&&0===n&&g,O=E.media!==_.media,P=(null==(r=E.media)?void 0:r.textTracks)!==(null==(o=_.media)?void 0:o.textTracks),N=(null==(c=E.media)?void 0:c.videoRenditions)!==(null==(d=_.media)?void 0:d.videoRenditions),U=(null==(h=E.media)?void 0:h.audioTracks)!==(null==(v=_.media)?void 0:v.audioTracks),F=(null==(m=E.media)?void 0:m.remote)!==(null==(p=_.media)?void 0:p.remote),B=E.documentElement!==_.documentElement,H=!!E.media&&(O||M),G=!!(null==(A=E.media)?void 0:A.textTracks)&&(P||M),K=!!(null==(S=E.media)?void 0:S.videoRenditions)&&(N||M),W=!!(null==(w=E.media)?void 0:w.audioTracks)&&(U||M),V=!!(null==(R=E.media)?void 0:R.remote)&&(F||M),q=!!E.documentElement&&(B||M),Y=H||G||K||W||V||q,j=0===y.length&&1===n&&g,z=!!_.media&&(O||j),X=!!(null==(L=_.media)?void 0:L.textTracks)&&(P||j),Q=!!(null==(I=_.media)?void 0:I.videoRenditions)&&(N||j),Z=!!(null==(D=_.media)?void 0:D.audioTracks)&&(U||j),J=!!(null==(C=_.media)?void 0:C.remote)&&(F||j),$=!!_.documentElement&&(B||j),ee=z||X||Q||Z||J||$,Y||ee){e.next=34;break}return Object.entries(_).forEach((function(e){var t=(0,a.A)(e,2),n=t[0],i=t[1];E[n]=i})),k(),_=void 0,e.abrupt("return");case 34:Object.entries(u).forEach((function(e){var t=(0,a.A)(e,2),n=t[0],i=t[1],r=i.get,o=i.mediaEvents,l=void 0===o?[]:o,u=i.textTracksEvents,c=void 0===u?[]:u,d=i.videoRenditionsEvents,h=void 0===d?[]:d,f=i.audioTracksEvents,v=void 0===f?[]:f,m=i.remoteEvents,p=void 0===m?[]:m,g=i.rootEvents,y=void 0===g?[]:g,A=i.stateOwnersUpdateHandlers,k=void 0===A?[]:A;T[n]||(T[n]={});var S,w=function(e){var t=r(E,e);b((0,s.A)({},n,t))};S=T[n].mediaEvents,l.forEach((function(e){S&&H&&(E.media.removeEventListener(e,S),T[n].mediaEvents=void 0),z&&(_.media.addEventListener(e,w),T[n].mediaEvents=w)})),S=T[n].textTracksEvents,c.forEach((function(e){var t,i;S&&G&&(null==(t=E.media.textTracks)||t.removeEventListener(e,S),T[n].textTracksEvents=void 0),X&&(null==(i=_.media.textTracks)||i.addEventListener(e,w),T[n].textTracksEvents=w)})),S=T[n].videoRenditionsEvents,h.forEach((function(e){var t,i;S&&K&&(null==(t=E.media.videoRenditions)||t.removeEventListener(e,S),T[n].videoRenditionsEvents=void 0),Q&&(null==(i=_.media.videoRenditions)||i.addEventListener(e,w),T[n].videoRenditionsEvents=w)})),S=T[n].audioTracksEvents,v.forEach((function(e){var t,i;S&&W&&(null==(t=E.media.audioTracks)||t.removeEventListener(e,S),T[n].audioTracksEvents=void 0),Z&&(null==(i=_.media.audioTracks)||i.addEventListener(e,w),T[n].audioTracksEvents=w)})),S=T[n].remoteEvents,p.forEach((function(e){var t,i;S&&V&&(null==(t=E.media.remote)||t.removeEventListener(e,S),T[n].remoteEvents=void 0),J&&(null==(i=_.media.remote)||i.addEventListener(e,w),T[n].remoteEvents=w)})),S=T[n].rootEvents,y.forEach((function(e){S&&q&&(E.documentElement.removeEventListener(e,S),T[n].rootEvents=void 0),$&&(_.documentElement.addEventListener(e,w),T[n].rootEvents=w)}));var R=T[n].stateOwnersUpdateHandlers;k.forEach((function(e){R&&Y&&R(),ee&&(T[n].stateOwnersUpdateHandlers=e(w,_))}))})),Object.entries(_).forEach((function(e){var t=(0,a.A)(e,2),n=t[0],i=t[1];E[n]=i})),k(),_=void 0;case 38:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return S({media:t,fullscreenElement:n,documentElement:r,options:m}),{dispatch:function(e){var t=e.type,n=e.detail;h[t]&&null==A.mediaErrorCode?b(h[t](u,E,e)):"mediaelementchangerequest"===t?S({media:n}):"fullscreenelementchangerequest"===t?S({fullscreenElement:n}):"documentelementchangerequest"===t?S({documentElement:n}):"optionschangerequest"===t&&Object.entries(null!=n?n:{}).forEach((function(e){var t=(0,a.A)(e,2),n=t[0],i=t[1];E.options[n]=i}))},getState:function(){return A},subscribe:function(e){return S({},y.length+1),y.push(e),e(A),function(){var t=y.indexOf(e);t>=0&&(S({},y.length-1),y.splice(t,1))}}}},Kg=function(e,t,n){if(!t.has(e))throw TypeError("Cannot "+n)},Wg=function(e,t,n){return Kg(e,t,"read from private field"),n?n.call(e):t.get(e)},Vg=function(e,t,n){if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},qg=function(e,t,n,i){return Kg(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n},Yg=function(e,t,n){return Kg(e,t,"access private method"),n},jg=["ArrowLeft","ArrowRight","Enter"," ","f","m","k","c"],zg="defaultsubtitles",Xg="defaultstreamtype",Qg="defaultduration",Zg="fullscreenelement",Jg="hotkeys",$g="keysused",ey="liveedgeoffset",ty="seektoliveoffset",ny="noautoseektolive",iy="nohotkeys",ay="novolumepref",ry="nosubtitleslangpref",oy="nodefaultstore",sy="keyboardforwardseekoffset",ly="keyboardbackwardseekoffset",uy="lang",cy=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){var e;(0,m.A)(this,n),e=t.call(this),Vg((0,Ln.A)(e),Zp),Vg((0,Ln.A)(e),$p),Vg((0,Ln.A)(e),tg),e.mediaStateReceivers=[],e.associatedElementSubscriptions=new Map,Vg((0,Ln.A)(e),qp,new Hp((0,Ln.A)(e),Jg)),Vg((0,Ln.A)(e),Yp,void 0),Vg((0,Ln.A)(e),jp,void 0),Vg((0,Ln.A)(e),zp,void 0),Vg((0,Ln.A)(e),Xp,void 0),Vg((0,Ln.A)(e),Qp,(function(t){var n;null==(n=Wg((0,Ln.A)(e),jp))||n.dispatch(t)})),e.associateElement((0,Ln.A)(e));var i={};return qg((0,Ln.A)(e),zp,(function(t){Object.entries(t).forEach((function(t){var n=(0,a.A)(t,2),r=n[0],o=n[1];if(!(r in i)||i[r]!==o){e.propagateMediaState(r,o);var s=r.toLowerCase(),l=new Sm.CustomEvent(Yv[s],{composed:!0,detail:o});e.dispatchEvent(l)}})),i=t})),e.enableHotkeys(),e}return(0,v.A)(n,[{key:"mediaStore",get:function(){return Wg(this,jp)},set:function(e){var t,n;Wg(this,jp)&&(null==(t=Wg(this,Xp))||t.call(this),qg(this,Xp,void 0)),qg(this,jp,e),Wg(this,jp)||this.hasAttribute(oy)?qg(this,Xp,null==(n=Wg(this,jp))?void 0:n.subscribe(Wg(this,zp))):Yg(this,Zp,Jp).call(this)}},{key:"fullscreenElement",get:function(){var e;return null!=(e=Wg(this,Yp))?e:this},set:function(e){var t;this.hasAttribute(Zg)&&this.removeAttribute(Zg),qg(this,Yp,e),null==(t=Wg(this,jp))||t.dispatch({type:"fullscreenelementchangerequest",detail:this.fullscreenElement})}},{key:"defaultSubtitles",get:function(){return Ym(this,zg)},set:function(e){jm(this,zg,e)}},{key:"defaultStreamType",get:function(){return zm(this,Xg)},set:function(e){Xm(this,Xg,e)}},{key:"defaultDuration",get:function(){return Vm(this,Qg)},set:function(e){qm(this,Qg,e)}},{key:"noHotkeys",get:function(){return Ym(this,iy)},set:function(e){jm(this,iy,e)}},{key:"keysUsed",get:function(){return zm(this,$g)},set:function(e){Xm(this,$g,e)}},{key:"liveEdgeOffset",get:function(){return Vm(this,ey)},set:function(e){qm(this,ey,e)}},{key:"noAutoSeekToLive",get:function(){return Ym(this,ny)},set:function(e){jm(this,ny,e)}},{key:"noVolumePref",get:function(){return Ym(this,ay)},set:function(e){jm(this,ay,e)}},{key:"noSubtitlesLangPref",get:function(){return Ym(this,ry)},set:function(e){jm(this,ry,e)}},{key:"noDefaultStore",get:function(){return Ym(this,oy)},set:function(e){jm(this,oy,e)}},{key:"attributeChangedCallback",value:function(e,t,i){var a,r,o,s,l,d,h,f;if((0,u.A)((0,c.A)(n.prototype),"attributeChangedCallback",this).call(this,e,t,i),e===iy)i!==t&&""===i?(this.hasAttribute(Jg)&&console.warn("Media Chrome: Both `hotkeys` and `nohotkeys` have been set. All hotkeys will be disabled."),this.disableHotkeys()):i!==t&&null===i&&this.enableHotkeys();else if(e===Jg)Wg(this,qp).value=i;else if(e===zg&&i!==t)null==(a=Wg(this,jp))||a.dispatch({type:"optionschangerequest",detail:{defaultSubtitles:this.hasAttribute(zg)}});else if(e===Xg)null==(o=Wg(this,jp))||o.dispatch({type:"optionschangerequest",detail:{defaultStreamType:null!=(r=this.getAttribute(Xg))?r:void 0}});else if(e===ey)null==(s=Wg(this,jp))||s.dispatch({type:"optionschangerequest",detail:{liveEdgeOffset:this.hasAttribute(ey)?+this.getAttribute(ey):void 0,seekToLiveOffset:this.hasAttribute(ty)?void 0:+this.getAttribute(ey)}});else if(e===ty)null==(l=Wg(this,jp))||l.dispatch({type:"optionschangerequest",detail:{seekToLiveOffset:this.hasAttribute(ty)?+this.getAttribute(ty):void 0}});else if(e===ny)null==(d=Wg(this,jp))||d.dispatch({type:"optionschangerequest",detail:{noAutoSeekToLive:this.hasAttribute(ny)}});else if(e===Zg){var v=i?null==(h=this.getRootNode())?void 0:h.getElementById(i):void 0;qg(this,Yp,v),null==(f=Wg(this,jp))||f.dispatch({type:"fullscreenelementchangerequest",detail:this.fullscreenElement})}else e===uy&&i!==t&&(mm=i)}},{key:"connectedCallback",value:function(){var e,t;Wg(this,jp)||this.hasAttribute(oy)||Yg(this,Zp,Jp).call(this),null==(e=Wg(this,jp))||e.dispatch({type:"documentelementchangerequest",detail:wm}),(0,u.A)((0,c.A)(n.prototype),"connectedCallback",this).call(this),Wg(this,jp)&&!Wg(this,Xp)&&qg(this,Xp,null==(t=Wg(this,jp))?void 0:t.subscribe(Wg(this,zp))),this.enableHotkeys()}},{key:"disconnectedCallback",value:function(){var e,t,i,a;null==(e=(0,u.A)((0,c.A)(n.prototype),"disconnectedCallback",this))||e.call(this),Wg(this,jp)&&(null==(t=Wg(this,jp))||t.dispatch({type:"documentelementchangerequest",detail:void 0}),null==(i=Wg(this,jp))||i.dispatch({type:Bv.MEDIA_TOGGLE_SUBTITLES_REQUEST,detail:!1})),Wg(this,Xp)&&(null==(a=Wg(this,Xp))||a.call(this),qg(this,Xp,void 0))}},{key:"mediaSetCallback",value:function(e){var t;(0,u.A)((0,c.A)(n.prototype),"mediaSetCallback",this).call(this,e),null==(t=Wg(this,jp))||t.dispatch({type:"mediaelementchangerequest",detail:e}),e.hasAttribute("tabindex")||(e.tabIndex=-1)}},{key:"mediaUnsetCallback",value:function(e){var t;(0,u.A)((0,c.A)(n.prototype),"mediaUnsetCallback",this).call(this,e),null==(t=Wg(this,jp))||t.dispatch({type:"mediaelementchangerequest",detail:void 0})}},{key:"propagateMediaState",value:function(e,t){Ey(this.mediaStateReceivers,e,t)}},{key:"associateElement",value:function(e){var t=this;if(e){var n=this.associatedElementSubscriptions;if(!n.has(e)){var i=this.registerMediaStateReceiver.bind(this),a=this.unregisterMediaStateReceiver.bind(this),r=Ay(e,i,a);Object.values(Bv).forEach((function(n){e.addEventListener(n,Wg(t,Qp))})),n.set(e,r)}}}},{key:"unassociateElement",value:function(e){var t=this;if(e){var n=this.associatedElementSubscriptions;if(n.has(e))n.get(e)(),n.delete(e),Object.values(Bv).forEach((function(n){e.removeEventListener(n,Wg(t,Qp))}))}}},{key:"registerMediaStateReceiver",value:function(e){if(e){var t=this.mediaStateReceivers;t.indexOf(e)>-1||(t.push(e),Wg(this,jp)&&Object.entries(Wg(this,jp).getState()).forEach((function(t){var n=(0,a.A)(t,2),i=n[0],r=n[1];Ey([e],i,r)})))}}},{key:"unregisterMediaStateReceiver",value:function(e){var t=this.mediaStateReceivers,n=t.indexOf(e);n<0||t.splice(n,1)}},{key:"enableHotkeys",value:function(){this.addEventListener("keydown",Yg(this,tg,ng))}},{key:"disableHotkeys",value:function(){this.removeEventListener("keydown",Yg(this,tg,ng)),this.removeEventListener("keyup",Yg(this,$p,eg))}},{key:"hotkeys",get:function(){return zm(this,Jg)},set:function(e){Xm(this,Jg,e)}},{key:"keyboardShortcutHandler",value:function(e){var t,n,i,a,r,o,s,l,u=e.target;if(!(null!=(i=null!=(n=null==(t=u.getAttribute($g))?void 0:t.split(" "))?n:null==u?void 0:u.keysUsed)?i:[]).map((function(e){return"Space"===e?" ":e})).filter(Boolean).includes(e.key)&&(!Wg(this,qp).contains("no".concat(e.key.toLowerCase()))&&(" "!==e.key||!Wg(this,qp).contains("nospace"))))switch(e.key){case" ":case"k":o=Wg(this,jp).getState().mediaPaused?Bv.MEDIA_PLAY_REQUEST:Bv.MEDIA_PAUSE_REQUEST,this.dispatchEvent(new Sm.CustomEvent(o,{composed:!0,bubbles:!0}));break;case"m":o="off"===this.mediaStore.getState().mediaVolumeLevel?Bv.MEDIA_UNMUTE_REQUEST:Bv.MEDIA_MUTE_REQUEST,this.dispatchEvent(new Sm.CustomEvent(o,{composed:!0,bubbles:!0}));break;case"f":o=this.mediaStore.getState().mediaIsFullscreen?Bv.MEDIA_EXIT_FULLSCREEN_REQUEST:Bv.MEDIA_ENTER_FULLSCREEN_REQUEST,this.dispatchEvent(new Sm.CustomEvent(o,{composed:!0,bubbles:!0}));break;case"c":this.dispatchEvent(new Sm.CustomEvent(Bv.MEDIA_TOGGLE_SUBTITLES_REQUEST,{composed:!0,bubbles:!0}));break;case"ArrowLeft":var c=this.hasAttribute(ly)?+this.getAttribute(ly):10;s=Math.max((null!=(a=this.mediaStore.getState().mediaCurrentTime)?a:0)-c,0),l=new Sm.CustomEvent(Bv.MEDIA_SEEK_REQUEST,{composed:!0,bubbles:!0,detail:s}),this.dispatchEvent(l);break;case"ArrowRight":var d=this.hasAttribute(sy)?+this.getAttribute(sy):10;s=Math.max((null!=(r=this.mediaStore.getState().mediaCurrentTime)?r:0)+d,0),l=new Sm.CustomEvent(Bv.MEDIA_SEEK_REQUEST,{composed:!0,bubbles:!0,detail:s}),this.dispatchEvent(l)}}}],[{key:"observedAttributes",get:function(){return(0,u.A)((0,c.A)(n),"observedAttributes",this).concat(iy,Jg,Xg,zg,Qg,uy)}}]),n}(Ip);qp=new WeakMap,Yp=new WeakMap,jp=new WeakMap,zp=new WeakMap,Xp=new WeakMap,Qp=new WeakMap,Zp=new WeakSet,Jp=function(){var e;this.mediaStore=Gg({media:this.media,fullscreenElement:this.fullscreenElement,options:{defaultSubtitles:this.hasAttribute(zg),defaultDuration:this.hasAttribute(Qg)?+this.getAttribute(Qg):void 0,defaultStreamType:null!=(e=this.getAttribute(Xg))?e:void 0,liveEdgeOffset:this.hasAttribute(ey)?+this.getAttribute(ey):void 0,seekToLiveOffset:this.hasAttribute(ty)?+this.getAttribute(ty):this.hasAttribute(ey)?+this.getAttribute(ey):void 0,noAutoSeekToLive:this.hasAttribute(ny),noVolumePref:this.hasAttribute(ay),noSubtitlesLangPref:this.hasAttribute(ry)}})},$p=new WeakSet,eg=function(e){var t=e.key;jg.includes(t)?this.keyboardShortcutHandler(e):this.removeEventListener("keyup",Yg(this,$p,eg))},tg=new WeakSet,ng=function(e){var t=e.metaKey,n=e.altKey,i=e.key;t||n||!jg.includes(i)?this.removeEventListener("keyup",Yg(this,$p,eg)):([" ","ArrowLeft","ArrowRight"].includes(i)&&!(Wg(this,qp).contains("no".concat(i.toLowerCase()))||" "===i&&Wg(this,qp).contains("nospace"))&&e.preventDefault(),this.addEventListener("keyup",Yg(this,$p,eg),{once:!0}))};var dy=Object.values(Vv),hy=Object.values(Kv),fy=function(e){var t,n,i,a,r=e.constructor.observedAttributes;!r&&(null==(t=e.nodeName)?void 0:t.includes("-"))&&(Sm.customElements.upgrade(e),r=e.constructor.observedAttributes);var o=null==(a=null==(i=null==(n=null==e?void 0:e.getAttribute)?void 0:n.call(e,Hv))?void 0:i.split)?void 0:a.call(i,/\s+/);return Array.isArray(r||o)?(r||o).filter((function(e){return dy.includes(e)})):[]},vy=function(e){return function(e){var t,n;return!(null==(t=e.nodeName)?void 0:t.includes("-"))||!Sm.customElements.get(null==(n=e.nodeName)?void 0:n.toLowerCase())||e instanceof Sm.customElements.get(e.nodeName.toLowerCase())||Sm.customElements.upgrade(e),hy.some((function(t){return t in e}))}(e)||!!fy(e).length},my=function(e){var t;return null==(t=null==e?void 0:e.join)?void 0:t.call(e,":")},py=(Vp={},(0,s.A)(Vp,Vv.MEDIA_SUBTITLES_LIST,lg),(0,s.A)(Vp,Vv.MEDIA_SUBTITLES_SHOWING,lg),(0,s.A)(Vp,Vv.MEDIA_SEEKABLE,my),(0,s.A)(Vp,Vv.MEDIA_BUFFERED,(function(e){return null==e?void 0:e.map(my).join(" ")})),(0,s.A)(Vp,Vv.MEDIA_PREVIEW_COORDS,(function(e){return null==e?void 0:e.join(" ")})),(0,s.A)(Vp,Vv.MEDIA_RENDITION_LIST,(function(e){return null==e?void 0:e.map(nm).join(" ")})),(0,s.A)(Vp,Vv.MEDIA_AUDIO_TRACK_LIST,(function(e){return null==e?void 0:e.map(am).join(" ")})),Vp),gy=function(){var e=(0,d.A)((0,l.A)().mark((function e(t,n,i){var a,r,o;return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isConnected){e.next=3;break}return e.next=3,um(0);case 3:if("boolean"!==typeof i&&null!=i){e.next=5;break}return e.abrupt("return",jm(t,n,i));case 5:if("number"!==typeof i){e.next=7;break}return e.abrupt("return",qm(t,n,i));case 7:if("string"!==typeof i){e.next=9;break}return e.abrupt("return",Xm(t,n,i));case 9:if(!Array.isArray(i)||i.length){e.next=11;break}return e.abrupt("return",t.removeAttribute(n));case 11:return o=null!=(r=null==(a=py[n])?void 0:a.call(py,i))?r:i,e.abrupt("return",t.setAttribute(n,o));case 13:case"end":return e.stop()}}),e)})));return function(t,n,i){return e.apply(this,arguments)}}(),yy=function e(t,n){if(!function(e){var t;return!!(null==(t=e.closest)?void 0:t.call(e,'*[slot="media"]'))}(t)){var i=function(t,n){var i,a;vy(t)&&n(t);var r=(null!=t?t:{}).children,o=void 0===r?[]:r,s=null!=(a=null==(i=null==t?void 0:t.shadowRoot)?void 0:i.children)?a:[];[].concat((0,f.A)(o),(0,f.A)(s)).forEach((function(t){return e(t,n)}))},a=null==t?void 0:t.nodeName.toLowerCase();!a.includes("-")||vy(t)?i(t,n):Sm.customElements.whenDefined(a).then((function(){i(t,n)}))}},Ey=function(e,t,n){e.forEach((function(e){if(t in e)e[t]=n;else{var i=fy(e),a=t.toLowerCase();i.includes(a)&&gy(e,a,n)}}))},Ay=function(e,t,n){yy(e,t);var i=function(e){var n,i=null!=(n=null==e?void 0:e.composedPath()[0])?n:e.target;t(i)},a=function(e){var t,i=null!=(t=null==e?void 0:e.composedPath()[0])?t:e.target;n(i)};e.addEventListener(Bv.REGISTER_MEDIA_STATE_RECEIVER,i),e.addEventListener(Bv.UNREGISTER_MEDIA_STATE_RECEIVER,a);var r=[],o=function(e){var i=e.target;"media"!==i.name&&(r.forEach((function(e){return yy(e,n)})),(r=(0,f.A)(i.assignedElements({flatten:!0}))).forEach((function(e){return yy(e,t)})))};e.addEventListener("slotchange",o);var s=new MutationObserver((function(e){e.forEach((function(e){var i=e.addedNodes,a=void 0===i?[]:i,r=e.removedNodes,o=void 0===r?[]:r,s=e.type,l=e.target,u=e.attributeName;"childList"===s?(Array.prototype.forEach.call(a,(function(e){return yy(e,t)})),Array.prototype.forEach.call(o,(function(e){return yy(e,n)}))):"attributes"===s&&u===Hv&&(vy(l)?t(l):n(l))}))}));s.observe(e,{childList:!0,attributes:!0,subtree:!0});return function(){yy(e,n),e.removeEventListener("slotchange",o),s.disconnect(),e.removeEventListener(Bv.REGISTER_MEDIA_STATE_RECEIVER,i),e.removeEventListener(Bv.UNREGISTER_MEDIA_STATE_RECEIVER,a)}};Sm.customElements.get("media-controller")||Sm.customElements.define("media-controller",cy);var by=cy,ky="placement",Ty="bounds";var _y=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){var e;if((0,m.A)(this,n),(e=t.call(this)).updateXOffset=function(){var t;if(Gm((0,Ln.A)(e),{checkOpacity:!1,checkVisibilityCSS:!1})){var n=e.placement;if("left"!==n&&"right"!==n){var i=getComputedStyle((0,Ln.A)(e)),a=null!=(t=Fm((0,Ln.A)(e),"#"+e.bounds))?t:Mm((0,Ln.A)(e));if(a){var r=a.getBoundingClientRect(),o=r.x,s=r.width,l=e.getBoundingClientRect(),u=l.x,c=u+l.width,d=o+s,h=i.getPropertyValue("--media-tooltip-offset-x"),f=h?parseFloat(h.replace("px","")):0,v=i.getPropertyValue("--media-tooltip-container-margin"),m=v?parseFloat(v.replace("px","")):0,p=u-o+f-m,g=c-d+f+m;p<0?e.style.setProperty("--media-tooltip-offset-x","".concat(p,"px")):g>0?e.style.setProperty("--media-tooltip-offset-x","".concat(g,"px")):e.style.removeProperty("--media-tooltip-offset-x")}}else e.style.removeProperty("--media-tooltip-offset-x")}},!e.shadowRoot){e.attachShadow(e.constructor.shadowRootOptions);var i=xm(e.attributes);e.shadowRoot.innerHTML=e.constructor.getTemplateHTML(i)}if(e.arrowEl=e.shadowRoot.querySelector("#arrow"),Object.prototype.hasOwnProperty.call((0,Ln.A)(e),"placement")){var a=e.placement;delete e.placement,e.placement=a}return e}return(0,v.A)(n,[{key:"placement",get:function(){return zm(this,ky)},set:function(e){Xm(this,ky,e)}},{key:"bounds",get:function(){return zm(this,Ty)},set:function(e){Xm(this,Ty,e)}}],[{key:"observedAttributes",get:function(){return[ky,Ty]}}]),n}(Sm.HTMLElement);_y.shadowRootOptions={mode:"open"},_y.getTemplateHTML=function(e){return'\n    <style>\n      :host {\n        --_tooltip-background-color: var(--media-tooltip-background-color, var(--media-secondary-color, rgba(20, 20, 30, .7)));\n        --_tooltip-background: var(--media-tooltip-background, var(--_tooltip-background-color));\n        --_tooltip-arrow-half-width: calc(var(--media-tooltip-arrow-width, 12px) / 2);\n        --_tooltip-arrow-height: var(--media-tooltip-arrow-height, 5px);\n        --_tooltip-arrow-background: var(--media-tooltip-arrow-color, var(--_tooltip-background-color));\n        position: relative;\n        pointer-events: none;\n        display: var(--media-tooltip-display, inline-flex);\n        justify-content: center;\n        align-items: center;\n        box-sizing: border-box;\n        z-index: var(--media-tooltip-z-index, 1);\n        background: var(--_tooltip-background);\n        color: var(--media-text-color, var(--media-primary-color, rgb(238 238 238)));\n        font: var(--media-font,\n          var(--media-font-weight, 400)\n          var(--media-font-size, 13px) /\n          var(--media-text-content-height, var(--media-control-height, 18px))\n          var(--media-font-family, helvetica neue, segoe ui, roboto, arial, sans-serif));\n        padding: var(--media-tooltip-padding, .35em .7em);\n        border: var(--media-tooltip-border, none);\n        border-radius: var(--media-tooltip-border-radius, 5px);\n        filter: var(--media-tooltip-filter, drop-shadow(0 0 4px rgba(0, 0, 0, .2)));\n        white-space: var(--media-tooltip-white-space, nowrap);\n      }\n\n      :host([hidden]) {\n        display: none;\n      }\n\n      img, svg {\n        display: inline-block;\n      }\n\n      #arrow {\n        position: absolute;\n        width: 0px;\n        height: 0px;\n        border-style: solid;\n        display: var(--media-tooltip-arrow-display, block);\n      }\n\n      :host(:not([placement])),\n      :host([placement="top"]) {\n        position: absolute;\n        bottom: calc(100% + var(--media-tooltip-distance, 12px));\n        left: 50%;\n        transform: translate(calc(-50% - var(--media-tooltip-offset-x, 0px)), 0);\n      }\n      :host(:not([placement])) #arrow,\n      :host([placement="top"]) #arrow {\n        top: 100%;\n        left: 50%;\n        border-width: var(--_tooltip-arrow-height) var(--_tooltip-arrow-half-width) 0 var(--_tooltip-arrow-half-width);\n        border-color: var(--_tooltip-arrow-background) transparent transparent transparent;\n        transform: translate(calc(-50% + var(--media-tooltip-offset-x, 0px)), 0);\n      }\n\n      :host([placement="right"]) {\n        position: absolute;\n        left: calc(100% + var(--media-tooltip-distance, 12px));\n        top: 50%;\n        transform: translate(0, -50%);\n      }\n      :host([placement="right"]) #arrow {\n        top: 50%;\n        right: 100%;\n        border-width: var(--_tooltip-arrow-half-width) var(--_tooltip-arrow-height) var(--_tooltip-arrow-half-width) 0;\n        border-color: transparent var(--_tooltip-arrow-background) transparent transparent;\n        transform: translate(0, -50%);\n      }\n\n      :host([placement="bottom"]) {\n        position: absolute;\n        top: calc(100% + var(--media-tooltip-distance, 12px));\n        left: 50%;\n        transform: translate(calc(-50% - var(--media-tooltip-offset-x, 0px)), 0);\n      }\n      :host([placement="bottom"]) #arrow {\n        bottom: 100%;\n        left: 50%;\n        border-width: 0 var(--_tooltip-arrow-half-width) var(--_tooltip-arrow-height) var(--_tooltip-arrow-half-width);\n        border-color: transparent transparent var(--_tooltip-arrow-background) transparent;\n        transform: translate(calc(-50% + var(--media-tooltip-offset-x, 0px)), 0);\n      }\n\n      :host([placement="left"]) {\n        position: absolute;\n        right: calc(100% + var(--media-tooltip-distance, 12px));\n        top: 50%;\n        transform: translate(0, -50%);\n      }\n      :host([placement="left"]) #arrow {\n        top: 50%;\n        left: 100%;\n        border-width: var(--_tooltip-arrow-half-width) 0 var(--_tooltip-arrow-half-width) var(--_tooltip-arrow-height);\n        border-color: transparent transparent transparent var(--_tooltip-arrow-background);\n        transform: translate(0, -50%);\n      }\n      \n      :host([placement="none"]) #arrow {\n        display: none;\n      }\n    </style>\n    <slot></slot>\n    <div id="arrow"></div>\n  '},Sm.customElements.get("media-tooltip")||Sm.customElements.define("media-tooltip",_y);var Sy,wy,Ry,Ly,Iy,Dy,Cy,xy=_y,My=function(e,t,n){if(!t.has(e))throw TypeError("Cannot "+n)},Oy=function(e,t,n){return My(e,t,"read from private field"),n?n.call(e):t.get(e)},Py=function(e,t,n){if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},Ny=function(e,t,n,i){return My(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n},Uy="tooltipplacement",Fy="disabled",By="notooltip";var Hy=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){var e;if((0,m.A)(this,n),e=t.call(this),Py((0,Ln.A)(e),Dy),Py((0,Ln.A)(e),Sy,void 0),e.preventClick=!1,e.tooltipEl=null,Py((0,Ln.A)(e),wy,(function(t){e.preventClick||e.handleClick(t),setTimeout(Oy((0,Ln.A)(e),Ry),0)})),Py((0,Ln.A)(e),Ry,(function(){var t,n;null==(n=null==(t=e.tooltipEl)?void 0:t.updateXOffset)||n.call(t)})),Py((0,Ln.A)(e),Ly,(function(t){var n=t.key;e.keysUsed.includes(n)?e.preventClick||e.handleClick(t):e.removeEventListener("keyup",Oy((0,Ln.A)(e),Ly))})),Py((0,Ln.A)(e),Iy,(function(t){var n=t.metaKey,i=t.altKey,a=t.key;n||i||!e.keysUsed.includes(a)?e.removeEventListener("keyup",Oy((0,Ln.A)(e),Ly)):e.addEventListener("keyup",Oy((0,Ln.A)(e),Ly),{once:!0})})),!e.shadowRoot){e.attachShadow(e.constructor.shadowRootOptions);var i=xm(e.attributes),a=e.constructor.getTemplateHTML(i);e.shadowRoot.setHTMLUnsafe?e.shadowRoot.setHTMLUnsafe(a):e.shadowRoot.innerHTML=a}return e.tooltipEl=e.shadowRoot.querySelector("media-tooltip"),e}return(0,v.A)(n,[{key:"enable",value:function(){this.addEventListener("click",Oy(this,wy)),this.addEventListener("keydown",Oy(this,Iy)),this.tabIndex=0}},{key:"disable",value:function(){this.removeEventListener("click",Oy(this,wy)),this.removeEventListener("keydown",Oy(this,Iy)),this.removeEventListener("keyup",Oy(this,Ly)),this.tabIndex=-1}},{key:"attributeChangedCallback",value:function(e,t,n){var i,a,r,o,s;e===Gv?(t&&(null==(a=null==(i=Oy(this,Sy))?void 0:i.unassociateElement)||a.call(i,this),Ny(this,Sy,null)),n&&this.isConnected&&(Ny(this,Sy,null==(r=this.getRootNode())?void 0:r.getElementById(n)),null==(s=null==(o=Oy(this,Sy))?void 0:o.associateElement)||s.call(o,this))):"disabled"===e&&n!==t?null==n?this.enable():this.disable():e===Uy&&this.tooltipEl&&n!==t&&(this.tooltipEl.placement=n),Oy(this,Ry).call(this)}},{key:"connectedCallback",value:function(){var e,t,n,i=this;Km(this.shadowRoot,":host").style.setProperty("display","var(--media-control-display, var(--".concat(this.localName,"-display, inline-flex))")),this.hasAttribute("disabled")?this.disable():this.enable(),this.setAttribute("role","button");var a=this.getAttribute(Gv);a&&(Ny(this,Sy,null==(e=this.getRootNode())?void 0:e.getElementById(a)),null==(n=null==(t=Oy(this,Sy))?void 0:t.associateElement)||n.call(t,this)),Sm.customElements.whenDefined("media-tooltip").then((function(){return(e=i,t=Dy,n=Cy,My(e,t,"access private method"),n).call(i);var e,t,n}))}},{key:"disconnectedCallback",value:function(){var e,t;this.disable(),null==(t=null==(e=Oy(this,Sy))?void 0:e.unassociateElement)||t.call(e,this),Ny(this,Sy,null),this.removeEventListener("mouseenter",Oy(this,Ry)),this.removeEventListener("focus",Oy(this,Ry)),this.removeEventListener("click",Oy(this,wy))}},{key:"keysUsed",get:function(){return["Enter"," "]}},{key:"tooltipPlacement",get:function(){return zm(this,Uy)},set:function(e){Xm(this,Uy,e)}},{key:"mediaController",get:function(){return zm(this,Gv)},set:function(e){Xm(this,Gv,e)}},{key:"disabled",get:function(){return Ym(this,Fy)},set:function(e){jm(this,Fy,e)}},{key:"noTooltip",get:function(){return Ym(this,By)},set:function(e){jm(this,By,e)}},{key:"handleClick",value:function(e){}}],[{key:"observedAttributes",get:function(){return["disabled",Uy,Gv]}}]),n}(Sm.HTMLElement);Sy=new WeakMap,wy=new WeakMap,Ry=new WeakMap,Ly=new WeakMap,Iy=new WeakMap,Dy=new WeakSet,Cy=function(){this.addEventListener("mouseenter",Oy(this,Ry)),this.addEventListener("focus",Oy(this,Ry)),this.addEventListener("click",Oy(this,wy));var e=this.tooltipPlacement;e&&this.tooltipEl&&(this.tooltipEl.placement=e)},Hy.shadowRootOptions={mode:"open"},Hy.getTemplateHTML=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"\n    <style>\n      :host {\n        position: relative;\n        font: var(--media-font,\n          var(--media-font-weight, bold)\n          var(--media-font-size, 14px) /\n          var(--media-text-content-height, var(--media-control-height, 24px))\n          var(--media-font-family, helvetica neue, segoe ui, roboto, arial, sans-serif));\n        color: var(--media-text-color, var(--media-primary-color, rgb(238 238 238)));\n        background: var(--media-control-background, var(--media-secondary-color, rgb(20 20 30 / .7)));\n        padding: var(--media-button-padding, var(--media-control-padding, 10px));\n        justify-content: var(--media-button-justify-content, center);\n        display: inline-flex;\n        align-items: center;\n        vertical-align: middle;\n        box-sizing: border-box;\n        transition: background .15s linear;\n        pointer-events: auto;\n        cursor: var(--media-cursor, pointer);\n        -webkit-tap-highlight-color: transparent;\n      }\n\n      ".concat("\n      :host(:focus-visible) {\n        box-shadow: inset 0 0 0 2px rgb(27 127 204 / .9);\n        outline: 0;\n      }\n      ","\n      :host(:where(:focus)) {\n        box-shadow: none;\n        outline: 0;\n      }\n\n      :host(:hover) {\n        background: var(--media-control-hover-background, rgba(50 50 70 / .7));\n      }\n\n      svg, img, ::slotted(svg), ::slotted(img) {\n        width: var(--media-button-icon-width);\n        height: var(--media-button-icon-height, var(--media-control-height, 24px));\n        transform: var(--media-button-icon-transform);\n        transition: var(--media-button-icon-transition);\n        fill: var(--media-icon-color, var(--media-primary-color, rgb(238 238 238)));\n        vertical-align: middle;\n        max-width: 100%;\n        max-height: 100%;\n        min-width: 100%;\n      }\n\n      media-tooltip {\n        ",'\n        max-width: 0;\n        overflow-x: clip;\n        opacity: 0;\n        transition: opacity .3s, max-width 0s 9s;\n      }\n\n      :host(:hover) media-tooltip,\n      :host(:focus-visible) media-tooltip {\n        max-width: 100vw;\n        opacity: 1;\n        transition: opacity .3s;\n      }\n\n      :host([notooltip]) slot[name="tooltip"] {\n        display: none;\n      }\n    </style>\n\n    ',this.getSlotTemplateHTML(e,t),'\n\n    <slot name="tooltip">\n      <media-tooltip part="tooltip" aria-hidden="true">\n        <template shadowrootmode="').concat(xy.shadowRootOptions.mode,'">\n          ').concat(xy.getTemplateHTML({}),'\n        </template>\n        <slot name="tooltip-content">\n          ').concat(this.getTooltipContentHTML(e),"\n        </slot>\n      </media-tooltip>\n    </slot>\n  ")},Hy.getSlotTemplateHTML=function(e,t){return"\n    <slot></slot>\n  "},Hy.getTooltipContentHTML=function(){return""},Sm.customElements.get("media-chrome-button")||Sm.customElements.define("media-chrome-button",Hy);var Gy='<svg aria-hidden="true" viewBox="0 0 26 24">\n  <path d="M22.13 3H3.87a.87.87 0 0 0-.87.87v13.26a.87.87 0 0 0 .87.87h3.4L9 16H5V5h16v11h-4l1.72 2h3.4a.87.87 0 0 0 .87-.87V3.87a.87.87 0 0 0-.86-.87Zm-8.75 11.44a.5.5 0 0 0-.76 0l-4.91 5.73a.5.5 0 0 0 .38.83h9.82a.501.501 0 0 0 .38-.83l-4.91-5.73Z"/>\n</svg>\n';var Ky=function(e){var t=e.mediaIsAirplaying?gm("stop airplay"):gm("start airplay");e.setAttribute("aria-label",t)},Wy=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){return(0,m.A)(this,n),t.apply(this,arguments)}return(0,v.A)(n,[{key:"connectedCallback",value:function(){(0,u.A)((0,c.A)(n.prototype),"connectedCallback",this).call(this),Ky(this)}},{key:"attributeChangedCallback",value:function(e,t,i){(0,u.A)((0,c.A)(n.prototype),"attributeChangedCallback",this).call(this,e,t,i),e===Vv.MEDIA_IS_AIRPLAYING&&Ky(this)}},{key:"mediaIsAirplaying",get:function(){return Ym(this,Vv.MEDIA_IS_AIRPLAYING)},set:function(e){jm(this,Vv.MEDIA_IS_AIRPLAYING,e)}},{key:"mediaAirplayUnavailable",get:function(){return zm(this,Vv.MEDIA_AIRPLAY_UNAVAILABLE)},set:function(e){Xm(this,Vv.MEDIA_AIRPLAY_UNAVAILABLE,e)}},{key:"handleClick",value:function(){var e=new Sm.CustomEvent(Bv.MEDIA_AIRPLAY_REQUEST,{composed:!0,bubbles:!0});this.dispatchEvent(e)}}],[{key:"observedAttributes",get:function(){return[].concat((0,f.A)((0,u.A)((0,c.A)(n),"observedAttributes",this)),[Vv.MEDIA_IS_AIRPLAYING,Vv.MEDIA_AIRPLAY_UNAVAILABLE])}}]),n}(Hy);Wy.getSlotTemplateHTML=function(e){return"\n    <style>\n      :host([".concat(Vv.MEDIA_IS_AIRPLAYING,"]) slot[name=icon] slot:not([name=exit]) {\n        display: none !important;\n      }\n\n      ","\n      :host(:not([").concat(Vv.MEDIA_IS_AIRPLAYING,"])) slot[name=icon] slot:not([name=enter]) {\n        display: none !important;\n      }\n\n      :host([").concat(Vv.MEDIA_IS_AIRPLAYING,"]) slot[name=tooltip-enter],\n      :host(:not([").concat(Vv.MEDIA_IS_AIRPLAYING,'])) slot[name=tooltip-exit] {\n        display: none;\n      }\n    </style>\n\n    <slot name="icon">\n      <slot name="enter">').concat(Gy,'</slot>\n      <slot name="exit">').concat(Gy,"</slot>\n    </slot>\n  ")},Wy.getTooltipContentHTML=function(){return'\n    <slot name="tooltip-enter">'.concat(gm("start airplay"),'</slot>\n    <slot name="tooltip-exit">').concat(gm("stop airplay"),"</slot>\n  ")},Sm.customElements.get("media-airplay-button")||Sm.customElements.define("media-airplay-button",Wy);var Vy=function(e){e.setAttribute("aria-checked",hg(e).toString())},qy=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){return(0,m.A)(this,n),t.apply(this,arguments)}return(0,v.A)(n,[{key:"connectedCallback",value:function(){(0,u.A)((0,c.A)(n.prototype),"connectedCallback",this).call(this),this.setAttribute("role","switch"),this.setAttribute("aria-label",gm("closed captions")),Vy(this)}},{key:"attributeChangedCallback",value:function(e,t,i){(0,u.A)((0,c.A)(n.prototype),"attributeChangedCallback",this).call(this,e,t,i),e===Vv.MEDIA_SUBTITLES_SHOWING&&Vy(this)}},{key:"mediaSubtitlesList",get:function(){return Yy(this,Vv.MEDIA_SUBTITLES_LIST)},set:function(e){jy(this,Vv.MEDIA_SUBTITLES_LIST,e)}},{key:"mediaSubtitlesShowing",get:function(){return Yy(this,Vv.MEDIA_SUBTITLES_SHOWING)},set:function(e){jy(this,Vv.MEDIA_SUBTITLES_SHOWING,e)}},{key:"handleClick",value:function(){this.dispatchEvent(new Sm.CustomEvent(Bv.MEDIA_TOGGLE_SUBTITLES_REQUEST,{composed:!0,bubbles:!0}))}}],[{key:"observedAttributes",get:function(){return[].concat((0,f.A)((0,u.A)((0,c.A)(n),"observedAttributes",this)),[Vv.MEDIA_SUBTITLES_LIST,Vv.MEDIA_SUBTITLES_SHOWING])}}]),n}(Hy);qy.getSlotTemplateHTML=function(e){return'\n    <style>\n      :host([aria-checked="true"]) slot[name=off] {\n        display: none !important;\n      }\n\n      '.concat('\n      :host(:not([aria-checked="true"])) slot[name=on] {\n        display: none !important;\n      }\n\n      :host([aria-checked="true"]) slot[name=tooltip-enable],\n      :host(:not([aria-checked="true"])) slot[name=tooltip-disable] {\n        display: none;\n      }\n    </style>\n\n    <slot name="icon">\n      <slot name="on">','<svg aria-hidden="true" viewBox="0 0 26 24">\n  <path d="M22.83 5.68a2.58 2.58 0 0 0-2.3-2.5c-3.62-.24-11.44-.24-15.06 0a2.58 2.58 0 0 0-2.3 2.5c-.23 4.21-.23 8.43 0 12.64a2.58 2.58 0 0 0 2.3 2.5c3.62.24 11.44.24 15.06 0a2.58 2.58 0 0 0 2.3-2.5c.23-4.21.23-8.43 0-12.64Zm-11.39 9.45a3.07 3.07 0 0 1-1.91.57 3.06 3.06 0 0 1-2.34-1 3.75 3.75 0 0 1-.92-2.67 3.92 3.92 0 0 1 .92-2.77 3.18 3.18 0 0 1 2.43-1 2.94 2.94 0 0 1 2.13.78c.364.359.62.813.74 1.31l-1.43.35a1.49 1.49 0 0 0-1.51-1.17 1.61 1.61 0 0 0-1.29.58 2.79 2.79 0 0 0-.5 1.89 3 3 0 0 0 .49 1.93 1.61 1.61 0 0 0 1.27.58 1.48 1.48 0 0 0 1-.37 2.1 2.1 0 0 0 .59-1.14l1.4.44a3.23 3.23 0 0 1-1.07 1.69Zm7.22 0a3.07 3.07 0 0 1-1.91.57 3.06 3.06 0 0 1-2.34-1 3.75 3.75 0 0 1-.92-2.67 3.88 3.88 0 0 1 .93-2.77 3.14 3.14 0 0 1 2.42-1 3 3 0 0 1 2.16.82 2.8 2.8 0 0 1 .73 1.31l-1.43.35a1.49 1.49 0 0 0-1.51-1.21 1.61 1.61 0 0 0-1.29.58A2.79 2.79 0 0 0 15 12a3 3 0 0 0 .49 1.93 1.61 1.61 0 0 0 1.27.58 1.44 1.44 0 0 0 1-.37 2.1 2.1 0 0 0 .6-1.15l1.4.44a3.17 3.17 0 0 1-1.1 1.7Z"/>\n</svg>','</slot>\n      <slot name="off">').concat('<svg aria-hidden="true" viewBox="0 0 26 24">\n  <path d="M17.73 14.09a1.4 1.4 0 0 1-1 .37 1.579 1.579 0 0 1-1.27-.58A3 3 0 0 1 15 12a2.8 2.8 0 0 1 .5-1.85 1.63 1.63 0 0 1 1.29-.57 1.47 1.47 0 0 1 1.51 1.2l1.43-.34A2.89 2.89 0 0 0 19 9.07a3 3 0 0 0-2.14-.78 3.14 3.14 0 0 0-2.42 1 3.91 3.91 0 0 0-.93 2.78 3.74 3.74 0 0 0 .92 2.66 3.07 3.07 0 0 0 2.34 1 3.07 3.07 0 0 0 1.91-.57 3.17 3.17 0 0 0 1.07-1.74l-1.4-.45c-.083.43-.3.822-.62 1.12Zm-7.22 0a1.43 1.43 0 0 1-1 .37 1.58 1.58 0 0 1-1.27-.58A3 3 0 0 1 7.76 12a2.8 2.8 0 0 1 .5-1.85 1.63 1.63 0 0 1 1.29-.57 1.47 1.47 0 0 1 1.51 1.2l1.43-.34a2.81 2.81 0 0 0-.74-1.32 2.94 2.94 0 0 0-2.13-.78 3.18 3.18 0 0 0-2.43 1 4 4 0 0 0-.92 2.78 3.74 3.74 0 0 0 .92 2.66 3.07 3.07 0 0 0 2.34 1 3.07 3.07 0 0 0 1.91-.57 3.23 3.23 0 0 0 1.07-1.74l-1.4-.45a2.06 2.06 0 0 1-.6 1.07Zm12.32-8.41a2.59 2.59 0 0 0-2.3-2.51C18.72 3.05 15.86 3 13 3c-2.86 0-5.72.05-7.53.17a2.59 2.59 0 0 0-2.3 2.51c-.23 4.207-.23 8.423 0 12.63a2.57 2.57 0 0 0 2.3 2.5c1.81.13 4.67.19 7.53.19 2.86 0 5.72-.06 7.53-.19a2.57 2.57 0 0 0 2.3-2.5c.23-4.207.23-8.423 0-12.63Zm-1.49 12.53a1.11 1.11 0 0 1-.91 1.11c-1.67.11-4.45.18-7.43.18-2.98 0-5.76-.07-7.43-.18a1.11 1.11 0 0 1-.91-1.11c-.21-4.14-.21-8.29 0-12.43a1.11 1.11 0 0 1 .91-1.11C7.24 4.56 10 4.49 13 4.49s5.76.07 7.43.18a1.11 1.11 0 0 1 .91 1.11c.21 4.14.21 8.29 0 12.43Z"/>\n</svg>',"</slot>\n    </slot>\n  ")},qy.getTooltipContentHTML=function(){return'\n    <slot name="tooltip-enable">'.concat(gm("Enable captions"),'</slot>\n    <slot name="tooltip-disable">').concat(gm("Disable captions"),"</slot>\n  ")};var Yy=function(e,t){var n=e.getAttribute(t);return n?rg(n):[]},jy=function(e,t,n){if(null==n?void 0:n.length){var i=lg(n);e.getAttribute(t)!==i&&e.setAttribute(t,i)}else e.removeAttribute(t)};Sm.customElements.get("media-captions-button")||Sm.customElements.define("media-captions-button",qy);var zy=function(e){var t=e.mediaIsCasting?gm("stop casting"):gm("start casting");e.setAttribute("aria-label",t)},Xy=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){return(0,m.A)(this,n),t.apply(this,arguments)}return(0,v.A)(n,[{key:"connectedCallback",value:function(){(0,u.A)((0,c.A)(n.prototype),"connectedCallback",this).call(this),zy(this)}},{key:"attributeChangedCallback",value:function(e,t,i){(0,u.A)((0,c.A)(n.prototype),"attributeChangedCallback",this).call(this,e,t,i),e===Vv.MEDIA_IS_CASTING&&zy(this)}},{key:"mediaIsCasting",get:function(){return Ym(this,Vv.MEDIA_IS_CASTING)},set:function(e){jm(this,Vv.MEDIA_IS_CASTING,e)}},{key:"mediaCastUnavailable",get:function(){return zm(this,Vv.MEDIA_CAST_UNAVAILABLE)},set:function(e){Xm(this,Vv.MEDIA_CAST_UNAVAILABLE,e)}},{key:"handleClick",value:function(){var e=this.mediaIsCasting?Bv.MEDIA_EXIT_CAST_REQUEST:Bv.MEDIA_ENTER_CAST_REQUEST;this.dispatchEvent(new Sm.CustomEvent(e,{composed:!0,bubbles:!0}))}}],[{key:"observedAttributes",get:function(){return[].concat((0,f.A)((0,u.A)((0,c.A)(n),"observedAttributes",this)),[Vv.MEDIA_IS_CASTING,Vv.MEDIA_CAST_UNAVAILABLE])}}]),n}(Hy);Xy.getSlotTemplateHTML=function(e){return"\n    <style>\n      :host([".concat(Vv.MEDIA_IS_CASTING,"]) slot[name=icon] slot:not([name=exit]) {\n        display: none !important;\n      }\n\n      ","\n      :host(:not([").concat(Vv.MEDIA_IS_CASTING,"])) slot[name=icon] slot:not([name=enter]) {\n        display: none !important;\n      }\n\n      :host([").concat(Vv.MEDIA_IS_CASTING,"]) slot[name=tooltip-enter],\n      :host(:not([").concat(Vv.MEDIA_IS_CASTING,'])) slot[name=tooltip-exit] {\n        display: none;\n      }\n    </style>\n\n    <slot name="icon">\n      <slot name="enter">').concat('<svg aria-hidden="true" viewBox="0 0 24 24"><g><path class="cast_caf_icon_arch0" d="M1,18 L1,21 L4,21 C4,19.3 2.66,18 1,18 L1,18 Z"/><path class="cast_caf_icon_arch1" d="M1,14 L1,16 C3.76,16 6,18.2 6,21 L8,21 C8,17.13 4.87,14 1,14 L1,14 Z"/><path class="cast_caf_icon_arch2" d="M1,10 L1,12 C5.97,12 10,16.0 10,21 L12,21 C12,14.92 7.07,10 1,10 L1,10 Z"/><path class="cast_caf_icon_box" d="M21,3 L3,3 C1.9,3 1,3.9 1,5 L1,8 L3,8 L3,5 L21,5 L21,19 L14,19 L14,21 L21,21 C22.1,21 23,20.1 23,19 L23,5 C23,3.9 22.1,3 21,3 L21,3 Z"/></g></svg>','</slot>\n      <slot name="exit">').concat('<svg aria-hidden="true" viewBox="0 0 24 24"><g><path class="cast_caf_icon_arch0" d="M1,18 L1,21 L4,21 C4,19.3 2.66,18 1,18 L1,18 Z"/><path class="cast_caf_icon_arch1" d="M1,14 L1,16 C3.76,16 6,18.2 6,21 L8,21 C8,17.13 4.87,14 1,14 L1,14 Z"/><path class="cast_caf_icon_arch2" d="M1,10 L1,12 C5.97,12 10,16.0 10,21 L12,21 C12,14.92 7.07,10 1,10 L1,10 Z"/><path class="cast_caf_icon_box" d="M21,3 L3,3 C1.9,3 1,3.9 1,5 L1,8 L3,8 L3,5 L21,5 L21,19 L14,19 L14,21 L21,21 C22.1,21 23,20.1 23,19 L23,5 C23,3.9 22.1,3 21,3 L21,3 Z"/><path class="cast_caf_icon_boxfill" d="M5,7 L5,8.63 C8,8.6 13.37,14 13.37,17 L19,17 L19,7 Z"/></g></svg>',"</slot>\n    </slot>\n  ")},Xy.getTooltipContentHTML=function(){return'\n    <slot name="tooltip-enter">'.concat(gm("Start casting"),'</slot>\n    <slot name="tooltip-exit">').concat(gm("Stop casting"),"</slot>\n  ")},Sm.customElements.get("media-cast-button")||Sm.customElements.define("media-cast-button",Xy);var Qy,Zy,Jy,$y,eE,tE,nE,iE,aE,rE,oE,sE,lE,uE,cE,dE=function(e,t,n){if(!t.has(e))throw TypeError("Cannot "+n)},hE=function(e,t,n){return dE(e,t,"read from private field"),n?n.call(e):t.get(e)},fE=function(e,t,n){if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},vE=function(e,t,n,i){return dE(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n},mE=function(e,t,n){return dE(e,t,"access private method"),n};var pE="open",gE="anchor",yE=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){var e;return(0,m.A)(this,n),e=t.call(this),fE((0,Ln.A)(e),$y),fE((0,Ln.A)(e),tE),fE((0,Ln.A)(e),iE),fE((0,Ln.A)(e),rE),fE((0,Ln.A)(e),sE),fE((0,Ln.A)(e),uE),fE((0,Ln.A)(e),Qy,!1),fE((0,Ln.A)(e),Zy,null),fE((0,Ln.A)(e),Jy,null),e.addEventListener("invoke",(0,Ln.A)(e)),e.addEventListener("focusout",(0,Ln.A)(e)),e.addEventListener("keydown",(0,Ln.A)(e)),e}return(0,v.A)(n,[{key:"open",get:function(){return Ym(this,pE)},set:function(e){jm(this,pE,e)}},{key:"handleEvent",value:function(e){switch(e.type){case"invoke":mE(this,rE,oE).call(this,e);break;case"focusout":mE(this,sE,lE).call(this,e);break;case"keydown":mE(this,uE,cE).call(this,e)}}},{key:"connectedCallback",value:function(){mE(this,$y,eE).call(this),this.role||(this.role="dialog")}},{key:"attributeChangedCallback",value:function(e,t,n){mE(this,$y,eE).call(this),e===pE&&n!==t&&(this.open?mE(this,tE,nE).call(this):mE(this,iE,aE).call(this))}},{key:"focus",value:function(){vE(this,Zy,Bm());var e=!this.dispatchEvent(new Event("focus",{composed:!0,cancelable:!0})),t=!this.dispatchEvent(new Event("focusin",{composed:!0,bubbles:!0,cancelable:!0}));if(!e&&!t){var n=this.querySelector('[autofocus], [tabindex]:not([tabindex="-1"]), [role="menu"]');null==n||n.focus()}}},{key:"keysUsed",get:function(){return["Escape","Tab"]}}],[{key:"observedAttributes",get:function(){return[pE,gE]}}]),n}(Sm.HTMLElement);Qy=new WeakMap,Zy=new WeakMap,Jy=new WeakMap,$y=new WeakSet,eE=function(){var e=this;if(!hE(this,Qy)&&(vE(this,Qy,!0),!this.shadowRoot)){this.attachShadow(this.constructor.shadowRootOptions);var t=xm(this.attributes);this.shadowRoot.innerHTML=this.constructor.getTemplateHTML(t),queueMicrotask((function(){Km(e.shadowRoot,":host").style.setProperty("transition","display .15s, visibility .15s, opacity .15s ease-in, transform .15s ease-in")}))}},tE=new WeakSet,nE=function(){var e,t=this;null==(e=hE(this,Jy))||e.setAttribute("aria-expanded","true"),this.dispatchEvent(new Event("open",{composed:!0,bubbles:!0})),this.addEventListener("transitionend",(function(){return t.focus()}),{once:!0})},iE=new WeakSet,aE=function(){var e;null==(e=hE(this,Jy))||e.setAttribute("aria-expanded","false"),this.dispatchEvent(new Event("close",{composed:!0,bubbles:!0}))},rE=new WeakSet,oE=function(e){vE(this,Jy,e.relatedTarget),Um(this,e.relatedTarget)||(this.open=!this.open)},sE=new WeakSet,lE=function(e){var t;Um(this,e.relatedTarget)||(null==(t=hE(this,Zy))||t.focus(),hE(this,Jy)&&hE(this,Jy)!==e.relatedTarget&&this.open&&(this.open=!1))},uE=new WeakSet,cE=function(e){var t,n,i,a,r,o=e.key,s=e.ctrlKey,l=e.altKey,u=e.metaKey;s||l||u||this.keysUsed.includes(o)&&(e.preventDefault(),e.stopPropagation(),"Tab"===o?(e.shiftKey?null==(n=null==(t=this.previousElementSibling)?void 0:t.focus)||n.call(t):null==(a=null==(i=this.nextElementSibling)?void 0:i.focus)||a.call(i),this.blur()):"Escape"===o&&(null==(r=hE(this,Zy))||r.focus(),this.open=!1))},yE.shadowRootOptions={mode:"open"},yE.getTemplateHTML=function(e){return"\n    <style>\n      :host {\n        font: var(--media-font,\n          var(--media-font-weight, normal)\n          var(--media-font-size, 14px) /\n          var(--media-text-content-height, var(--media-control-height, 24px))\n          var(--media-font-family, helvetica neue, segoe ui, roboto, arial, sans-serif));\n        color: var(--media-text-color, var(--media-primary-color, rgb(238 238 238)));\n        display: var(--media-dialog-display, inline-flex);\n        justify-content: center;\n        align-items: center;\n        ".concat("\n        transition-behavior: allow-discrete;\n        visibility: hidden;\n        opacity: 0;\n        transform: translateY(2px) scale(.99);\n        pointer-events: none;\n      }\n\n      :host([open]) {\n        transition: display .2s, visibility 0s, opacity .2s ease-out, transform .15s ease-out;\n        visibility: visible;\n        opacity: 1;\n        transform: translateY(0) scale(1);\n        pointer-events: auto;\n      }\n\n      #content {\n        display: flex;\n        position: relative;\n        box-sizing: border-box;\n        width: min(320px, 100%);\n        word-wrap: break-word;\n        max-height: 100%;\n        overflow: auto;\n        text-align: center;\n        line-height: 1.4;\n      }\n    </style>\n    ",this.getSlotTemplateHTML(e),"\n  ")},yE.getSlotTemplateHTML=function(e){return'\n    <slot id="content"></slot>\n  '},Sm.customElements.get("media-chrome-dialog")||Sm.customElements.define("media-chrome-dialog",yE);var EE,AE,bE,kE,TE,_E,SE,wE,RE,LE,IE,DE,CE,xE,ME,OE,PE,NE,UE,FE,BE,HE,GE,KE,WE,VE=function(e,t,n){if(!t.has(e))throw TypeError("Cannot "+n)},qE=function(e,t,n){return VE(e,t,"read from private field"),n?n.call(e):t.get(e)},YE=function(e,t,n){if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},jE=function(e,t,n,i){return VE(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n},zE=function(e,t,n){return VE(e,t,"access private method"),n};var XE=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){var e;if((0,m.A)(this,n),e=t.call(this),YE((0,Ln.A)(e),LE),YE((0,Ln.A)(e),DE),YE((0,Ln.A)(e),xE),YE((0,Ln.A)(e),OE),YE((0,Ln.A)(e),NE),YE((0,Ln.A)(e),FE),YE((0,Ln.A)(e),HE),YE((0,Ln.A)(e),KE),YE((0,Ln.A)(e),EE,void 0),YE((0,Ln.A)(e),AE,void 0),YE((0,Ln.A)(e),bE,void 0),YE((0,Ln.A)(e),kE,void 0),YE((0,Ln.A)(e),TE,{}),YE((0,Ln.A)(e),_E,[]),YE((0,Ln.A)(e),SE,(function(){e.range.matches(":focus-visible")&&Km(e.shadowRoot,":host").style.setProperty("--_focus-visible-box-shadow","var(--_focus-box-shadow)")})),YE((0,Ln.A)(e),wE,(function(){Km(e.shadowRoot,":host").style.removeProperty("--_focus-visible-box-shadow")})),YE((0,Ln.A)(e),RE,(function(){var t=e.shadowRoot.querySelector("#segments-clipping");t&&t.parentNode.append(t)})),!e.shadowRoot){e.attachShadow(e.constructor.shadowRootOptions);var i=xm(e.attributes),a=e.constructor.getTemplateHTML(i);e.shadowRoot.setHTMLUnsafe?e.shadowRoot.setHTMLUnsafe(a):e.shadowRoot.innerHTML=a}return e.container=e.shadowRoot.querySelector("#container"),jE((0,Ln.A)(e),bE,e.shadowRoot.querySelector("#startpoint")),jE((0,Ln.A)(e),kE,e.shadowRoot.querySelector("#endpoint")),e.range=e.shadowRoot.querySelector("#range"),e.appearance=e.shadowRoot.querySelector("#appearance"),e}return(0,v.A)(n,[{key:"attributeChangedCallback",value:function(e,t,n){var i,a,r,o,s;e===Gv?(t&&(null==(a=null==(i=qE(this,EE))?void 0:i.unassociateElement)||a.call(i,this),jE(this,EE,null)),n&&this.isConnected&&(jE(this,EE,null==(r=this.getRootNode())?void 0:r.getElementById(n)),null==(s=null==(o=qE(this,EE))?void 0:o.associateElement)||s.call(o,this))):("disabled"===e||"aria-disabled"===e&&t!==n)&&(null==n?(this.range.removeAttribute(e),zE(this,DE,CE).call(this)):(this.range.setAttribute(e,n),zE(this,xE,ME).call(this)))}},{key:"connectedCallback",value:function(){var e,t,n;Km(this.shadowRoot,":host").style.setProperty("display","var(--media-control-display, var(--".concat(this.localName,"-display, inline-flex))")),qE(this,TE).pointer=Km(this.shadowRoot,"#pointer"),qE(this,TE).progress=Km(this.shadowRoot,"#progress"),qE(this,TE).thumb=Km(this.shadowRoot,'#thumb, ::slotted([slot="thumb"])'),qE(this,TE).activeSegment=Km(this.shadowRoot,"#segments-clipping rect:nth-child(0)");var i=this.getAttribute(Gv);i&&(jE(this,EE,null==(e=this.getRootNode())?void 0:e.getElementById(i)),null==(n=null==(t=qE(this,EE))?void 0:t.associateElement)||n.call(t,this)),this.updateBar(),this.shadowRoot.addEventListener("focusin",qE(this,SE)),this.shadowRoot.addEventListener("focusout",qE(this,wE)),zE(this,DE,CE).call(this),Dm(this.container,qE(this,RE))}},{key:"disconnectedCallback",value:function(){var e,t;zE(this,xE,ME).call(this),null==(t=null==(e=qE(this,EE))?void 0:e.unassociateElement)||t.call(e,this),jE(this,EE,null),this.shadowRoot.removeEventListener("focusin",qE(this,SE)),this.shadowRoot.removeEventListener("focusout",qE(this,wE)),Cm(this.container,qE(this,RE))}},{key:"updatePointerBar",value:function(e){var t;null==(t=qE(this,TE).pointer)||t.style.setProperty("width","".concat(100*this.getPointerRatio(e),"%"))}},{key:"updateBar",value:function(){var e,t,n=100*this.range.valueAsNumber;null==(e=qE(this,TE).progress)||e.style.setProperty("width","".concat(n,"%")),null==(t=qE(this,TE).thumb)||t.style.setProperty("left","".concat(n,"%"))}},{key:"updateSegments",value:function(e){var t=this.shadowRoot.querySelector("#segments-clipping");if(t.textContent="",this.container.classList.toggle("segments",!!(null==e?void 0:e.length)),null==e?void 0:e.length){var n=(0,f.A)(new Set([+this.range.min].concat((0,f.A)(e.flatMap((function(e){return[e.start,e.end]}))),[+this.range.max])));jE(this,_E,(0,f.A)(n));var i,r=n.pop(),o=(0,h.A)(n.entries());try{for(o.s();!(i=o.n()).done;){var s=(0,a.A)(i.value,2),l=s[0],u=s[1],c=0===l,d=l===n.length-1,v=c?"calc(var(--segments-gap) / -1)":"".concat(100*u,"%"),m=d?r:n[l+1],p="calc(".concat(100*(m-u),"%").concat(c||d?"":" - var(--segments-gap)",")"),g=wm.createElementNS("http://www.w3.org/2000/svg","rect"),y=Km(this.shadowRoot,"#segments-clipping rect:nth-child(".concat(l+1,")"));y.style.setProperty("x",v),y.style.setProperty("width",p),t.append(g)}}catch(BL){o.e(BL)}finally{o.f()}}}},{key:"getPointerRatio",value:function(e){return function(e,t,n,i){var a=i.x-n.x,r=i.y-n.y,o=a*a+r*r;if(0===o)return 0;var s=((e-n.x)*a+(t-n.y)*r)/o;return Math.max(0,Math.min(1,s))}(e.clientX,e.clientY,qE(this,bE).getBoundingClientRect(),qE(this,kE).getBoundingClientRect())}},{key:"dragging",get:function(){return this.hasAttribute("dragging")}},{key:"handleEvent",value:function(e){switch(e.type){case"pointermove":zE(this,KE,WE).call(this,e);break;case"input":this.updateBar();break;case"pointerenter":zE(this,NE,UE).call(this,e);break;case"pointerdown":zE(this,OE,PE).call(this,e);break;case"pointerup":zE(this,FE,BE).call(this);break;case"pointerleave":zE(this,HE,GE).call(this)}}},{key:"keysUsed",get:function(){return["ArrowUp","ArrowRight","ArrowDown","ArrowLeft"]}}],[{key:"observedAttributes",get:function(){return["disabled","aria-disabled",Gv]}}]),n}(Sm.HTMLElement);EE=new WeakMap,AE=new WeakMap,bE=new WeakMap,kE=new WeakMap,TE=new WeakMap,_E=new WeakMap,SE=new WeakMap,wE=new WeakMap,RE=new WeakMap,LE=new WeakSet,IE=function(e){var t=qE(this,TE).activeSegment;if(t){var n=this.getPointerRatio(e),i=qE(this,_E).findIndex((function(e,t,i){var a=i[t+1];return null!=a&&n>=e&&n<=a})),a="#segments-clipping rect:nth-child(".concat(i+1,")");t.selectorText==a&&t.style.transform||(t.selectorText=a,t.style.setProperty("transform","var(--media-range-segment-hover-transform, scaleY(2))"))}},DE=new WeakSet,CE=function(){this.hasAttribute("disabled")||(this.addEventListener("input",this),this.addEventListener("pointerdown",this),this.addEventListener("pointerenter",this))},xE=new WeakSet,ME=function(){var e,t;this.removeEventListener("input",this),this.removeEventListener("pointerdown",this),this.removeEventListener("pointerenter",this),null==(e=Sm.window)||e.removeEventListener("pointerup",this),null==(t=Sm.window)||t.removeEventListener("pointermove",this)},OE=new WeakSet,PE=function(e){var t;jE(this,AE,e.composedPath().includes(this.range)),null==(t=Sm.window)||t.addEventListener("pointerup",this)},NE=new WeakSet,UE=function(e){var t;"mouse"!==e.pointerType&&zE(this,OE,PE).call(this,e),this.addEventListener("pointerleave",this),null==(t=Sm.window)||t.addEventListener("pointermove",this)},FE=new WeakSet,BE=function(){var e;null==(e=Sm.window)||e.removeEventListener("pointerup",this),this.toggleAttribute("dragging",!1),this.range.disabled=this.hasAttribute("disabled")},HE=new WeakSet,GE=function(){var e,t;this.removeEventListener("pointerleave",this),null==(e=Sm.window)||e.removeEventListener("pointermove",this),this.toggleAttribute("dragging",!1),this.range.disabled=this.hasAttribute("disabled"),null==(t=qE(this,TE).activeSegment)||t.style.removeProperty("transform")},KE=new WeakSet,WE=function(e){this.toggleAttribute("dragging",1===e.buttons||"mouse"!==e.pointerType),this.updatePointerBar(e),zE(this,LE,IE).call(this,e),!this.dragging||"mouse"===e.pointerType&&qE(this,AE)||(this.range.disabled=!0,this.range.valueAsNumber=this.getPointerRatio(e),this.range.dispatchEvent(new Event("input",{bubbles:!0,composed:!0})))},XE.shadowRootOptions={mode:"open"},XE.getTemplateHTML=function(e){return"\n    <style>\n      :host {\n        --_focus-box-shadow: var(--media-focus-box-shadow, inset 0 0 0 2px rgb(27 127 204 / .9));\n        --_media-range-padding: var(--media-range-padding, var(--media-control-padding, 10px));\n\n        box-shadow: var(--_focus-visible-box-shadow, none);\n        background: var(--media-control-background, var(--media-secondary-color, rgb(20 20 30 / .7)));\n        height: calc(var(--media-control-height, 24px) + 2 * var(--_media-range-padding));\n        display: inline-flex;\n        align-items: center;\n        ".concat("\n        vertical-align: middle;\n        box-sizing: border-box;\n        position: relative;\n        width: 100px;\n        transition: background .15s linear;\n        cursor: var(--media-cursor, pointer);\n        pointer-events: auto;\n        touch-action: none; ","\n      }\n\n      ","\n      input[type=range]:focus {\n        outline: 0;\n      }\n      input[type=range]:focus::-webkit-slider-runnable-track {\n        outline: 0;\n      }\n\n      :host(:hover) {\n        background: var(--media-control-hover-background, rgb(50 50 70 / .7));\n      }\n\n      #leftgap {\n        padding-left: var(--media-range-padding-left, var(--_media-range-padding));\n      }\n\n      #rightgap {\n        padding-right: var(--media-range-padding-right, var(--_media-range-padding));\n      }\n\n      #startpoint,\n      #endpoint {\n        position: absolute;\n      }\n\n      #endpoint {\n        right: 0;\n      }\n\n      #container {\n        ","\n        width: var(--media-range-track-width, 100%);\n        transform: translate(var(--media-range-track-translate-x, 0px), var(--media-range-track-translate-y, 0px));\n        position: relative;\n        height: 100%;\n        display: flex;\n        align-items: center;\n        min-width: 40px;\n      }\n\n      #range {\n        ","\n        display: var(--media-time-range-hover-display, block);\n        bottom: var(--media-time-range-hover-bottom, -7px);\n        height: var(--media-time-range-hover-height, max(100% + 7px, 25px));\n        width: 100%;\n        position: absolute;\n        cursor: var(--media-cursor, pointer);\n\n        -webkit-appearance: none; ","\n        -webkit-tap-highlight-color: transparent;\n        background: transparent; ","\n        margin: 0;\n        z-index: 1;\n      }\n\n      @media (hover: hover) {\n        #range {\n          bottom: var(--media-time-range-hover-bottom, -5px);\n          height: var(--media-time-range-hover-height, max(100% + 5px, 20px));\n        }\n      }\n\n      ","\n      ","\n      #range::-webkit-slider-thumb {\n        -webkit-appearance: none;\n        background: transparent;\n        width: .1px;\n        height: .1px;\n      }\n\n      ","\n      #range::-moz-range-thumb {\n        background: transparent;\n        border: transparent;\n        width: .1px;\n        height: .1px;\n      }\n\n      #appearance {\n        height: var(--media-range-track-height, 4px);\n        display: flex;\n        flex-direction: column;\n        justify-content: center;\n        width: 100%;\n        position: absolute;\n        ",'\n        will-change: transform;\n      }\n\n      #track {\n        background: var(--media-range-track-background, rgb(255 255 255 / .2));\n        border-radius: var(--media-range-track-border-radius, 1px);\n        border: var(--media-range-track-border, none);\n        outline: var(--media-range-track-outline);\n        outline-offset: var(--media-range-track-outline-offset);\n        backdrop-filter: var(--media-range-track-backdrop-filter);\n        -webkit-backdrop-filter: var(--media-range-track-backdrop-filter);\n        box-shadow: var(--media-range-track-box-shadow, none);\n        position: absolute;\n        width: 100%;\n        height: 100%;\n        overflow: hidden;\n      }\n\n      #progress,\n      #pointer {\n        position: absolute;\n        height: 100%;\n        will-change: width;\n      }\n\n      #progress {\n        background: var(--media-range-bar-color, var(--media-primary-color, rgb(238 238 238)));\n        transition: var(--media-range-track-transition);\n      }\n\n      #pointer {\n        background: var(--media-range-track-pointer-background);\n        border-right: var(--media-range-track-pointer-border-right);\n        transition: visibility .25s, opacity .25s;\n        visibility: hidden;\n        opacity: 0;\n      }\n\n      @media (hover: hover) {\n        :host(:hover) #pointer {\n          transition: visibility .5s, opacity .5s;\n          visibility: visible;\n          opacity: 1;\n        }\n      }\n\n      #thumb,\n      ::slotted([slot=thumb]) {\n        width: var(--media-range-thumb-width, 10px);\n        height: var(--media-range-thumb-height, 10px);\n        transition: var(--media-range-thumb-transition);\n        transform: var(--media-range-thumb-transform, none);\n        opacity: var(--media-range-thumb-opacity, 1);\n        translate: -50%;\n        position: absolute;\n        left: 0;\n        cursor: var(--media-cursor, pointer);\n      }\n\n      #thumb {\n        border-radius: var(--media-range-thumb-border-radius, 10px);\n        background: var(--media-range-thumb-background, var(--media-primary-color, rgb(238 238 238)));\n        box-shadow: var(--media-range-thumb-box-shadow, 1px 1px 1px transparent);\n        border: var(--media-range-thumb-border, none);\n      }\n\n      :host([disabled]) #thumb {\n        background-color: #777;\n      }\n\n      .segments #appearance {\n        height: var(--media-range-segment-hover-height, 7px);\n      }\n\n      #track {\n        clip-path: url(#segments-clipping);\n      }\n\n      #segments {\n        --segments-gap: var(--media-range-segments-gap, 2px);\n        position: absolute;\n        width: 100%;\n        height: 100%;\n      }\n\n      #segments-clipping {\n        transform: translateX(calc(var(--segments-gap) / 2));\n      }\n\n      #segments-clipping:empty {\n        display: none;\n      }\n\n      #segments-clipping rect {\n        height: var(--media-range-track-height, 4px);\n        y: calc((var(--media-range-segment-hover-height, 7px) - var(--media-range-track-height, 4px)) / 2);\n        transition: var(--media-range-segment-transition, transform .1s ease-in-out);\n        transform: var(--media-range-segment-transform, scaleY(1));\n        transform-origin: center;\n      }\n    </style>\n    <div id="leftgap"></div>\n    <div id="container">\n      <div id="startpoint"></div>\n      <div id="endpoint"></div>\n      <div id="appearance">\n        <div id="track" part="track">\n          <div id="pointer"></div>\n          <div id="progress" part="progress"></div>\n        </div>\n        <slot name="thumb">\n          <div id="thumb" part="thumb"></div>\n        </slot>\n        <svg id="segments"><clipPath id="segments-clipping"></clipPath></svg>\n      </div>\n      <input id="range" type="range" min="0" max="1" step="any" value="0">\n    </div>\n    <div id="rightgap"></div>\n  ')},Sm.customElements.get("media-chrome-range")||Sm.customElements.define("media-chrome-range",XE);var QE,ZE=function(e,t,n){if(!t.has(e))throw TypeError("Cannot "+n)},JE=function(e,t,n){return ZE(e,t,"read from private field"),n?n.call(e):t.get(e)},$E=function(e,t,n,i){return ZE(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n};var eA=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){var e;if((0,m.A)(this,n),e=t.call(this),function(e,t,n){if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)}((0,Ln.A)(e),QE,void 0),!e.shadowRoot){e.attachShadow(e.constructor.shadowRootOptions);var i=xm(e.attributes);e.shadowRoot.innerHTML=e.constructor.getTemplateHTML(i)}return e}return(0,v.A)(n,[{key:"attributeChangedCallback",value:function(e,t,n){var i,a,r,o,s;e===Gv&&(t&&(null==(a=null==(i=JE(this,QE))?void 0:i.unassociateElement)||a.call(i,this),$E(this,QE,null)),n&&this.isConnected&&($E(this,QE,null==(r=this.getRootNode())?void 0:r.getElementById(n)),null==(s=null==(o=JE(this,QE))?void 0:o.associateElement)||s.call(o,this)))}},{key:"connectedCallback",value:function(){var e,t,n,i=this.getAttribute(Gv);i&&($E(this,QE,null==(e=this.getRootNode())?void 0:e.getElementById(i)),null==(n=null==(t=JE(this,QE))?void 0:t.associateElement)||n.call(t,this))}},{key:"disconnectedCallback",value:function(){var e,t;null==(t=null==(e=JE(this,QE))?void 0:e.unassociateElement)||t.call(e,this),$E(this,QE,null)}}],[{key:"observedAttributes",get:function(){return[Gv]}}]),n}(Sm.HTMLElement);QE=new WeakMap,eA.shadowRootOptions={mode:"open"},eA.getTemplateHTML=function(e){return"\n    <style>\n      :host {\n        ".concat('\n        box-sizing: border-box;\n        display: var(--media-control-display, var(--media-control-bar-display, inline-flex));\n        color: var(--media-text-color, var(--media-primary-color, rgb(238 238 238)));\n        --media-loading-indicator-icon-height: 44px;\n      }\n\n      ::slotted(media-time-range),\n      ::slotted(media-volume-range) {\n        min-height: 100%;\n      }\n\n      ::slotted(media-time-range),\n      ::slotted(media-clip-selector) {\n        flex-grow: 1;\n      }\n\n      ::slotted([role="menu"]) {\n        position: absolute;\n      }\n    </style>\n\n    <slot></slot>\n  ')},Sm.customElements.get("media-control-bar")||Sm.customElements.define("media-control-bar",eA);var tA,nA=function(e,t,n){if(!t.has(e))throw TypeError("Cannot "+n)},iA=function(e,t,n){return nA(e,t,"read from private field"),n?n.call(e):t.get(e)},aA=function(e,t,n,i){return nA(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n};var rA=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){var e;if((0,m.A)(this,n),e=t.call(this),function(e,t,n){if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)}((0,Ln.A)(e),tA,void 0),!e.shadowRoot){e.attachShadow(e.constructor.shadowRootOptions);var i=xm(e.attributes);e.shadowRoot.innerHTML=e.constructor.getTemplateHTML(i)}return e}return(0,v.A)(n,[{key:"attributeChangedCallback",value:function(e,t,n){var i,a,r,o,s;e===Gv&&(t&&(null==(a=null==(i=iA(this,tA))?void 0:i.unassociateElement)||a.call(i,this),aA(this,tA,null)),n&&this.isConnected&&(aA(this,tA,null==(r=this.getRootNode())?void 0:r.getElementById(n)),null==(s=null==(o=iA(this,tA))?void 0:o.associateElement)||s.call(o,this)))}},{key:"connectedCallback",value:function(){var e,t,n;Km(this.shadowRoot,":host").style.setProperty("display","var(--media-control-display, var(--".concat(this.localName,"-display, inline-flex))"));var i=this.getAttribute(Gv);i&&(aA(this,tA,null==(e=this.getRootNode())?void 0:e.getElementById(i)),null==(n=null==(t=iA(this,tA))?void 0:t.associateElement)||n.call(t,this))}},{key:"disconnectedCallback",value:function(){var e,t;null==(t=null==(e=iA(this,tA))?void 0:e.unassociateElement)||t.call(e,this),aA(this,tA,null)}}],[{key:"observedAttributes",get:function(){return[Gv]}}]),n}(Sm.HTMLElement);tA=new WeakMap,rA.shadowRootOptions={mode:"open"},rA.getTemplateHTML=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"\n    <style>\n      :host {\n        font: var(--media-font,\n          var(--media-font-weight, normal)\n          var(--media-font-size, 14px) /\n          var(--media-text-content-height, var(--media-control-height, 24px))\n          var(--media-font-family, helvetica neue, segoe ui, roboto, arial, sans-serif));\n        color: var(--media-text-color, var(--media-primary-color, rgb(238 238 238)));\n        background: var(--media-text-background, var(--media-control-background, var(--media-secondary-color, rgb(20 20 30 / .7))));\n        padding: var(--media-control-padding, 10px);\n        display: inline-flex;\n        justify-content: center;\n        align-items: center;\n        vertical-align: middle;\n        box-sizing: border-box;\n        text-align: center;\n        pointer-events: auto;\n      }\n\n      ".concat("\n      :host(:focus-visible) {\n        box-shadow: inset 0 0 0 2px rgb(27 127 204 / .9);\n        outline: 0;\n      }\n\n      ","\n      :host(:where(:focus)) {\n        box-shadow: none;\n        outline: 0;\n      }\n    </style>\n\n    ",this.getSlotTemplateHTML(e,t),"\n  ")},rA.getSlotTemplateHTML=function(e,t){return"\n    <slot></slot>\n  "},Sm.customElements.get("media-text-display")||Sm.customElements.define("media-text-display",rA);var oA,sA=function(e,t,n){if(!t.has(e))throw TypeError("Cannot "+n)},lA=function(e,t,n){return sA(e,t,"read from private field"),n?n.call(e):t.get(e)};var uA=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){var e,i,a,r,o,s;return(0,m.A)(this,n),e=t.call(this),function(e,t,n){if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)}((0,Ln.A)(e),oA,void 0),a=(0,Ln.A)(e),r=oA,o=e.shadowRoot.querySelector("slot"),sA(a,r,"write to private field"),s?s.call(a,o):r.set(a,o),lA((0,Ln.A)(e),oA).textContent=hm(null!=(i=e.mediaDuration)?i:0),e}return(0,v.A)(n,[{key:"attributeChangedCallback",value:function(e,t,i){e===Vv.MEDIA_DURATION&&(lA(this,oA).textContent=hm(+i)),(0,u.A)((0,c.A)(n.prototype),"attributeChangedCallback",this).call(this,e,t,i)}},{key:"mediaDuration",get:function(){return Vm(this,Vv.MEDIA_DURATION)},set:function(e){qm(this,Vv.MEDIA_DURATION,e)}}],[{key:"observedAttributes",get:function(){return[].concat((0,f.A)((0,u.A)((0,c.A)(n),"observedAttributes",this)),[Vv.MEDIA_DURATION])}}]),n}(rA);oA=new WeakMap,uA.getSlotTemplateHTML=function(e,t){return"\n    <slot>".concat(hm(t.mediaDuration),"</slot>\n  ")},Sm.customElements.get("media-duration-display")||Sm.customElements.define("media-duration-display",uA);var cA,dA={2:gm("Network Error"),3:gm("Decode Error"),4:gm("Source Not Supported"),5:gm("Encryption Error")},hA={2:gm("A network error caused the media download to fail."),3:gm("A media error caused playback to be aborted. The media could be corrupt or your browser does not support this format."),4:gm("An unsupported error occurred. The server or network failed, or your browser does not support this format."),5:gm("The media is encrypted and there are no keys to decrypt it.")},fA=function(e){var t,n;return 1===e.code?null:{title:null!=(t=dA[e.code])?t:"Error ".concat(e.code),message:null!=(n=hA[e.code])?n:e.message}},vA=function(e,t,n){if(!t.has(e))throw TypeError("Cannot "+n)},mA=function(e,t,n){if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)};function pA(e){var t,n=null!=(t=fA(e))?t:{},i=n.title,a=n.message,r="";return i&&(r+='<slot name="error-'.concat(e.code,'-title"><h3>').concat(i,"</h3></slot>")),a&&(r+='<slot name="error-'.concat(e.code,'-message"><p>').concat(a,"</p></slot>")),r}var gA=[Vv.MEDIA_ERROR_CODE,Vv.MEDIA_ERROR_MESSAGE],yA=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){var e;return(0,m.A)(this,n),e=t.apply(this,arguments),mA((0,Ln.A)(e),cA,null),e}return(0,v.A)(n,[{key:"formatErrorMessage",value:function(e){return this.constructor.formatErrorMessage(e)}},{key:"attributeChangedCallback",value:function(e,t,i){var a;if((0,u.A)((0,c.A)(n.prototype),"attributeChangedCallback",this).call(this,e,t,i),gA.includes(e)){var r,o=null!=(a=this.mediaError)?a:{code:this.mediaErrorCode,message:this.mediaErrorMessage};this.open=(r=o).code&&null!==fA(r),this.open&&(this.shadowRoot.querySelector("slot").name="error-".concat(this.mediaErrorCode),this.shadowRoot.querySelector("#content").innerHTML=this.formatErrorMessage(o))}}},{key:"mediaError",get:function(){return vA(e=this,t=cA,"read from private field"),n?n.call(e):t.get(e);var e,t,n},set:function(e){!function(e,t,n,i){vA(e,t,"write to private field"),i?i.call(e,n):t.set(e,n)}(this,cA,e)}},{key:"mediaErrorCode",get:function(){return Vm(this,"mediaerrorcode")},set:function(e){qm(this,"mediaerrorcode",e)}},{key:"mediaErrorMessage",get:function(){return zm(this,"mediaerrormessage")},set:function(e){Xm(this,"mediaerrormessage",e)}}],[{key:"observedAttributes",get:function(){return[].concat((0,f.A)((0,u.A)((0,c.A)(n),"observedAttributes",this)),gA)}}]),n}(yE);cA=new WeakMap,yA.getSlotTemplateHTML=function(e){return'\n    <style>\n      :host {\n        background: rgb(20 20 30 / .8);\n      }\n\n      #content {\n        display: block;\n        padding: 1.2em 1.5em;\n      }\n\n      h3,\n      p {\n        margin-block: 0 .3em;\n      }\n    </style>\n    <slot name="error-'.concat(e.mediaerrorcode,'" id="content">\n      ').concat(pA({code:+e.mediaerrorcode,message:e.mediaerrormessage}),"\n    </slot>\n  ")},yA.formatErrorMessage=pA,Sm.customElements.get("media-error-dialog")||Sm.customElements.define("media-error-dialog",yA);var EA=yA;var AA=function(e){var t=e.mediaIsFullscreen?gm("exit fullscreen mode"):gm("enter fullscreen mode");e.setAttribute("aria-label",t)},bA=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){return(0,m.A)(this,n),t.apply(this,arguments)}return(0,v.A)(n,[{key:"connectedCallback",value:function(){(0,u.A)((0,c.A)(n.prototype),"connectedCallback",this).call(this),AA(this)}},{key:"attributeChangedCallback",value:function(e,t,i){(0,u.A)((0,c.A)(n.prototype),"attributeChangedCallback",this).call(this,e,t,i),e===Vv.MEDIA_IS_FULLSCREEN&&AA(this)}},{key:"mediaFullscreenUnavailable",get:function(){return zm(this,Vv.MEDIA_FULLSCREEN_UNAVAILABLE)},set:function(e){Xm(this,Vv.MEDIA_FULLSCREEN_UNAVAILABLE,e)}},{key:"mediaIsFullscreen",get:function(){return Ym(this,Vv.MEDIA_IS_FULLSCREEN)},set:function(e){jm(this,Vv.MEDIA_IS_FULLSCREEN,e)}},{key:"handleClick",value:function(){var e=this.mediaIsFullscreen?Bv.MEDIA_EXIT_FULLSCREEN_REQUEST:Bv.MEDIA_ENTER_FULLSCREEN_REQUEST;this.dispatchEvent(new Sm.CustomEvent(e,{composed:!0,bubbles:!0}))}}],[{key:"observedAttributes",get:function(){return[].concat((0,f.A)((0,u.A)((0,c.A)(n),"observedAttributes",this)),[Vv.MEDIA_IS_FULLSCREEN,Vv.MEDIA_FULLSCREEN_UNAVAILABLE])}}]),n}(Hy);bA.getSlotTemplateHTML=function(e){return"\n    <style>\n      :host([".concat(Vv.MEDIA_IS_FULLSCREEN,"]) slot[name=icon] slot:not([name=exit]) {\n        display: none !important;\n      }\n\n      ","\n      :host(:not([").concat(Vv.MEDIA_IS_FULLSCREEN,"])) slot[name=icon] slot:not([name=enter]) {\n        display: none !important;\n      }\n\n      :host([").concat(Vv.MEDIA_IS_FULLSCREEN,"]) slot[name=tooltip-enter],\n      :host(:not([").concat(Vv.MEDIA_IS_FULLSCREEN,'])) slot[name=tooltip-exit] {\n        display: none;\n      }\n    </style>\n\n    <slot name="icon">\n      <slot name="enter">').concat('<svg aria-hidden="true" viewBox="0 0 26 24">\n  <path d="M16 3v2.5h3.5V9H22V3h-6ZM4 9h2.5V5.5H10V3H4v6Zm15.5 9.5H16V21h6v-6h-2.5v3.5ZM6.5 15H4v6h6v-2.5H6.5V15Z"/>\n</svg>','</slot>\n      <slot name="exit">').concat('<svg aria-hidden="true" viewBox="0 0 26 24">\n  <path d="M18.5 6.5V3H16v6h6V6.5h-3.5ZM16 21h2.5v-3.5H22V15h-6v6ZM4 17.5h3.5V21H10v-6H4v2.5Zm3.5-11H4V9h6V3H7.5v3.5Z"/>\n</svg>',"</slot>\n    </slot>\n  ")},bA.getTooltipContentHTML=function(){return'\n    <slot name="tooltip-enter">'.concat(gm("Enter fullscreen mode"),'</slot>\n    <slot name="tooltip-exit">').concat(gm("Exit fullscreen mode"),"</slot>\n  ")},Sm.customElements.get("media-fullscreen-button")||Sm.customElements.define("media-fullscreen-button",bA);var kA=Vv.MEDIA_TIME_IS_LIVE,TA=Vv.MEDIA_PAUSED,_A=Bv.MEDIA_SEEK_TO_LIVE_REQUEST,SA=Bv.MEDIA_PLAY_REQUEST;var wA=function(e){var t=e.mediaPaused||!e.mediaTimeIsLive,n=gm(t?"seek to live":"playing live");e.setAttribute("aria-label",n),t?e.removeAttribute("aria-disabled"):e.setAttribute("aria-disabled","true")},RA=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){return(0,m.A)(this,n),t.apply(this,arguments)}return(0,v.A)(n,[{key:"connectedCallback",value:function(){(0,u.A)((0,c.A)(n.prototype),"connectedCallback",this).call(this),wA(this)}},{key:"attributeChangedCallback",value:function(e,t,i){(0,u.A)((0,c.A)(n.prototype),"attributeChangedCallback",this).call(this,e,t,i),wA(this)}},{key:"mediaPaused",get:function(){return Ym(this,Vv.MEDIA_PAUSED)},set:function(e){jm(this,Vv.MEDIA_PAUSED,e)}},{key:"mediaTimeIsLive",get:function(){return Ym(this,Vv.MEDIA_TIME_IS_LIVE)},set:function(e){jm(this,Vv.MEDIA_TIME_IS_LIVE,e)}},{key:"handleClick",value:function(){!this.mediaPaused&&this.mediaTimeIsLive||(this.dispatchEvent(new Sm.CustomEvent(_A,{composed:!0,bubbles:!0})),this.hasAttribute(TA)&&this.dispatchEvent(new Sm.CustomEvent(SA,{composed:!0,bubbles:!0})))}}],[{key:"observedAttributes",get:function(){return[].concat((0,f.A)((0,u.A)((0,c.A)(n),"observedAttributes",this)),[kA,TA])}}]),n}(Hy);RA.getSlotTemplateHTML=function(e){return"\n    <style>\n      :host { --media-tooltip-display: none; }\n      \n      slot[name=indicator] > *,\n      :host ::slotted([slot=indicator]) {\n        ".concat("\n        min-width: auto;\n        fill: var(--media-live-button-icon-color, rgb(140, 140, 140));\n        color: var(--media-live-button-icon-color, rgb(140, 140, 140));\n      }\n\n      :host([",kA,"]:not([").concat(TA,"])) slot[name=indicator] > *,\n      :host([").concat(kA,"]:not([").concat(TA,"])) ::slotted([slot=indicator]) {\n        fill: var(--media-live-button-indicator-color, rgb(255, 0, 0));\n        color: var(--media-live-button-indicator-color, rgb(255, 0, 0));\n      }\n\n      :host([").concat(kA,"]:not([").concat(TA,'])) {\n        cursor: var(--media-cursor, not-allowed);\n      }\n\n      slot[name=text]{\n        text-transform: uppercase;\n      }\n\n    </style>\n\n    <slot name="indicator">').concat('<svg viewBox="0 0 6 12"><circle cx="3" cy="6" r="2"></circle></svg>',"</slot>\n    ",'\n    <slot name="spacer">&nbsp;</slot><slot name="text">').concat(gm("live"),"</slot>\n  ")},Sm.customElements.get("media-live-button")||Sm.customElements.define("media-live-button",RA);var LA,IA,DA=function(e,t,n){if(!t.has(e))throw TypeError("Cannot "+n)},CA=function(e,t,n){return DA(e,t,"read from private field"),n?n.call(e):t.get(e)},xA=function(e,t,n){if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},MA=function(e,t,n,i){return DA(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n},OA="loadingdelay",PA="noautohide";var NA=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){var e;if((0,m.A)(this,n),e=t.call(this),xA((0,Ln.A)(e),LA,void 0),xA((0,Ln.A)(e),IA,500),!e.shadowRoot){e.attachShadow(e.constructor.shadowRootOptions);var i=xm(e.attributes);e.shadowRoot.innerHTML=e.constructor.getTemplateHTML(i)}return e}return(0,v.A)(n,[{key:"attributeChangedCallback",value:function(e,t,n){var i,a,r,o,s;e===OA&&t!==n?this.loadingDelay=Number(n):e===Gv&&(t&&(null==(a=null==(i=CA(this,LA))?void 0:i.unassociateElement)||a.call(i,this),MA(this,LA,null)),n&&this.isConnected&&(MA(this,LA,null==(r=this.getRootNode())?void 0:r.getElementById(n)),null==(s=null==(o=CA(this,LA))?void 0:o.associateElement)||s.call(o,this)))}},{key:"connectedCallback",value:function(){var e,t,n,i=this.getAttribute(Gv);i&&(MA(this,LA,null==(e=this.getRootNode())?void 0:e.getElementById(i)),null==(n=null==(t=CA(this,LA))?void 0:t.associateElement)||n.call(t,this))}},{key:"disconnectedCallback",value:function(){var e,t;null==(t=null==(e=CA(this,LA))?void 0:e.unassociateElement)||t.call(e,this),MA(this,LA,null)}},{key:"loadingDelay",get:function(){return CA(this,IA)},set:function(e){MA(this,IA,e),Km(this.shadowRoot,":host").style.setProperty("--_loading-indicator-delay","var(--media-loading-indicator-transition-delay, ".concat(e,"ms)"))}},{key:"mediaPaused",get:function(){return Ym(this,Vv.MEDIA_PAUSED)},set:function(e){jm(this,Vv.MEDIA_PAUSED,e)}},{key:"mediaLoading",get:function(){return Ym(this,Vv.MEDIA_LOADING)},set:function(e){jm(this,Vv.MEDIA_LOADING,e)}},{key:"mediaController",get:function(){return zm(this,Gv)},set:function(e){Xm(this,Gv,e)}},{key:"noAutohide",get:function(){return Ym(this,PA)},set:function(e){jm(this,PA,e)}}],[{key:"observedAttributes",get:function(){return[Gv,Vv.MEDIA_PAUSED,Vv.MEDIA_LOADING,OA]}}]),n}(Sm.HTMLElement);LA=new WeakMap,IA=new WeakMap,NA.shadowRootOptions={mode:"open"},NA.getTemplateHTML=function(e){return"\n    <style>\n      :host {\n        display: var(--media-control-display, var(--media-loading-indicator-display, inline-block));\n        vertical-align: middle;\n        box-sizing: border-box;\n        --_loading-indicator-delay: var(--media-loading-indicator-transition-delay, ".concat(500,"ms);\n      }\n\n      #status {\n        color: rgba(0,0,0,0);\n        width: 0px;\n        height: 0px;\n      }\n\n      :host slot[name=icon] > *,\n      :host ::slotted([slot=icon]) {\n        opacity: var(--media-loading-indicator-opacity, 0);\n        transition: opacity 0.15s;\n      }\n\n      :host([").concat(Vv.MEDIA_LOADING,"]:not([").concat(Vv.MEDIA_PAUSED,"])) slot[name=icon] > *,\n      :host([").concat(Vv.MEDIA_LOADING,"]:not([").concat(Vv.MEDIA_PAUSED,"])) ::slotted([slot=icon]) {\n        opacity: var(--media-loading-indicator-opacity, 1);\n        transition: opacity 0.15s var(--_loading-indicator-delay);\n      }\n\n      :host #status {\n        visibility: var(--media-loading-indicator-opacity, hidden);\n        transition: visibility 0.15s;\n      }\n\n      :host([").concat(Vv.MEDIA_LOADING,"]:not([").concat(Vv.MEDIA_PAUSED,'])) #status {\n        visibility: var(--media-loading-indicator-opacity, visible);\n        transition: visibility 0.15s var(--_loading-indicator-delay);\n      }\n\n      svg, img, ::slotted(svg), ::slotted(img) {\n        width: var(--media-loading-indicator-icon-width);\n        height: var(--media-loading-indicator-icon-height, 100px);\n        fill: var(--media-icon-color, var(--media-primary-color, rgb(238 238 238)));\n        vertical-align: middle;\n      }\n    </style>\n\n    <slot name="icon">').concat('\n<svg aria-hidden="true" viewBox="0 0 100 100">\n  <path d="M73,50c0-12.7-10.3-23-23-23S27,37.3,27,50 M30.9,50c0-10.5,8.5-19.1,19.1-19.1S69.1,39.5,69.1,50">\n    <animateTransform\n       attributeName="transform"\n       attributeType="XML"\n       type="rotate"\n       dur="1s"\n       from="0 50 50"\n       to="360 50 50"\n       repeatCount="indefinite" />\n  </path>\n</svg>\n','</slot>\n    <div id="status" role="status" aria-live="polite">').concat(gm("media loading"),"</div>\n  ")},Sm.customElements.get("media-loading-indicator")||Sm.customElements.define("media-loading-indicator",NA);var UA='<svg aria-hidden="true" viewBox="0 0 24 24">\n  <path d="M3 9v6h4l5 5V4L7 9H3Zm13.5 3A4.5 4.5 0 0 0 14 8v8a4.47 4.47 0 0 0 2.5-4Z"/>\n</svg>';var FA=function(e){var t="off"===e.mediaVolumeLevel,n=gm(t?"unmute":"mute");e.setAttribute("aria-label",n)},BA=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){return(0,m.A)(this,n),t.apply(this,arguments)}return(0,v.A)(n,[{key:"connectedCallback",value:function(){(0,u.A)((0,c.A)(n.prototype),"connectedCallback",this).call(this),FA(this)}},{key:"attributeChangedCallback",value:function(e,t,i){(0,u.A)((0,c.A)(n.prototype),"attributeChangedCallback",this).call(this,e,t,i),e===Vv.MEDIA_VOLUME_LEVEL&&FA(this)}},{key:"mediaVolumeLevel",get:function(){return zm(this,Vv.MEDIA_VOLUME_LEVEL)},set:function(e){Xm(this,Vv.MEDIA_VOLUME_LEVEL,e)}},{key:"handleClick",value:function(){var e="off"===this.mediaVolumeLevel?Bv.MEDIA_UNMUTE_REQUEST:Bv.MEDIA_MUTE_REQUEST;this.dispatchEvent(new Sm.CustomEvent(e,{composed:!0,bubbles:!0}))}}],[{key:"observedAttributes",get:function(){return[].concat((0,f.A)((0,u.A)((0,c.A)(n),"observedAttributes",this)),[Vv.MEDIA_VOLUME_LEVEL])}}]),n}(Hy);BA.getSlotTemplateHTML=function(e){return"\n    <style>\n      :host(:not([".concat(Vv.MEDIA_VOLUME_LEVEL,"])) slot[name=icon] slot:not([name=high]),\n      :host([").concat(Vv.MEDIA_VOLUME_LEVEL,"=high]) slot[name=icon] slot:not([name=high]) {\n        display: none !important;\n      }\n\n      :host([").concat(Vv.MEDIA_VOLUME_LEVEL,"=off]) slot[name=icon] slot:not([name=off]) {\n        display: none !important;\n      }\n\n      :host([").concat(Vv.MEDIA_VOLUME_LEVEL,"=low]) slot[name=icon] slot:not([name=low]) {\n        display: none !important;\n      }\n\n      :host([").concat(Vv.MEDIA_VOLUME_LEVEL,"=medium]) slot[name=icon] slot:not([name=medium]) {\n        display: none !important;\n      }\n\n      :host(:not([").concat(Vv.MEDIA_VOLUME_LEVEL,"=off])) slot[name=tooltip-unmute],\n      :host([").concat(Vv.MEDIA_VOLUME_LEVEL,'=off]) slot[name=tooltip-mute] {\n        display: none;\n      }\n    </style>\n\n    <slot name="icon">\n      <slot name="off">').concat('<svg aria-hidden="true" viewBox="0 0 24 24">\n  <path d="M16.5 12A4.5 4.5 0 0 0 14 8v2.18l2.45 2.45a4.22 4.22 0 0 0 .05-.63Zm2.5 0a6.84 6.84 0 0 1-.54 2.64L20 16.15A8.8 8.8 0 0 0 21 12a9 9 0 0 0-7-8.77v2.06A7 7 0 0 1 19 12ZM4.27 3 3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25A6.92 6.92 0 0 1 14 18.7v2.06A9 9 0 0 0 17.69 19l2 2.05L21 19.73l-9-9L4.27 3ZM12 4 9.91 6.09 12 8.18V4Z"/>\n</svg>','</slot>\n      <slot name="low">').concat(UA,'</slot>\n      <slot name="medium">').concat(UA,'</slot>\n      <slot name="high">').concat('<svg aria-hidden="true" viewBox="0 0 24 24">\n  <path d="M3 9v6h4l5 5V4L7 9H3Zm13.5 3A4.5 4.5 0 0 0 14 8v8a4.47 4.47 0 0 0 2.5-4ZM14 3.23v2.06a7 7 0 0 1 0 13.42v2.06a9 9 0 0 0 0-17.54Z"/>\n</svg>',"</slot>\n    </slot>\n  ")},BA.getTooltipContentHTML=function(){return'\n    <slot name="tooltip-mute">'.concat(gm("Mute"),'</slot>\n    <slot name="tooltip-unmute">').concat(gm("Unmute"),"</slot>\n  ")},Sm.customElements.get("media-mute-button")||Sm.customElements.define("media-mute-button",BA);var HA='<svg aria-hidden="true" viewBox="0 0 28 24">\n  <path d="M24 3H4a1 1 0 0 0-1 1v16a1 1 0 0 0 1 1h20a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1Zm-1 16H5V5h18v14Zm-3-8h-7v5h7v-5Z"/>\n</svg>';var GA=function(e){var t=e.mediaIsPip?gm("exit picture in picture mode"):gm("enter picture in picture mode");e.setAttribute("aria-label",t)},KA=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){return(0,m.A)(this,n),t.apply(this,arguments)}return(0,v.A)(n,[{key:"connectedCallback",value:function(){(0,u.A)((0,c.A)(n.prototype),"connectedCallback",this).call(this),GA(this)}},{key:"attributeChangedCallback",value:function(e,t,i){(0,u.A)((0,c.A)(n.prototype),"attributeChangedCallback",this).call(this,e,t,i),e===Vv.MEDIA_IS_PIP&&GA(this)}},{key:"mediaPipUnavailable",get:function(){return zm(this,Vv.MEDIA_PIP_UNAVAILABLE)},set:function(e){Xm(this,Vv.MEDIA_PIP_UNAVAILABLE,e)}},{key:"mediaIsPip",get:function(){return Ym(this,Vv.MEDIA_IS_PIP)},set:function(e){jm(this,Vv.MEDIA_IS_PIP,e)}},{key:"handleClick",value:function(){var e=this.mediaIsPip?Bv.MEDIA_EXIT_PIP_REQUEST:Bv.MEDIA_ENTER_PIP_REQUEST;this.dispatchEvent(new Sm.CustomEvent(e,{composed:!0,bubbles:!0}))}}],[{key:"observedAttributes",get:function(){return[].concat((0,f.A)((0,u.A)((0,c.A)(n),"observedAttributes",this)),[Vv.MEDIA_IS_PIP,Vv.MEDIA_PIP_UNAVAILABLE])}}]),n}(Hy);KA.getSlotTemplateHTML=function(e){return"\n    <style>\n      :host([".concat(Vv.MEDIA_IS_PIP,"]) slot[name=icon] slot:not([name=exit]) {\n        display: none !important;\n      }\n\n      :host(:not([").concat(Vv.MEDIA_IS_PIP,"])) slot[name=icon] slot:not([name=enter]) {\n        display: none !important;\n      }\n\n      :host([").concat(Vv.MEDIA_IS_PIP,"]) slot[name=tooltip-enter],\n      :host(:not([").concat(Vv.MEDIA_IS_PIP,'])) slot[name=tooltip-exit] {\n        display: none;\n      }\n    </style>\n\n    <slot name="icon">\n      <slot name="enter">').concat(HA,'</slot>\n      <slot name="exit">').concat(HA,"</slot>\n    </slot>\n  ")},KA.getTooltipContentHTML=function(){return'\n    <slot name="tooltip-enter">'.concat(gm("Enter picture in picture mode"),'</slot>\n    <slot name="tooltip-exit">').concat(gm("Exit picture in picture mode"),"</slot>\n  ")},Sm.customElements.get("media-pip-button")||Sm.customElements.define("media-pip-button",KA);var WA,VA=function(e,t,n){return function(e,t,n){if(!t.has(e))throw TypeError("Cannot "+n)}(e,t,"read from private field"),n?n.call(e):t.get(e)},qA="rates",YA=[1,1.2,1.5,1.7,2];var jA=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){var e,i;return(0,m.A)(this,n),e=t.call(this),function(e,t,n){if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)}((0,Ln.A)(e),WA,new Hp((0,Ln.A)(e),qA,{defaultValue:YA})),e.container=e.shadowRoot.querySelector('slot[name="icon"]'),e.container.innerHTML="".concat(null!=(i=e.mediaPlaybackRate)?i:1,"x"),e}return(0,v.A)(n,[{key:"attributeChangedCallback",value:function(e,t,i){if((0,u.A)((0,c.A)(n.prototype),"attributeChangedCallback",this).call(this,e,t,i),e===qA&&(VA(this,WA).value=i),e===Vv.MEDIA_PLAYBACK_RATE){var a=i?+i:Number.NaN,r=Number.isNaN(a)?1:a;this.container.innerHTML="".concat(r,"x"),this.setAttribute("aria-label",gm("Playback rate {playbackRate}",{playbackRate:r}))}}},{key:"rates",get:function(){return VA(this,WA)},set:function(e){e?Array.isArray(e)?VA(this,WA).value=e.join(" "):"string"===typeof e&&(VA(this,WA).value=e):VA(this,WA).value=""}},{key:"mediaPlaybackRate",get:function(){return Vm(this,Vv.MEDIA_PLAYBACK_RATE,1)},set:function(e){qm(this,Vv.MEDIA_PLAYBACK_RATE,e)}},{key:"handleClick",value:function(){var e,t,n=this,i=Array.from(VA(this,WA).values(),(function(e){return+e})).sort((function(e,t){return e-t})),a=null!=(t=null!=(e=i.find((function(e){return e>n.mediaPlaybackRate})))?e:i[0])?t:1,r=new Sm.CustomEvent(Bv.MEDIA_PLAYBACK_RATE_REQUEST,{composed:!0,bubbles:!0,detail:a});this.dispatchEvent(r)}}],[{key:"observedAttributes",get:function(){return[].concat((0,f.A)((0,u.A)((0,c.A)(n),"observedAttributes",this)),[Vv.MEDIA_PLAYBACK_RATE,qA])}}]),n}(Hy);WA=new WeakMap,jA.getSlotTemplateHTML=function(e){return'\n    <style>\n      :host {\n        min-width: 5ch;\n        padding: var(--media-button-padding, var(--media-control-padding, 10px 5px));\n      }\n    </style>\n    <slot name="icon">'.concat(e.mediaplaybackrate||1,"x</slot>\n  ")},jA.getTooltipContentHTML=function(){return gm("Playback rate")},Sm.customElements.get("media-playback-rate-button")||Sm.customElements.define("media-playback-rate-button",jA);var zA=function(e){var t=e.mediaPaused?gm("play"):gm("pause");e.setAttribute("aria-label",t)},XA=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){return(0,m.A)(this,n),t.apply(this,arguments)}return(0,v.A)(n,[{key:"connectedCallback",value:function(){(0,u.A)((0,c.A)(n.prototype),"connectedCallback",this).call(this),zA(this)}},{key:"attributeChangedCallback",value:function(e,t,i){(0,u.A)((0,c.A)(n.prototype),"attributeChangedCallback",this).call(this,e,t,i),e===Vv.MEDIA_PAUSED&&zA(this)}},{key:"mediaPaused",get:function(){return Ym(this,Vv.MEDIA_PAUSED)},set:function(e){jm(this,Vv.MEDIA_PAUSED,e)}},{key:"handleClick",value:function(){var e=this.mediaPaused?Bv.MEDIA_PLAY_REQUEST:Bv.MEDIA_PAUSE_REQUEST;this.dispatchEvent(new Sm.CustomEvent(e,{composed:!0,bubbles:!0}))}}],[{key:"observedAttributes",get:function(){return[].concat((0,f.A)((0,u.A)((0,c.A)(n),"observedAttributes",this)),[Vv.MEDIA_PAUSED,Vv.MEDIA_ENDED])}}]),n}(Hy);XA.getSlotTemplateHTML=function(e){return"\n    <style>\n      :host([".concat(Vv.MEDIA_PAUSED,"]) slot[name=pause],\n      :host(:not([").concat(Vv.MEDIA_PAUSED,"])) slot[name=play] {\n        display: none !important;\n      }\n\n      :host([").concat(Vv.MEDIA_PAUSED,"]) slot[name=tooltip-pause],\n      :host(:not([").concat(Vv.MEDIA_PAUSED,'])) slot[name=tooltip-play] {\n        display: none;\n      }\n    </style>\n\n    <slot name="icon">\n      <slot name="play">').concat('<svg aria-hidden="true" viewBox="0 0 24 24">\n  <path d="m6 21 15-9L6 3v18Z"/>\n</svg>','</slot>\n      <slot name="pause">').concat('<svg aria-hidden="true" viewBox="0 0 24 24">\n  <path d="M6 20h4V4H6v16Zm8-16v16h4V4h-4Z"/>\n</svg>',"</slot>\n    </slot>\n  ")},XA.getTooltipContentHTML=function(){return'\n    <slot name="tooltip-play">'.concat(gm("Play"),'</slot>\n    <slot name="tooltip-pause">').concat(gm("Pause"),"</slot>\n  ")},Sm.customElements.get("media-play-button")||Sm.customElements.define("media-play-button",XA);var QA="placeholdersrc",ZA="src";var JA=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){var e;if((0,m.A)(this,n),!(e=t.call(this)).shadowRoot){e.attachShadow(e.constructor.shadowRootOptions);var i=xm(e.attributes);e.shadowRoot.innerHTML=e.constructor.getTemplateHTML(i)}return e.image=e.shadowRoot.querySelector("#image"),e}return(0,v.A)(n,[{key:"attributeChangedCallback",value:function(e,t,n){e===ZA&&(null==n?this.image.removeAttribute(ZA):this.image.setAttribute(ZA,n)),e===QA&&(null==n?this.image.style.removeProperty("background-image"):function(e,t){e.style["background-image"]="url('".concat(t,"')")}(this.image,n))}},{key:"placeholderSrc",get:function(){return zm(this,QA)},set:function(e){Xm(this,ZA,e)}},{key:"src",get:function(){return zm(this,ZA)},set:function(e){Xm(this,ZA,e)}}],[{key:"observedAttributes",get:function(){return[QA,ZA]}}]),n}(Sm.HTMLElement);JA.shadowRootOptions={mode:"open"},JA.getTemplateHTML=function(e){return'\n    <style>\n      :host {\n        pointer-events: none;\n        display: var(--media-poster-image-display, inline-block);\n        box-sizing: border-box;\n      }\n\n      img {\n        max-width: 100%;\n        max-height: 100%;\n        min-width: 100%;\n        min-height: 100%;\n        background-repeat: no-repeat;\n        background-position: var(--media-poster-image-background-position, var(--media-object-position, center));\n        background-size: var(--media-poster-image-background-size, var(--media-object-fit, contain));\n        object-fit: var(--media-object-fit, contain);\n        object-position: var(--media-object-position, center);\n      }\n    </style>\n\n    <img part="poster img" aria-hidden="true" id="image"/>\n  '},Sm.customElements.get("media-poster-image")||Sm.customElements.define("media-poster-image",JA);var $A,eb=function(e,t,n){if(!t.has(e))throw TypeError("Cannot "+n)},tb=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){var e,i,a,r,o;return(0,m.A)(this,n),e=t.call(this),function(e,t,n){if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)}((0,Ln.A)(e),$A,void 0),i=(0,Ln.A)(e),a=$A,r=e.shadowRoot.querySelector("slot"),eb(i,a,"write to private field"),o?o.call(i,r):a.set(i,r),e}return(0,v.A)(n,[{key:"attributeChangedCallback",value:function(e,t,i){var a,r,o;(0,u.A)((0,c.A)(n.prototype),"attributeChangedCallback",this).call(this,e,t,i),e===Vv.MEDIA_PREVIEW_CHAPTER&&i!==t&&null!=i&&((a=this,r=$A,eb(a,r,"read from private field"),o?o.call(a):r.get(a)).textContent=i,""!==i?this.setAttribute("aria-valuetext","chapter: ".concat(i)):this.removeAttribute("aria-valuetext"))}},{key:"mediaPreviewChapter",get:function(){return zm(this,Vv.MEDIA_PREVIEW_CHAPTER)},set:function(e){Xm(this,Vv.MEDIA_PREVIEW_CHAPTER,e)}}],[{key:"observedAttributes",get:function(){return[].concat((0,f.A)((0,u.A)((0,c.A)(n),"observedAttributes",this)),[Vv.MEDIA_PREVIEW_CHAPTER])}}]),n}(rA);$A=new WeakMap,Sm.customElements.get("media-preview-chapter-display")||Sm.customElements.define("media-preview-chapter-display",tb);var nb,ib=function(e,t,n){if(!t.has(e))throw TypeError("Cannot "+n)},ab=function(e,t,n){return ib(e,t,"read from private field"),n?n.call(e):t.get(e)},rb=function(e,t,n,i){return ib(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n};var ob=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){var e;if((0,m.A)(this,n),e=t.call(this),function(e,t,n){if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)}((0,Ln.A)(e),nb,void 0),!e.shadowRoot){e.attachShadow(e.constructor.shadowRootOptions);var i=xm(e.attributes);e.shadowRoot.innerHTML=e.constructor.getTemplateHTML(i)}return e}return(0,v.A)(n,[{key:"connectedCallback",value:function(){var e,t,n,i=this.getAttribute(Gv);i&&(rb(this,nb,null==(e=this.getRootNode())?void 0:e.getElementById(i)),null==(n=null==(t=ab(this,nb))?void 0:t.associateElement)||n.call(t,this))}},{key:"disconnectedCallback",value:function(){var e,t;null==(t=null==(e=ab(this,nb))?void 0:e.unassociateElement)||t.call(e,this),rb(this,nb,null)}},{key:"attributeChangedCallback",value:function(e,t,n){var i,a,r,o,s;[Vv.MEDIA_PREVIEW_IMAGE,Vv.MEDIA_PREVIEW_COORDS].includes(e)&&this.update(),e===Gv&&(t&&(null==(a=null==(i=ab(this,nb))?void 0:i.unassociateElement)||a.call(i,this),rb(this,nb,null)),n&&this.isConnected&&(rb(this,nb,null==(r=this.getRootNode())?void 0:r.getElementById(n)),null==(s=null==(o=ab(this,nb))?void 0:o.associateElement)||s.call(o,this)))}},{key:"mediaPreviewImage",get:function(){return zm(this,Vv.MEDIA_PREVIEW_IMAGE)},set:function(e){Xm(this,Vv.MEDIA_PREVIEW_IMAGE,e)}},{key:"mediaPreviewCoords",get:function(){var e=this.getAttribute(Vv.MEDIA_PREVIEW_COORDS);if(e)return e.split(/\s+/).map((function(e){return+e}))},set:function(e){e?this.setAttribute(Vv.MEDIA_PREVIEW_COORDS,e.join(" ")):this.removeAttribute(Vv.MEDIA_PREVIEW_COORDS)}},{key:"update",value:function(){var e=this,t=this.mediaPreviewCoords,n=this.mediaPreviewImage;if(t&&n){var i=(0,a.A)(t,4),r=i[0],o=i[1],s=i[2],l=i[3],u=n.split("#")[0],c=getComputedStyle(this),d=c.maxWidth,h=c.maxHeight,f=c.minWidth,v=c.minHeight,m=Math.min(parseInt(d)/s,parseInt(h)/l),p=Math.max(parseInt(f)/s,parseInt(v)/l),g=m<1,y=g?m:p>1?p:1,E=Km(this.shadowRoot,":host").style,A=Km(this.shadowRoot,"img").style,b=this.shadowRoot.querySelector("img"),k=g?"min":"max";E.setProperty("".concat(k,"-width"),"initial","important"),E.setProperty("".concat(k,"-height"),"initial","important"),E.width="".concat(s*y,"px"),E.height="".concat(l*y,"px");var T=function(){A.width="".concat(e.imgWidth*y,"px"),A.height="".concat(e.imgHeight*y,"px"),A.display="block"};b.src!==u&&(b.onload=function(){e.imgWidth=b.naturalWidth,e.imgHeight=b.naturalHeight,T()},b.src=u,T()),T(),A.transform="translate(-".concat(r*y,"px, -").concat(o*y,"px)")}}}],[{key:"observedAttributes",get:function(){return[Gv,Vv.MEDIA_PREVIEW_IMAGE,Vv.MEDIA_PREVIEW_COORDS]}}]),n}(Sm.HTMLElement);nb=new WeakMap,ob.shadowRootOptions={mode:"open"},ob.getTemplateHTML=function(e){return'\n    <style>\n      :host {\n        box-sizing: border-box;\n        display: var(--media-control-display, var(--media-preview-thumbnail-display, inline-block));\n        overflow: hidden;\n      }\n\n      img {\n        display: none;\n        position: relative;\n      }\n    </style>\n    <img crossorigin loading="eager" decoding="async">\n  '},Sm.customElements.get("media-preview-thumbnail")||Sm.customElements.define("media-preview-thumbnail",ob);var sb,lb=ob,ub=function(e,t,n){if(!t.has(e))throw TypeError("Cannot "+n)},cb=function(e,t,n){return ub(e,t,"read from private field"),n?n.call(e):t.get(e)},db=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){var e,i,a,r,o;return(0,m.A)(this,n),e=t.call(this),function(e,t,n){if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)}((0,Ln.A)(e),sb,void 0),i=(0,Ln.A)(e),a=sb,r=e.shadowRoot.querySelector("slot"),ub(i,a,"write to private field"),o?o.call(i,r):a.set(i,r),cb((0,Ln.A)(e),sb).textContent=hm(0),e}return(0,v.A)(n,[{key:"attributeChangedCallback",value:function(e,t,i){(0,u.A)((0,c.A)(n.prototype),"attributeChangedCallback",this).call(this,e,t,i),e===Vv.MEDIA_PREVIEW_TIME&&null!=i&&(cb(this,sb).textContent=hm(parseFloat(i)))}},{key:"mediaPreviewTime",get:function(){return Vm(this,Vv.MEDIA_PREVIEW_TIME)},set:function(e){qm(this,Vv.MEDIA_PREVIEW_TIME,e)}}],[{key:"observedAttributes",get:function(){return[].concat((0,f.A)((0,u.A)((0,c.A)(n),"observedAttributes",this)),[Vv.MEDIA_PREVIEW_TIME])}}]),n}(rA);sb=new WeakMap,Sm.customElements.get("media-preview-time-display")||Sm.customElements.define("media-preview-time-display",db);var hb="seekoffset";var fb=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){return(0,m.A)(this,n),t.apply(this,arguments)}return(0,v.A)(n,[{key:"connectedCallback",value:function(){(0,u.A)((0,c.A)(n.prototype),"connectedCallback",this).call(this),this.seekOffset=Vm(this,hb,30)}},{key:"attributeChangedCallback",value:function(e,t,i){(0,u.A)((0,c.A)(n.prototype),"attributeChangedCallback",this).call(this,e,t,i),e===hb&&(this.seekOffset=Vm(this,hb,30))}},{key:"seekOffset",get:function(){return Vm(this,hb,30)},set:function(e){qm(this,hb,e),this.setAttribute("aria-label",gm("seek back {seekOffset} seconds",{seekOffset:this.seekOffset})),Pm(Nm(this,"icon"),this.seekOffset)}},{key:"mediaCurrentTime",get:function(){return Vm(this,Vv.MEDIA_CURRENT_TIME,0)},set:function(e){qm(this,Vv.MEDIA_CURRENT_TIME,e)}},{key:"handleClick",value:function(){var e=Math.max(this.mediaCurrentTime-this.seekOffset,0),t=new Sm.CustomEvent(Bv.MEDIA_SEEK_REQUEST,{composed:!0,bubbles:!0,detail:e});this.dispatchEvent(t)}}],[{key:"observedAttributes",get:function(){return[].concat((0,f.A)((0,u.A)((0,c.A)(n),"observedAttributes",this)),[Vv.MEDIA_CURRENT_TIME,hb])}}]),n}(Hy);fb.getSlotTemplateHTML=function(e,t){return'\n    <slot name="icon">'.concat((n=t.seekOffset,'\n  <svg aria-hidden="true" viewBox="0 0 20 24">\n    <defs>\n      <style>.text{font-size:8px;font-family:Arial-BoldMT, Arial;font-weight:700;}</style>\n    </defs>\n    <text class="text value" transform="translate(2.18 19.87)">'.concat(n,'</text>\n    <path d="M10 6V3L4.37 7 10 10.94V8a5.54 5.54 0 0 1 1.9 10.48v2.12A7.5 7.5 0 0 0 10 6Z"/>\n  </svg>')),"</slot>\n  ");var n},fb.getTooltipContentHTML=function(){return gm("Seek backward")},Sm.customElements.get("media-seek-backward-button")||Sm.customElements.define("media-seek-backward-button",fb);var vb="seekoffset";var mb=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){return(0,m.A)(this,n),t.apply(this,arguments)}return(0,v.A)(n,[{key:"connectedCallback",value:function(){(0,u.A)((0,c.A)(n.prototype),"connectedCallback",this).call(this),this.seekOffset=Vm(this,vb,30)}},{key:"attributeChangedCallback",value:function(e,t,i){(0,u.A)((0,c.A)(n.prototype),"attributeChangedCallback",this).call(this,e,t,i),e===vb&&(this.seekOffset=Vm(this,vb,30))}},{key:"seekOffset",get:function(){return Vm(this,vb,30)},set:function(e){qm(this,vb,e),this.setAttribute("aria-label",gm("seek forward {seekOffset} seconds",{seekOffset:this.seekOffset})),Pm(Nm(this,"icon"),this.seekOffset)}},{key:"mediaCurrentTime",get:function(){return Vm(this,Vv.MEDIA_CURRENT_TIME,0)},set:function(e){qm(this,Vv.MEDIA_CURRENT_TIME,e)}},{key:"handleClick",value:function(){var e=this.mediaCurrentTime+this.seekOffset,t=new Sm.CustomEvent(Bv.MEDIA_SEEK_REQUEST,{composed:!0,bubbles:!0,detail:e});this.dispatchEvent(t)}}],[{key:"observedAttributes",get:function(){return[].concat((0,f.A)((0,u.A)((0,c.A)(n),"observedAttributes",this)),[Vv.MEDIA_CURRENT_TIME,vb])}}]),n}(Hy);mb.getSlotTemplateHTML=function(e,t){return'\n    <slot name="icon">'.concat((n=t.seekOffset,'\n  <svg aria-hidden="true" viewBox="0 0 20 24">\n    <defs>\n      <style>.text{font-size:8px;font-family:Arial-BoldMT, Arial;font-weight:700;}</style>\n    </defs>\n    <text class="text value" transform="translate(8.9 19.87)">'.concat(n,'</text>\n    <path d="M10 6V3l5.61 4L10 10.94V8a5.54 5.54 0 0 0-1.9 10.48v2.12A7.5 7.5 0 0 1 10 6Z"/>\n  </svg>')),"</slot>\n  ");var n},mb.getTooltipContentHTML=function(){return gm("Seek forward")},Sm.customElements.get("media-seek-forward-button")||Sm.customElements.define("media-seek-forward-button",mb);var pb,gb=function(e,t,n){if(!t.has(e))throw TypeError("Cannot "+n)},yb=function(e,t,n){return gb(e,t,"read from private field"),n?n.call(e):t.get(e)},Eb={REMAINING:"remaining",SHOW_DURATION:"showduration",NO_TOGGLE:"notoggle"},Ab=[].concat((0,f.A)(Object.values(Eb)),[Vv.MEDIA_CURRENT_TIME,Vv.MEDIA_DURATION,Vv.MEDIA_SEEKABLE]),bb=["Enter"," "],kb="&nbsp;/&nbsp;",Tb=function(e){var t,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=i.timesSep,o=void 0===r?kb:r,s=null!=(t=e.mediaCurrentTime)?t:0,l=null!=(n=e.mediaSeekable)?n:[],u=(0,a.A)(l,2),c=u[1],d=0;Number.isFinite(e.mediaDuration)?d=e.mediaDuration:Number.isFinite(c)&&(d=c);var h=e.remaining?hm(0-(d-s)):hm(s);return e.showDuration?"".concat(h).concat(o).concat(hm(d)):h};var _b=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){var e,i,a,r,o;return(0,m.A)(this,n),e=t.call(this),function(e,t,n){if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)}((0,Ln.A)(e),pb,void 0),i=(0,Ln.A)(e),a=pb,r=e.shadowRoot.querySelector("slot"),gb(i,a,"write to private field"),o?o.call(i,r):a.set(i,r),yb((0,Ln.A)(e),pb).innerHTML="".concat(Tb((0,Ln.A)(e))),e}return(0,v.A)(n,[{key:"connectedCallback",value:function(){var e=this,t=Km(this.shadowRoot,":host(:hover:not([notoggle]))").style;t.setProperty("cursor","var(--media-cursor, pointer)"),t.setProperty("background","var(--media-control-hover-background, rgba(50 50 70 / .7))"),this.hasAttribute("disabled")||this.enable(),this.setAttribute("role","progressbar"),this.setAttribute("aria-label",gm("playback time"));var i=function t(n){var i=n.key;bb.includes(i)?e.toggleTimeDisplay():e.removeEventListener("keyup",t)};this.addEventListener("keydown",(function(t){var n=t.metaKey,a=t.altKey,r=t.key;n||a||!bb.includes(r)?e.removeEventListener("keyup",i):e.addEventListener("keyup",i)})),this.addEventListener("click",this.toggleTimeDisplay),(0,u.A)((0,c.A)(n.prototype),"connectedCallback",this).call(this)}},{key:"toggleTimeDisplay",value:function(){this.noToggle||(this.hasAttribute("remaining")?this.removeAttribute("remaining"):this.setAttribute("remaining",""))}},{key:"disconnectedCallback",value:function(){this.disable(),(0,u.A)((0,c.A)(n.prototype),"disconnectedCallback",this).call(this)}},{key:"attributeChangedCallback",value:function(e,t,i){Ab.includes(e)?this.update():"disabled"===e&&i!==t&&(null==i?this.enable():this.disable()),(0,u.A)((0,c.A)(n.prototype),"attributeChangedCallback",this).call(this,e,t,i)}},{key:"enable",value:function(){this.tabIndex=0}},{key:"disable",value:function(){this.tabIndex=-1}},{key:"remaining",get:function(){return Ym(this,Eb.REMAINING)},set:function(e){jm(this,Eb.REMAINING,e)}},{key:"showDuration",get:function(){return Ym(this,Eb.SHOW_DURATION)},set:function(e){jm(this,Eb.SHOW_DURATION,e)}},{key:"noToggle",get:function(){return Ym(this,Eb.NO_TOGGLE)},set:function(e){jm(this,Eb.NO_TOGGLE,e)}},{key:"mediaDuration",get:function(){return Vm(this,Vv.MEDIA_DURATION)},set:function(e){qm(this,Vv.MEDIA_DURATION,e)}},{key:"mediaCurrentTime",get:function(){return Vm(this,Vv.MEDIA_CURRENT_TIME)},set:function(e){qm(this,Vv.MEDIA_CURRENT_TIME,e)}},{key:"mediaSeekable",get:function(){var e=this.getAttribute(Vv.MEDIA_SEEKABLE);if(e)return e.split(":").map((function(e){return+e}))},set:function(e){null!=e?this.setAttribute(Vv.MEDIA_SEEKABLE,e.join(":")):this.removeAttribute(Vv.MEDIA_SEEKABLE)}},{key:"update",value:function(){var e=Tb(this);!function(e){var t,n=e.mediaCurrentTime,i=null!=(t=e.mediaSeekable)?t:[],r=(0,a.A)(i,2)[1],o=null;if(Number.isFinite(e.mediaDuration)?o=e.mediaDuration:Number.isFinite(r)&&(o=r),null!=n&&null!==o){var s=e.remaining?dm(0-(o-n)):dm(n);if(e.showDuration){var l=dm(o),u="".concat(s," of ").concat(l);e.setAttribute("aria-valuetext",u)}else e.setAttribute("aria-valuetext",s)}else e.setAttribute("aria-valuetext","video not loaded, unknown time.")}(this),e!==yb(this,pb).innerHTML&&(yb(this,pb).innerHTML=e)}}],[{key:"observedAttributes",get:function(){return[].concat((0,f.A)((0,u.A)((0,c.A)(n),"observedAttributes",this)),(0,f.A)(Ab),["disabled"])}}]),n}(rA);pb=new WeakMap,_b.getSlotTemplateHTML=function(e,t){return"\n    <slot>".concat(Tb(t),"</slot>\n  ")},Sm.customElements.get("media-time-display")||Sm.customElements.define("media-time-display",_b);var Sb,wb,Rb,Lb,Ib,Db,Cb,xb,Mb,Ob,Pb=function(e,t,n){if(!t.has(e))throw TypeError("Cannot "+n)},Nb=function(e,t,n){return Pb(e,t,"read from private field"),n?n.call(e):t.get(e)},Ub=function(e,t,n){if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},Fb=function(e,t,n,i){return Pb(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n},Bb=function(e,t,n,i){return{set _(i){Fb(e,t,i,n)},get _(){return Nb(e,t,i)}}},Hb=function(){function e(t,n,i){var a=this;(0,m.A)(this,e),Ub(this,Sb,void 0),Ub(this,wb,void 0),Ub(this,Rb,void 0),Ub(this,Lb,void 0),Ub(this,Ib,void 0),Ub(this,Db,void 0),Ub(this,Cb,void 0),Ub(this,xb,void 0),Ub(this,Mb,0),Ub(this,Ob,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:performance.now();Fb(a,Mb,requestAnimationFrame(Nb(a,Ob))),Fb(a,Lb,performance.now()-Nb(a,Rb));var t=1e3/a.fps;if(Nb(a,Lb)>t){Fb(a,Rb,e-Nb(a,Lb)%t);var n=1e3/((e-Nb(a,wb))/++Bb(a,Ib)._),i=(e-Nb(a,Db))/1e3/a.duration,r=Nb(a,Cb)+i*a.playbackRate,o=r-Nb(a,Sb).valueAsNumber;o>0?Fb(a,xb,a.playbackRate/a.duration/n):(Fb(a,xb,.995*Nb(a,xb)),r=Nb(a,Sb).valueAsNumber+Nb(a,xb)),a.callback(r)}})),Fb(this,Sb,t),this.callback=n,this.fps=i}return(0,v.A)(e,[{key:"start",value:function(){0===Nb(this,Mb)&&(Fb(this,Rb,performance.now()),Fb(this,wb,Nb(this,Rb)),Fb(this,Ib,0),Nb(this,Ob).call(this))}},{key:"stop",value:function(){0!==Nb(this,Mb)&&(cancelAnimationFrame(Nb(this,Mb)),Fb(this,Mb,0))}},{key:"update",value:function(e){var t=e.start,n=e.duration,i=e.playbackRate,a=t-Nb(this,Sb).valueAsNumber,r=Math.abs(n-this.duration);(a>0||a<-.03||r>=.5)&&this.callback(t),Fb(this,Cb,t),Fb(this,Db,performance.now()),this.duration=n,this.playbackRate=i}}]),e}();Sb=new WeakMap,wb=new WeakMap,Rb=new WeakMap,Lb=new WeakMap,Ib=new WeakMap,Db=new WeakMap,Cb=new WeakMap,xb=new WeakMap,Mb=new WeakMap,Ob=new WeakMap;var Gb,Kb,Wb,Vb,qb,Yb,jb,zb,Xb,Qb,Zb,Jb,$b,ek,tk,nk,ik,ak,rk,ok,sk,lk,uk,ck,dk,hk,fk=function(e,t,n){if(!t.has(e))throw TypeError("Cannot "+n)},vk=function(e,t,n){return fk(e,t,"read from private field"),n?n.call(e):t.get(e)},mk=function(e,t,n){if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},pk=function(e,t,n,i){return fk(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n},gk=function(e,t,n){return fk(e,t,"access private method"),n};var yk=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.mediaCurrentTime,n=Number.isFinite(e.mediaSeekableStart)?e.mediaSeekableStart:0,i=Number.isFinite(e.mediaDuration)?e.mediaDuration:e.mediaSeekableEnd;if(Number.isNaN(i))return 0;var a=(t-n)/(i-n);return Math.max(0,Math.min(a,1))},Ek=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.range.valueAsNumber,n=Number.isFinite(e.mediaSeekableStart)?e.mediaSeekableStart:0,i=Number.isFinite(e.mediaDuration)?e.mediaDuration:e.mediaSeekableEnd;return Number.isNaN(i)?0:t*(i-n)+n},Ak=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){var e;(0,m.A)(this,n),e=t.call(this),mk((0,Ln.A)(e),Qb),mk((0,Ln.A)(e),Jb),mk((0,Ln.A)(e),tk),mk((0,Ln.A)(e),ik),mk((0,Ln.A)(e),rk),mk((0,Ln.A)(e),sk),mk((0,Ln.A)(e),uk),mk((0,Ln.A)(e),dk),mk((0,Ln.A)(e),Gb,void 0),mk((0,Ln.A)(e),Kb,void 0),mk((0,Ln.A)(e),Wb,void 0),mk((0,Ln.A)(e),Vb,void 0),mk((0,Ln.A)(e),qb,void 0),mk((0,Ln.A)(e),Yb,void 0),mk((0,Ln.A)(e),jb,void 0),mk((0,Ln.A)(e),zb,void 0),mk((0,Ln.A)(e),Xb,void 0),mk((0,Ln.A)(e),ek,(function(t){e.dragging||(sm(t)&&(e.range.valueAsNumber=t),e.updateBar())})),e.shadowRoot.querySelector("#track").insertAdjacentHTML("afterbegin",'<div id="buffered" part="buffered"></div>'),pk((0,Ln.A)(e),Wb,e.shadowRoot.querySelectorAll('[part~="box"]')),pk((0,Ln.A)(e),qb,e.shadowRoot.querySelector('[part~="preview-box"]')),pk((0,Ln.A)(e),Yb,e.shadowRoot.querySelector('[part~="current-box"]'));var i=getComputedStyle((0,Ln.A)(e));return pk((0,Ln.A)(e),jb,parseInt(i.getPropertyValue("--media-box-padding-left"))),pk((0,Ln.A)(e),zb,parseInt(i.getPropertyValue("--media-box-padding-right"))),pk((0,Ln.A)(e),Kb,new Hb(e.range,vk((0,Ln.A)(e),ek),60)),e}return(0,v.A)(n,[{key:"connectedCallback",value:function(){var e;(0,u.A)((0,c.A)(n.prototype),"connectedCallback",this).call(this),this.range.setAttribute("aria-label",gm("seek")),gk(this,Qb,Zb).call(this),pk(this,Gb,this.getRootNode()),null==(e=vk(this,Gb))||e.addEventListener("transitionstart",this)}},{key:"disconnectedCallback",value:function(){var e;(0,u.A)((0,c.A)(n.prototype),"disconnectedCallback",this).call(this),gk(this,Qb,Zb).call(this),null==(e=vk(this,Gb))||e.removeEventListener("transitionstart",this),pk(this,Gb,null)}},{key:"attributeChangedCallback",value:function(e,t,i){(0,u.A)((0,c.A)(n.prototype),"attributeChangedCallback",this).call(this,e,t,i),t!=i&&(e===Vv.MEDIA_CURRENT_TIME||e===Vv.MEDIA_PAUSED||e===Vv.MEDIA_ENDED||e===Vv.MEDIA_LOADING||e===Vv.MEDIA_DURATION||e===Vv.MEDIA_SEEKABLE?(vk(this,Kb).update({start:yk(this),duration:this.mediaSeekableEnd-this.mediaSeekableStart,playbackRate:this.mediaPlaybackRate}),gk(this,Qb,Zb).call(this),function(e){var t=e.range,n=dm(+Ek(e)),i=dm(+e.mediaSeekableEnd),a=n&&i?"".concat(n," of ").concat(i):"video not loaded, unknown time.";t.setAttribute("aria-valuetext",a)}(this)):e===Vv.MEDIA_BUFFERED&&this.updateBufferedBar(),e!==Vv.MEDIA_DURATION&&e!==Vv.MEDIA_SEEKABLE||(this.mediaChaptersCues=vk(this,Xb),this.updateBar()))}},{key:"mediaChaptersCues",get:function(){return vk(this,Xb)},set:function(e){var t,n=this;pk(this,Xb,e),this.updateSegments(null==(t=vk(this,Xb))?void 0:t.map((function(e){return{start:yk(n,e.startTime),end:yk(n,e.endTime)}})))}},{key:"mediaPaused",get:function(){return Ym(this,Vv.MEDIA_PAUSED)},set:function(e){jm(this,Vv.MEDIA_PAUSED,e)}},{key:"mediaLoading",get:function(){return Ym(this,Vv.MEDIA_LOADING)},set:function(e){jm(this,Vv.MEDIA_LOADING,e)}},{key:"mediaDuration",get:function(){return Vm(this,Vv.MEDIA_DURATION)},set:function(e){qm(this,Vv.MEDIA_DURATION,e)}},{key:"mediaCurrentTime",get:function(){return Vm(this,Vv.MEDIA_CURRENT_TIME)},set:function(e){qm(this,Vv.MEDIA_CURRENT_TIME,e)}},{key:"mediaPlaybackRate",get:function(){return Vm(this,Vv.MEDIA_PLAYBACK_RATE,1)},set:function(e){qm(this,Vv.MEDIA_PLAYBACK_RATE,e)}},{key:"mediaBuffered",get:function(){var e=this.getAttribute(Vv.MEDIA_BUFFERED);return e?e.split(" ").map((function(e){return e.split(":").map((function(e){return+e}))})):[]},set:function(e){if(e){var t=e.map((function(e){return e.join(":")})).join(" ");this.setAttribute(Vv.MEDIA_BUFFERED,t)}else this.removeAttribute(Vv.MEDIA_BUFFERED)}},{key:"mediaSeekable",get:function(){var e=this.getAttribute(Vv.MEDIA_SEEKABLE);if(e)return e.split(":").map((function(e){return+e}))},set:function(e){null!=e?this.setAttribute(Vv.MEDIA_SEEKABLE,e.join(":")):this.removeAttribute(Vv.MEDIA_SEEKABLE)}},{key:"mediaSeekableEnd",get:function(){var e,t=null!=(e=this.mediaSeekable)?e:[],n=(0,a.A)(t,2)[1];return void 0===n?this.mediaDuration:n}},{key:"mediaSeekableStart",get:function(){var e,t=null!=(e=this.mediaSeekable)?e:[],n=(0,a.A)(t,1)[0];return void 0===n?0:n}},{key:"mediaPreviewImage",get:function(){return zm(this,Vv.MEDIA_PREVIEW_IMAGE)},set:function(e){Xm(this,Vv.MEDIA_PREVIEW_IMAGE,e)}},{key:"mediaPreviewTime",get:function(){return Vm(this,Vv.MEDIA_PREVIEW_TIME)},set:function(e){qm(this,Vv.MEDIA_PREVIEW_TIME,e)}},{key:"mediaEnded",get:function(){return Ym(this,Vv.MEDIA_ENDED)},set:function(e){jm(this,Vv.MEDIA_ENDED,e)}},{key:"updateBar",value:function(){(0,u.A)((0,c.A)(n.prototype),"updateBar",this).call(this),this.updateBufferedBar(),this.updateCurrentBox()}},{key:"updateBufferedBar",value:function(){var e,t=this.mediaBuffered;if(t.length){var n;if(this.mediaEnded)n=1;else{var i=this.mediaCurrentTime,r=null!=(e=t.find((function(e){var t=(0,a.A)(e,2),n=t[0],r=t[1];return n<=i&&i<=r})))?e:[],o=(0,a.A)(r,2)[1],s=void 0===o?this.mediaSeekableStart:o;n=yk(this,s)}Km(this.shadowRoot,"#buffered").style.setProperty("width","".concat(100*n,"%"))}}},{key:"updateCurrentBox",value:function(){if(this.shadowRoot.querySelector('slot[name="current"]').assignedElements().length){var e=Km(this.shadowRoot,"#current-rail"),t=Km(this.shadowRoot,'[part~="current-box"]'),n=gk(this,tk,nk).call(this,vk(this,Yb)),i=gk(this,ik,ak).call(this,n,this.range.valueAsNumber),a=gk(this,rk,ok).call(this,n,this.range.valueAsNumber);e.style.transform="translateX(".concat(i,")"),e.style.setProperty("--_range-width","".concat(n.range.width)),t.style.setProperty("--_box-shift","".concat(a)),t.style.setProperty("--_box-width","".concat(n.box.width,"px")),t.style.setProperty("visibility","initial")}}},{key:"handleEvent",value:function(e){var t=this;switch((0,u.A)((0,c.A)(n.prototype),"handleEvent",this).call(this,e),e.type){case"input":gk(this,dk,hk).call(this);break;case"pointermove":gk(this,sk,lk).call(this,e);break;case"pointerup":case"pointerleave":gk(this,uk,ck).call(this,null);break;case"transitionstart":Um(e.target,this)&&setTimeout((function(){return gk(t,Qb,Zb).call(t)}),0)}}}],[{key:"observedAttributes",get:function(){return[].concat((0,f.A)((0,u.A)((0,c.A)(n),"observedAttributes",this)),[Vv.MEDIA_PAUSED,Vv.MEDIA_DURATION,Vv.MEDIA_SEEKABLE,Vv.MEDIA_CURRENT_TIME,Vv.MEDIA_PREVIEW_IMAGE,Vv.MEDIA_PREVIEW_TIME,Vv.MEDIA_PREVIEW_CHAPTER,Vv.MEDIA_BUFFERED,Vv.MEDIA_PLAYBACK_RATE,Vv.MEDIA_LOADING,Vv.MEDIA_ENDED])}}]),n}(XE);Gb=new WeakMap,Kb=new WeakMap,Wb=new WeakMap,Vb=new WeakMap,qb=new WeakMap,Yb=new WeakMap,jb=new WeakMap,zb=new WeakMap,Xb=new WeakMap,Qb=new WeakSet,Zb=function(){gk(this,Jb,$b).call(this)?vk(this,Kb).start():vk(this,Kb).stop()},Jb=new WeakSet,$b=function(){return this.isConnected&&!this.mediaPaused&&!this.mediaLoading&&!this.mediaEnded&&this.mediaSeekableEnd>0&&Gm(this)},ek=new WeakMap,tk=new WeakSet,nk=function(e){var t,n=(null!=(t=this.getAttribute("bounds")?Fm(this,"#".concat(this.getAttribute("bounds"))):this.parentElement)?t:this).getBoundingClientRect(),i=this.range.getBoundingClientRect(),a=e.offsetWidth;return{box:{width:a,min:-(i.left-n.left-a/2),max:n.right-i.left-a/2},bounds:n,range:i}},ik=new WeakSet,ak=function(e,t){var n="".concat(100*t,"%"),i=e.box,a=i.width,r=i.min,o=i.max;if(!a)return n;if(!Number.isNaN(r)){var s="calc(1 / var(--_range-width) * 100 * ".concat(r,"% + ").concat("var(--media-box-padding-left)",")");n="max(".concat(s,", ").concat(n,")")}if(!Number.isNaN(o)){var l="calc(1 / var(--_range-width) * 100 * ".concat(o,"% - ").concat("var(--media-box-padding-right)",")");n="min(".concat(n,", ").concat(l,")")}return n},rk=new WeakSet,ok=function(e,t){var n=e.box,i=n.width,a=n.min,r=n.max,o=t*e.range.width;if(o<a+vk(this,jb)){var s=e.range.left-e.bounds.left-vk(this,jb);return"".concat(o-i/2+s,"px")}if(o>r-vk(this,zb)){var l=e.bounds.right-e.range.right-vk(this,zb);return"".concat(o+i/2-l-e.range.width,"px")}return 0},sk=new WeakSet,lk=function(e){var t=(0,f.A)(vk(this,Wb)).some((function(t){return e.composedPath().includes(t)}));if(this.dragging||!t&&e.composedPath().includes(this)){var n=this.mediaSeekableEnd;if(n){var i=Km(this.shadowRoot,"#preview-rail"),a=Km(this.shadowRoot,'[part~="preview-box"]'),r=gk(this,tk,nk).call(this,vk(this,qb)),o=(e.clientX-r.range.left)/r.range.width;o=Math.max(0,Math.min(1,o));var s=gk(this,ik,ak).call(this,r,o),l=gk(this,rk,ok).call(this,r,o);i.style.transform="translateX(".concat(s,")"),i.style.setProperty("--_range-width","".concat(r.range.width)),a.style.setProperty("--_box-shift","".concat(l)),a.style.setProperty("--_box-width","".concat(r.box.width,"px"));var u=Math.round(vk(this,Vb))-Math.round(o*n);Math.abs(u)<1&&o>.01&&o<.99||(pk(this,Vb,o*n),gk(this,uk,ck).call(this,vk(this,Vb)))}}else gk(this,uk,ck).call(this,null)},uk=new WeakSet,ck=function(e){this.dispatchEvent(new Sm.CustomEvent(Bv.MEDIA_PREVIEW_REQUEST,{composed:!0,bubbles:!0,detail:e}))},dk=new WeakSet,hk=function(){vk(this,Kb).stop();var e=Ek(this);this.dispatchEvent(new Sm.CustomEvent(Bv.MEDIA_SEEK_REQUEST,{composed:!0,bubbles:!0,detail:e}))},Ak.shadowRootOptions={mode:"open"},Ak.getTemplateHTML=function(e){return"\n    ".concat(XE.getTemplateHTML(e),"\n    <style>\n      :host {\n        --media-box-border-radius: 4px;\n        --media-box-padding-left: 10px;\n        --media-box-padding-right: 10px;\n        --media-preview-border-radius: var(--media-box-border-radius);\n        --media-box-arrow-offset: var(--media-box-border-radius);\n        --_control-background: var(--media-control-background, var(--media-secondary-color, rgb(20 20 30 / .7)));\n        --_preview-background: var(--media-preview-background, var(--_control-background));\n\n        ",'\n        contain: layout;\n      }\n\n      #buffered {\n        background: var(--media-time-range-buffered-color, rgb(255 255 255 / .4));\n        position: absolute;\n        height: 100%;\n        will-change: width;\n      }\n\n      #preview-rail,\n      #current-rail {\n        width: 100%;\n        position: absolute;\n        left: 0;\n        bottom: 100%;\n        pointer-events: none;\n        will-change: transform;\n      }\n\n      [part~="box"] {\n        width: min-content;\n        ','\n        position: absolute;\n        bottom: 100%;\n        flex-direction: column;\n        align-items: center;\n        transform: translateX(-50%);\n      }\n\n      [part~="current-box"] {\n        display: var(--media-current-box-display, var(--media-box-display, flex));\n        margin: var(--media-current-box-margin, var(--media-box-margin, 0 0 5px));\n        visibility: hidden;\n      }\n\n      [part~="preview-box"] {\n        display: var(--media-preview-box-display, var(--media-box-display, flex));\n        margin: var(--media-preview-box-margin, var(--media-box-margin, 0 0 5px));\n        transition-property: var(--media-preview-transition-property, visibility, opacity);\n        transition-duration: var(--media-preview-transition-duration-out, .25s);\n        transition-delay: var(--media-preview-transition-delay-out, 0s);\n        visibility: hidden;\n        opacity: 0;\n      }\n\n      :host(:is([').concat(Vv.MEDIA_PREVIEW_IMAGE,"], [").concat(Vv.MEDIA_PREVIEW_TIME,'])[dragging]) [part~="preview-box"] {\n        transition-duration: var(--media-preview-transition-duration-in, .5s);\n        transition-delay: var(--media-preview-transition-delay-in, .25s);\n        visibility: visible;\n        opacity: 1;\n      }\n\n      @media (hover: hover) {\n        :host(:is([').concat(Vv.MEDIA_PREVIEW_IMAGE,"], [").concat(Vv.MEDIA_PREVIEW_TIME,']):hover) [part~="preview-box"] {\n          transition-duration: var(--media-preview-transition-duration-in, .5s);\n          transition-delay: var(--media-preview-transition-delay-in, .25s);\n          visibility: visible;\n          opacity: 1;\n        }\n      }\n\n      media-preview-thumbnail,\n      ::slotted(media-preview-thumbnail) {\n        visibility: hidden;\n        ',"\n        transition: visibility 0s .25s;\n        transition-delay: calc(var(--media-preview-transition-delay-out, 0s) + var(--media-preview-transition-duration-out, .25s));\n        background: var(--media-preview-thumbnail-background, var(--_preview-background));\n        box-shadow: var(--media-preview-thumbnail-box-shadow, 0 0 4px rgb(0 0 0 / .2));\n        max-width: var(--media-preview-thumbnail-max-width, 180px);\n        max-height: var(--media-preview-thumbnail-max-height, 160px);\n        min-width: var(--media-preview-thumbnail-min-width, 120px);\n        min-height: var(--media-preview-thumbnail-min-height, 80px);\n        border: var(--media-preview-thumbnail-border);\n        border-radius: var(--media-preview-thumbnail-border-radius,\n          var(--media-preview-border-radius) var(--media-preview-border-radius) 0 0);\n      }\n\n      :host([").concat(Vv.MEDIA_PREVIEW_IMAGE,"][dragging]) media-preview-thumbnail,\n      :host([").concat(Vv.MEDIA_PREVIEW_IMAGE,"][dragging]) ::slotted(media-preview-thumbnail) {\n        transition-delay: var(--media-preview-transition-delay-in, .25s);\n        visibility: visible;\n      }\n\n      @media (hover: hover) {\n        :host([").concat(Vv.MEDIA_PREVIEW_IMAGE,"]:hover) media-preview-thumbnail,\n        :host([").concat(Vv.MEDIA_PREVIEW_IMAGE,"]:hover) ::slotted(media-preview-thumbnail) {\n          transition-delay: var(--media-preview-transition-delay-in, .25s);\n          visibility: visible;\n        }\n\n        :host([").concat(Vv.MEDIA_PREVIEW_TIME,"]:hover) {\n          --media-time-range-hover-display: block;\n        }\n      }\n\n      media-preview-chapter-display,\n      ::slotted(media-preview-chapter-display) {\n        font-size: var(--media-font-size, 13px);\n        line-height: 17px;\n        min-width: 0;\n        visibility: hidden;\n        ","\n        transition: min-width 0s, border-radius 0s, margin 0s, padding 0s, visibility 0s;\n        transition-delay: calc(var(--media-preview-transition-delay-out, 0s) + var(--media-preview-transition-duration-out, .25s));\n        background: var(--media-preview-chapter-background, var(--_preview-background));\n        border-radius: var(--media-preview-chapter-border-radius,\n          var(--media-preview-border-radius) var(--media-preview-border-radius)\n          var(--media-preview-border-radius) var(--media-preview-border-radius));\n        padding: var(--media-preview-chapter-padding, 3.5px 9px);\n        margin: var(--media-preview-chapter-margin, 0 0 5px);\n        text-shadow: var(--media-preview-chapter-text-shadow, 0 0 4px rgb(0 0 0 / .75));\n      }\n\n      :host([").concat(Vv.MEDIA_PREVIEW_IMAGE,"]) media-preview-chapter-display,\n      :host([").concat(Vv.MEDIA_PREVIEW_IMAGE,"]) ::slotted(media-preview-chapter-display) {\n        transition-delay: var(--media-preview-transition-delay-in, .25s);\n        border-radius: var(--media-preview-chapter-border-radius, 0);\n        padding: var(--media-preview-chapter-padding, 3.5px 9px 0);\n        margin: var(--media-preview-chapter-margin, 0);\n        min-width: 100%;\n      }\n\n      media-preview-chapter-display[").concat(Vv.MEDIA_PREVIEW_CHAPTER,"],\n      ::slotted(media-preview-chapter-display[").concat(Vv.MEDIA_PREVIEW_CHAPTER,"]) {\n        visibility: visible;\n      }\n\n      media-preview-chapter-display:not([aria-valuetext]),\n      ::slotted(media-preview-chapter-display:not([aria-valuetext])) {\n        display: none;\n      }\n\n      media-preview-time-display,\n      ::slotted(media-preview-time-display),\n      media-time-display,\n      ::slotted(media-time-display) {\n        font-size: var(--media-font-size, 13px);\n        line-height: 17px;\n        min-width: 0;\n        ","\n        transition: min-width 0s, border-radius 0s;\n        transition-delay: calc(var(--media-preview-transition-delay-out, 0s) + var(--media-preview-transition-duration-out, .25s));\n        background: var(--media-preview-time-background, var(--_preview-background));\n        border-radius: var(--media-preview-time-border-radius,\n          var(--media-preview-border-radius) var(--media-preview-border-radius)\n          var(--media-preview-border-radius) var(--media-preview-border-radius));\n        padding: var(--media-preview-time-padding, 3.5px 9px);\n        margin: var(--media-preview-time-margin, 0);\n        text-shadow: var(--media-preview-time-text-shadow, 0 0 4px rgb(0 0 0 / .75));\n        transform: translateX(min(\n          max(calc(50% - var(--_box-width) / 2),\n          calc(var(--_box-shift, 0))),\n          calc(var(--_box-width) / 2 - 50%)\n        ));\n      }\n\n      :host([").concat(Vv.MEDIA_PREVIEW_IMAGE,"]) media-preview-time-display,\n      :host([").concat(Vv.MEDIA_PREVIEW_IMAGE,"]) ::slotted(media-preview-time-display) {\n        transition-delay: var(--media-preview-transition-delay-in, .25s);\n        border-radius: var(--media-preview-time-border-radius,\n          0 0 var(--media-preview-border-radius) var(--media-preview-border-radius));\n        min-width: 100%;\n      }\n\n      :host([").concat(Vv.MEDIA_PREVIEW_TIME,']:hover) {\n        --media-time-range-hover-display: block;\n      }\n\n      [part~="arrow"],\n      ::slotted([part~="arrow"]) {\n        display: var(--media-box-arrow-display, inline-block);\n        transform: translateX(min(\n          max(calc(50% - var(--_box-width) / 2 + var(--media-box-arrow-offset)),\n          calc(var(--_box-shift, 0))),\n          calc(var(--_box-width) / 2 - 50% - var(--media-box-arrow-offset))\n        ));\n        ','\n        border-color: transparent;\n        border-top-color: var(--media-box-arrow-background, var(--_control-background));\n        border-width: var(--media-box-arrow-border-width,\n          var(--media-box-arrow-height, 5px) var(--media-box-arrow-width, 6px) 0);\n        border-style: solid;\n        justify-content: center;\n        height: 0;\n      }\n    </style>\n    <div id="preview-rail">\n      <slot name="preview" part="box preview-box">\n        <media-preview-thumbnail>\n          <template shadowrootmode="').concat(lb.shadowRootOptions.mode,'">\n            ').concat(lb.getTemplateHTML({}),'\n          </template>\n        </media-preview-thumbnail>\n        <media-preview-chapter-display></media-preview-chapter-display>\n        <media-preview-time-display></media-preview-time-display>\n        <slot name="preview-arrow"><div part="arrow"></div></slot>\n      </slot>\n    </div>\n    <div id="current-rail">\n      <slot name="current" part="box current-box">\n        ',"\n      </slot>\n    </div>\n  ")},Sm.customElements.get("media-time-range")||Sm.customElements.define("media-time-range",Ak);var bk=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){var e;return(0,m.A)(this,n),(e=t.call(this)).range.addEventListener("input",(function(){var t=e.range.value,n=new Sm.CustomEvent(Bv.MEDIA_VOLUME_REQUEST,{composed:!0,bubbles:!0,detail:t});e.dispatchEvent(n)})),e}return(0,v.A)(n,[{key:"connectedCallback",value:function(){(0,u.A)((0,c.A)(n.prototype),"connectedCallback",this).call(this),this.range.setAttribute("aria-label",gm("volume"))}},{key:"attributeChangedCallback",value:function(e,t,i){var a,r;(0,u.A)((0,c.A)(n.prototype),"attributeChangedCallback",this).call(this,e,t,i),e!==Vv.MEDIA_VOLUME&&e!==Vv.MEDIA_MUTED||(this.range.valueAsNumber=(r=this).mediaMuted?0:r.mediaVolume,this.range.setAttribute("aria-valuetext",(a=this.range.valueAsNumber,"".concat(Math.round(100*a),"%"))),this.updateBar())}},{key:"mediaVolume",get:function(){return Vm(this,Vv.MEDIA_VOLUME,1)},set:function(e){qm(this,Vv.MEDIA_VOLUME,e)}},{key:"mediaMuted",get:function(){return Ym(this,Vv.MEDIA_MUTED)},set:function(e){jm(this,Vv.MEDIA_MUTED,e)}},{key:"mediaVolumeUnavailable",get:function(){return zm(this,Vv.MEDIA_VOLUME_UNAVAILABLE)},set:function(e){Xm(this,Vv.MEDIA_VOLUME_UNAVAILABLE,e)}}],[{key:"observedAttributes",get:function(){return[].concat((0,f.A)((0,u.A)((0,c.A)(n),"observedAttributes",this)),[Vv.MEDIA_VOLUME,Vv.MEDIA_MUTED,Vv.MEDIA_VOLUME_UNAVAILABLE])}}]),n}(XE);Sm.customElements.get("media-volume-range")||Sm.customElements.define("media-volume-range",bk);var kk,Tk,_k,Sk,wk,Rk,Lk,Ik,Dk,Ck,xk,Mk=function(e,t,n){if(!t.has(e))throw TypeError("Cannot "+n)},Ok=function(e,t,n){return Mk(e,t,"read from private field"),n?n.call(e):t.get(e)},Pk=function(e,t,n){if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},Nk=function(e,t,n,i){return Mk(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n},Uk={processCallback:function(e,t,n){if(n){var i,r=(0,h.A)(t);try{for(r.s();!(i=r.n()).done;){var o=(0,a.A)(i.value,2),s=o[0],l=o[1];if(s in n){var u=n[s];"boolean"===typeof u&&l instanceof qk&&"boolean"===typeof l.element[l.attributeName]?l.booleanValue=u:"function"===typeof u&&l instanceof qk?l.element[l.attributeName]=u:l.value=u}}}catch(BL){r.e(BL)}finally{r.f()}}}},Fk=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(e,i){var a,r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Uk;return(0,m.A)(this,n),a=t.call(this),Pk((0,Ln.A)(a),kk,void 0),Pk((0,Ln.A)(a),Tk,void 0),a.append(e.content.cloneNode(!0)),Nk((0,Ln.A)(a),kk,Bk((0,Ln.A)(a))),Nk((0,Ln.A)(a),Tk,o),null==(r=o.createCallback)||r.call(o,(0,Ln.A)(a),Ok((0,Ln.A)(a),kk),i),o.processCallback((0,Ln.A)(a),Ok((0,Ln.A)(a),kk),i),a}return(0,v.A)(n,[{key:"update",value:function(e){Ok(this,Tk).processCallback(this,Ok(this,kk),e)}}]),n}(Sm.DocumentFragment);kk=new WeakMap,Tk=new WeakMap;var Bk=function e(t){var n,i,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=(0,h.A)(t.attributes||[]);try{for(s.s();!(r=s.n()).done;){var l=r.value;if(l.value.includes("{{")){var u,c=new Vk,d=(0,h.A)(Gk(l.value));try{for(d.s();!(u=d.n()).done;){var v=(0,a.A)(u.value,2);if(n=v[0],i=v[1],n){var m=new qk(t,l.name,l.namespaceURI);c.append(m),o.push([i,m])}else c.append(i)}}catch(BL){d.e(BL)}finally{d.f()}l.value=c.toString()}}}catch(BL){s.e(BL)}finally{s.f()}var p,g=(0,h.A)(t.childNodes);try{for(g.s();!(p=g.n()).done;){var y=p.value;if(1!==y.nodeType||y instanceof HTMLTemplateElement){var E=y.data;if(1===y.nodeType||E.includes("{{")){var A=[];if(E){var b,k=(0,h.A)(Gk(E));try{for(k.s();!(b=k.n()).done;){var T=(0,a.A)(b.value,2);if(n=T[0],i=T[1],n){var _=new Yk(t);A.push(_),o.push([i,_])}else A.push(new Text(i))}}catch(BL){k.e(BL)}finally{k.f()}}else if(y instanceof HTMLTemplateElement){var S=new jk(t,y);A.push(S),o.push([S.expression,S])}y.replaceWith.apply(y,(0,f.A)(A.flatMap((function(e){return e.replacementNodes||[e]}))))}}else e(y,o)}}catch(BL){g.e(BL)}finally{g.f()}return o},Hk={},Gk=function(e){var t,n="",i=0,a=Hk[e],r=0;if(a)return a;for(a=[];t=e[r];r++)"{"===t&&"{"===e[r+1]&&"\\"!==e[r-1]&&e[r+2]&&1==++i?(n&&a.push([0,n]),n="",r++):"}"!==t||"}"!==e[r+1]||"\\"===e[r-1]||--i?n+=t||"":(a.push([1,n.trim()]),n="",r++);return n&&a.push([0,(i>0?"{{":"")+n]),Hk[e]=a},Kk=function(){function e(){(0,m.A)(this,e)}return(0,v.A)(e,[{key:"value",get:function(){return""},set:function(e){}},{key:"toString",value:function(){return this.value}}]),e}(),Wk=new WeakMap,Vk=function(e){function t(){(0,m.A)(this,t),Pk(this,_k,[])}return(0,v.A)(t,[{key:e,value:function(){return Ok(this,_k).values()}},{key:"length",get:function(){return Ok(this,_k).length}},{key:"item",value:function(e){return Ok(this,_k)[e]}},{key:"append",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var i=0,a=t;i<a.length;i++){var r=a[i];r instanceof qk&&Wk.set(r,this),Ok(this,_k).push(r)}}},{key:"toString",value:function(){return Ok(this,_k).join("")}}]),t}(Symbol.iterator);_k=new WeakMap;var qk=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(e,i,a){var r;return(0,m.A)(this,n),r=t.call(this),Pk((0,Ln.A)(r),Ik),Pk((0,Ln.A)(r),Sk,""),Pk((0,Ln.A)(r),wk,void 0),Pk((0,Ln.A)(r),Rk,void 0),Pk((0,Ln.A)(r),Lk,void 0),Nk((0,Ln.A)(r),wk,e),Nk((0,Ln.A)(r),Rk,i),Nk((0,Ln.A)(r),Lk,a),r}return(0,v.A)(n,[{key:"attributeName",get:function(){return Ok(this,Rk)}},{key:"attributeNamespace",get:function(){return Ok(this,Lk)}},{key:"element",get:function(){return Ok(this,wk)}},{key:"value",get:function(){return Ok(this,Sk)},set:function(e){Ok(this,Sk)!==e&&(Nk(this,Sk,e),Ok(this,Ik,Dk)&&1!==Ok(this,Ik,Dk).length?Ok(this,wk).setAttributeNS(Ok(this,Lk),Ok(this,Rk),Ok(this,Ik,Dk).toString()):null==e?Ok(this,wk).removeAttributeNS(Ok(this,Lk),Ok(this,Rk)):Ok(this,wk).setAttributeNS(Ok(this,Lk),Ok(this,Rk),e))}},{key:"booleanValue",get:function(){return Ok(this,wk).hasAttributeNS(Ok(this,Lk),Ok(this,Rk))},set:function(e){if(Ok(this,Ik,Dk)&&1!==Ok(this,Ik,Dk).length)throw new DOMException("Value is not fully templatized");this.value=e?"":null}}]),n}(Kk);Sk=new WeakMap,wk=new WeakMap,Rk=new WeakMap,Lk=new WeakMap,Ik=new WeakSet,Dk=function(){return Wk.get(this)};var Yk=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(e,i){var a;return(0,m.A)(this,n),a=t.call(this),Pk((0,Ln.A)(a),Ck,void 0),Pk((0,Ln.A)(a),xk,void 0),Nk((0,Ln.A)(a),Ck,e),Nk((0,Ln.A)(a),xk,i?(0,f.A)(i):[new Text]),a}return(0,v.A)(n,[{key:"replacementNodes",get:function(){return Ok(this,xk)}},{key:"parentNode",get:function(){return Ok(this,Ck)}},{key:"nextSibling",get:function(){return Ok(this,xk)[Ok(this,xk).length-1].nextSibling}},{key:"previousSibling",get:function(){return Ok(this,xk)[0].previousSibling}},{key:"value",get:function(){return Ok(this,xk).map((function(e){return e.textContent})).join("")},set:function(e){this.replace(e)}},{key:"replace",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=t.flat().flatMap((function(e){return null==e?[new Text]:e.forEach?(0,f.A)(e):11===e.nodeType?(0,f.A)(e.childNodes):e.nodeType?[e]:[new Text(e)]}));i.length||i.push(new Text),Nk(this,xk,zk(Ok(this,xk)[0].parentNode,Ok(this,xk),i,this.nextSibling))}}]),n}(Kk);Ck=new WeakMap,xk=new WeakMap;var jk=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(e,i){var a;(0,m.A)(this,n);var r=i.getAttribute("directive")||i.getAttribute("type"),o=i.getAttribute("expression")||i.getAttribute(r)||"";return o.startsWith("{{")&&(o=o.trim().slice(2,-2).trim()),(a=t.call(this,e)).expression=o,a.template=i,a.directive=r,a}return(0,v.A)(n)}(Yk);function zk(e,t,n){for(var i,a,r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=0,l=n.length,u=t.length;s<l&&s<u&&t[s]==n[s];)s++;for(;s<l&&s<u&&n[l-1]==t[u-1];)o=n[(--u,--l)];if(s==u)for(;s<l;)e.insertBefore(n[s++],o);if(s==l)for(;s<u;)e.removeChild(t[s++]);else{for(i=t[s];s<l;)r=n[s++],a=i?i.nextSibling:o,i==r?i=a:s<l&&n[s]==a?(e.replaceChild(r,i),i=a):e.insertBefore(r,i);for(;i!=o;)a=i.nextSibling,e.removeChild(i),i=a}return n}var Xk={string:function(e){return String(e)}},Qk=(0,v.A)((function e(t){(0,m.A)(this,e),this.template=t,this.state=void 0})),Zk=new WeakMap,Jk=new WeakMap,$k={partial:function(e,t){t[e.expression]=new Qk(e.template)},if:function(e,t){var n;if(aT(e.expression,t))if(Zk.get(e)!==e.template){Zk.set(e,e.template);var i=new Fk(e.template,t,tT);e.replace(i),Jk.set(e,i)}else null==(n=Jk.get(e))||n.update(t);else e.replace(""),Zk.delete(e),Jk.delete(e)}},eT=Object.keys($k),tT={processCallback:function(e,t,n){var i,r;if(n){var o,s=(0,h.A)(t);try{var l=function(){var e=(0,a.A)(o.value,2),t=e[0],s=e[1];if(s instanceof jk){if(!s.directive){var l=eT.find((function(e){return s.template.hasAttribute(e)}));l&&(s.directive=l,s.expression=s.template.getAttribute(l))}return null==(i=$k[s.directive])||i.call($k,s,n),"continue"}var u=aT(t,n);if(u instanceof Qk)return Zk.get(s)!==u.template?(Zk.set(s,u.template),u=new Fk(u.template,u.state,tT),s.value=u,Jk.set(s,u)):null==(r=Jk.get(s))||r.update(u.state),"continue";u?(s instanceof qk&&s.attributeName.startsWith("aria-")&&(u=String(u)),s instanceof qk?"boolean"===typeof u?s.booleanValue=u:"function"===typeof u?s.element[s.attributeName]=u:s.value=u:(s.value=u,Zk.delete(s),Jk.delete(s))):s instanceof qk?s.value=void 0:(s.value=void 0,Zk.delete(s),Jk.delete(s))};for(s.s();!(o=s.n()).done;)l()}catch(BL){s.e(BL)}finally{s.f()}}}},nT={"!":function(e){return!e},"!!":function(e){return!!e},"==":function(e,t){return e==t},"!=":function(e,t){return e!=t},">":function(e,t){return e>t},">=":function(e,t){return e>=t},"<":function(e,t){return e<t},"<=":function(e,t){return e<=t},"??":function(e,t){return null!=e?e:t},"|":function(e,t){var n;return null==(n=Xk[t])?void 0:n.call(Xk,e)}};function iT(e){return function(e,t){var n,i,a,r=[];for(;e;){for(var o in a=null,n=e.length,t)(i=t[o].exec(e))&&i.index<n&&(a={token:i[0],type:o,matches:i.slice(1)},n=i.index);n&&r.push({token:e.substr(0,n),type:void 0}),a&&r.push(a),e=e.substr(n+(a?a.token.length:0))}return r}(e,{boolean:/true|false/,number:/-?\d+\.?\d*/,string:/(["'])((?:\\.|[^\\])*?)\1/,operator:/[!=><][=!]?|\?\?|\|/,ws:/\s+/,param:/[$a-z_][$\w]*/i}).filter((function(e){return"ws"!==e.type}))}function aT(e){var t,n,a,r,o,s,l,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=iT(e);if(0===c.length||c.some((function(e){return!e.type})))return rT(e);if(">"===(null==(t=c[0])?void 0:t.token)){var d=u[null==(n=c[1])?void 0:n.token];if(!d)return rT(e);var h=(0,i.A)({},u);d.state=h;for(var f=c.slice(2),v=0;v<f.length;v+=3){var m=null==(a=f[v])?void 0:a.token,p=null==(r=f[v+1])?void 0:r.token,g=null==(o=f[v+2])?void 0:o.token;m&&"="===p&&(h[m]=sT(g,u))}return d}if(1===c.length)return oT(c[0])?sT(c[0].token,u):rT(e);if(2===c.length){var y=null==(s=c[0])?void 0:s.token,E=nT[y];if(!E||!oT(c[1]))return rT(e);var A=sT(c[1].token,u);return E(A)}if(3===c.length){var b=null==(l=c[1])?void 0:l.token,k=nT[b];if(!k||!oT(c[0])||!oT(c[2]))return rT(e);var T=sT(c[0].token,u);if("|"===b)return k(T,c[2].token);var _=sT(c[2].token,u);return k(T,_)}}function rT(e){return console.warn("Warning: invalid expression `".concat(e,"`")),!1}function oT(e){var t=e.type;return["number","boolean","string","param"].includes(t)}function sT(e,t){var n=e[0],i=e.slice(-1);return"true"===e||"false"===e?"true"===e:n===i&&["'",'"'].includes(n)?e.slice(1,-1):lm(e)?parseFloat(e):t[e]}var lT,uT,cT,dT,hT,fT,vT,mT=function(e,t,n){if(!t.has(e))throw TypeError("Cannot "+n)},pT=function(e,t,n){return mT(e,t,"read from private field"),n?n.call(e):t.get(e)},gT=function(e,t,n){if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},yT=function(e,t,n,i){return mT(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n},ET=function(e,t,n){return mT(e,t,"access private method"),n},AT={mediatargetlivewindow:"targetlivewindow",mediastreamtype:"streamtype"},bT=wm.createElement("template");bT.innerHTML="\n  <style>\n    :host {\n      display: inline-block;\n      line-height: 0;\n    }\n\n    media-controller {\n      width: 100%;\n      height: 100%;\n    }\n\n    media-captions-button:not([mediasubtitleslist]),\n    media-captions-menu:not([mediasubtitleslist]),\n    media-captions-menu-button:not([mediasubtitleslist]),\n    media-audio-track-menu[mediaaudiotrackunavailable],\n    media-audio-track-menu-button[mediaaudiotrackunavailable],\n    media-rendition-menu[mediarenditionunavailable],\n    media-rendition-menu-button[mediarenditionunavailable],\n    media-volume-range[mediavolumeunavailable],\n    media-airplay-button[mediaairplayunavailable],\n    media-fullscreen-button[mediafullscreenunavailable],\n    media-cast-button[mediacastunavailable],\n    media-pip-button[mediapipunavailable] {\n      display: none;\n    }\n  </style>\n";var kT=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){var e;(0,m.A)(this,n),e=t.call(this),gT((0,Ln.A)(e),dT),gT((0,Ln.A)(e),fT),gT((0,Ln.A)(e),lT,void 0),gT((0,Ln.A)(e),uT,void 0),gT((0,Ln.A)(e),cT,void 0),e.shadowRoot?e.renderRoot=e.shadowRoot:(e.renderRoot=e.attachShadow({mode:"open"}),e.createRenderer());var i=new MutationObserver((function(t){var n;e.mediaController&&!(null==(n=e.mediaController)?void 0:n.breakpointsComputed)||t.some((function(t){var n=t.target;return n===(0,Ln.A)(e)||"media-controller"===n.localName&&(!!AT[t.attributeName]||!!t.attributeName.startsWith("breakpoint"))}))&&e.render()}));return i.observe((0,Ln.A)(e),{attributes:!0}),i.observe(e.renderRoot,{attributes:!0,subtree:!0}),e.addEventListener(qv.BREAKPOINTS_COMPUTED,e.render),ET((0,Ln.A)(e),dT,hT).call((0,Ln.A)(e),"template"),e}return(0,v.A)(n,[{key:"mediaController",get:function(){return this.renderRoot.querySelector("media-controller")}},{key:"template",get:function(){var e;return null!=(e=pT(this,lT))?e:this.constructor.template},set:function(e){yT(this,cT,null),yT(this,lT,e),this.createRenderer()}},{key:"props",get:function(){var e,t,n,i,a=[].concat((0,f.A)(Array.from(null!=(t=null==(e=this.mediaController)?void 0:e.attributes)?t:[]).filter((function(e){var t=e.name;return AT[t]||t.startsWith("breakpoint")}))),(0,f.A)(Array.from(this.attributes))),r={},o=(0,h.A)(a);try{for(o.s();!(i=o.n()).done;){var s=i.value,l=null!=(n=AT[s.name])?n:om(s.name),u=s.value;null!=u?(lm(u)&&(u=parseFloat(u)),r[l]=""===u||u):r[l]=!1}}catch(BL){o.e(BL)}finally{o.f()}return r}},{key:"attributeChangedCallback",value:function(e,t,n){"template"===e&&t!=n&&ET(this,fT,vT).call(this)}},{key:"connectedCallback",value:function(){ET(this,fT,vT).call(this)}},{key:"createRenderer",value:function(){this.template&&this.template!==pT(this,uT)&&(yT(this,uT,this.template),this.renderer=new Fk(this.template,this.props,this.constructor.processor),this.renderRoot.textContent="",this.renderRoot.append(bT.content.cloneNode(!0),this.renderer))}},{key:"render",value:function(){var e;null==(e=this.renderer)||e.update(this.props)}}]),n}(Sm.HTMLElement);function TT(){return(TT=(0,d.A)((0,l.A)().mark((function e(t){var n;return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:if(200===(n=e.sent).status){e.next=5;break}throw new Error("Failed to load resource: the server responded with a status of ".concat(n.status));case 5:return e.abrupt("return",n.text());case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _T(e){var t=e.anchor,n=e.floating,i=e.placement,a=function(e){var t=e.anchor,n=e.floating;return{anchor:ST(t,n.offsetParent),floating:{x:0,y:0,width:n.offsetWidth,height:n.offsetHeight}}}({anchor:t,floating:n}),r=function(e,t){var n,i=e.anchor,a=e.floating,r="x"===function(e){return["top","bottom"].includes(wT(e))?"y":"x"}(t)?"y":"x",o="y"===r?"height":"width",s=wT(t),l=i.x+i.width/2-a.width/2,u=i.y+i.height/2-a.height/2,c=i[o]/2-a[o]/2;switch(s){case"top":n={x:l,y:i.y-a.height};break;case"bottom":n={x:l,y:i.y+i.height};break;case"right":n={x:i.x+i.width,y:u};break;case"left":n={x:i.x-a.width,y:u};break;default:n={x:i.x,y:i.y}}switch(t.split("-")[1]){case"start":n[r]-=c;break;case"end":n[r]+=c}return n}(a,i);return{x:r.x,y:r.y}}function ST(e,t){var n,i=e.getBoundingClientRect(),a=null!=(n=null==t?void 0:t.getBoundingClientRect())?n:{x:0,y:0};return{x:i.x-a.x,y:i.y-a.y,width:i.width,height:i.height}}function wT(e){return e.split("-")[0]}lT=new WeakMap,uT=new WeakMap,cT=new WeakMap,dT=new WeakSet,hT=function(e){if(Object.prototype.hasOwnProperty.call(this,e)){var t=this[e];delete this[e],this[e]=t}},fT=new WeakSet,vT=function(){var e,t=this,n=this.getAttribute("template");if(n&&n!==pT(this,cT)){var i=this.getRootNode(),a=null==(e=null==i?void 0:i.getElementById)?void 0:e.call(i,n);if(a)return yT(this,cT,n),yT(this,lT,a),void this.createRenderer();(function(e){if(!/^(\/|\.\/|https?:\/\/)/.test(e))return!1;var t=/^https?:\/\//.test(e)?void 0:location.origin;try{new URL(e,t)}catch(Rv){return!1}return!0})(n)&&(yT(this,cT,n),function(e){return TT.apply(this,arguments)}(n).then((function(e){var n=wm.createElement("template");n.innerHTML=e,yT(t,lT,n),t.createRenderer()})).catch(console.error))}},kT.observedAttributes=["template"],kT.processor=tT,Sm.customElements.get("media-theme")||Sm.customElements.define("media-theme",kT);var RT,LT,IT,DT,CT,xT,MT,OT,PT,NT,UT,FT,BT,HT,GT,KT,WT,VT,qT,YT,jT,zT,XT,QT,ZT,JT,$T,e_,t_,n_,i_,a_,r_,o_,s_,l_,u_,c_,d_,h_,f_,v_,m_,p_,g_=["action","relatedTarget"],y_=["newState","oldState"],E_=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(e){var i,a=e.action,o=void 0===a?"auto":a,s=e.relatedTarget,l=(0,r.A)(e,g_);return(0,m.A)(this,n),(i=t.call(this,"invoke",l)).action=o,i.relatedTarget=s,i}return(0,v.A)(n)}((0,y.A)(Event)),A_=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(e){var i,a=e.newState,o=e.oldState,s=(0,r.A)(e,y_);return(0,m.A)(this,n),(i=t.call(this,"toggle",s)).newState=a,i.oldState=o,i}return(0,v.A)(n)}((0,y.A)(Event)),b_=function(e,t,n){if(!t.has(e))throw TypeError("Cannot "+n)},k_=function(e,t,n){return b_(e,t,"read from private field"),n?n.call(e):t.get(e)},T_=function(e,t,n){if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},__=function(e,t,n,i){return b_(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n},S_=function(e,t,n){return b_(e,t,"access private method"),n};function w_(e){var t=e.type,n=e.text,i=e.value,a=e.checked,r=wm.createElement("media-chrome-menu-item");r.type=null!=t?t:"",r.part.add("menu-item"),t&&r.part.add(t),r.value=i,r.checked=a;var o=wm.createElement("span");return o.textContent=n,r.append(o),r}function R_(e,t){var n=e.querySelector(':scope > [slot="'.concat(t,'"]'));if("SLOT"==(null==n?void 0:n.nodeName)&&(n=n.assignedElements({flatten:!0})[0]),n)return n=n.cloneNode(!0);var i=e.shadowRoot.querySelector('[name="'.concat(t,'"] > svg'));return i?i.cloneNode(!0):""}var L_="style",I_="hidden",D_="disabled",C_="anchor",x_=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){var e;if((0,m.A)(this,n),e=t.call(this),T_((0,Ln.A)(e),OT),T_((0,Ln.A)(e),UT),T_((0,Ln.A)(e),BT),T_((0,Ln.A)(e),GT),T_((0,Ln.A)(e),WT),T_((0,Ln.A)(e),jT),T_((0,Ln.A)(e),XT),T_((0,Ln.A)(e),ZT),T_((0,Ln.A)(e),$T),T_((0,Ln.A)(e),t_),T_((0,Ln.A)(e),i_),T_((0,Ln.A)(e),r_),T_((0,Ln.A)(e),s_),T_((0,Ln.A)(e),u_),T_((0,Ln.A)(e),d_),T_((0,Ln.A)(e),f_),T_((0,Ln.A)(e),m_),T_((0,Ln.A)(e),RT,null),T_((0,Ln.A)(e),LT,null),T_((0,Ln.A)(e),IT,null),T_((0,Ln.A)(e),DT,new Set),T_((0,Ln.A)(e),CT,void 0),T_((0,Ln.A)(e),xT,!1),T_((0,Ln.A)(e),MT,null),T_((0,Ln.A)(e),NT,(function(){var t,n=k_((0,Ln.A)(e),DT),i=new Set(e.items),a=(0,h.A)(n);try{for(a.s();!(t=a.n()).done;){var r=t.value;i.has(r)||e.dispatchEvent(new CustomEvent("removemenuitem",{detail:r}))}}catch(BL){a.e(BL)}finally{a.f()}var o,s=(0,h.A)(i);try{for(s.s();!(o=s.n()).done;){var l=o.value;n.has(l)||e.dispatchEvent(new CustomEvent("addmenuitem",{detail:l}))}}catch(BL){s.e(BL)}finally{s.f()}__((0,Ln.A)(e),DT,i)})),T_((0,Ln.A)(e),qT,(function(){S_((0,Ln.A)(e),jT,zT).call((0,Ln.A)(e)),S_((0,Ln.A)(e),XT,QT).call((0,Ln.A)(e),!1)})),T_((0,Ln.A)(e),YT,(function(){S_((0,Ln.A)(e),jT,zT).call((0,Ln.A)(e))})),!e.shadowRoot){e.attachShadow(e.constructor.shadowRootOptions);var i=xm(e.attributes);e.shadowRoot.innerHTML=e.constructor.getTemplateHTML(i)}return e.container=e.shadowRoot.querySelector("#container"),e.defaultSlot=e.shadowRoot.querySelector("slot:not([name])"),e.shadowRoot.addEventListener("slotchange",(0,Ln.A)(e)),__((0,Ln.A)(e),CT,new MutationObserver(k_((0,Ln.A)(e),NT))),k_((0,Ln.A)(e),CT).observe(e.defaultSlot,{childList:!0}),e}return(0,v.A)(n,[{key:"enable",value:function(){this.addEventListener("click",this),this.addEventListener("focusout",this),this.addEventListener("keydown",this),this.addEventListener("invoke",this),this.addEventListener("toggle",this)}},{key:"disable",value:function(){this.removeEventListener("click",this),this.removeEventListener("focusout",this),this.removeEventListener("keyup",this),this.removeEventListener("invoke",this),this.removeEventListener("toggle",this)}},{key:"handleEvent",value:function(e){switch(e.type){case"slotchange":S_(this,OT,PT).call(this,e);break;case"invoke":S_(this,BT,HT).call(this,e);break;case"click":S_(this,ZT,JT).call(this,e);break;case"toggle":S_(this,t_,n_).call(this,e);break;case"focusout":S_(this,r_,o_).call(this,e);break;case"keydown":S_(this,s_,l_).call(this,e)}}},{key:"connectedCallback",value:function(){var e,t;__(this,MT,Wm(this.shadowRoot,":host")),S_(this,UT,FT).call(this),this.hasAttribute("disabled")||this.enable(),this.role||(this.role="menu"),__(this,RT,Om(this)),null==(t=null==(e=k_(this,RT))?void 0:e.associateElement)||t.call(e,this),this.hidden||(Dm(O_(this),k_(this,qT)),Dm(this,k_(this,YT)))}},{key:"disconnectedCallback",value:function(){var e,t;Cm(O_(this),k_(this,qT)),Cm(this,k_(this,YT)),this.disable(),null==(t=null==(e=k_(this,RT))?void 0:e.unassociateElement)||t.call(e,this),__(this,RT,null)}},{key:"attributeChangedCallback",value:function(e,t,n){var i,a,r,o;e===I_&&n!==t?(k_(this,xT)||__(this,xT,!0),this.hidden?S_(this,WT,VT).call(this):S_(this,GT,KT).call(this),this.dispatchEvent(new A_({oldState:this.hidden?"open":"closed",newState:this.hidden?"closed":"open",bubbles:!0}))):e===Gv?(t&&(null==(a=null==(i=k_(this,RT))?void 0:i.unassociateElement)||a.call(i,this),__(this,RT,null)),n&&this.isConnected&&(__(this,RT,Om(this)),null==(o=null==(r=k_(this,RT))?void 0:r.associateElement)||o.call(r,this))):e===D_&&n!==t?null==n?this.enable():this.disable():e===L_&&n!==t&&S_(this,UT,FT).call(this)}},{key:"formatMenuItemText",value:function(e,t){return this.constructor.formatMenuItemText(e,t)}},{key:"anchor",get:function(){return this.getAttribute("anchor")},set:function(e){this.setAttribute("anchor","".concat(e))}},{key:"anchorElement",get:function(){var e;return this.anchor?null==(e=Hm(this))?void 0:e.querySelector("#".concat(this.anchor)):null}},{key:"items",get:function(){return this.defaultSlot.assignedElements({flatten:!0}).filter(M_)}},{key:"radioGroupItems",get:function(){return this.items.filter((function(e){return"menuitemradio"===e.role}))}},{key:"checkedItems",get:function(){return this.items.filter((function(e){return e.checked}))}},{key:"value",get:function(){var e,t;return null!=(t=null==(e=this.checkedItems[0])?void 0:e.value)?t:""},set:function(e){var t=this.items.find((function(t){return t.value===e}));t&&S_(this,m_,p_).call(this,t)}},{key:"focus",value:function(){if(__(this,LT,Bm()),this.items.length)return S_(this,f_,v_).call(this,this.items[0]),void this.items[0].focus();var e=this.querySelector('[autofocus], [tabindex]:not([tabindex="-1"]), [role="menu"]');null==e||e.focus()}},{key:"handleSelect",value:function(e){var t,n=S_(this,u_,c_).call(this,e);n&&(S_(this,m_,p_).call(this,n,"checkbox"===n.type),k_(this,IT)&&!this.hidden&&(null==(t=k_(this,LT))||t.focus(),this.hidden=!0))}},{key:"keysUsed",get:function(){return["Enter","Escape","Tab"," ","ArrowDown","ArrowUp","Home","End"]}},{key:"handleMove",value:function(e){var t,n,i=e.key,a=this.items,r=null!=(n=null!=(t=S_(this,u_,c_).call(this,e))?t:S_(this,d_,h_).call(this))?n:a[0],o=a.indexOf(r),s=Math.max(0,o);"ArrowDown"===i?s++:"ArrowUp"===i?s--:"Home"===e.key?s=0:"End"===e.key&&(s=a.length-1),s<0&&(s=a.length-1),s>a.length-1&&(s=0),S_(this,f_,v_).call(this,a[s]),a[s].focus()}}],[{key:"observedAttributes",get:function(){return[D_,I_,L_,C_,Gv]}},{key:"formatMenuItemText",value:function(e,t){return e}}]),n}(Sm.HTMLElement);function M_(e){return["menuitem","menuitemradio","menuitemcheckbox"].includes(null==e?void 0:e.role)}function O_(e){var t;return null!=(t=e.getAttribute("bounds")?Fm(e,"#".concat(e.getAttribute("bounds"))):Mm(e)||e.parentElement)?t:e}RT=new WeakMap,LT=new WeakMap,IT=new WeakMap,DT=new WeakMap,CT=new WeakMap,xT=new WeakMap,MT=new WeakMap,OT=new WeakSet,PT=function(e){var t,n=e.target,i=(0,h.A)(n.assignedNodes({flatten:!0}));try{for(i.s();!(t=i.n()).done;){var a=t.value;3===a.nodeType&&""===a.textContent.trim()&&a.remove()}}catch(BL){i.e(BL)}finally{i.f()}["header","title"].includes(n.name)&&(this.shadowRoot.querySelector('slot[name="header"]').hidden=0===n.assignedNodes().length);n.name||k_(this,NT).call(this)},NT=new WeakMap,UT=new WeakSet,FT=function(){var e,t=this.shadowRoot.querySelector("#layout-row"),n=null==(e=getComputedStyle(this).getPropertyValue("--media-menu-layout"))?void 0:e.trim();t.setAttribute("media","row"===n?"":"width:0")},BT=new WeakSet,HT=function(e){__(this,IT,e.relatedTarget),Um(this,e.relatedTarget)||(this.hidden=!this.hidden)},GT=new WeakSet,KT=function(){var e,t=this;null==(e=k_(this,IT))||e.setAttribute("aria-expanded","true"),this.addEventListener("transitionend",(function(){return t.focus()}),{once:!0}),Dm(O_(this),k_(this,qT)),Dm(this,k_(this,YT))},WT=new WeakSet,VT=function(){var e;null==(e=k_(this,IT))||e.setAttribute("aria-expanded","false"),Cm(O_(this),k_(this,qT)),Cm(this,k_(this,YT))},qT=new WeakMap,YT=new WeakMap,jT=new WeakSet,zT=function(e){if((!this.hasAttribute("mediacontroller")||this.anchor)&&!this.hidden&&this.anchorElement){var t=_T({anchor:this.anchorElement,floating:this,placement:"top-start"}),n=t.x,i=t.y;null!=e||(e=this.offsetWidth);var a=O_(this).getBoundingClientRect(),r=a.width-n-e,o=a.height-i-this.offsetHeight,s=k_(this,MT).style;s.setProperty("position","absolute"),s.setProperty("right","".concat(Math.max(0,r),"px")),s.setProperty("--_menu-bottom","".concat(o,"px"));var l=getComputedStyle(this),u=s.getPropertyValue("--_menu-bottom")===l.bottom?o:parseFloat(l.bottom),c=a.height-u-parseFloat(l.marginBottom);this.style.setProperty("--_menu-max-height","".concat(c,"px"))}},XT=new WeakSet,QT=function(e){var t=this.querySelector('[role="menuitem"][aria-haspopup][aria-expanded="true"]'),n=null==t?void 0:t.querySelector('[role="menu"]'),i=k_(this,MT).style;if(e||i.setProperty("--media-menu-transition-in","none"),n){var a=n.offsetHeight,r=Math.max(n.offsetWidth,t.offsetWidth);this.style.setProperty("min-width","".concat(r,"px")),this.style.setProperty("min-height","".concat(a,"px")),S_(this,jT,zT).call(this,r)}else this.style.removeProperty("min-width"),this.style.removeProperty("min-height"),S_(this,jT,zT).call(this);i.removeProperty("--media-menu-transition-in")},ZT=new WeakSet,JT=function(e){var t;if(e.stopPropagation(),e.composedPath().includes(k_(this,$T,e_)))return null==(t=k_(this,LT))||t.focus(),void(this.hidden=!0);var n=S_(this,u_,c_).call(this,e);n&&!n.hasAttribute("disabled")&&(S_(this,f_,v_).call(this,n),this.handleSelect(e))},$T=new WeakSet,e_=function(){var e;return null==(e=this.shadowRoot.querySelector('slot[name="header"]').assignedElements({flatten:!0}))?void 0:e.find((function(e){return e.matches('button[part~="back"]')}))},t_=new WeakSet,n_=function(e){if(e.target!==this){S_(this,i_,a_).call(this);for(var t=Array.from(this.querySelectorAll('[role="menuitem"][aria-haspopup]')),n=0,i=t;n<i.length;n++){var a=i[n];a.invokeTargetElement!=e.target&&("open"!=e.newState||"true"!=a.getAttribute("aria-expanded")||a.invokeTargetElement.hidden||a.invokeTargetElement.dispatchEvent(new E_({relatedTarget:a})))}for(var r=0,o=t;r<o.length;r++){var s=o[r];s.setAttribute("aria-expanded","".concat(!s.submenuElement.hidden))}S_(this,XT,QT).call(this,!0)}},i_=new WeakSet,a_=function(){var e=this.querySelector('[role="menuitem"] > [role="menu"]:not([hidden])');this.container.classList.toggle("has-expanded",!!e)},r_=new WeakSet,o_=function(e){var t;Um(this,e.relatedTarget)||(k_(this,xT)&&(null==(t=k_(this,LT))||t.focus()),k_(this,IT)&&k_(this,IT)!==e.relatedTarget&&!this.hidden&&(this.hidden=!0))},s_=new WeakSet,l_=function(e){var t,n,i,a,r,o=e.key,s=e.ctrlKey,l=e.altKey,u=e.metaKey;if(!(s||l||u)&&this.keysUsed.includes(o))if(e.preventDefault(),e.stopPropagation(),"Tab"===o){if(k_(this,xT))return void(this.hidden=!0);e.shiftKey?null==(n=null==(t=this.previousElementSibling)?void 0:t.focus)||n.call(t):null==(a=null==(i=this.nextElementSibling)?void 0:i.focus)||a.call(i),this.blur()}else"Escape"===o?(null==(r=k_(this,LT))||r.focus(),k_(this,xT)&&(this.hidden=!0)):"Enter"===o||" "===o?this.handleSelect(e):this.handleMove(e)},u_=new WeakSet,c_=function(e){return e.composedPath().find((function(e){return["menuitemradio","menuitemcheckbox"].includes(e.role)}))},d_=new WeakSet,h_=function(){return this.items.find((function(e){return 0===e.tabIndex}))},f_=new WeakSet,v_=function(e){var t,n=(0,h.A)(this.items);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.tabIndex=i===e?0:-1}}catch(BL){n.e(BL)}finally{n.f()}},m_=new WeakSet,p_=function(e,t){var n=(0,f.A)(this.checkedItems);"radio"===e.type&&this.radioGroupItems.forEach((function(e){return e.checked=!1})),e.checked=!t||!e.checked,this.checkedItems.some((function(e,t){return e!=n[t]}))&&this.dispatchEvent(new Event("change",{bubbles:!0,composed:!0}))},x_.shadowRootOptions={mode:"open"},x_.getTemplateHTML=function(e){return"\n    <style>\n      :host {\n        font: var(--media-font,\n          var(--media-font-weight, normal)\n          var(--media-font-size, 14px) /\n          var(--media-text-content-height, var(--media-control-height, 24px))\n          var(--media-font-family, helvetica neue, segoe ui, roboto, arial, sans-serif));\n        color: var(--media-text-color, var(--media-primary-color, rgb(238 238 238)));\n        --_menu-bg: rgb(20 20 30 / .8);\n        background: var(--media-menu-background, var(--media-control-background, var(--media-secondary-color, var(--_menu-bg))));\n        border-radius: var(--media-menu-border-radius);\n        border: var(--media-menu-border, none);\n        display: var(--media-menu-display, inline-flex);\n        transition: var(--media-menu-transition-in,\n          visibility 0s,\n          opacity .2s ease-out,\n          transform .15s ease-out,\n          left .2s ease-in-out,\n          min-width .2s ease-in-out,\n          min-height .2s ease-in-out\n        ) !important;\n        ".concat("\n        visibility: var(--media-menu-visibility, visible);\n        opacity: var(--media-menu-opacity, 1);\n        max-height: var(--media-menu-max-height, var(--_menu-max-height, 300px));\n        transform: var(--media-menu-transform-in, translateY(0) scale(1));\n        flex-direction: column;\n        ",'\n        min-height: 0;\n        position: relative;\n        bottom: var(--_menu-bottom);\n        box-sizing: border-box;\n      } \n\n      @-moz-document url-prefix() {\n        :host{\n          --_menu-bg: rgb(20 20 30);\n        }\n      }\n\n      :host([hidden]) {\n        transition: var(--media-menu-transition-out,\n          visibility .15s ease-in,\n          opacity .15s ease-in,\n          transform .15s ease-in\n        ) !important;\n        visibility: var(--media-menu-hidden-visibility, hidden);\n        opacity: var(--media-menu-hidden-opacity, 0);\n        max-height: var(--media-menu-hidden-max-height,\n          var(--media-menu-max-height, var(--_menu-max-height, 300px)));\n        transform: var(--media-menu-transform-out, translateY(2px) scale(.99));\n        pointer-events: none;\n      }\n\n      :host([slot="submenu"]) {\n        background: none;\n        width: 100%;\n        min-height: 100%;\n        position: absolute;\n        bottom: 0;\n        right: -100%;\n      }\n\n      #container {\n        display: flex;\n        flex-direction: column;\n        min-height: 0;\n        transition: transform .2s ease-out;\n        transform: translate(0, 0);\n      }\n\n      #container.has-expanded {\n        transition: transform .2s ease-in;\n        transform: translate(-100%, 0);\n      }\n\n      button {\n        background: none;\n        color: inherit;\n        border: none;\n        padding: 0;\n        font: inherit;\n        outline: inherit;\n        display: inline-flex;\n        align-items: center;\n      }\n\n      slot[name="header"][hidden] {\n        display: none;\n      }\n\n      slot[name="header"] > *,\n      slot[name="header"]::slotted(*) {\n        padding: .4em .7em;\n        border-bottom: 1px solid rgb(255 255 255 / .25);\n        cursor: var(--media-cursor, default);\n      }\n\n      slot[name="header"] > button[part~="back"],\n      slot[name="header"]::slotted(button[part~="back"]) {\n        cursor: var(--media-cursor, pointer);\n      }\n\n      svg[part~="back"] {\n        height: var(--media-menu-icon-height, var(--media-control-height, 24px));\n        fill: var(--media-icon-color, var(--media-primary-color, rgb(238 238 238)));\n        display: block;\n        margin-right: .5ch;\n      }\n\n      slot:not([name]) {\n        gap: var(--media-menu-gap);\n        flex-direction: var(--media-menu-flex-direction, column);\n        overflow: var(--media-menu-overflow, hidden auto);\n        display: flex;\n        min-height: 0;\n      }\n\n      :host([role="menu"]) slot:not([name]) {\n        padding-block: .4em;\n      }\n\n      slot:not([name])::slotted([role="menu"]) {\n        background: none;\n      }\n\n      media-chrome-menu-item > span {\n        margin-right: .5ch;\n        max-width: var(--media-menu-item-max-width);\n        text-overflow: ellipsis;\n        overflow: hidden;\n      }\n    </style>\n    <style id="layout-row" media="width:0">\n\n      slot[name="header"] > *,\n      slot[name="header"]::slotted(*) {\n        padding: .4em .5em;\n      }\n\n      slot:not([name]) {\n        gap: var(--media-menu-gap, .25em);\n        flex-direction: var(--media-menu-flex-direction, row);\n        padding-inline: .5em;\n      }\n\n      media-chrome-menu-item {\n        padding: .3em .5em;\n      }\n\n      media-chrome-menu-item[aria-checked="true"] {\n        background: var(--media-menu-item-checked-background, rgb(255 255 255 / .2));\n      }\n\n      ','\n      media-chrome-menu-item::part(checked-indicator) {\n        display: var(--media-menu-item-checked-indicator-display, none);\n      }\n    </style>\n    <div id="container">\n      <slot name="header" hidden>\n        <button part="back button" aria-label="Back to previous menu">\n          <slot name="back-icon">\n            <svg aria-hidden="true" viewBox="0 0 20 24" part="back indicator">\n              <path d="m11.88 17.585.742-.669-4.2-4.665 4.2-4.666-.743-.669-4.803 5.335 4.803 5.334Z"/>\n            </svg>\n          </slot>\n          <slot name="title"></slot>\n        </button>\n      </slot>\n      <slot></slot>\n    </div>\n    <slot name="checked-indicator" hidden></slot>\n  ')},Sm.customElements.get("media-chrome-menu")||Sm.customElements.define("media-chrome-menu",x_);var P_,N_,U_,F_,B_,H_,G_,K_,W_,V_,q_,Y_,j_,z_,X_,Q_=function(e,t,n){if(!t.has(e))throw TypeError("Cannot "+n)},Z_=function(e,t,n){return Q_(e,t,"read from private field"),n?n.call(e):t.get(e)},J_=function(e,t,n){if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},$_=function(e,t,n,i){return Q_(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n},eS=function(e,t,n){return Q_(e,t,"access private method"),n};var tS="type",nS="value",iS="checked",aS="disabled",rS=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){var e;if((0,m.A)(this,n),e=t.call(this),J_((0,Ln.A)(e),U_),J_((0,Ln.A)(e),B_),J_((0,Ln.A)(e),G_),J_((0,Ln.A)(e),V_),J_((0,Ln.A)(e),Y_),J_((0,Ln.A)(e),z_),J_((0,Ln.A)(e),P_,!1),J_((0,Ln.A)(e),N_,void 0),J_((0,Ln.A)(e),W_,(function(){var t,n;e.setAttribute("submenusize","".concat(e.submenuElement.items.length));var i=e.shadowRoot.querySelector('slot[name="description"]'),a=null==(t=e.submenuElement.checkedItems)?void 0:t[0],r=null!=(n=null==a?void 0:a.dataset.description)?n:null==a?void 0:a.text,o=wm.createElement("span");o.textContent=null!=r?r:"",i.replaceChildren(o)})),!e.shadowRoot){e.attachShadow(e.constructor.shadowRootOptions);var i=xm(e.attributes);e.shadowRoot.innerHTML=e.constructor.getTemplateHTML(i)}return e.shadowRoot.addEventListener("slotchange",(0,Ln.A)(e)),e}return(0,v.A)(n,[{key:"enable",value:function(){this.hasAttribute("tabindex")||this.setAttribute("tabindex","-1"),oS(this)&&!this.hasAttribute("aria-checked")&&this.setAttribute("aria-checked","false"),this.addEventListener("click",this),this.addEventListener("keydown",this)}},{key:"disable",value:function(){this.removeAttribute("tabindex"),this.removeEventListener("click",this),this.removeEventListener("keydown",this),this.removeEventListener("keyup",this)}},{key:"handleEvent",value:function(e){switch(e.type){case"slotchange":eS(this,U_,F_).call(this,e);break;case"click":this.handleClick(e);break;case"keydown":eS(this,Y_,j_).call(this,e);break;case"keyup":eS(this,V_,q_).call(this,e)}}},{key:"attributeChangedCallback",value:function(e,t,n){e===iS&&oS(this)&&!Z_(this,P_)?this.setAttribute("aria-checked",null!=n?"true":"false"):e===tS&&n!==t?this.role="menuitem"+n:e===aS&&n!==t&&(null==n?this.enable():this.disable())}},{key:"connectedCallback",value:function(){this.hasAttribute(aS)||this.enable(),this.role="menuitem"+this.type,$_(this,N_,sS(this,this.parentNode)),eS(this,z_,X_).call(this)}},{key:"disconnectedCallback",value:function(){this.disable(),eS(this,z_,X_).call(this),$_(this,N_,null)}},{key:"invokeTarget",get:function(){return this.getAttribute("invoketarget")},set:function(e){this.setAttribute("invoketarget","".concat(e))}},{key:"invokeTargetElement",get:function(){var e;return this.invokeTarget?null==(e=Hm(this))?void 0:e.querySelector("#".concat(this.invokeTarget)):this.submenuElement}},{key:"submenuElement",get:function(){return this.shadowRoot.querySelector('slot[name="submenu"]').assignedElements({flatten:!0})[0]}},{key:"type",get:function(){var e;return null!=(e=this.getAttribute(tS))?e:""},set:function(e){this.setAttribute(tS,"".concat(e))}},{key:"value",get:function(){var e;return null!=(e=this.getAttribute(nS))?e:this.text},set:function(e){this.setAttribute(nS,e)}},{key:"text",get:function(){var e;return(null!=(e=this.textContent)?e:"").trim()}},{key:"checked",get:function(){if(oS(this))return"true"===this.getAttribute("aria-checked")},set:function(e){oS(this)&&($_(this,P_,!0),this.setAttribute("aria-checked",e?"true":"false"),e?this.part.add("checked"):this.part.remove("checked"))}},{key:"handleClick",value:function(e){oS(this)||this.invokeTargetElement&&Um(this,e.target)&&this.invokeTargetElement.dispatchEvent(new E_({relatedTarget:this}))}},{key:"keysUsed",get:function(){return["Enter"," "]}}],[{key:"observedAttributes",get:function(){return[tS,aS,iS,nS]}}]),n}(Sm.HTMLElement);function oS(e){return"radio"===e.type||"checkbox"===e.type}function sS(e,t){if(!e)return null;var n=e.getRootNode().host;return!t&&n?sS(e,n):(null==t?void 0:t.items)?t:sS(t,null==t?void 0:t.parentNode)}P_=new WeakMap,N_=new WeakMap,U_=new WeakSet,F_=function(e){var t=e.target;if(!(null==t?void 0:t.name)){var n,i=(0,h.A)(t.assignedNodes({flatten:!0}));try{for(i.s();!(n=i.n()).done;){var a=n.value;a instanceof Text&&""===a.textContent.trim()&&a.remove()}}catch(BL){i.e(BL)}finally{i.f()}}"submenu"===t.name&&(this.submenuElement?eS(this,B_,H_).call(this):eS(this,G_,K_).call(this))},B_=new WeakSet,H_=function(){var e=(0,d.A)((0,l.A)().mark((function e(){return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setAttribute("aria-haspopup","menu"),this.setAttribute("aria-expanded","".concat(!this.submenuElement.hidden)),this.submenuElement.addEventListener("change",Z_(this,W_)),this.submenuElement.addEventListener("addmenuitem",Z_(this,W_)),this.submenuElement.addEventListener("removemenuitem",Z_(this,W_)),Z_(this,W_).call(this);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),G_=new WeakSet,K_=function(){this.removeAttribute("aria-haspopup"),this.removeAttribute("aria-expanded"),this.submenuElement.removeEventListener("change",Z_(this,W_)),this.submenuElement.removeEventListener("addmenuitem",Z_(this,W_)),this.submenuElement.removeEventListener("removemenuitem",Z_(this,W_)),Z_(this,W_).call(this)},W_=new WeakMap,V_=new WeakSet,q_=function(e){var t=e.key;this.keysUsed.includes(t)?this.handleClick(e):this.removeEventListener("keyup",eS(this,V_,q_))},Y_=new WeakSet,j_=function(e){var t=e.metaKey,n=e.altKey,i=e.key;t||n||!this.keysUsed.includes(i)?this.removeEventListener("keyup",eS(this,V_,q_)):this.addEventListener("keyup",eS(this,V_,q_),{once:!0})},z_=new WeakSet,X_=function(){var e,t=null==(e=Z_(this,N_))?void 0:e.radioGroupItems;if(t){var n=t.filter((function(e){return"true"===e.getAttribute("aria-checked")})).pop();n||(n=t[0]);var i,a=(0,h.A)(t);try{for(a.s();!(i=a.n()).done;){i.value.setAttribute("aria-checked","false")}}catch(BL){a.e(BL)}finally{a.f()}null==n||n.setAttribute("aria-checked","true")}},rS.shadowRootOptions={mode:"open"},rS.getTemplateHTML=function(e){return'\n    <style>\n      :host {\n        transition: var(--media-menu-item-transition,\n          background .15s linear,\n          opacity .2s ease-in-out\n        );\n        outline: var(--media-menu-item-outline, 0);\n        outline-offset: var(--media-menu-item-outline-offset, -1px);\n        cursor: var(--media-cursor, pointer);\n        display: flex;\n        align-items: center;\n        align-self: stretch;\n        justify-self: stretch;\n        white-space: nowrap;\n        white-space-collapse: collapse;\n        text-wrap: nowrap;\n        padding: .4em .8em .4em 1em;\n      }\n\n      :host(:focus-visible) {\n        box-shadow: var(--media-menu-item-focus-shadow, inset 0 0 0 2px rgb(27 127 204 / .9));\n        outline: var(--media-menu-item-hover-outline, 0);\n        outline-offset: var(--media-menu-item-hover-outline-offset,  var(--media-menu-item-outline-offset, -1px));\n      }\n\n      :host(:hover) {\n        cursor: var(--media-cursor, pointer);\n        background: var(--media-menu-item-hover-background, rgb(92 92 102 / .5));\n        outline: var(--media-menu-item-hover-outline);\n        outline-offset: var(--media-menu-item-hover-outline-offset,  var(--media-menu-item-outline-offset, -1px));\n      }\n\n      :host([aria-checked="true"]) {\n        background: var(--media-menu-item-checked-background);\n      }\n\n      :host([hidden]) {\n        display: none;\n      }\n\n      :host([disabled]) {\n        pointer-events: none;\n        color: rgba(255, 255, 255, .3);\n      }\n\n      slot:not([name]) {\n        width: 100%;\n      }\n\n      slot:not([name="submenu"]) {\n        display: inline-flex;\n        align-items: center;\n        transition: inherit;\n        opacity: var(--media-menu-item-opacity, 1);\n      }\n\n      slot[name="description"] {\n        justify-content: end;\n      }\n\n      slot[name="description"] > span {\n        display: inline-block;\n        margin-inline: 1em .2em;\n        max-width: var(--media-menu-item-description-max-width, 100px);\n        text-overflow: ellipsis;\n        overflow: hidden;\n        font-size: .8em;\n        font-weight: 400;\n        text-align: right;\n        position: relative;\n        top: .04em;\n      }\n\n      slot[name="checked-indicator"] {\n        display: none;\n      }\n\n      :host(:is([role="menuitemradio"],[role="menuitemcheckbox"])) slot[name="checked-indicator"] {\n        display: var(--media-menu-item-checked-indicator-display, inline-block);\n      }\n\n      '.concat("\n      svg, img, ::slotted(svg), ::slotted(img) {\n        height: var(--media-menu-item-icon-height, var(--media-control-height, 24px));\n        fill: var(--media-icon-color, var(--media-primary-color, rgb(238 238 238)));\n        display: block;\n      }\n\n      ",'\n      [part~="indicator"],\n      ::slotted([part~="indicator"]) {\n        fill: var(--media-menu-item-indicator-fill,\n          var(--media-icon-color, var(--media-primary-color, rgb(238 238 238))));\n        height: var(--media-menu-item-indicator-height, 1.25em);\n        margin-right: .5ch;\n      }\n\n      [part~="checked-indicator"] {\n        visibility: hidden;\n      }\n\n      :host([aria-checked="true"]) [part~="checked-indicator"] {\n        visibility: visible;\n      }\n    </style>\n    <slot name="checked-indicator">\n      <svg aria-hidden="true" viewBox="0 1 24 24" part="checked-indicator indicator">\n        <path d="m10 15.17 9.193-9.191 1.414 1.414-10.606 10.606-6.364-6.364 1.414-1.414 4.95 4.95Z"/>\n      </svg>\n    </slot>\n    <slot name="prefix"></slot>\n    <slot></slot>\n    <slot name="description"></slot>\n    <slot name="suffix">\n      ',this.getSuffixSlotInnerHTML(e),'\n    </slot>\n    <slot name="submenu"></slot>\n  ')},rS.getSuffixSlotInnerHTML=function(e){return""},Sm.customElements.get("media-chrome-menu-item")||Sm.customElements.define("media-chrome-menu-item",rS);var lS=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){return(0,m.A)(this,n),t.apply(this,arguments)}return(0,v.A)(n,[{key:"anchorElement",get:function(){return"auto"!==this.anchor?(0,u.A)((0,c.A)(n.prototype),"anchorElement",this):Mm(this).querySelector("media-settings-menu-button")}}]),n}(x_);lS.getTemplateHTML=function(e){return"\n    ".concat(x_.getTemplateHTML(e),'\n    <style>\n      :host {\n        --_menu-bg: rgb(20 20 30 / .8);\n        background: var(--media-settings-menu-background,\n            var(--media-menu-background,\n              var(--media-control-background,\n                var(--media-secondary-color, var(--_menu-bg)))));\n        min-width: var(--media-settings-menu-min-width, 170px);\n        border-radius: 2px 2px 0 0;\n        overflow: hidden;\n      }\n\n      @-moz-document url-prefix() {\n        :host{\n          --_menu-bg: rgb(20 20 30);\n        }\n      }\n\n      :host([role="menu"]) {\n        ',"\n        justify-content: end;\n      }\n\n      slot:not([name]) {\n        justify-content: var(--media-settings-menu-justify-content);\n        flex-direction: var(--media-settings-menu-flex-direction, column);\n        overflow: visible;\n      }\n\n      #container.has-expanded {\n        --media-settings-menu-item-opacity: 0;\n      }\n    </style>\n  ")},Sm.customElements.get("media-settings-menu")||Sm.customElements.define("media-settings-menu",lS);var uS=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){return(0,m.A)(this,n),t.apply(this,arguments)}return(0,v.A)(n)}(rS);uS.shadowRootOptions={mode:"open"},uS.getTemplateHTML=function(e){return"\n    ".concat(rS.getTemplateHTML.call(this,e),'\n    <style>\n      slot:not([name="submenu"]) {\n        opacity: var(--media-settings-menu-item-opacity, var(--media-menu-item-opacity));\n      }\n\n      :host([aria-expanded="true"]:hover) {\n        background: transparent;\n      }\n    </style>\n  ')},uS.getSuffixSlotInnerHTML=function(e){return'\n    <svg aria-hidden="true" viewBox="0 0 20 24">\n      <path d="m8.12 17.585-.742-.669 4.2-4.665-4.2-4.666.743-.669 4.803 5.335-4.803 5.334Z"/>\n    </svg>\n  '},Sm.customElements.get("media-settings-menu-item")||Sm.customElements.define("media-settings-menu-item",uS);var cS=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){return(0,m.A)(this,n),t.apply(this,arguments)}return(0,v.A)(n,[{key:"connectedCallback",value:function(){(0,u.A)((0,c.A)(n.prototype),"connectedCallback",this).call(this),this.invokeTargetElement&&this.setAttribute("aria-haspopup","menu")}},{key:"invokeTarget",get:function(){return this.getAttribute("invoketarget")},set:function(e){this.setAttribute("invoketarget","".concat(e))}},{key:"invokeTargetElement",get:function(){var e;return this.invokeTarget?null==(e=Hm(this))?void 0:e.querySelector("#".concat(this.invokeTarget)):null}},{key:"handleClick",value:function(){var e;null==(e=this.invokeTargetElement)||e.dispatchEvent(new E_({relatedTarget:this}))}}]),n}(Hy);Sm.customElements.get("media-chrome-menu-button")||Sm.customElements.define("media-chrome-menu-button",cS);var dS=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){return(0,m.A)(this,n),t.apply(this,arguments)}return(0,v.A)(n,[{key:"connectedCallback",value:function(){(0,u.A)((0,c.A)(n.prototype),"connectedCallback",this).call(this),this.setAttribute("aria-label",gm("settings"))}},{key:"invokeTargetElement",get:function(){return void 0!=this.invokeTarget?(0,u.A)((0,c.A)(n.prototype),"invokeTargetElement",this):Mm(this).querySelector("media-settings-menu")}}],[{key:"observedAttributes",get:function(){return[].concat((0,f.A)((0,u.A)((0,c.A)(n),"observedAttributes",this)),["target"])}}]),n}(cS);dS.getSlotTemplateHTML=function(){return'\n    <style>\n      :host([aria-expanded="true"]) slot[name=tooltip] {\n        display: none;\n      }\n    </style>\n    <slot name="icon">\n      <svg aria-hidden="true" viewBox="0 0 24 24">\n        <path d="M4.5 14.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5Zm7.5 0a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5Zm7.5 0a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5Z"/>\n      </svg>\n    </slot>\n  '},dS.getTooltipContentHTML=function(){return gm("Settings")},Sm.customElements.get("media-settings-menu-button")||Sm.customElements.define("media-settings-menu-button",dS);var hS,fS,vS,mS,pS,gS,yS=function(e,t,n){if(!t.has(e))throw TypeError("Cannot "+n)},ES=function(e,t,n){return yS(e,t,"read from private field"),n?n.call(e):t.get(e)},AS=function(e,t,n){if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},bS=function(e,t,n,i){return yS(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n},kS=function(e,t,n){return yS(e,t,"access private method"),n},TS=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){var e;return(0,m.A)(this,n),e=t.apply(this,arguments),AS((0,Ln.A)(e),vS),AS((0,Ln.A)(e),pS),AS((0,Ln.A)(e),hS,[]),AS((0,Ln.A)(e),fS,void 0),e}return(0,v.A)(n,[{key:"attributeChangedCallback",value:function(e,t,i){var a;(0,u.A)((0,c.A)(n.prototype),"attributeChangedCallback",this).call(this,e,t,i),e===Vv.MEDIA_AUDIO_TRACK_ENABLED&&t!==i?this.value=i:e===Vv.MEDIA_AUDIO_TRACK_LIST&&t!==i&&(bS(this,hS,null==(a=null!=i?i:"")?void 0:a.split(/\s+/).map(rm)),kS(this,vS,mS).call(this))}},{key:"connectedCallback",value:function(){(0,u.A)((0,c.A)(n.prototype),"connectedCallback",this).call(this),this.addEventListener("change",kS(this,pS,gS))}},{key:"disconnectedCallback",value:function(){(0,u.A)((0,c.A)(n.prototype),"disconnectedCallback",this).call(this),this.removeEventListener("change",kS(this,pS,gS))}},{key:"anchorElement",get:function(){var e;return"auto"!==this.anchor?(0,u.A)((0,c.A)(n.prototype),"anchorElement",this):null==(e=Mm(this))?void 0:e.querySelector("media-audio-track-menu-button")}},{key:"mediaAudioTrackList",get:function(){return ES(this,hS)},set:function(e){bS(this,hS,e),kS(this,vS,mS).call(this)}},{key:"mediaAudioTrackEnabled",get:function(){var e;return null!=(e=zm(this,Vv.MEDIA_AUDIO_TRACK_ENABLED))?e:""},set:function(e){Xm(this,Vv.MEDIA_AUDIO_TRACK_ENABLED,e)}}],[{key:"observedAttributes",get:function(){return[].concat((0,f.A)((0,u.A)((0,c.A)(n),"observedAttributes",this)),[Vv.MEDIA_AUDIO_TRACK_LIST,Vv.MEDIA_AUDIO_TRACK_ENABLED,Vv.MEDIA_AUDIO_TRACK_UNAVAILABLE])}}]),n}(x_);hS=new WeakMap,fS=new WeakMap,vS=new WeakSet,mS=function(){if(ES(this,fS)!==JSON.stringify(this.mediaAudioTrackList)){bS(this,fS,JSON.stringify(this.mediaAudioTrackList));var e=this.mediaAudioTrackList;this.defaultSlot.textContent="";var t,n=(0,h.A)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,a=w_({type:"radio",text:this.formatMenuItemText(i.label,i),value:"".concat(i.id),checked:i.enabled});a.prepend(R_(this,"checked-indicator")),this.defaultSlot.append(a)}}catch(BL){n.e(BL)}finally{n.f()}}},pS=new WeakSet,gS=function(){if(null!=this.value){var e=new Sm.CustomEvent(Bv.MEDIA_AUDIO_TRACK_REQUEST,{composed:!0,bubbles:!0,detail:this.value});this.dispatchEvent(e)}},Sm.customElements.get("media-audio-track-menu")||Sm.customElements.define("media-audio-track-menu",TS);var _S=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){return(0,m.A)(this,n),t.apply(this,arguments)}return(0,v.A)(n,[{key:"connectedCallback",value:function(){(0,u.A)((0,c.A)(n.prototype),"connectedCallback",this).call(this),this.setAttribute("aria-label",gm("Audio"))}},{key:"invokeTargetElement",get:function(){var e;return void 0!=this.invokeTarget?(0,u.A)((0,c.A)(n.prototype),"invokeTargetElement",this):null==(e=Mm(this))?void 0:e.querySelector("media-audio-track-menu")}},{key:"mediaAudioTrackEnabled",get:function(){var e;return null!=(e=zm(this,Vv.MEDIA_AUDIO_TRACK_ENABLED))?e:""},set:function(e){Xm(this,Vv.MEDIA_AUDIO_TRACK_ENABLED,e)}}],[{key:"observedAttributes",get:function(){return[].concat((0,f.A)((0,u.A)((0,c.A)(n),"observedAttributes",this)),[Vv.MEDIA_AUDIO_TRACK_ENABLED,Vv.MEDIA_AUDIO_TRACK_UNAVAILABLE])}}]),n}(cS);_S.getSlotTemplateHTML=function(){return'\n    <style>\n      :host([aria-expanded="true"]) slot[name=tooltip] {\n        display: none;\n      }\n    </style>\n    <slot name="icon">'.concat('<svg aria-hidden="true" viewBox="0 0 24 24">\n  <path d="M11 17H9.5V7H11v10Zm-3-3H6.5v-4H8v4Zm6-5h-1.5v6H14V9Zm3 7h-1.5V8H17v8Z"/>\n  <path d="M22 12c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2s10 4.477 10 10Zm-2 0a8 8 0 1 0-16 0 8 8 0 0 0 16 0Z"/>\n</svg>',"</slot>\n  ")},_S.getTooltipContentHTML=function(){return gm("Audio")},Sm.customElements.get("media-audio-track-menu-button")||Sm.customElements.define("media-audio-track-menu-button",_S);var SS,wS,RS,LS,IS,DS=function(e,t,n){if(!t.has(e))throw TypeError("Cannot "+n)},CS=function(e,t,n){if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},xS=function(e,t,n){return DS(e,t,"access private method"),n};var MS=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){var e;return(0,m.A)(this,n),e=t.apply(this,arguments),CS((0,Ln.A)(e),wS),CS((0,Ln.A)(e),LS),CS((0,Ln.A)(e),SS,void 0),e}return(0,v.A)(n,[{key:"attributeChangedCallback",value:function(e,t,i){(0,u.A)((0,c.A)(n.prototype),"attributeChangedCallback",this).call(this,e,t,i),e===Vv.MEDIA_SUBTITLES_LIST&&t!==i?xS(this,wS,RS).call(this):e===Vv.MEDIA_SUBTITLES_SHOWING&&t!==i&&(this.value=i)}},{key:"connectedCallback",value:function(){(0,u.A)((0,c.A)(n.prototype),"connectedCallback",this).call(this),this.addEventListener("change",xS(this,LS,IS))}},{key:"disconnectedCallback",value:function(){(0,u.A)((0,c.A)(n.prototype),"disconnectedCallback",this).call(this),this.removeEventListener("change",xS(this,LS,IS))}},{key:"anchorElement",get:function(){return"auto"!==this.anchor?(0,u.A)((0,c.A)(n.prototype),"anchorElement",this):Mm(this).querySelector("media-captions-menu-button")}},{key:"mediaSubtitlesList",get:function(){return OS(this,Vv.MEDIA_SUBTITLES_LIST)},set:function(e){PS(this,Vv.MEDIA_SUBTITLES_LIST,e)}},{key:"mediaSubtitlesShowing",get:function(){return OS(this,Vv.MEDIA_SUBTITLES_SHOWING)},set:function(e){PS(this,Vv.MEDIA_SUBTITLES_SHOWING,e)}}],[{key:"observedAttributes",get:function(){return[].concat((0,f.A)((0,u.A)((0,c.A)(n),"observedAttributes",this)),[Vv.MEDIA_SUBTITLES_LIST,Vv.MEDIA_SUBTITLES_SHOWING])}}]),n}(x_);SS=new WeakMap,wS=new WeakSet,RS=function(){var e;if(DS(t=this,n=SS,"read from private field"),(i?i.call(t):n.get(t))!==JSON.stringify(this.mediaSubtitlesList)){var t,n,i;!function(e,t,n,i){DS(e,t,"write to private field"),i?i.call(e,n):t.set(e,n)}(this,SS,JSON.stringify(this.mediaSubtitlesList)),this.defaultSlot.textContent="";var a=!this.value,r=w_({type:"radio",text:this.formatMenuItemText(gm("Off")),value:"off",checked:a});r.prepend(R_(this,"checked-indicator")),this.defaultSlot.append(r);var o,s=this.mediaSubtitlesList,l=(0,h.A)(s);try{for(l.s();!(o=l.n()).done;){var u=o.value,c=w_({type:"radio",text:this.formatMenuItemText(u.label,u),value:sg(u),checked:this.value==sg(u)});c.prepend(R_(this,"checked-indicator")),"captions"===(null!=(e=u.kind)?e:"subs")&&c.append(R_(this,"captions-indicator")),this.defaultSlot.append(c)}}catch(BL){l.e(BL)}finally{l.f()}}},LS=new WeakSet,IS=function(){var e=this.mediaSubtitlesShowing,t=this.getAttribute(Vv.MEDIA_SUBTITLES_SHOWING),n=this.value!==t;if((null==e?void 0:e.length)&&n&&this.dispatchEvent(new Sm.CustomEvent(Bv.MEDIA_DISABLE_SUBTITLES_REQUEST,{composed:!0,bubbles:!0,detail:e})),this.value&&n){var i=new Sm.CustomEvent(Bv.MEDIA_SHOW_SUBTITLES_REQUEST,{composed:!0,bubbles:!0,detail:this.value});this.dispatchEvent(i)}},MS.getTemplateHTML=function(e){return"\n    ".concat(x_.getTemplateHTML(e),'\n    <slot name="captions-indicator" hidden>').concat('\n  <svg aria-hidden="true" viewBox="0 0 26 24" part="captions-indicator indicator">\n    <path d="M22.83 5.68a2.58 2.58 0 0 0-2.3-2.5c-3.62-.24-11.44-.24-15.06 0a2.58 2.58 0 0 0-2.3 2.5c-.23 4.21-.23 8.43 0 12.64a2.58 2.58 0 0 0 2.3 2.5c3.62.24 11.44.24 15.06 0a2.58 2.58 0 0 0 2.3-2.5c.23-4.21.23-8.43 0-12.64Zm-11.39 9.45a3.07 3.07 0 0 1-1.91.57 3.06 3.06 0 0 1-2.34-1 3.75 3.75 0 0 1-.92-2.67 3.92 3.92 0 0 1 .92-2.77 3.18 3.18 0 0 1 2.43-1 2.94 2.94 0 0 1 2.13.78c.364.359.62.813.74 1.31l-1.43.35a1.49 1.49 0 0 0-1.51-1.17 1.61 1.61 0 0 0-1.29.58 2.79 2.79 0 0 0-.5 1.89 3 3 0 0 0 .49 1.93 1.61 1.61 0 0 0 1.27.58 1.48 1.48 0 0 0 1-.37 2.1 2.1 0 0 0 .59-1.14l1.4.44a3.23 3.23 0 0 1-1.07 1.69Zm7.22 0a3.07 3.07 0 0 1-1.91.57 3.06 3.06 0 0 1-2.34-1 3.75 3.75 0 0 1-.92-2.67 3.88 3.88 0 0 1 .93-2.77 3.14 3.14 0 0 1 2.42-1 3 3 0 0 1 2.16.82 2.8 2.8 0 0 1 .73 1.31l-1.43.35a1.49 1.49 0 0 0-1.51-1.21 1.61 1.61 0 0 0-1.29.58A2.79 2.79 0 0 0 15 12a3 3 0 0 0 .49 1.93 1.61 1.61 0 0 0 1.27.58 1.44 1.44 0 0 0 1-.37 2.1 2.1 0 0 0 .6-1.15l1.4.44a3.17 3.17 0 0 1-1.1 1.7Z"/>\n  </svg>',"</slot>\n  ")};var OS=function(e,t){var n=e.getAttribute(t);return n?rg(n):[]},PS=function(e,t,n){if(null==n?void 0:n.length){var i=lg(n);e.getAttribute(t)!==i&&e.setAttribute(t,i)}else e.removeAttribute(t)};Sm.customElements.get("media-captions-menu")||Sm.customElements.define("media-captions-menu",MS);var NS=function(e){e.setAttribute("aria-checked",hg(e).toString())},US=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){return(0,m.A)(this,n),t.apply(this,arguments)}return(0,v.A)(n,[{key:"connectedCallback",value:function(){(0,u.A)((0,c.A)(n.prototype),"connectedCallback",this).call(this),this.setAttribute("aria-label",gm("closed captions")),NS(this)}},{key:"attributeChangedCallback",value:function(e,t,i){(0,u.A)((0,c.A)(n.prototype),"attributeChangedCallback",this).call(this,e,t,i),e===Vv.MEDIA_SUBTITLES_SHOWING&&NS(this)}},{key:"invokeTargetElement",get:function(){var e;return void 0!=this.invokeTarget?(0,u.A)((0,c.A)(n.prototype),"invokeTargetElement",this):null==(e=Mm(this))?void 0:e.querySelector("media-captions-menu")}},{key:"mediaSubtitlesList",get:function(){return FS(this,Vv.MEDIA_SUBTITLES_LIST)},set:function(e){BS(this,Vv.MEDIA_SUBTITLES_LIST,e)}},{key:"mediaSubtitlesShowing",get:function(){return FS(this,Vv.MEDIA_SUBTITLES_SHOWING)},set:function(e){BS(this,Vv.MEDIA_SUBTITLES_SHOWING,e)}}],[{key:"observedAttributes",get:function(){return[].concat((0,f.A)((0,u.A)((0,c.A)(n),"observedAttributes",this)),[Vv.MEDIA_SUBTITLES_LIST,Vv.MEDIA_SUBTITLES_SHOWING])}}]),n}(cS);US.getSlotTemplateHTML=function(){return'\n    <style>\n      :host([aria-checked="true"]) slot[name=off] {\n        display: none !important;\n      }\n\n      '.concat('\n      :host(:not([aria-checked="true"])) slot[name=on] {\n        display: none !important;\n      }\n\n      :host([aria-expanded="true"]) slot[name=tooltip] {\n        display: none;\n      }\n    </style>\n\n    <slot name="icon">\n      <slot name="on">','<svg aria-hidden="true" viewBox="0 0 26 24">\n  <path d="M22.83 5.68a2.58 2.58 0 0 0-2.3-2.5c-3.62-.24-11.44-.24-15.06 0a2.58 2.58 0 0 0-2.3 2.5c-.23 4.21-.23 8.43 0 12.64a2.58 2.58 0 0 0 2.3 2.5c3.62.24 11.44.24 15.06 0a2.58 2.58 0 0 0 2.3-2.5c.23-4.21.23-8.43 0-12.64Zm-11.39 9.45a3.07 3.07 0 0 1-1.91.57 3.06 3.06 0 0 1-2.34-1 3.75 3.75 0 0 1-.92-2.67 3.92 3.92 0 0 1 .92-2.77 3.18 3.18 0 0 1 2.43-1 2.94 2.94 0 0 1 2.13.78c.364.359.62.813.74 1.31l-1.43.35a1.49 1.49 0 0 0-1.51-1.17 1.61 1.61 0 0 0-1.29.58 2.79 2.79 0 0 0-.5 1.89 3 3 0 0 0 .49 1.93 1.61 1.61 0 0 0 1.27.58 1.48 1.48 0 0 0 1-.37 2.1 2.1 0 0 0 .59-1.14l1.4.44a3.23 3.23 0 0 1-1.07 1.69Zm7.22 0a3.07 3.07 0 0 1-1.91.57 3.06 3.06 0 0 1-2.34-1 3.75 3.75 0 0 1-.92-2.67 3.88 3.88 0 0 1 .93-2.77 3.14 3.14 0 0 1 2.42-1 3 3 0 0 1 2.16.82 2.8 2.8 0 0 1 .73 1.31l-1.43.35a1.49 1.49 0 0 0-1.51-1.21 1.61 1.61 0 0 0-1.29.58A2.79 2.79 0 0 0 15 12a3 3 0 0 0 .49 1.93 1.61 1.61 0 0 0 1.27.58 1.44 1.44 0 0 0 1-.37 2.1 2.1 0 0 0 .6-1.15l1.4.44a3.17 3.17 0 0 1-1.1 1.7Z"/>\n</svg>','</slot>\n      <slot name="off">').concat('<svg aria-hidden="true" viewBox="0 0 26 24">\n  <path d="M17.73 14.09a1.4 1.4 0 0 1-1 .37 1.579 1.579 0 0 1-1.27-.58A3 3 0 0 1 15 12a2.8 2.8 0 0 1 .5-1.85 1.63 1.63 0 0 1 1.29-.57 1.47 1.47 0 0 1 1.51 1.2l1.43-.34A2.89 2.89 0 0 0 19 9.07a3 3 0 0 0-2.14-.78 3.14 3.14 0 0 0-2.42 1 3.91 3.91 0 0 0-.93 2.78 3.74 3.74 0 0 0 .92 2.66 3.07 3.07 0 0 0 2.34 1 3.07 3.07 0 0 0 1.91-.57 3.17 3.17 0 0 0 1.07-1.74l-1.4-.45c-.083.43-.3.822-.62 1.12Zm-7.22 0a1.43 1.43 0 0 1-1 .37 1.58 1.58 0 0 1-1.27-.58A3 3 0 0 1 7.76 12a2.8 2.8 0 0 1 .5-1.85 1.63 1.63 0 0 1 1.29-.57 1.47 1.47 0 0 1 1.51 1.2l1.43-.34a2.81 2.81 0 0 0-.74-1.32 2.94 2.94 0 0 0-2.13-.78 3.18 3.18 0 0 0-2.43 1 4 4 0 0 0-.92 2.78 3.74 3.74 0 0 0 .92 2.66 3.07 3.07 0 0 0 2.34 1 3.07 3.07 0 0 0 1.91-.57 3.23 3.23 0 0 0 1.07-1.74l-1.4-.45a2.06 2.06 0 0 1-.6 1.07Zm12.32-8.41a2.59 2.59 0 0 0-2.3-2.51C18.72 3.05 15.86 3 13 3c-2.86 0-5.72.05-7.53.17a2.59 2.59 0 0 0-2.3 2.51c-.23 4.207-.23 8.423 0 12.63a2.57 2.57 0 0 0 2.3 2.5c1.81.13 4.67.19 7.53.19 2.86 0 5.72-.06 7.53-.19a2.57 2.57 0 0 0 2.3-2.5c.23-4.207.23-8.423 0-12.63Zm-1.49 12.53a1.11 1.11 0 0 1-.91 1.11c-1.67.11-4.45.18-7.43.18-2.98 0-5.76-.07-7.43-.18a1.11 1.11 0 0 1-.91-1.11c-.21-4.14-.21-8.29 0-12.43a1.11 1.11 0 0 1 .91-1.11C7.24 4.56 10 4.49 13 4.49s5.76.07 7.43.18a1.11 1.11 0 0 1 .91 1.11c.21 4.14.21 8.29 0 12.43Z"/>\n</svg>',"</slot>\n    </slot>\n  ")},US.getTooltipContentHTML=function(){return gm("Captions")};var FS=function(e,t){var n=e.getAttribute(t);return n?rg(n):[]},BS=function(e,t,n){if(null==n?void 0:n.length){var i=lg(n);e.getAttribute(t)!==i&&e.setAttribute(t,i)}else e.removeAttribute(t)};Sm.customElements.get("media-captions-menu-button")||Sm.customElements.define("media-captions-menu-button",US);var HS,GS,KS,WS,VS,qS=function(e,t,n){if(!t.has(e))throw TypeError("Cannot "+n)},YS=function(e,t,n){return qS(e,t,"read from private field"),n?n.call(e):t.get(e)},jS=function(e,t,n){if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},zS=function(e,t,n){return qS(e,t,"access private method"),n},XS="rates",QS=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){var e;return(0,m.A)(this,n),e=t.call(this),jS((0,Ln.A)(e),GS),jS((0,Ln.A)(e),WS),jS((0,Ln.A)(e),HS,new Hp((0,Ln.A)(e),XS,{defaultValue:YA})),zS((0,Ln.A)(e),GS,KS).call((0,Ln.A)(e)),e}return(0,v.A)(n,[{key:"attributeChangedCallback",value:function(e,t,i){(0,u.A)((0,c.A)(n.prototype),"attributeChangedCallback",this).call(this,e,t,i),e===Vv.MEDIA_PLAYBACK_RATE&&t!=i?this.value=i:e===XS&&t!=i&&(YS(this,HS).value=i,zS(this,GS,KS).call(this))}},{key:"connectedCallback",value:function(){(0,u.A)((0,c.A)(n.prototype),"connectedCallback",this).call(this),this.addEventListener("change",zS(this,WS,VS))}},{key:"disconnectedCallback",value:function(){(0,u.A)((0,c.A)(n.prototype),"disconnectedCallback",this).call(this),this.removeEventListener("change",zS(this,WS,VS))}},{key:"anchorElement",get:function(){return"auto"!==this.anchor?(0,u.A)((0,c.A)(n.prototype),"anchorElement",this):Mm(this).querySelector("media-playback-rate-menu-button")}},{key:"rates",get:function(){return YS(this,HS)},set:function(e){e?Array.isArray(e)?YS(this,HS).value=e.join(" "):"string"===typeof e&&(YS(this,HS).value=e):YS(this,HS).value="",zS(this,GS,KS).call(this)}},{key:"mediaPlaybackRate",get:function(){return Vm(this,Vv.MEDIA_PLAYBACK_RATE,1)},set:function(e){qm(this,Vv.MEDIA_PLAYBACK_RATE,e)}}],[{key:"observedAttributes",get:function(){return[].concat((0,f.A)((0,u.A)((0,c.A)(n),"observedAttributes",this)),[Vv.MEDIA_PLAYBACK_RATE,XS])}}]),n}(x_);HS=new WeakMap,GS=new WeakSet,KS=function(){this.defaultSlot.textContent="";var e,t=(0,h.A)(YS(this,HS));try{for(t.s();!(e=t.n()).done;){var n=e.value,i=w_({type:"radio",text:this.formatMenuItemText("".concat(n,"x"),n),value:n,checked:this.mediaPlaybackRate===Number(n)});i.prepend(R_(this,"checked-indicator")),this.defaultSlot.append(i)}}catch(BL){t.e(BL)}finally{t.f()}},WS=new WeakSet,VS=function(){if(this.value){var e=new Sm.CustomEvent(Bv.MEDIA_PLAYBACK_RATE_REQUEST,{composed:!0,bubbles:!0,detail:this.value});this.dispatchEvent(e)}},Sm.customElements.get("media-playback-rate-menu")||Sm.customElements.define("media-playback-rate-menu",QS);var ZS=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){var e,i;return(0,m.A)(this,n),(e=t.call(this)).container=e.shadowRoot.querySelector('slot[name="icon"]'),e.container.innerHTML="".concat(null!=(i=e.mediaPlaybackRate)?i:1,"x"),e}return(0,v.A)(n,[{key:"attributeChangedCallback",value:function(e,t,i){if((0,u.A)((0,c.A)(n.prototype),"attributeChangedCallback",this).call(this,e,t,i),e===Vv.MEDIA_PLAYBACK_RATE){var a=i?+i:Number.NaN,r=Number.isNaN(a)?1:a;this.container.innerHTML="".concat(r,"x"),this.setAttribute("aria-label",gm("Playback rate {playbackRate}",{playbackRate:r}))}}},{key:"invokeTargetElement",get:function(){return void 0!=this.invokeTarget?(0,u.A)((0,c.A)(n.prototype),"invokeTargetElement",this):Mm(this).querySelector("media-playback-rate-menu")}},{key:"mediaPlaybackRate",get:function(){return Vm(this,Vv.MEDIA_PLAYBACK_RATE,1)},set:function(e){qm(this,Vv.MEDIA_PLAYBACK_RATE,e)}}],[{key:"observedAttributes",get:function(){return[].concat((0,f.A)((0,u.A)((0,c.A)(n),"observedAttributes",this)),[Vv.MEDIA_PLAYBACK_RATE])}}]),n}(cS);ZS.getSlotTemplateHTML=function(e){return'\n    <style>\n      :host {\n        min-width: 5ch;\n        padding: var(--media-button-padding, var(--media-control-padding, 10px 5px));\n      }\n      \n      :host([aria-expanded="true"]) slot[name=tooltip] {\n        display: none;\n      }\n    </style>\n    <slot name="icon">'.concat(e.mediaplaybackrate||1,"x</slot>\n  ")},ZS.getTooltipContentHTML=function(){return gm("Playback rate")},Sm.customElements.get("media-playback-rate-menu-button")||Sm.customElements.define("media-playback-rate-menu-button",ZS);var JS,$S,ew,tw,nw,iw,aw=function(e,t,n){if(!t.has(e))throw TypeError("Cannot "+n)},rw=function(e,t,n){return aw(e,t,"read from private field"),n?n.call(e):t.get(e)},ow=function(e,t,n){if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},sw=function(e,t,n,i){return aw(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n},lw=function(e,t,n){return aw(e,t,"access private method"),n},uw=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){var e;return(0,m.A)(this,n),e=t.apply(this,arguments),ow((0,Ln.A)(e),ew),ow((0,Ln.A)(e),nw),ow((0,Ln.A)(e),JS,[]),ow((0,Ln.A)(e),$S,{}),e}return(0,v.A)(n,[{key:"attributeChangedCallback",value:function(e,t,i){var a;(0,u.A)((0,c.A)(n.prototype),"attributeChangedCallback",this).call(this,e,t,i),e===Vv.MEDIA_RENDITION_SELECTED&&t!==i?(this.value=null!=i?i:"auto",lw(this,ew,tw).call(this)):e===Vv.MEDIA_RENDITION_LIST&&t!==i?(sw(this,JS,null==(a=i)?void 0:a.split(/\s+/).map(im)),lw(this,ew,tw).call(this)):e===Vv.MEDIA_HEIGHT&&t!==i&&lw(this,ew,tw).call(this)}},{key:"connectedCallback",value:function(){(0,u.A)((0,c.A)(n.prototype),"connectedCallback",this).call(this),this.addEventListener("change",lw(this,nw,iw))}},{key:"disconnectedCallback",value:function(){(0,u.A)((0,c.A)(n.prototype),"disconnectedCallback",this).call(this),this.removeEventListener("change",lw(this,nw,iw))}},{key:"anchorElement",get:function(){return"auto"!==this.anchor?(0,u.A)((0,c.A)(n.prototype),"anchorElement",this):Mm(this).querySelector("media-rendition-menu-button")}},{key:"mediaRenditionList",get:function(){return rw(this,JS)},set:function(e){sw(this,JS,e),lw(this,ew,tw).call(this)}},{key:"mediaRenditionSelected",get:function(){return zm(this,Vv.MEDIA_RENDITION_SELECTED)},set:function(e){Xm(this,Vv.MEDIA_RENDITION_SELECTED,e)}},{key:"mediaHeight",get:function(){return Vm(this,Vv.MEDIA_HEIGHT)},set:function(e){qm(this,Vv.MEDIA_HEIGHT,e)}}],[{key:"observedAttributes",get:function(){return[].concat((0,f.A)((0,u.A)((0,c.A)(n),"observedAttributes",this)),[Vv.MEDIA_RENDITION_LIST,Vv.MEDIA_RENDITION_SELECTED,Vv.MEDIA_RENDITION_UNAVAILABLE,Vv.MEDIA_HEIGHT])}}]),n}(x_);JS=new WeakMap,$S=new WeakMap,ew=new WeakSet,tw=function(){if(rw(this,$S).mediaRenditionList!==JSON.stringify(this.mediaRenditionList)||rw(this,$S).mediaHeight!==this.mediaHeight){rw(this,$S).mediaRenditionList=JSON.stringify(this.mediaRenditionList),rw(this,$S).mediaHeight=this.mediaHeight;var e,t=this.mediaRenditionList.sort((function(e,t){return t.height-e.height})),n=(0,h.A)(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.selected=i.id===this.mediaRenditionSelected}}catch(BL){n.e(BL)}finally{n.f()}this.defaultSlot.textContent="";var a,r=!this.mediaRenditionSelected,o=(0,h.A)(t);try{for(o.s();!(a=o.n()).done;){var s=a.value,l=w_({type:"radio",text:this.formatMenuItemText("".concat(Math.min(s.width,s.height),"p"),s),value:"".concat(s.id),checked:s.selected&&!r});l.prepend(R_(this,"checked-indicator")),this.defaultSlot.append(l)}}catch(BL){o.e(BL)}finally{o.f()}var u=w_({type:"radio",text:r?this.formatMenuItemText("".concat(gm("Auto")," (").concat(this.mediaHeight,"p)")):this.formatMenuItemText(gm("Auto")),value:"auto",checked:r}),c=this.mediaHeight>0?"".concat(gm("Auto")," (").concat(this.mediaHeight,"p)"):gm("Auto");u.dataset.description=c,u.prepend(R_(this,"checked-indicator")),this.defaultSlot.append(u)}},nw=new WeakSet,iw=function(){if(null!=this.value){var e=new Sm.CustomEvent(Bv.MEDIA_RENDITION_REQUEST,{composed:!0,bubbles:!0,detail:this.value});this.dispatchEvent(e)}},Sm.customElements.get("media-rendition-menu")||Sm.customElements.define("media-rendition-menu",uw);var cw=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){return(0,m.A)(this,n),t.apply(this,arguments)}return(0,v.A)(n,[{key:"connectedCallback",value:function(){(0,u.A)((0,c.A)(n.prototype),"connectedCallback",this).call(this),this.setAttribute("aria-label",gm("quality"))}},{key:"invokeTargetElement",get:function(){return void 0!=this.invokeTarget?(0,u.A)((0,c.A)(n.prototype),"invokeTargetElement",this):Mm(this).querySelector("media-rendition-menu")}},{key:"mediaRenditionSelected",get:function(){return zm(this,Vv.MEDIA_RENDITION_SELECTED)},set:function(e){Xm(this,Vv.MEDIA_RENDITION_SELECTED,e)}},{key:"mediaHeight",get:function(){return Vm(this,Vv.MEDIA_HEIGHT)},set:function(e){qm(this,Vv.MEDIA_HEIGHT,e)}}],[{key:"observedAttributes",get:function(){return[].concat((0,f.A)((0,u.A)((0,c.A)(n),"observedAttributes",this)),[Vv.MEDIA_RENDITION_SELECTED,Vv.MEDIA_RENDITION_UNAVAILABLE,Vv.MEDIA_HEIGHT])}}]),n}(cS);cw.getSlotTemplateHTML=function(){return'\n    <style>\n      :host([aria-expanded="true"]) slot[name=tooltip] {\n        display: none;\n      }\n    </style>\n    <slot name="icon">'.concat('<svg aria-hidden="true" viewBox="0 0 24 24">\n  <path d="M13.5 2.5h2v6h-2v-2h-11v-2h11v-2Zm4 2h4v2h-4v-2Zm-12 4h2v6h-2v-2h-3v-2h3v-2Zm4 2h12v2h-12v-2Zm1 4h2v6h-2v-2h-8v-2h8v-2Zm4 2h7v2h-7v-2Z" />\n</svg>',"</slot>\n  ")},cw.getTooltipContentHTML=function(){return gm("Quality")},Sm.customElements.get("media-rendition-menu-button")||Sm.customElements.define("media-rendition-menu-button",cw);var dw,hw,fw,vw,mw=function(e){throw TypeError(e)},pw=function(e,t,n){return t.has(e)||mw("Cannot "+n)},gw=function(e,t,n){return pw(e,t,"read from private field"),n?n.call(e):t.get(e)},yw=function(e,t,n){return t.has(e)?mw("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n)},Ew=function(e,t,n,i){return pw(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n},Aw=function(e,t,n){return pw(e,t,"access private method"),n},bw=function(){function e(){(0,m.A)(this,e)}return(0,v.A)(e,[{key:"addEventListener",value:function(){}},{key:"removeEventListener",value:function(){}},{key:"dispatchEvent",value:function(e){return!0}}]),e}();if("undefined"==typeof DocumentFragment){var kw=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){return(0,m.A)(this,n),t.apply(this,arguments)}return(0,v.A)(n)}(bw);globalThis.DocumentFragment=kw}var Tw,_w=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){return(0,m.A)(this,n),t.apply(this,arguments)}return(0,v.A)(n)}(bw),Sw=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){return(0,m.A)(this,n),t.apply(this,arguments)}return(0,v.A)(n)}(bw),ww={get:function(e){},define:function(e,t,n){},getName:function(e){return null},upgrade:function(e){},whenDefined:function(e){return Promise.resolve(_w)}},Rw=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,m.A)(this,e),yw(this,Tw),Ew(this,Tw,null==n?void 0:n.detail)}return(0,v.A)(e,[{key:"detail",get:function(){return gw(this,Tw)}},{key:"initCustomEvent",value:function(){}}]),e}();Tw=new WeakMap;var Lw={document:{createElement:function(e,t){return new _w}},DocumentFragment:DocumentFragment,customElements:ww,CustomEvent:Rw,EventTarget:bw,HTMLElement:_w,HTMLVideoElement:Sw},Iw="undefined"==typeof window||"undefined"==typeof globalThis.customElements,Dw=Iw?Lw:globalThis,Cw=Iw?Lw.document:globalThis.document;function xw(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function Mw(e){return e.replace(/[-_]([a-z])/g,(function(e,t){return t.toUpperCase()}))}function Ow(e){if(null!=e){var t=+e;return Number.isNaN(t)?void 0:t}}function Pw(e){var t=function(e){var t={};for(var n in e)null!=e[n]&&(t[n]=e[n]);return new URLSearchParams(t)}(e).toString();return t?"?"+t:""}var Nw=function e(t,n){return!(!t||!n)&&(!!t.contains(n)||e(t,n.getRootNode().host))},Uw="mux.com",Fw=function(){try{return"3.5.0"}catch(e){}return"UNKNOWN"}(),Bw=function(){return Fw},Hw=function(e){if(e){if([Nc.LIVE,Nc.ON_DEMAND].includes(e))return e;if(null!=e&&e.includes("live"))return Nc.LIVE}},Gw={crossorigin:"crossOrigin",playsinline:"playsInline"};var Kw,Ww,Vw,qw=function(e){function t(e,n){(0,m.A)(this,t),yw(this,Kw),yw(this,Ww),yw(this,Vw,[]),Ew(this,Kw,e),Ew(this,Ww,n)}return(0,v.A)(t,[{key:e,value:function(){return gw(this,Vw).values()}},{key:"length",get:function(){return gw(this,Vw).length}},{key:"value",get:function(){var e;return null!=(e=gw(this,Vw).join(" "))?e:""}},{key:"value",set:function(e){var t;e!==this.value&&(Ew(this,Vw,[]),this.add.apply(this,(0,f.A)(null!=(t=null==e?void 0:e.split(" "))?t:[])))}},{key:"toString",value:function(){return this.value}},{key:"item",value:function(e){return gw(this,Vw)[e]}},{key:"values",value:function(){return gw(this,Vw).values()}},{key:"keys",value:function(){return gw(this,Vw).keys()}},{key:"forEach",value:function(e){gw(this,Vw).forEach(e)}},{key:"add",value:function(){for(var e,t,n=this,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];a.forEach((function(e){n.contains(e)||gw(n,Vw).push(e)})),(""!==this.value||null!=(e=gw(this,Kw))&&e.hasAttribute("".concat(gw(this,Ww))))&&(null==(t=gw(this,Kw))||t.setAttribute("".concat(gw(this,Ww)),"".concat(this.value)))}},{key:"remove",value:function(){for(var e,t=this,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];i.forEach((function(e){gw(t,Vw).splice(gw(t,Vw).indexOf(e),1)})),null==(e=gw(this,Kw))||e.setAttribute("".concat(gw(this,Ww)),"".concat(this.value))}},{key:"contains",value:function(e){return gw(this,Vw).includes(e)}},{key:"toggle",value:function(e,t){return"undefined"!=typeof t?t?(this.add(e),!0):(this.remove(e),!1):this.contains(e)?(this.remove(e),!1):(this.add(e),!0)}},{key:"replace",value:function(e,t){this.remove(e),this.add(t)}}]),t}(Symbol.iterator);Kw=new WeakMap,Ww=new WeakMap,Vw=new WeakMap;var Yw="[mux-player ".concat(Bw(),"]");function jw(){for(var e,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];(e=console).warn.apply(e,[Yw].concat(n))}function zw(){for(var e,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];(e=console).error.apply(e,[Yw].concat(n))}function Xw(e){var t,n=null!=(t=e.message)?t:"";e.context&&(n+=" ".concat(e.context)),e.file&&(n+=" ".concat(od("Read more: "),"\nhttps://github.com/muxinc/elements/blob/main/errors/").concat(e.file)),jw(n)}var Qw={AUTOPLAY:"autoplay",CROSSORIGIN:"crossorigin",LOOP:"loop",MUTED:"muted",PLAYSINLINE:"playsinline",PRELOAD:"preload"},Zw={VOLUME:"volume",PLAYBACKRATE:"playbackrate",MUTED:"muted"},Jw=((0,i.A)((0,i.A)({},Qw),Zw),Object.freeze({length:0,start:function(e){var t=e>>>0;if(t>=this.length)throw new DOMException("Failed to execute 'start' on 'TimeRanges': The index provided (".concat(t,") is greater than or equal to the maximum bound (").concat(this.length,")."));return 0},end:function(e){var t=e>>>0;if(t>=this.length)throw new DOMException("Failed to execute 'end' on 'TimeRanges': The index provided (".concat(t,") is greater than or equal to the maximum bound (").concat(this.length,")."));return 0}})),$w=Object.values(Qw).filter((function(e){return Qw.PLAYSINLINE!==e})),eR=Object.values(Zw),tR=[].concat((0,f.A)($w),eR),nR=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){return(0,m.A)(this,n),t.call(this)}return(0,v.A)(n,[{key:"attributeChangedCallback",value:function(e,t,n){var i,a;switch(e){case Zw.MUTED:return void(this.media&&(this.media.muted=null!=n,this.media.defaultMuted=null!=n));case Zw.VOLUME:var r=null!=(i=Ow(n))?i:1;return void(this.media&&(this.media.volume=r));case Zw.PLAYBACKRATE:var o=null!=(a=Ow(n))?a:1;return void(this.media&&(this.media.playbackRate=o,this.media.defaultPlaybackRate=o))}}},{key:"play",value:function(){var e,t;return null!=(t=null==(e=this.media)?void 0:e.play())?t:Promise.reject()}},{key:"pause",value:function(){var e;null==(e=this.media)||e.pause()}},{key:"load",value:function(){var e;null==(e=this.media)||e.load()}},{key:"media",get:function(){var e;return null==(e=this.shadowRoot)?void 0:e.querySelector("mux-video")}},{key:"audioTracks",get:function(){return this.media.audioTracks}},{key:"videoTracks",get:function(){return this.media.videoTracks}},{key:"audioRenditions",get:function(){return this.media.audioRenditions}},{key:"videoRenditions",get:function(){return this.media.videoRenditions}},{key:"paused",get:function(){var e,t;return null==(t=null==(e=this.media)?void 0:e.paused)||t}},{key:"duration",get:function(){var e,t;return null!=(t=null==(e=this.media)?void 0:e.duration)?t:NaN}},{key:"ended",get:function(){var e,t;return null!=(t=null==(e=this.media)?void 0:e.ended)&&t}},{key:"buffered",get:function(){var e,t;return null!=(t=null==(e=this.media)?void 0:e.buffered)?t:Jw}},{key:"seekable",get:function(){var e,t;return null!=(t=null==(e=this.media)?void 0:e.seekable)?t:Jw}},{key:"readyState",get:function(){var e,t;return null!=(t=null==(e=this.media)?void 0:e.readyState)?t:0}},{key:"videoWidth",get:function(){var e,t;return null!=(t=null==(e=this.media)?void 0:e.videoWidth)?t:0}},{key:"videoHeight",get:function(){var e,t;return null!=(t=null==(e=this.media)?void 0:e.videoHeight)?t:0}},{key:"currentSrc",get:function(){var e,t;return null!=(t=null==(e=this.media)?void 0:e.currentSrc)?t:""}},{key:"currentTime",get:function(){var e,t;return null!=(t=null==(e=this.media)?void 0:e.currentTime)?t:0},set:function(e){this.media&&(this.media.currentTime=Number(e))}},{key:"volume",get:function(){var e,t;return null!=(t=null==(e=this.media)?void 0:e.volume)?t:1},set:function(e){this.media&&(this.media.volume=Number(e))}},{key:"playbackRate",get:function(){var e,t;return null!=(t=null==(e=this.media)?void 0:e.playbackRate)?t:1},set:function(e){this.media&&(this.media.playbackRate=Number(e))}},{key:"defaultPlaybackRate",get:function(){var e;return null!=(e=Ow(this.getAttribute(Zw.PLAYBACKRATE)))?e:1},set:function(e){null!=e?this.setAttribute(Zw.PLAYBACKRATE,"".concat(e)):this.removeAttribute(Zw.PLAYBACKRATE)}},{key:"crossOrigin",get:function(){return iR(this,Qw.CROSSORIGIN)},set:function(e){this.setAttribute(Qw.CROSSORIGIN,"".concat(e))}},{key:"autoplay",get:function(){return null!=iR(this,Qw.AUTOPLAY)},set:function(e){e?this.setAttribute(Qw.AUTOPLAY,"string"==typeof e?e:""):this.removeAttribute(Qw.AUTOPLAY)}},{key:"loop",get:function(){return null!=iR(this,Qw.LOOP)},set:function(e){e?this.setAttribute(Qw.LOOP,""):this.removeAttribute(Qw.LOOP)}},{key:"muted",get:function(){var e,t;return null!=(t=null==(e=this.media)?void 0:e.muted)&&t},set:function(e){this.media&&(this.media.muted=!!e)}},{key:"defaultMuted",get:function(){return null!=iR(this,Qw.MUTED)},set:function(e){e?this.setAttribute(Qw.MUTED,""):this.removeAttribute(Qw.MUTED)}},{key:"playsInline",get:function(){return null!=iR(this,Qw.PLAYSINLINE)},set:function(e){zw("playsInline is set to true by default and is not currently supported as a setter.")}},{key:"preload",get:function(){return this.media?this.media.preload:this.getAttribute("preload")},set:function(e){["","none","metadata","auto"].includes(e)?this.setAttribute(Qw.PRELOAD,e):this.removeAttribute(Qw.PRELOAD)}}],[{key:"observedAttributes",get:function(){return tR}}]),n}(Dw.HTMLElement);function iR(e,t){return e.media?e.media.getAttribute(t):e.getAttribute(t)}var aR=nR,rR=new WeakMap,oR=function(){function e(t,n){(0,m.A)(this,e),this.element=t,this.type=n,this.element.addEventListener(this.type,this);var i=rR.get(this.element);i&&i.set(this.type,this)}return(0,v.A)(e,[{key:"set",value:function(e){if("function"==typeof e)this.handleEvent=e.bind(this.element);else if("object"==typeof e&&"function"==typeof e.handleEvent)this.handleEvent=e.handleEvent.bind(e);else{this.element.removeEventListener(this.type,this);var t=rR.get(this.element);t&&t.delete(this.type)}}}],[{key:"for",value:function(t){rR.has(t.element)||rR.set(t.element,new Map);var n=t.attributeName.slice(2),i=rR.get(t.element);return i&&i.has(n)?i.get(n):new e(t.element,n)}}]),e}();function sR(e,t){(function(e,t){if(e instanceof qk&&t instanceof Element){var n=e.element;return n[e.attributeName]!==t&&(e.element.removeAttributeNS(e.attributeNamespace,e.attributeName),n[e.attributeName]=t),!0}return!1})(e,t)||function(e,t){if("boolean"==typeof t&&e instanceof qk){var n=e.attributeNamespace;return t!==e.element.hasAttributeNS(n,e.attributeName)&&(e.booleanValue=t),!0}return!1}(e,t)||function(e,t){return!!(e instanceof qk&&e.attributeName.startsWith("on"))&&(oR.for(e).set(t),e.element.removeAttributeNS(e.attributeNamespace,e.attributeName),!0)}(e,t)||function(e,t){return!1===t&&e instanceof Yk&&(e.replace(""),!0)}(e,t)||function(e,t){return t instanceof dR&&e instanceof Yk&&(t.renderInto(e),!0)}(e,t)||function(e,t){return t instanceof DocumentFragment&&e instanceof Yk&&(t.childNodes.length&&e.replace.apply(e,(0,f.A)(t.childNodes)),!0)}(e,t)||function(e,t){if(e instanceof qk){var n=e.attributeNamespace,i=e.element.getAttributeNS(n,e.attributeName);return String(t)!==i&&(e.value=String(t)),!0}e.value=String(t)}(e,t)}var lR=new Map,uR=new WeakMap,cR=new WeakMap,dR=function(){function e(t,n,i){(0,m.A)(this,e),this.strings=t,this.values=n,this.processor=i,this.stringsKey=this.strings.join("\x01")}return(0,v.A)(e,[{key:"template",get:function(){if(lR.has(this.stringsKey))return lR.get(this.stringsKey);var e=Cw.createElement("template"),t=this.strings.length-1;return e.innerHTML=this.strings.reduce((function(e,n,i){return e+n+(i<t?"{{ ".concat(i," }}"):"")}),""),lR.set(this.stringsKey,e),e}},{key:"renderInto",value:function(e){var t,n=this.template;if(uR.get(e)!==n){uR.set(e,n);var i=new Fk(n,this.values,this.processor);return cR.set(e,i),void(e instanceof Yk?e.replace.apply(e,(0,f.A)(i.children)):e.appendChild(i))}var a=cR.get(e);null==(t=null==a?void 0:a.update)||t.call(a,this.values)}}]),e}(),hR={processCallback:function(e,t,n){var i;if(n){var r,o=(0,h.A)(t);try{for(o.s();!(r=o.n()).done;){var s=(0,a.A)(r.value,2),l=s[0],u=s[1];if(l in n)sR(u,null!=(i=n[l])?i:"")}}catch(BL){o.e(BL)}finally{o.f()}}}};function fR(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return new dR(e,n,hR)}function vR(e,t){e.renderInto(t)}var mR=function(e){return fR(dw||(dw=Fv(["\n  <style>\n    ","\n    ","\n  </style>\n  ","\n"])),function(e){return e.tokens.drm?":host(:not([cast-receiver])) { --_cast-button-drm-display: none; }":""}(e),":host {\n  --media-control-display: var(--controls);\n  --media-loading-indicator-display: var(--loading-indicator);\n  --media-dialog-display: var(--dialog);\n  --media-play-button-display: var(--play-button);\n  --media-live-button-display: var(--live-button);\n  --media-seek-backward-button-display: var(--seek-backward-button);\n  --media-seek-forward-button-display: var(--seek-forward-button);\n  --media-mute-button-display: var(--mute-button);\n  --media-captions-button-display: var(--captions-button);\n  --media-captions-menu-button-display: var(--captions-menu-button, var(--media-captions-button-display));\n  --media-rendition-menu-button-display: var(--rendition-menu-button);\n  --media-audio-track-menu-button-display: var(--audio-track-menu-button);\n  --media-airplay-button-display: var(--airplay-button);\n  --media-pip-button-display: var(--pip-button);\n  --media-fullscreen-button-display: var(--fullscreen-button);\n  --media-cast-button-display: var(--cast-button, var(--_cast-button-drm-display));\n  --media-playback-rate-button-display: var(--playback-rate-button);\n  --media-playback-rate-menu-button-display: var(--playback-rate-menu-button);\n  --media-volume-range-display: var(--volume-range);\n  --media-time-range-display: var(--time-range);\n  --media-time-display-display: var(--time-display);\n  --media-duration-display-display: var(--duration-display);\n  --media-title-display-display: var(--title-display);\n\n  display: inline-block;\n  line-height: 0;\n  width: 100%;\n}\n\na {\n  color: #fff;\n  font-size: 0.9em;\n  text-decoration: underline;\n}\n\nmedia-theme {\n  display: inline-block;\n  line-height: 0;\n  width: 100%;\n  height: 100%;\n  direction: ltr;\n}\n\nmedia-poster-image {\n  display: inline-block;\n  line-height: 0;\n  width: 100%;\n  height: 100%;\n}\n\nmedia-poster-image:not([src]):not([placeholdersrc]) {\n  display: none;\n}\n\n::part(top),\n[part~='top'] {\n  --media-control-display: var(--controls, var(--top-controls));\n  --media-play-button-display: var(--play-button, var(--top-play-button));\n  --media-live-button-display: var(--live-button, var(--top-live-button));\n  --media-seek-backward-button-display: var(--seek-backward-button, var(--top-seek-backward-button));\n  --media-seek-forward-button-display: var(--seek-forward-button, var(--top-seek-forward-button));\n  --media-mute-button-display: var(--mute-button, var(--top-mute-button));\n  --media-captions-button-display: var(--captions-button, var(--top-captions-button));\n  --media-captions-menu-button-display: var(\n    --captions-menu-button,\n    var(--media-captions-button-display, var(--top-captions-menu-button))\n  );\n  --media-rendition-menu-button-display: var(--rendition-menu-button, var(--top-rendition-menu-button));\n  --media-audio-track-menu-button-display: var(--audio-track-menu-button, var(--top-audio-track-menu-button));\n  --media-airplay-button-display: var(--airplay-button, var(--top-airplay-button));\n  --media-pip-button-display: var(--pip-button, var(--top-pip-button));\n  --media-fullscreen-button-display: var(--fullscreen-button, var(--top-fullscreen-button));\n  --media-cast-button-display: var(--cast-button, var(--top-cast-button, var(--_cast-button-drm-display)));\n  --media-playback-rate-button-display: var(--playback-rate-button, var(--top-playback-rate-button));\n  --media-playback-rate-menu-button-display: var(\n    --captions-menu-button,\n    var(--media-playback-rate-button-display, var(--top-playback-rate-menu-button))\n  );\n  --media-volume-range-display: var(--volume-range, var(--top-volume-range));\n  --media-time-range-display: var(--time-range, var(--top-time-range));\n  --media-time-display-display: var(--time-display, var(--top-time-display));\n  --media-duration-display-display: var(--duration-display, var(--top-duration-display));\n  --media-title-display-display: var(--title-display, var(--top-title-display));\n}\n\n::part(center),\n[part~='center'] {\n  --media-control-display: var(--controls, var(--center-controls));\n  --media-play-button-display: var(--play-button, var(--center-play-button));\n  --media-live-button-display: var(--live-button, var(--center-live-button));\n  --media-seek-backward-button-display: var(--seek-backward-button, var(--center-seek-backward-button));\n  --media-seek-forward-button-display: var(--seek-forward-button, var(--center-seek-forward-button));\n  --media-mute-button-display: var(--mute-button, var(--center-mute-button));\n  --media-captions-button-display: var(--captions-button, var(--center-captions-button));\n  --media-captions-menu-button-display: var(\n    --captions-menu-button,\n    var(--media-captions-button-display, var(--center-captions-menu-button))\n  );\n  --media-rendition-menu-button-display: var(--rendition-menu-button, var(--center-rendition-menu-button));\n  --media-audio-track-menu-button-display: var(--audio-track-menu-button, var(--center-audio-track-menu-button));\n  --media-airplay-button-display: var(--airplay-button, var(--center-airplay-button));\n  --media-pip-button-display: var(--pip-button, var(--center-pip-button));\n  --media-fullscreen-button-display: var(--fullscreen-button, var(--center-fullscreen-button));\n  --media-cast-button-display: var(--cast-button, var(--center-cast-button, var(--_cast-button-drm-display)));\n  --media-playback-rate-button-display: var(--playback-rate-button, var(--center-playback-rate-button));\n  --media-playback-rate-menu-button-display: var(\n    --playback-rate-menu-button,\n    var(--media-playback-rate-button-display, var(--center-playback-rate-menu-button))\n  );\n  --media-volume-range-display: var(--volume-range, var(--center-volume-range));\n  --media-time-range-display: var(--time-range, var(--center-time-range));\n  --media-time-display-display: var(--time-display, var(--center-time-display));\n  --media-duration-display-display: var(--duration-display, var(--center-duration-display));\n}\n\n::part(bottom),\n[part~='bottom'] {\n  --media-control-display: var(--controls, var(--bottom-controls));\n  --media-play-button-display: var(--play-button, var(--bottom-play-button));\n  --media-live-button-display: var(--live-button, var(--bottom-live-button));\n  --media-seek-backward-button-display: var(--seek-backward-button, var(--bottom-seek-backward-button));\n  --media-seek-forward-button-display: var(--seek-forward-button, var(--bottom-seek-forward-button));\n  --media-mute-button-display: var(--mute-button, var(--bottom-mute-button));\n  --media-captions-button-display: var(--captions-button, var(--bottom-captions-button));\n  --media-captions-menu-button-display: var(\n    --captions-menu-button,\n    var(--media-captions-button-display, var(--bottom-captions-menu-button))\n  );\n  --media-rendition-menu-button-display: var(--rendition-menu-button, var(--bottom-rendition-menu-button));\n  --media-audio-track-menu-button-display: var(--audio-track-menu-button, var(--bottom-audio-track-menu-button));\n  --media-airplay-button-display: var(--airplay-button, var(--bottom-airplay-button));\n  --media-pip-button-display: var(--pip-button, var(--bottom-pip-button));\n  --media-fullscreen-button-display: var(--fullscreen-button, var(--bottom-fullscreen-button));\n  --media-cast-button-display: var(--cast-button, var(--bottom-cast-button, var(--_cast-button-drm-display)));\n  --media-playback-rate-button-display: var(--playback-rate-button, var(--bottom-playback-rate-button));\n  --media-playback-rate-menu-button-display: var(\n    --playback-rate-menu-button,\n    var(--media-playback-rate-button-display, var(--bottom-playback-rate-menu-button))\n  );\n  --media-volume-range-display: var(--volume-range, var(--bottom-volume-range));\n  --media-time-range-display: var(--time-range, var(--bottom-time-range));\n  --media-time-display-display: var(--time-display, var(--bottom-time-display));\n  --media-duration-display-display: var(--duration-display, var(--bottom-duration-display));\n  --media-title-display-display: var(--title-display, var(--bottom-title-display));\n}\n\n:host([no-tooltips]) {\n  --media-tooltip-display: none;\n}\n",gR(e))},pR=Object.values({TOP:"top",CENTER:"center",BOTTOM:"bottom",LAYER:"layer",MEDIA_LAYER:"media-layer",POSTER_LAYER:"poster-layer",VERTICAL_LAYER:"vertical-layer",CENTERED_LAYER:"centered-layer",GESTURE_LAYER:"gesture-layer",CONTROLLER_LAYER:"controller",BUTTON:"button",RANGE:"range",DISPLAY:"display",CONTROL_BAR:"control-bar",MENU_BUTTON:"menu-button",MENU:"menu",OPTION:"option",POSTER:"poster",LIVE:"live",PLAY:"play",PRE_PLAY:"pre-play",SEEK_BACKWARD:"seek-backward",SEEK_FORWARD:"seek-forward",MUTE:"mute",CAPTIONS:"captions",AIRPLAY:"airplay",PIP:"pip",FULLSCREEN:"fullscreen",CAST:"cast",PLAYBACK_RATE:"playback-rate",VOLUME:"volume",TIME:"time",TITLE:"title",AUDIO_TRACK:"audio-track",RENDITION:"rendition"}).join(", "),gR=function(e){var t,n,i,r,o,s,l,u,c,d,h,f,v,m,p,g,y,E,A,b,k,T,_,S,w,R,L,I,D,C,x,M,O,P,N;return fR(hw||(hw=Fv(['\n  <media-theme\n    template="','"\n    defaultstreamtype="','"\n    hotkeys="','"\n    nohotkeys="','"\n    noautoseektolive="','"\n    novolumepref="','"\n    disabled="','"\n    audio="','"\n    style="','"\n    defaultsubtitles="','"\n    forwardseekoffset="','"\n    backwardseekoffset="','"\n    playbackrates="','"\n    defaultshowremainingtime="','"\n    defaultduration="','"\n    hideduration="','"\n    title="','"\n    videotitle="','"\n    proudlydisplaymuxbadge="','"\n    exportparts="','"\n    onclose="','"\n    onfocusin="','"\n  >\n    <mux-video\n      slot="media"\n      target-live-window="','"\n      stream-type="','"\n      crossorigin="','"\n      playsinline\n      autoplay="','"\n      muted="','"\n      loop="','"\n      preload="','"\n      debug="','"\n      prefer-cmcd="','"\n      disable-tracking="','"\n      disable-cookies="','"\n      prefer-playback="','"\n      start-time="','"\n      beacon-collection-domain="','"\n      player-init-time="','"\n      player-software-name="','"\n      player-software-version="','"\n      env-key="','"\n      custom-domain="','"\n      src="','"\n      cast-src="','"\n      cast-receiver="','"\n      drm-token="','"\n      exportparts="video"\n    >\n      ','\n      <slot></slot>\n    </mux-video>\n    <slot name="poster" slot="poster">\n      <media-poster-image\n        part="poster"\n        exportparts="poster, img"\n        src="','"\n        placeholdersrc="','"\n      ></media-poster-image>\n    </slot>\n  </media-theme>\n'])),e.themeTemplate||!1,null!=(t=e.defaultStreamType)&&t,function(e){var t=e.hotKeys?"".concat(e.hotKeys):"";return"live"===Hw(e.streamType)&&(t+=" noarrowleft noarrowright"),t}(e)||!1,e.noHotKeys||!e.hasSrc||!1,!(null==(n=e.streamType)||!n.includes(Nc.LIVE))&&0!==e.targetLiveWindow,e.novolumepref||!1,!e.hasSrc||e.isDialogOpen,null!=(i=e.audio)&&i,null!=(r=function(e){var t="";return Object.entries(e).forEach((function(e){var n=(0,a.A)(e,2),i=n[0],r=n[1];null!=r&&(t+="".concat(xw(i),": ").concat(r,"; "))})),t?t.trim():void 0}({"--media-primary-color":e.primaryColor,"--media-secondary-color":e.secondaryColor,"--media-accent-color":e.accentColor}))&&r,!e.defaultHiddenCaptions,null!=(o=e.forwardSeekOffset)&&o,null!=(s=e.backwardSeekOffset)&&s,null!=(l=e.playbackRates)&&l,null!=(u=e.defaultShowRemainingTime)&&u,null!=(c=e.defaultDuration)&&c,null!=(d=e.hideDuration)&&d,null!=(h=e.title)&&h,null!=(f=e.videoTitle)&&f,null!=(v=e.proudlyDisplayMuxBadge)&&v,pR,e.onCloseErrorDialog,e.onFocusInErrorDialog,null!=(m=e.targetLiveWindow)&&m,null!=(p=Hw(e.streamType))&&p,null!=(g=e.crossOrigin)?g:"",null!=(y=e.autoplay)&&y,null!=(E=e.muted)&&E,null!=(A=e.loop)&&A,null!=(b=e.preload)&&b,null!=(k=e.debug)&&k,null!=(T=e.preferCmcd)&&T,null!=(_=e.disableTracking)&&_,null!=(S=e.disableCookies)&&S,null!=(w=e.preferPlayback)&&w,null!=e.startTime&&e.startTime,null!=(R=e.beaconCollectionDomain)&&R,null!=(L=e.playerInitTime)&&L,null!=(I=e.playerSoftwareName)&&I,null!=(D=e.playerSoftwareVersion)&&D,null!=(C=e.envKey)&&C,null!=(x=e.customDomain)&&x,e.src?e.src:!!e.playbackId&&mh(e),e.src?e.src:!!e.playbackId&&mh(e),null!=(M=e.castReceiver)&&M,null!=(P=null==(O=e.tokens)?void 0:O.drm)&&P,e.storyboard?fR(fw||(fw=Fv(['<track label="thumbnails" default kind="metadata" src="','" />'])),e.storyboard):fR(vw||(vw=Fv([""]))),!!e.poster&&e.poster,null!=(N=e.placeholder)&&N)},yR=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},ER=function(e){var t,n,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.muxCode){var a=yR(null!=(t=e.errorCategory)?t:"video"),r=Cc(null!=(n=e.errorCategory)?n:Lc);if(e.muxCode===Dc.NETWORK_OFFLINE)return od("Your device appears to be offline",i);if(e.muxCode===Dc.NETWORK_TOKEN_EXPIRED)return od("{category} URL has expired",i).format({category:a});if([Dc.NETWORK_TOKEN_SUB_MISMATCH,Dc.NETWORK_TOKEN_AUD_MISMATCH,Dc.NETWORK_TOKEN_AUD_MISSING,Dc.NETWORK_TOKEN_MALFORMED].includes(e.muxCode))return od("{category} URL is formatted incorrectly",i).format({category:a});if(e.muxCode===Dc.NETWORK_TOKEN_MISSING)return od("Invalid {categoryName} URL",i).format({categoryName:r});if(e.muxCode===Dc.NETWORK_NOT_FOUND)return od("{category} does not exist",i).format({category:a});if(e.muxCode===Dc.NETWORK_NOT_READY){var o="live"===e.streamType?"Live stream":"Video";return od("{mediaType} is not currently available",i).format({mediaType:o})}}if(e.code){if(e.code===Mc.MEDIA_ERR_NETWORK)return od("Network Error",i);if(e.code===Mc.MEDIA_ERR_DECODE)return od("Media Error",i);if(e.code===Mc.MEDIA_ERR_SRC_NOT_SUPPORTED)return od("Source Not Supported",i)}return od("Error",i)},AR=function(e){var t,n,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.muxCode){var a=yR(null!=(t=e.errorCategory)?t:"video"),r=Cc(null!=(n=e.errorCategory)?n:Lc);return e.muxCode===Dc.NETWORK_OFFLINE?od("Check your internet connection and try reloading this video.",i):e.muxCode===Dc.NETWORK_TOKEN_EXPIRED?od("The video\u2019s secured {tokenNamePrefix}-token has expired.",i).format({tokenNamePrefix:r}):e.muxCode===Dc.NETWORK_TOKEN_SUB_MISMATCH?od("The video\u2019s playback ID does not match the one encoded in the {tokenNamePrefix}-token.",i).format({tokenNamePrefix:r}):e.muxCode===Dc.NETWORK_TOKEN_MALFORMED?od("{category} URL is formatted incorrectly",i).format({category:a}):[Dc.NETWORK_TOKEN_AUD_MISMATCH,Dc.NETWORK_TOKEN_AUD_MISSING].includes(e.muxCode)?od("The {tokenNamePrefix}-token is formatted with incorrect information.",i).format({tokenNamePrefix:r}):[Dc.NETWORK_TOKEN_MISSING,Dc.NETWORK_INVALID_URL].includes(e.muxCode)?od("The video URL or {tokenNamePrefix}-token are formatted with incorrect or incomplete information.",i).format({tokenNamePrefix:r}):e.muxCode===Dc.NETWORK_NOT_FOUND?"":e.message}return e.code&&(e.code===Mc.MEDIA_ERR_NETWORK||e.code===Mc.MEDIA_ERR_DECODE||(e.code,Mc.MEDIA_ERR_SRC_NOT_SUPPORTED)),e.message},bR=function(e,t){var n=function(e){if(e.muxCode){if(e.muxCode===Dc.NETWORK_TOKEN_EXPIRED)return"403-expired-token.md";if(e.muxCode===Dc.NETWORK_TOKEN_MALFORMED)return"403-malformatted-token.md";if([Dc.NETWORK_TOKEN_AUD_MISMATCH,Dc.NETWORK_TOKEN_AUD_MISSING].includes(e.muxCode))return"403-incorrect-aud-value.md";if(e.muxCode===Dc.NETWORK_TOKEN_SUB_MISMATCH)return"403-playback-id-mismatch.md";if(e.muxCode===Dc.NETWORK_TOKEN_MISSING)return"missing-signed-tokens.md";if(e.muxCode===Dc.NETWORK_NOT_FOUND)return"404-not-found.md";if(e.muxCode===Dc.NETWORK_NOT_READY)return"412-not-playable.md"}if(e.code){if(e.code===Mc.MEDIA_ERR_NETWORK)return"";if(e.code===Mc.MEDIA_ERR_DECODE)return"media-decode-error.md";if(e.code===Mc.MEDIA_ERR_SRC_NOT_SUPPORTED)return"media-src-not-supported.md"}return""}(e);return{message:e.message,context:e.context,file:n}},kR=Cw.createElement("template");"innerHTML"in kR&&(kR.innerHTML='<template id="media-theme-gerwig">\n  <style>\n    @keyframes pre-play-hide {\n      0% {\n        transform: scale(1);\n        opacity: 1;\n      }\n\n      30% {\n        transform: scale(0.7);\n      }\n\n      100% {\n        transform: scale(1.5);\n        opacity: 0;\n      }\n    }\n\n    :host {\n      --_primary-color: var(--media-primary-color, #fff);\n      --_secondary-color: var(--media-secondary-color, transparent);\n      --_accent-color: var(--media-accent-color, #fa50b5);\n      --_text-color: var(--media-text-color, #000);\n\n      --media-icon-color: var(--_primary-color);\n      --media-control-background: var(--_secondary-color);\n      --media-control-hover-background: var(--_accent-color);\n      --media-time-buffered-color: rgba(255, 255, 255, 0.4);\n      --media-preview-time-text-shadow: none;\n      --media-control-height: 14px;\n      --media-control-padding: 6px;\n      --media-tooltip-container-margin: 6px;\n      --media-tooltip-distance: 18px;\n\n      color: var(--_primary-color);\n      display: inline-block;\n      width: 100%;\n      height: 100%;\n    }\n\n    :host([audio]) {\n      --_secondary-color: var(--media-secondary-color, black);\n      --media-preview-time-text-shadow: none;\n    }\n\n    :host([audio]) ::slotted([slot=\'media\']) {\n      height: 0px;\n    }\n\n    :host([audio]) media-loading-indicator {\n      display: none;\n    }\n\n    :host([audio]) media-controller {\n      background: transparent;\n    }\n\n    :host([audio]) media-controller::part(vertical-layer) {\n      background: transparent;\n    }\n\n    :host([audio]) media-control-bar {\n      width: 100%;\n      background-color: var(--media-control-background);\n    }\n\n    /*\n     * 0.433s is the transition duration for VTT Regions.\n     * Borrowed here, so the captions don\'t move too fast.\n     */\n    media-controller {\n      --media-webkit-text-track-transform: translateY(0) scale(0.98);\n      --media-webkit-text-track-transition: transform 0.433s ease-out 0.3s;\n    }\n    media-controller:is([mediapaused], :not([userinactive])) {\n      --media-webkit-text-track-transform: translateY(-50px) scale(0.98);\n      --media-webkit-text-track-transition: transform 0.15s ease;\n    }\n\n    /*\n     * CSS specific to iOS devices.\n     * See: https://stackoverflow.com/questions/30102792/css-media-query-to-target-only-ios-devices/60220757#60220757\n     */\n    @supports (-webkit-touch-callout: none) {\n      /* Disable subtitle adjusting for iOS Safari */\n      media-controller[mediaisfullscreen] {\n        --media-webkit-text-track-transform: unset;\n        --media-webkit-text-track-transition: unset;\n      }\n    }\n\n    media-time-range {\n      --media-box-padding-left: 6px;\n      --media-box-padding-right: 6px;\n      --media-range-bar-color: var(--_accent-color);\n      --media-time-range-buffered-color: var(--_primary-color);\n      --media-range-track-color: transparent;\n      --media-range-track-background: rgba(255, 255, 255, 0.4);\n      --media-range-thumb-background: radial-gradient(\n        circle,\n        #000 0%,\n        #000 25%,\n        var(--_accent-color) 25%,\n        var(--_accent-color)\n      );\n      --media-range-thumb-width: 12px;\n      --media-range-thumb-height: 12px;\n      --media-range-thumb-transform: scale(0);\n      --media-range-thumb-transition: transform 0.3s;\n      --media-range-thumb-opacity: 1;\n      --media-preview-background: var(--_primary-color);\n      --media-box-arrow-background: var(--_primary-color);\n      --media-preview-thumbnail-border: 5px solid var(--_primary-color);\n      --media-preview-border-radius: 5px;\n      --media-text-color: var(--_text-color);\n      --media-control-hover-background: transparent;\n      --media-preview-chapter-text-shadow: none;\n      color: var(--_accent-color);\n      padding: 0 6px;\n    }\n\n    :host([audio]) media-time-range {\n      --media-preview-time-padding: 1.5px 6px;\n      --media-preview-box-margin: 0 0 -5px;\n    }\n\n    media-time-range:hover {\n      --media-range-thumb-transform: scale(1);\n    }\n\n    media-preview-thumbnail {\n      border-bottom-width: 0;\n    }\n\n    [part~=\'menu\'] {\n      border-radius: 2px;\n      border: 1px solid rgba(0, 0, 0, 0.1);\n      bottom: 50px;\n      padding: 2.5px 10px;\n    }\n\n    [part~=\'menu\']::part(indicator) {\n      fill: var(--_accent-color);\n    }\n\n    [part~=\'menu\']::part(menu-item) {\n      box-sizing: border-box;\n      display: flex;\n      align-items: center;\n      padding: 6px 10px;\n      min-height: 34px;\n    }\n\n    [part~=\'menu\']::part(checked) {\n      font-weight: 700;\n    }\n\n    media-captions-menu,\n    media-rendition-menu,\n    media-audio-track-menu,\n    media-playback-rate-menu {\n      position: absolute; /* ensure they don\'t take up space in DOM on load */\n      --media-menu-background: var(--_primary-color);\n      --media-menu-item-checked-background: transparent;\n      --media-text-color: var(--_text-color);\n      --media-menu-item-hover-background: transparent;\n      --media-menu-item-hover-outline: var(--_accent-color) solid 1px;\n    }\n\n    media-rendition-menu {\n      min-width: 140px;\n    }\n\n    /* The icon is a circle so make it 16px high instead of 14px for more balance. */\n    media-audio-track-menu-button {\n      --media-control-padding: 5px;\n      --media-control-height: 16px;\n    }\n\n    media-playback-rate-menu-button {\n      --media-control-padding: 6px 3px;\n      min-width: 4.4ch;\n    }\n\n    media-playback-rate-menu {\n      --media-menu-flex-direction: row;\n      --media-menu-item-checked-background: var(--_accent-color);\n      --media-menu-item-checked-indicator-display: none;\n      margin-right: 6px;\n      padding: 0;\n      --media-menu-gap: 0.25em;\n    }\n\n    media-playback-rate-menu[part~=\'menu\']::part(menu-item) {\n      padding: 6px 6px 6px 8px;\n    }\n\n    media-playback-rate-menu[part~=\'menu\']::part(checked) {\n      color: #fff;\n    }\n\n    :host(:not([audio])) media-time-range {\n      /* Adding px is required here for calc() */\n      --media-range-padding: 0px;\n      background: transparent;\n      z-index: 10;\n      height: 10px;\n      bottom: -3px;\n      width: 100%;\n    }\n\n    media-control-bar :is([role=\'button\'], [role=\'switch\'], button) {\n      line-height: 0;\n    }\n\n    media-control-bar :is([part*=\'button\'], [part*=\'range\'], [part*=\'display\']) {\n      border-radius: 3px;\n    }\n\n    .spacer {\n      flex-grow: 1;\n      background-color: var(--media-control-background, rgba(20, 20, 30, 0.7));\n    }\n\n    media-control-bar[slot~=\'top-chrome\'] {\n      min-height: 42px;\n      pointer-events: none;\n    }\n\n    media-control-bar {\n      --gradient-steps:\n        hsl(0 0% 0% / 0) 0%, hsl(0 0% 0% / 0.013) 8.1%, hsl(0 0% 0% / 0.049) 15.5%, hsl(0 0% 0% / 0.104) 22.5%,\n        hsl(0 0% 0% / 0.175) 29%, hsl(0 0% 0% / 0.259) 35.3%, hsl(0 0% 0% / 0.352) 41.2%, hsl(0 0% 0% / 0.45) 47.1%,\n        hsl(0 0% 0% / 0.55) 52.9%, hsl(0 0% 0% / 0.648) 58.8%, hsl(0 0% 0% / 0.741) 64.7%, hsl(0 0% 0% / 0.825) 71%,\n        hsl(0 0% 0% / 0.896) 77.5%, hsl(0 0% 0% / 0.951) 84.5%, hsl(0 0% 0% / 0.987) 91.9%, hsl(0 0% 0%) 100%;\n    }\n\n    :host([title]:not([audio])) media-control-bar[slot=\'top-chrome\']::before {\n      content: \'\';\n      position: absolute;\n      width: 100%;\n      padding-bottom: min(100px, 25%);\n      background: linear-gradient(to top, var(--gradient-steps));\n      opacity: 0.8;\n      pointer-events: none;\n    }\n\n    :host(:not([audio])) media-control-bar[part~=\'bottom\']::before {\n      content: \'\';\n      position: absolute;\n      width: 100%;\n      bottom: 0;\n      left: 0;\n      padding-bottom: min(100px, 25%);\n      background: linear-gradient(to bottom, var(--gradient-steps));\n      opacity: 0.8;\n      z-index: 1;\n      pointer-events: none;\n    }\n\n    media-control-bar[part~=\'bottom\'] > * {\n      z-index: 20;\n    }\n\n    media-control-bar[part~=\'bottom\'] {\n      padding: 6px 6px;\n    }\n\n    media-control-bar[slot~=\'top-chrome\'] > * {\n      --media-control-background: transparent;\n      --media-control-hover-background: transparent;\n      position: relative;\n    }\n\n    media-controller::part(vertical-layer) {\n      transition: background-color 1s;\n    }\n\n    media-controller:is([mediapaused], :not([userinactive]))::part(vertical-layer) {\n      background-color: var(--controls-backdrop-color, var(--controls, transparent));\n      transition: background-color 0.25s;\n    }\n\n    .center-controls {\n      --media-button-icon-width: 100%;\n      --media-button-icon-height: auto;\n      --media-tooltip-display: none;\n      pointer-events: none;\n      width: 100%;\n      display: flex;\n      flex-flow: row;\n      align-items: center;\n      justify-content: center;\n      filter: drop-shadow(0 0 2px rgb(0 0 0 / 0.25)) drop-shadow(0 0 6px rgb(0 0 0 / 0.25));\n      paint-order: stroke;\n      stroke: rgba(102, 102, 102, 1);\n      stroke-width: 0.3px;\n      text-shadow:\n        0 0 2px rgb(0 0 0 / 0.25),\n        0 0 6px rgb(0 0 0 / 0.25);\n    }\n\n    .center-controls media-play-button {\n      --media-control-background: transparent;\n      --media-control-hover-background: transparent;\n      --media-control-padding: 0;\n      width: 40px;\n    }\n\n    [breakpointsm] .center-controls media-play-button {\n      width: 90px;\n      height: 90px;\n      border-radius: 50%;\n      transition: background 0.4s;\n      padding: 24px;\n      --media-control-background: #000;\n      --media-control-hover-background: var(--_accent-color);\n    }\n\n    .center-controls media-seek-backward-button,\n    .center-controls media-seek-forward-button {\n      --media-control-background: transparent;\n      --media-control-hover-background: transparent;\n      padding: 0;\n      margin: 0 20px;\n      width: max(33px, min(8%, 40px));\n    }\n\n    [breakpointsm]:not([audio]) .center-controls.pre-playback {\n      display: grid;\n      align-items: initial;\n      justify-content: initial;\n      height: 100%;\n      overflow: hidden;\n    }\n\n    [breakpointsm]:not([audio]) .center-controls.pre-playback media-play-button {\n      place-self: var(--_pre-playback-place, center);\n      grid-area: 1 / 1;\n      margin: 16px;\n    }\n\n    /* Show and hide controls or pre-playback state */\n\n    [breakpointsm]:is([mediahasplayed], :not([mediapaused])):not([audio])\n      .center-controls.pre-playback\n      media-play-button {\n      /* Using `forwards` would lead to a laggy UI after the animation got in the end state */\n      animation: 0.3s linear pre-play-hide;\n      opacity: 0;\n      pointer-events: none;\n    }\n\n    .autoplay-unmute {\n      --media-control-hover-background: transparent;\n      width: 100%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      filter: drop-shadow(0 0 2px rgb(0 0 0 / 0.25)) drop-shadow(0 0 6px rgb(0 0 0 / 0.25));\n    }\n\n    .autoplay-unmute-btn {\n      --media-control-height: 16px;\n      border-radius: 8px;\n      background: #000;\n      color: var(--_primary-color);\n      display: flex;\n      align-items: center;\n      padding: 8px 16px;\n      font-size: 18px;\n      font-weight: 500;\n      cursor: pointer;\n    }\n\n    .autoplay-unmute-btn:hover {\n      background: var(--_accent-color);\n    }\n\n    [breakpointsm] .autoplay-unmute-btn {\n      --media-control-height: 30px;\n      padding: 14px 24px;\n      font-size: 26px;\n    }\n\n    .autoplay-unmute-btn svg {\n      margin: 0 6px 0 0;\n    }\n\n    [breakpointsm] .autoplay-unmute-btn svg {\n      margin: 0 10px 0 0;\n    }\n\n    media-controller:not([audio]):not([mediahasplayed]) *:is(media-control-bar, media-time-range) {\n      display: none;\n    }\n\n    media-error-dialog:not([mediaerrorcode]) {\n      opacity: 0;\n    }\n\n    media-loading-indicator {\n      --media-loading-icon-width: 100%;\n      --media-button-icon-height: auto;\n      display: var(--media-control-display, var(--media-loading-indicator-display, flex));\n      pointer-events: none;\n      position: absolute;\n      width: min(15%, 150px);\n      flex-flow: row;\n      align-items: center;\n      justify-content: center;\n    }\n\n    /* Intentionally don\'t target the div for transition but the children\n     of the div. Prevents messing with media-chrome\'s autohide feature. */\n    media-loading-indicator + div * {\n      transition: opacity 0.15s;\n      opacity: 1;\n    }\n\n    media-loading-indicator[medialoading]:not([mediapaused]) ~ div > * {\n      opacity: 0;\n      transition-delay: 400ms;\n    }\n\n    media-volume-range {\n      width: min(100%, 100px);\n      --media-range-padding-left: 10px;\n      --media-range-padding-right: 10px;\n      --media-range-thumb-width: 12px;\n      --media-range-thumb-height: 12px;\n      --media-range-thumb-background: radial-gradient(\n        circle,\n        #000 0%,\n        #000 25%,\n        var(--_primary-color) 25%,\n        var(--_primary-color)\n      );\n      --media-control-hover-background: none;\n    }\n\n    media-time-display {\n      white-space: nowrap;\n    }\n\n    /* Generic style for explicitly disabled controls */\n    media-control-bar[part~=\'bottom\'] [disabled],\n    media-control-bar[part~=\'bottom\'] [aria-disabled=\'true\'] {\n      opacity: 60%;\n      cursor: not-allowed;\n    }\n\n    media-text-display {\n      --media-font-size: 16px;\n      --media-control-padding: 14px;\n      font-weight: 500;\n    }\n\n    media-play-button.animated *:is(g, path) {\n      transition: all 0.3s;\n    }\n\n    media-play-button.animated[mediapaused] .pause-icon-pt1 {\n      opacity: 0;\n    }\n\n    media-play-button.animated[mediapaused] .pause-icon-pt2 {\n      transform-origin: center center;\n      transform: scaleY(0);\n    }\n\n    media-play-button.animated[mediapaused] .play-icon {\n      clip-path: inset(0 0 0 0);\n    }\n\n    media-play-button.animated:not([mediapaused]) .play-icon {\n      clip-path: inset(0 0 0 100%);\n    }\n\n    media-seek-forward-button,\n    media-seek-backward-button {\n      --media-font-weight: 400;\n    }\n\n    .mute-icon {\n      display: inline-block;\n    }\n\n    .mute-icon :is(path, g) {\n      transition: opacity 0.5s;\n    }\n\n    .muted {\n      opacity: 0;\n    }\n\n    media-mute-button[mediavolumelevel=\'low\'] :is(.volume-medium, .volume-high),\n    media-mute-button[mediavolumelevel=\'medium\'] :is(.volume-high) {\n      opacity: 0;\n    }\n\n    media-mute-button[mediavolumelevel=\'off\'] .unmuted {\n      opacity: 0;\n    }\n\n    media-mute-button[mediavolumelevel=\'off\'] .muted {\n      opacity: 1;\n    }\n\n    /**\n     * Our defaults for these buttons are to hide them at small sizes\n     * users can override this with CSS\n     */\n    media-controller:not([breakpointsm]):not([audio]) {\n      --bottom-play-button: none;\n      --bottom-seek-backward-button: none;\n      --bottom-seek-forward-button: none;\n      --bottom-time-display: none;\n      --bottom-playback-rate-menu-button: none;\n      --bottom-pip-button: none;\n    }\n\n    [part=\'mux-badge\'] {\n      position: absolute;\n      bottom: 10px;\n      right: 10px;\n      z-index: 2;\n      opacity: 0.6;\n      transition:\n        opacity 0.2s ease-in-out,\n        bottom 0.2s ease-in-out;\n    }\n\n    [part=\'mux-badge\']:hover {\n      opacity: 1;\n    }\n\n    [part=\'mux-badge\'] a {\n      font-size: 14px;\n      font-family: var(--_font-family);\n      color: var(--_primary-color);\n      text-decoration: none;\n      display: flex;\n      align-items: center;\n      gap: 5px;\n    }\n\n    [part=\'mux-badge\'] .mux-badge-text {\n      transition: opacity 0.5s ease-in-out;\n      opacity: 0;\n    }\n\n    [part=\'mux-badge\'] .mux-badge-logo {\n      width: 40px;\n      height: auto;\n      display: inline-block;\n    }\n\n    [part=\'mux-badge\'] .mux-badge-logo svg {\n      width: 100%;\n      height: 100%;\n      fill: white;\n    }\n\n    media-controller:not([userinactive]):not([mediahasplayed]) [part=\'mux-badge\'],\n    media-controller:not([userinactive]) [part=\'mux-badge\'],\n    media-controller[mediahasplayed][mediapaused] [part=\'mux-badge\'] {\n      transition: bottom 0.1s ease-in-out;\n    }\n\n    media-controller[userinactive]:not([mediapaused]) [part=\'mux-badge\'] {\n      transition: bottom 0.2s ease-in-out 0.62s;\n    }\n\n    media-controller:not([userinactive]) [part=\'mux-badge\'] .mux-badge-text,\n    media-controller[mediahasplayed][mediapaused] [part=\'mux-badge\'] .mux-badge-text {\n      opacity: 1;\n    }\n\n    media-controller[userinactive]:not([mediapaused]) [part=\'mux-badge\'] .mux-badge-text {\n      opacity: 0;\n    }\n\n    media-controller[userinactive]:not([mediapaused]) [part=\'mux-badge\'] {\n      bottom: 10px;\n    }\n\n    media-controller:not([userinactive]):not([mediahasplayed]) [part=\'mux-badge\'] {\n      bottom: 10px;\n    }\n\n    media-controller:not([userinactive])[mediahasplayed] [part=\'mux-badge\'],\n    media-controller[mediahasplayed][mediapaused] [part=\'mux-badge\'] {\n      bottom: calc(28px + var(--media-control-height, 0px) + var(--media-control-padding, 0px) * 2);\n    }\n  </style>\n\n  <template partial="TitleDisplay">\n    <template if="videotitle">\n      <template if="videotitle != true">\n        <media-text-display part="top title display" class="title-display">{{videotitle}}</media-text-display>\n      </template>\n    </template>\n    <template if="!videotitle">\n      <template if="title">\n        <media-text-display part="top title display" class="title-display">{{title}}</media-text-display>\n      </template>\n    </template>\n  </template>\n\n  <template partial="PlayButton">\n    <media-play-button\n      part="{{section ?? \'bottom\'}} play button"\n      disabled="{{disabled}}"\n      aria-disabled="{{disabled}}"\n      class="animated"\n    >\n      <svg aria-hidden="true" viewBox="0 0 18 14" slot="icon">\n        <g class="play-icon">\n          <path\n            d="M15.5987 6.2911L3.45577 0.110898C2.83667 -0.204202 2.06287 0.189698 2.06287 0.819798V13.1802C2.06287 13.8103 2.83667 14.2042 3.45577 13.8891L15.5987 7.7089C16.2178 7.3938 16.2178 6.6061 15.5987 6.2911Z"\n          />\n        </g>\n        <g class="pause-icon">\n          <path\n            class="pause-icon-pt1"\n            d="M5.90709 0H2.96889C2.46857 0 2.06299 0.405585 2.06299 0.9059V13.0941C2.06299 13.5944 2.46857 14 2.96889 14H5.90709C6.4074 14 6.81299 13.5944 6.81299 13.0941V0.9059C6.81299 0.405585 6.4074 0 5.90709 0Z"\n          />\n          <path\n            class="pause-icon-pt2"\n            d="M15.1571 0H12.2189C11.7186 0 11.313 0.405585 11.313 0.9059V13.0941C11.313 13.5944 11.7186 14 12.2189 14H15.1571C15.6574 14 16.063 13.5944 16.063 13.0941V0.9059C16.063 0.405585 15.6574 0 15.1571 0Z"\n          />\n        </g>\n      </svg>\n    </media-play-button>\n  </template>\n\n  <template partial="PrePlayButton">\n    <media-play-button\n      part="{{section ?? \'center\'}} play button pre-play"\n      disabled="{{disabled}}"\n      aria-disabled="{{disabled}}"\n    >\n      <svg aria-hidden="true" viewBox="0 0 18 14" slot="icon" style="transform: translate(3px, 0)">\n        <path\n          d="M15.5987 6.2911L3.45577 0.110898C2.83667 -0.204202 2.06287 0.189698 2.06287 0.819798V13.1802C2.06287 13.8103 2.83667 14.2042 3.45577 13.8891L15.5987 7.7089C16.2178 7.3938 16.2178 6.6061 15.5987 6.2911Z"\n        />\n      </svg>\n    </media-play-button>\n  </template>\n\n  <template partial="SeekBackwardButton">\n    <media-seek-backward-button\n      seekoffset="{{backwardseekoffset}}"\n      part="{{section ?? \'bottom\'}} seek-backward button"\n      disabled="{{disabled}}"\n      aria-disabled="{{disabled}}"\n    >\n      <svg viewBox="0 0 22 14" aria-hidden="true" slot="icon">\n        <path\n          d="M3.65 2.07888L0.0864 6.7279C-0.0288 6.87812 -0.0288 7.12188 0.0864 7.2721L3.65 11.9211C3.7792 12.0896 4 11.9703 4 11.7321V2.26787C4 2.02968 3.7792 1.9104 3.65 2.07888Z"\n        />\n        <text transform="translate(6 12)" style="font-size: 14px; font-family: \'ArialMT\', \'Arial\'">\n          {{backwardseekoffset}}\n        </text>\n      </svg>\n    </media-seek-backward-button>\n  </template>\n\n  <template partial="SeekForwardButton">\n    <media-seek-forward-button\n      seekoffset="{{forwardseekoffset}}"\n      part="{{section ?? \'bottom\'}} seek-forward button"\n      disabled="{{disabled}}"\n      aria-disabled="{{disabled}}"\n    >\n      <svg viewBox="0 0 22 14" aria-hidden="true" slot="icon">\n        <g>\n          <text transform="translate(-1 12)" style="font-size: 14px; font-family: \'ArialMT\', \'Arial\'">\n            {{forwardseekoffset}}\n          </text>\n          <path\n            d="M18.35 11.9211L21.9136 7.2721C22.0288 7.12188 22.0288 6.87812 21.9136 6.7279L18.35 2.07888C18.2208 1.91041 18 2.02968 18 2.26787V11.7321C18 11.9703 18.2208 12.0896 18.35 11.9211Z"\n          />\n        </g>\n      </svg>\n    </media-seek-forward-button>\n  </template>\n\n  <template partial="MuteButton">\n    <media-mute-button part="bottom mute button" disabled="{{disabled}}" aria-disabled="{{disabled}}">\n      <svg viewBox="0 0 18 14" slot="icon" class="mute-icon" aria-hidden="true">\n        <g class="unmuted">\n          <path\n            d="M6.76786 1.21233L3.98606 3.98924H1.19937C0.593146 3.98924 0.101743 4.51375 0.101743 5.1607V6.96412L0 6.99998L0.101743 7.03583V8.83926C0.101743 9.48633 0.593146 10.0108 1.19937 10.0108H3.98606L6.76773 12.7877C7.23561 13.2547 8 12.9007 8 12.2171V1.78301C8 1.09925 7.23574 0.745258 6.76786 1.21233Z"\n          />\n          <path\n            class="volume-low"\n            d="M10 3.54781C10.7452 4.55141 11.1393 5.74511 11.1393 6.99991C11.1393 8.25471 10.7453 9.44791 10 10.4515L10.7988 11.0496C11.6734 9.87201 12.1356 8.47161 12.1356 6.99991C12.1356 5.52821 11.6735 4.12731 10.7988 2.94971L10 3.54781Z"\n          />\n          <path\n            class="volume-medium"\n            d="M12.3778 2.40086C13.2709 3.76756 13.7428 5.35806 13.7428 7.00026C13.7428 8.64246 13.2709 10.233 12.3778 11.5992L13.2106 12.1484C14.2107 10.6185 14.739 8.83796 14.739 7.00016C14.739 5.16236 14.2107 3.38236 13.2106 1.85156L12.3778 2.40086Z"\n          />\n          <path\n            class="volume-high"\n            d="M15.5981 0.75L14.7478 1.2719C15.7937 2.9919 16.3468 4.9723 16.3468 7C16.3468 9.0277 15.7937 11.0082 14.7478 12.7281L15.5981 13.25C16.7398 11.3722 17.343 9.211 17.343 7C17.343 4.789 16.7398 2.6268 15.5981 0.75Z"\n          />\n        </g>\n        <g class="muted">\n          <path\n            fill-rule="evenodd"\n            clip-rule="evenodd"\n            d="M4.39976 4.98924H1.19937C1.19429 4.98924 1.17777 4.98961 1.15296 5.01609C1.1271 5.04369 1.10174 5.09245 1.10174 5.1607V8.83926C1.10174 8.90761 1.12714 8.95641 1.15299 8.984C1.17779 9.01047 1.1943 9.01084 1.19937 9.01084H4.39977L7 11.6066V2.39357L4.39976 4.98924ZM7.47434 1.92006C7.4743 1.9201 7.47439 1.92002 7.47434 1.92006V1.92006ZM6.76773 12.7877L3.98606 10.0108H1.19937C0.593146 10.0108 0.101743 9.48633 0.101743 8.83926V7.03583L0 6.99998L0.101743 6.96412V5.1607C0.101743 4.51375 0.593146 3.98924 1.19937 3.98924H3.98606L6.76786 1.21233C7.23574 0.745258 8 1.09925 8 1.78301V12.2171C8 12.9007 7.23561 13.2547 6.76773 12.7877Z"\n          />\n          <path\n            fill-rule="evenodd"\n            clip-rule="evenodd"\n            d="M15.2677 9.30323C15.463 9.49849 15.7796 9.49849 15.9749 9.30323C16.1701 9.10796 16.1701 8.79138 15.9749 8.59612L14.2071 6.82841L15.9749 5.06066C16.1702 4.8654 16.1702 4.54882 15.9749 4.35355C15.7796 4.15829 15.4631 4.15829 15.2678 4.35355L13.5 6.1213L11.7322 4.35348C11.537 4.15822 11.2204 4.15822 11.0251 4.35348C10.8298 4.54874 10.8298 4.86532 11.0251 5.06058L12.7929 6.82841L11.0251 8.59619C10.8299 8.79146 10.8299 9.10804 11.0251 9.3033C11.2204 9.49856 11.537 9.49856 11.7323 9.3033L13.5 7.53552L15.2677 9.30323Z"\n          />\n        </g>\n      </svg>\n    </media-mute-button>\n  </template>\n\n  <template partial="PipButton">\n    <media-pip-button part="bottom pip button" disabled="{{disabled}}" aria-disabled="{{disabled}}">\n      <svg viewBox="0 0 18 14" aria-hidden="true" slot="icon">\n        <path\n          d="M15.9891 0H2.011C0.9004 0 0 0.9003 0 2.0109V11.989C0 13.0996 0.9004 14 2.011 14H15.9891C17.0997 14 18 13.0997 18 11.9891V2.0109C18 0.9003 17.0997 0 15.9891 0ZM17 11.9891C17 12.5465 16.5465 13 15.9891 13H2.011C1.4536 13 1.0001 12.5465 1.0001 11.9891V2.0109C1.0001 1.4535 1.4536 0.9999 2.011 0.9999H15.9891C16.5465 0.9999 17 1.4535 17 2.0109V11.9891Z"\n        />\n        <path\n          d="M15.356 5.67822H8.19523C8.03253 5.67822 7.90063 5.81012 7.90063 5.97282V11.3836C7.90063 11.5463 8.03253 11.6782 8.19523 11.6782H15.356C15.5187 11.6782 15.6506 11.5463 15.6506 11.3836V5.97282C15.6506 5.81012 15.5187 5.67822 15.356 5.67822Z"\n        />\n      </svg>\n    </media-pip-button>\n  </template>\n\n  <template partial="CaptionsMenu">\n    <media-captions-menu-button part="bottom captions button">\n      <svg aria-hidden="true" viewBox="0 0 18 14" slot="on">\n        <path\n          d="M15.989 0H2.011C0.9004 0 0 0.9003 0 2.0109V11.9891C0 13.0997 0.9004 14 2.011 14H15.989C17.0997 14 18 13.0997 18 11.9891V2.0109C18 0.9003 17.0997 0 15.989 0ZM4.2292 8.7639C4.5954 9.1902 5.0935 9.4031 5.7233 9.4031C6.1852 9.4031 6.5544 9.301 6.8302 9.0969C7.1061 8.8933 7.2863 8.614 7.3702 8.26H8.4322C8.3062 8.884 8.0093 9.3733 7.5411 9.7273C7.0733 10.0813 6.4703 10.2581 5.732 10.2581C5.108 10.2581 4.5699 10.1219 4.1168 9.8489C3.6637 9.5759 3.3141 9.1946 3.0685 8.7058C2.8224 8.2165 2.6994 7.6511 2.6994 7.009C2.6994 6.3611 2.8224 5.7927 3.0685 5.3034C3.3141 4.8146 3.6637 4.4323 4.1168 4.1559C4.5699 3.88 5.108 3.7418 5.732 3.7418C6.4703 3.7418 7.0733 3.922 7.5411 4.2818C8.0094 4.6422 8.3062 5.1461 8.4322 5.794H7.3702C7.2862 5.4283 7.106 5.1368 6.8302 4.921C6.5544 4.7052 6.1852 4.5968 5.7233 4.5968C5.0934 4.5968 4.5954 4.8116 4.2292 5.2404C3.8635 5.6696 3.6804 6.259 3.6804 7.009C3.6804 7.7531 3.8635 8.3381 4.2292 8.7639ZM11.0974 8.7639C11.4636 9.1902 11.9617 9.4031 12.5915 9.4031C13.0534 9.4031 13.4226 9.301 13.6984 9.0969C13.9743 8.8933 14.1545 8.614 14.2384 8.26H15.3004C15.1744 8.884 14.8775 9.3733 14.4093 9.7273C13.9415 10.0813 13.3385 10.2581 12.6002 10.2581C11.9762 10.2581 11.4381 10.1219 10.985 9.8489C10.5319 9.5759 10.1823 9.1946 9.9367 8.7058C9.6906 8.2165 9.5676 7.6511 9.5676 7.009C9.5676 6.3611 9.6906 5.7927 9.9367 5.3034C10.1823 4.8146 10.5319 4.4323 10.985 4.1559C11.4381 3.88 11.9762 3.7418 12.6002 3.7418C13.3385 3.7418 13.9415 3.922 14.4093 4.2818C14.8776 4.6422 15.1744 5.1461 15.3004 5.794H14.2384C14.1544 5.4283 13.9742 5.1368 13.6984 4.921C13.4226 4.7052 13.0534 4.5968 12.5915 4.5968C11.9616 4.5968 11.4636 4.8116 11.0974 5.2404C10.7317 5.6696 10.5486 6.259 10.5486 7.009C10.5486 7.7531 10.7317 8.3381 11.0974 8.7639Z"\n        />\n      </svg>\n      <svg aria-hidden="true" viewBox="0 0 18 14" slot="off">\n        <path\n          d="M5.73219 10.258C5.10819 10.258 4.57009 10.1218 4.11699 9.8488C3.66389 9.5758 3.31429 9.1945 3.06869 8.7057C2.82259 8.2164 2.69958 7.651 2.69958 7.0089C2.69958 6.361 2.82259 5.7926 3.06869 5.3033C3.31429 4.8145 3.66389 4.4322 4.11699 4.1558C4.57009 3.8799 5.10819 3.7417 5.73219 3.7417C6.47049 3.7417 7.07348 3.9219 7.54128 4.2817C8.00958 4.6421 8.30638 5.146 8.43238 5.7939H7.37039C7.28639 5.4282 7.10618 5.1367 6.83039 4.9209C6.55459 4.7051 6.18538 4.5967 5.72348 4.5967C5.09358 4.5967 4.59559 4.8115 4.22939 5.2403C3.86369 5.6695 3.68058 6.2589 3.68058 7.0089C3.68058 7.753 3.86369 8.338 4.22939 8.7638C4.59559 9.1901 5.09368 9.403 5.72348 9.403C6.18538 9.403 6.55459 9.3009 6.83039 9.0968C7.10629 8.8932 7.28649 8.6139 7.37039 8.2599H8.43238C8.30638 8.8839 8.00948 9.3732 7.54128 9.7272C7.07348 10.0812 6.47049 10.258 5.73219 10.258Z"\n        />\n        <path\n          d="M12.6003 10.258C11.9763 10.258 11.4382 10.1218 10.9851 9.8488C10.532 9.5758 10.1824 9.1945 9.93685 8.7057C9.69075 8.2164 9.56775 7.651 9.56775 7.0089C9.56775 6.361 9.69075 5.7926 9.93685 5.3033C10.1824 4.8145 10.532 4.4322 10.9851 4.1558C11.4382 3.8799 11.9763 3.7417 12.6003 3.7417C13.3386 3.7417 13.9416 3.9219 14.4094 4.2817C14.8777 4.6421 15.1745 5.146 15.3005 5.7939H14.2385C14.1545 5.4282 13.9743 5.1367 13.6985 4.9209C13.4227 4.7051 13.0535 4.5967 12.5916 4.5967C11.9617 4.5967 11.4637 4.8115 11.0975 5.2403C10.7318 5.6695 10.5487 6.2589 10.5487 7.0089C10.5487 7.753 10.7318 8.338 11.0975 8.7638C11.4637 9.1901 11.9618 9.403 12.5916 9.403C13.0535 9.403 13.4227 9.3009 13.6985 9.0968C13.9744 8.8932 14.1546 8.6139 14.2385 8.2599H15.3005C15.1745 8.8839 14.8776 9.3732 14.4094 9.7272C13.9416 10.0812 13.3386 10.258 12.6003 10.258Z"\n        />\n        <path\n          d="M15.9891 1C16.5465 1 17 1.4535 17 2.011V11.9891C17 12.5465 16.5465 13 15.9891 13H2.0109C1.4535 13 1 12.5465 1 11.9891V2.0109C1 1.4535 1.4535 0.9999 2.0109 0.9999L15.9891 1ZM15.9891 0H2.0109C0.9003 0 0 0.9003 0 2.0109V11.9891C0 13.0997 0.9003 14 2.0109 14H15.9891C17.0997 14 18 13.0997 18 11.9891V2.0109C18 0.9003 17.0997 0 15.9891 0Z"\n        />\n      </svg>\n    </media-captions-menu-button>\n    <media-captions-menu\n      hidden\n      anchor="auto"\n      part="bottom captions menu"\n      disabled="{{disabled}}"\n      aria-disabled="{{disabled}}"\n      exportparts="menu-item"\n    >\n      <div slot="checked-indicator">\n        <style>\n          .indicator {\n            position: relative;\n            top: 1px;\n            width: 0.9em;\n            height: auto;\n            fill: var(--_accent-color);\n            margin-right: 5px;\n          }\n\n          [aria-checked=\'false\'] .indicator {\n            display: none;\n          }\n        </style>\n        <svg viewBox="0 0 14 18" class="indicator">\n          <path\n            d="M12.252 3.48c-.115.033-.301.161-.425.291-.059.063-1.407 1.815-2.995 3.894s-2.897 3.79-2.908 3.802c-.013.014-.661-.616-1.672-1.624-.908-.905-1.702-1.681-1.765-1.723-.401-.27-.783-.211-1.176.183a1.285 1.285 0 0 0-.261.342.582.582 0 0 0-.082.35c0 .165.01.205.08.35.075.153.213.296 2.182 2.271 1.156 1.159 2.17 2.159 2.253 2.222.189.143.338.196.539.194.203-.003.412-.104.618-.299.205-.193 6.7-8.693 6.804-8.903a.716.716 0 0 0 .085-.345c.01-.179.005-.203-.062-.339-.124-.252-.45-.531-.746-.639a.784.784 0 0 0-.469-.027"\n            fill-rule="evenodd"\n          />\n        </svg></div\n    ></media-captions-menu>\n  </template>\n\n  <template partial="AirplayButton">\n    <media-airplay-button part="bottom airplay button" disabled="{{disabled}}" aria-disabled="{{disabled}}">\n      <svg viewBox="0 0 18 14" aria-hidden="true" slot="icon">\n        <path\n          d="M16.1383 0H1.8618C0.8335 0 0 0.8335 0 1.8617V10.1382C0 11.1664 0.8335 12 1.8618 12H3.076C3.1204 11.9433 3.1503 11.8785 3.2012 11.826L4.004 11H1.8618C1.3866 11 1 10.6134 1 10.1382V1.8617C1 1.3865 1.3866 0.9999 1.8618 0.9999H16.1383C16.6135 0.9999 17.0001 1.3865 17.0001 1.8617V10.1382C17.0001 10.6134 16.6135 11 16.1383 11H13.9961L14.7989 11.826C14.8499 11.8785 14.8798 11.9432 14.9241 12H16.1383C17.1665 12 18.0001 11.1664 18.0001 10.1382V1.8617C18 0.8335 17.1665 0 16.1383 0Z"\n        />\n        <path\n          d="M9.55061 8.21903C9.39981 8.06383 9.20001 7.98633 9.00011 7.98633C8.80021 7.98633 8.60031 8.06383 8.44951 8.21903L4.09771 12.697C3.62471 13.1838 3.96961 13.9998 4.64831 13.9998H13.3518C14.0304 13.9998 14.3754 13.1838 13.9023 12.697L9.55061 8.21903Z"\n        />\n      </svg>\n    </media-airplay-button>\n  </template>\n\n  <template partial="FullscreenButton">\n    <media-fullscreen-button part="bottom fullscreen button" disabled="{{disabled}}" aria-disabled="{{disabled}}">\n      <svg viewBox="0 0 18 14" aria-hidden="true" slot="enter">\n        <path\n          d="M1.00745 4.39539L1.01445 1.98789C1.01605 1.43049 1.47085 0.978289 2.02835 0.979989L6.39375 0.992589L6.39665 -0.007411L2.03125 -0.020011C0.920646 -0.023211 0.0176463 0.874489 0.0144463 1.98509L0.00744629 4.39539H1.00745Z"\n        />\n        <path\n          d="M17.0144 2.03431L17.0076 4.39541H18.0076L18.0144 2.03721C18.0176 0.926712 17.1199 0.0237125 16.0093 0.0205125L11.6439 0.0078125L11.641 1.00781L16.0064 1.02041C16.5638 1.02201 17.016 1.47681 17.0144 2.03431Z"\n        />\n        <path\n          d="M16.9925 9.60498L16.9855 12.0124C16.9839 12.5698 16.5291 13.022 15.9717 13.0204L11.6063 13.0078L11.6034 14.0078L15.9688 14.0204C17.0794 14.0236 17.9823 13.1259 17.9855 12.0153L17.9925 9.60498H16.9925Z"\n        />\n        <path\n          d="M0.985626 11.9661L0.992426 9.60498H-0.0074737L-0.0142737 11.9632C-0.0174737 13.0738 0.880226 13.9767 1.99083 13.98L6.35623 13.9926L6.35913 12.9926L1.99373 12.98C1.43633 12.9784 0.983926 12.5236 0.985626 11.9661Z"\n        />\n      </svg>\n      <svg viewBox="0 0 18 14" aria-hidden="true" slot="exit">\n        <path\n          d="M5.39655 -0.0200195L5.38955 2.38748C5.38795 2.94488 4.93315 3.39708 4.37565 3.39538L0.0103463 3.38278L0.00744629 4.38278L4.37285 4.39538C5.48345 4.39858 6.38635 3.50088 6.38965 2.39028L6.39665 -0.0200195H5.39655Z"\n        />\n        <path\n          d="M12.6411 2.36891L12.6479 0.0078125H11.6479L11.6411 2.36601C11.6379 3.47651 12.5356 4.37951 13.6462 4.38271L18.0116 4.39531L18.0145 3.39531L13.6491 3.38271C13.0917 3.38111 12.6395 2.92641 12.6411 2.36891Z"\n        />\n        <path\n          d="M12.6034 14.0204L12.6104 11.613C12.612 11.0556 13.0668 10.6034 13.6242 10.605L17.9896 10.6176L17.9925 9.61759L13.6271 9.60499C12.5165 9.60179 11.6136 10.4995 11.6104 11.6101L11.6034 14.0204H12.6034Z"\n        />\n        <path\n          d="M5.359 11.6315L5.3522 13.9926H6.3522L6.359 11.6344C6.3622 10.5238 5.4645 9.62088 4.3539 9.61758L-0.0115043 9.60498L-0.0144043 10.605L4.351 10.6176C4.9084 10.6192 5.3607 11.074 5.359 11.6315Z"\n        />\n      </svg>\n    </media-fullscreen-button>\n  </template>\n\n  <template partial="CastButton">\n    <media-cast-button part="bottom cast button" disabled="{{disabled}}" aria-disabled="{{disabled}}">\n      <svg viewBox="0 0 18 14" aria-hidden="true" slot="enter">\n        <path\n          d="M16.0072 0H2.0291C0.9185 0 0.0181 0.9003 0.0181 2.011V5.5009C0.357 5.5016 0.6895 5.5275 1.0181 5.5669V2.011C1.0181 1.4536 1.4716 1 2.029 1H16.0072C16.5646 1 17.0181 1.4536 17.0181 2.011V11.9891C17.0181 12.5465 16.5646 13 16.0072 13H8.4358C8.4746 13.3286 8.4999 13.6611 8.4999 13.9999H16.0071C17.1177 13.9999 18.018 13.0996 18.018 11.989V2.011C18.0181 0.9003 17.1178 0 16.0072 0ZM0 6.4999V7.4999C3.584 7.4999 6.5 10.4159 6.5 13.9999H7.5C7.5 9.8642 4.1357 6.4999 0 6.4999ZM0 8.7499V9.7499C2.3433 9.7499 4.25 11.6566 4.25 13.9999H5.25C5.25 11.1049 2.895 8.7499 0 8.7499ZM0.0181 11V14H3.0181C3.0181 12.3431 1.675 11 0.0181 11Z"\n        />\n      </svg>\n      <svg viewBox="0 0 18 14" aria-hidden="true" slot="exit">\n        <path\n          d="M15.9891 0H2.01103C0.900434 0 3.35947e-05 0.9003 3.35947e-05 2.011V5.5009C0.338934 5.5016 0.671434 5.5275 1.00003 5.5669V2.011C1.00003 1.4536 1.45353 1 2.01093 1H15.9891C16.5465 1 17 1.4536 17 2.011V11.9891C17 12.5465 16.5465 13 15.9891 13H8.41773C8.45653 13.3286 8.48183 13.6611 8.48183 13.9999H15.989C17.0996 13.9999 17.9999 13.0996 17.9999 11.989V2.011C18 0.9003 17.0997 0 15.9891 0ZM-0.0180664 6.4999V7.4999C3.56593 7.4999 6.48193 10.4159 6.48193 13.9999H7.48193C7.48193 9.8642 4.11763 6.4999 -0.0180664 6.4999ZM-0.0180664 8.7499V9.7499C2.32523 9.7499 4.23193 11.6566 4.23193 13.9999H5.23193C5.23193 11.1049 2.87693 8.7499 -0.0180664 8.7499ZM3.35947e-05 11V14H3.00003C3.00003 12.3431 1.65693 11 3.35947e-05 11Z"\n        />\n        <path d="M2.15002 5.634C5.18352 6.4207 7.57252 8.8151 8.35282 11.8499H15.8501V2.1499H2.15002V5.634Z" />\n      </svg>\n    </media-cast-button>\n  </template>\n\n  <template partial="LiveButton">\n    <media-live-button part="{{section ?? \'top\'}} live button" disabled="{{disabled}}" aria-disabled="{{disabled}}">\n      <span slot="text">Live</span>\n    </media-live-button>\n  </template>\n\n  <template partial="PlaybackRateMenu">\n    <media-playback-rate-menu-button part="bottom playback-rate button"></media-playback-rate-menu-button>\n    <media-playback-rate-menu\n      hidden\n      anchor="auto"\n      rates="{{playbackrates}}"\n      exportparts="menu-item"\n      part="bottom playback-rate menu"\n      disabled="{{disabled}}"\n      aria-disabled="{{disabled}}"\n    ></media-playback-rate-menu>\n  </template>\n\n  <template partial="VolumeRange">\n    <media-volume-range\n      part="bottom volume range"\n      disabled="{{disabled}}"\n      aria-disabled="{{disabled}}"\n    ></media-volume-range>\n  </template>\n\n  <template partial="TimeDisplay">\n    <media-time-display\n      remaining="{{defaultshowremainingtime}}"\n      showduration="{{!hideduration}}"\n      part="bottom time display"\n      disabled="{{disabled}}"\n      aria-disabled="{{disabled}}"\n    ></media-time-display>\n  </template>\n\n  <template partial="TimeRange">\n    <media-time-range part="bottom time range" disabled="{{disabled}}" aria-disabled="{{disabled}}">\n      <media-preview-thumbnail slot="preview"></media-preview-thumbnail>\n      <media-preview-chapter-display slot="preview"></media-preview-chapter-display>\n      <media-preview-time-display slot="preview"></media-preview-time-display>\n      <div slot="preview" part="arrow"></div>\n    </media-time-range>\n  </template>\n\n  <template partial="AudioTrackMenu">\n    <media-audio-track-menu-button part="bottom audio-track button">\n      <svg aria-hidden="true" slot="icon" viewBox="0 0 18 16">\n        <path d="M9 15A7 7 0 1 1 9 1a7 7 0 0 1 0 14Zm0 1A8 8 0 1 0 9 0a8 8 0 0 0 0 16Z" />\n        <path\n          d="M5.2 6.3a.5.5 0 0 1 .5.5v2.4a.5.5 0 1 1-1 0V6.8a.5.5 0 0 1 .5-.5Zm2.4-2.4a.5.5 0 0 1 .5.5v7.2a.5.5 0 0 1-1 0V4.4a.5.5 0 0 1 .5-.5ZM10 5.5a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5Zm2.4-.8a.5.5 0 0 1 .5.5v5.6a.5.5 0 0 1-1 0V5.2a.5.5 0 0 1 .5-.5Z"\n        />\n      </svg>\n    </media-audio-track-menu-button>\n    <media-audio-track-menu\n      hidden\n      anchor="auto"\n      part="bottom audio-track menu"\n      disabled="{{disabled}}"\n      aria-disabled="{{disabled}}"\n      exportparts="menu-item"\n    >\n      <div slot="checked-indicator">\n        <style>\n          .indicator {\n            position: relative;\n            top: 1px;\n            width: 0.9em;\n            height: auto;\n            fill: var(--_accent-color);\n            margin-right: 5px;\n          }\n\n          [aria-checked=\'false\'] .indicator {\n            display: none;\n          }\n        </style>\n        <svg viewBox="0 0 14 18" class="indicator">\n          <path\n            d="M12.252 3.48c-.115.033-.301.161-.425.291-.059.063-1.407 1.815-2.995 3.894s-2.897 3.79-2.908 3.802c-.013.014-.661-.616-1.672-1.624-.908-.905-1.702-1.681-1.765-1.723-.401-.27-.783-.211-1.176.183a1.285 1.285 0 0 0-.261.342.582.582 0 0 0-.082.35c0 .165.01.205.08.35.075.153.213.296 2.182 2.271 1.156 1.159 2.17 2.159 2.253 2.222.189.143.338.196.539.194.203-.003.412-.104.618-.299.205-.193 6.7-8.693 6.804-8.903a.716.716 0 0 0 .085-.345c.01-.179.005-.203-.062-.339-.124-.252-.45-.531-.746-.639a.784.784 0 0 0-.469-.027"\n            fill-rule="evenodd"\n          />\n        </svg>\n      </div>\n    </media-audio-track-menu>\n  </template>\n\n  <template partial="RenditionMenu">\n    <media-rendition-menu-button part="bottom rendition button">\n      <svg aria-hidden="true" slot="icon" viewBox="0 0 18 14">\n        <path\n          d="M2.25 9a2 2 0 1 0 0-4 2 2 0 0 0 0 4ZM9 9a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm6.75 0a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z"\n        />\n      </svg>\n    </media-rendition-menu-button>\n    <media-rendition-menu\n      hidden\n      anchor="auto"\n      part="bottom rendition menu"\n      disabled="{{disabled}}"\n      aria-disabled="{{disabled}}"\n    >\n      <div slot="checked-indicator">\n        <style>\n          .indicator {\n            position: relative;\n            top: 1px;\n            width: 0.9em;\n            height: auto;\n            fill: var(--_accent-color);\n            margin-right: 5px;\n          }\n\n          [aria-checked=\'false\'] .indicator {\n            opacity: 0;\n          }\n        </style>\n        <svg viewBox="0 0 14 18" class="indicator">\n          <path\n            d="M12.252 3.48c-.115.033-.301.161-.425.291-.059.063-1.407 1.815-2.995 3.894s-2.897 3.79-2.908 3.802c-.013.014-.661-.616-1.672-1.624-.908-.905-1.702-1.681-1.765-1.723-.401-.27-.783-.211-1.176.183a1.285 1.285 0 0 0-.261.342.582.582 0 0 0-.082.35c0 .165.01.205.08.35.075.153.213.296 2.182 2.271 1.156 1.159 2.17 2.159 2.253 2.222.189.143.338.196.539.194.203-.003.412-.104.618-.299.205-.193 6.7-8.693 6.804-8.903a.716.716 0 0 0 .085-.345c.01-.179.005-.203-.062-.339-.124-.252-.45-.531-.746-.639a.784.784 0 0 0-.469-.027"\n            fill-rule="evenodd"\n          />\n        </svg>\n      </div>\n    </media-rendition-menu>\n  </template>\n\n  <template partial="MuxBadge">\n    <div part="mux-badge">\n      <a href="https://www.mux.com/player" target="_blank">\n        <span class="mux-badge-text">Powered by</span>\n        <div class="mux-badge-logo">\n          <svg\n            viewBox="0 0 1600 500"\n            style="fill-rule: evenodd; clip-rule: evenodd; stroke-linejoin: round; stroke-miterlimit: 2"\n          >\n            <g>\n              <path\n                d="M994.287,93.486c-17.121,-0 -31,-13.879 -31,-31c0,-17.121 13.879,-31 31,-31c17.121,-0 31,13.879 31,31c0,17.121 -13.879,31 -31,31m0,-93.486c-34.509,-0 -62.484,27.976 -62.484,62.486l0,187.511c0,68.943 -56.09,125.033 -125.032,125.033c-68.942,-0 -125.03,-56.09 -125.03,-125.033l0,-187.511c0,-34.51 -27.976,-62.486 -62.485,-62.486c-34.509,-0 -62.484,27.976 -62.484,62.486l0,187.511c0,137.853 112.149,250.003 249.999,250.003c137.851,-0 250.001,-112.15 250.001,-250.003l0,-187.511c0,-34.51 -27.976,-62.486 -62.485,-62.486"\n                style="fill-rule: nonzero"\n              ></path>\n              <path\n                d="M1537.51,468.511c-17.121,-0 -31,-13.879 -31,-31c0,-17.121 13.879,-31 31,-31c17.121,-0 31,13.879 31,31c0,17.121 -13.879,31 -31,31m-275.883,-218.509l-143.33,143.329c-24.402,24.402 -24.402,63.966 0,88.368c24.402,24.402 63.967,24.402 88.369,-0l143.33,-143.329l143.328,143.329c24.402,24.4 63.967,24.402 88.369,-0c24.403,-24.402 24.403,-63.966 0.001,-88.368l-143.33,-143.329l0.001,-0.004l143.329,-143.329c24.402,-24.402 24.402,-63.965 0,-88.367c-24.402,-24.402 -63.967,-24.402 -88.369,-0l-143.329,143.328l-143.329,-143.328c-24.402,-24.401 -63.967,-24.402 -88.369,-0c-24.402,24.402 -24.402,63.965 0,88.367l143.329,143.329l0,0.004Z"\n                style="fill-rule: nonzero"\n              ></path>\n              <path\n                d="M437.511,468.521c-17.121,-0 -31,-13.879 -31,-31c0,-17.121 13.879,-31 31,-31c17.121,-0 31,13.879 31,31c0,17.121 -13.879,31 -31,31m23.915,-463.762c-23.348,-9.672 -50.226,-4.327 -68.096,13.544l-143.331,143.329l-143.33,-143.329c-17.871,-17.871 -44.747,-23.216 -68.096,-13.544c-23.349,9.671 -38.574,32.455 -38.574,57.729l0,375.026c0,34.51 27.977,62.486 62.487,62.486c34.51,-0 62.486,-27.976 62.486,-62.486l0,-224.173l80.843,80.844c24.404,24.402 63.965,24.402 88.369,-0l80.843,-80.844l0,224.173c0,34.51 27.976,62.486 62.486,62.486c34.51,-0 62.486,-27.976 62.486,-62.486l0,-375.026c0,-25.274 -15.224,-48.058 -38.573,-57.729"\n                style="fill-rule: nonzero"\n              ></path>\n            </g>\n          </svg>\n        </div>\n      </a>\n    </div>\n  </template>\n\n  <media-controller\n    part="controller"\n    defaultstreamtype="{{defaultstreamtype ?? \'on-demand\'}}"\n    breakpoints="sm:470"\n    gesturesdisabled="{{disabled}}"\n    hotkeys="{{hotkeys}}"\n    nohotkeys="{{nohotkeys}}"\n    novolumepref="{{novolumepref}}"\n    audio="{{audio}}"\n    noautoseektolive="{{noautoseektolive}}"\n    defaultsubtitles="{{defaultsubtitles}}"\n    defaultduration="{{defaultduration ?? false}}"\n    keyboardforwardseekoffset="{{forwardseekoffset}}"\n    keyboardbackwardseekoffset="{{backwardseekoffset}}"\n    exportparts="layer, media-layer, poster-layer, vertical-layer, centered-layer, gesture-layer"\n    style="--_pre-playback-place:{{preplaybackplace ?? \'center\'}}"\n  >\n    <slot name="media" slot="media"></slot>\n    <slot name="poster" slot="poster"></slot>\n\n    <media-loading-indicator slot="centered-chrome" noautohide></media-loading-indicator>\n    <media-error-dialog slot="dialog" noautohide></media-error-dialog>\n\n    <template if="!audio">\n      \x3c!-- Pre-playback UI --\x3e\n      \x3c!-- same for both on-demand and live --\x3e\n      <div slot="centered-chrome" class="center-controls pre-playback">\n        <template if="!breakpointsm">{{>PlayButton section="center"}}</template>\n        <template if="breakpointsm">{{>PrePlayButton section="center"}}</template>\n      </div>\n\n      \x3c!-- Mux Badge --\x3e\n      <template if="proudlydisplaymuxbadge"> {{>MuxBadge}} </template>\n\n      \x3c!-- Autoplay centered unmute button --\x3e\n      \x3c!--\n        todo: figure out how show this with available state variables\n        needs to show when:\n        - autoplay is enabled\n        - playback has been successful\n        - audio is muted\n        - in place / instead of the pre-plaback play button\n        - not to show again after user has interacted with this button\n          - OR user has interacted with the mute button in the control bar\n      --\x3e\n      \x3c!--\n        There should be a >MuteButton to the left of the "Unmute" text, but a templating bug\n        makes it appear even if commented out in the markup, add it back when code is un-commented\n      --\x3e\n      \x3c!-- <div slot="centered-chrome" class="autoplay-unmute">\n        <div role="button" class="autoplay-unmute-btn">Unmute</div>\n      </div> --\x3e\n\n      <template if="streamtype == \'on-demand\'">\n        <template if="breakpointsm">\n          <media-control-bar part="control-bar top" slot="top-chrome">{{>TitleDisplay}} </media-control-bar>\n        </template>\n        {{>TimeRange}}\n        <media-control-bar part="control-bar bottom">\n          {{>PlayButton}} {{>SeekBackwardButton}} {{>SeekForwardButton}} {{>TimeDisplay}} {{>MuteButton}}\n          {{>VolumeRange}}\n          <div class="spacer"></div>\n          {{>RenditionMenu}} {{>PlaybackRateMenu}} {{>AudioTrackMenu}} {{>CaptionsMenu}} {{>AirplayButton}}\n          {{>CastButton}} {{>PipButton}} {{>FullscreenButton}}\n        </media-control-bar>\n      </template>\n\n      <template if="streamtype == \'live\'">\n        <media-control-bar part="control-bar top" slot="top-chrome">\n          {{>LiveButton}}\n          <template if="breakpointsm"> {{>TitleDisplay}} </template>\n        </media-control-bar>\n        <template if="targetlivewindow > 0">{{>TimeRange}}</template>\n        <media-control-bar part="control-bar bottom">\n          {{>PlayButton}}\n          <template if="targetlivewindow > 0">{{>SeekBackwardButton}} {{>SeekForwardButton}}</template>\n          {{>MuteButton}} {{>VolumeRange}}\n          <div class="spacer"></div>\n          {{>RenditionMenu}} {{>AudioTrackMenu}} {{>CaptionsMenu}} {{>AirplayButton}} {{>CastButton}} {{>PipButton}}\n          {{>FullscreenButton}}\n        </media-control-bar>\n      </template>\n    </template>\n\n    <template if="audio">\n      <template if="streamtype == \'on-demand\'">\n        <template if="title">\n          <media-control-bar part="control-bar top">{{>TitleDisplay}}</media-control-bar>\n        </template>\n        <media-control-bar part="control-bar bottom">\n          {{>PlayButton}}\n          <template if="breakpointsm"> {{>SeekBackwardButton}} {{>SeekForwardButton}} </template>\n          {{>MuteButton}}\n          <template if="breakpointsm">{{>VolumeRange}}</template>\n          {{>TimeDisplay}} {{>TimeRange}}\n          <template if="breakpointsm">{{>PlaybackRateMenu}}</template>\n          {{>AirplayButton}} {{>CastButton}}\n        </media-control-bar>\n      </template>\n\n      <template if="streamtype == \'live\'">\n        <template if="title">\n          <media-control-bar part="control-bar top">{{>TitleDisplay}}</media-control-bar>\n        </template>\n        <media-control-bar part="control-bar bottom">\n          {{>PlayButton}} {{>LiveButton section="bottom"}} {{>MuteButton}}\n          <template if="breakpointsm">\n            {{>VolumeRange}}\n            <template if="targetlivewindow > 0"> {{>SeekBackwardButton}} {{>SeekForwardButton}} </template>\n          </template>\n          <template if="targetlivewindow > 0"> {{>TimeDisplay}} {{>TimeRange}} </template>\n          <template if="!targetlivewindow"><div class="spacer"></div></template>\n          {{>AirplayButton}} {{>CastButton}}\n        </media-control-bar>\n      </template>\n    </template>\n\n    <slot></slot>\n  </media-controller>\n</template>\n');var TR,_R,SR=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){return(0,m.A)(this,n),t.apply(this,arguments)}return(0,v.A)(n)}(kT);SR.template=null==(_R=null==(TR=kR.content)?void 0:TR.children)?void 0:_R[0],Dw.customElements.get("media-theme-gerwig")||Dw.customElements.define("media-theme-gerwig",SR);var wR={SRC:"src",POSTER:"poster"},RR={STYLE:"style",DEFAULT_HIDDEN_CAPTIONS:"default-hidden-captions",PRIMARY_COLOR:"primary-color",SECONDARY_COLOR:"secondary-color",ACCENT_COLOR:"accent-color",FORWARD_SEEK_OFFSET:"forward-seek-offset",BACKWARD_SEEK_OFFSET:"backward-seek-offset",PLAYBACK_TOKEN:"playback-token",THUMBNAIL_TOKEN:"thumbnail-token",STORYBOARD_TOKEN:"storyboard-token",DRM_TOKEN:"drm-token",STORYBOARD_SRC:"storyboard-src",THUMBNAIL_TIME:"thumbnail-time",AUDIO:"audio",NOHOTKEYS:"nohotkeys",HOTKEYS:"hotkeys",PLAYBACK_RATES:"playbackrates",DEFAULT_SHOW_REMAINING_TIME:"default-show-remaining-time",DEFAULT_DURATION:"default-duration",TITLE:"title",VIDEO_TITLE:"video-title",PLACEHOLDER:"placeholder",THEME:"theme",DEFAULT_STREAM_TYPE:"default-stream-type",TARGET_LIVE_WINDOW:"target-live-window",EXTRA_SOURCE_PARAMS:"extra-source-params",NO_VOLUME_PREF:"no-volume-pref",CAST_RECEIVER:"cast-receiver",NO_TOOLTIPS:"no-tooltips",PROUDLY_DISPLAY_MUX_BADGE:"proudly-display-mux-badge"},LR=["audio","backwardseekoffset","defaultduration","defaultshowremainingtime","defaultsubtitles","noautoseektolive","disabled","exportparts","forwardseekoffset","hideduration","hotkeys","nohotkeys","playbackrates","defaultstreamtype","streamtype","style","targetlivewindow","template","title","videotitle","novolumepref","proudlydisplaymuxbadge"];function IR(e,t){var n,a;return(0,i.A)((0,i.A)({src:!e.playbackId&&e.src,playbackId:e.playbackId,hasSrc:!!e.playbackId||!!e.src||!!e.currentSrc,poster:e.poster,storyboard:e.storyboard,storyboardSrc:e.getAttribute(RR.STORYBOARD_SRC),placeholder:e.getAttribute("placeholder"),themeTemplate:CR(e),thumbnailTime:!e.tokens.thumbnail&&e.thumbnailTime,autoplay:e.autoplay,crossOrigin:e.crossOrigin,loop:e.loop,noHotKeys:e.hasAttribute(RR.NOHOTKEYS),hotKeys:e.getAttribute(RR.HOTKEYS),muted:e.muted,paused:e.paused,preload:e.preload,envKey:e.envKey,preferCmcd:e.preferCmcd,debug:e.debug,disableTracking:e.disableTracking,disableCookies:e.disableCookies,tokens:e.tokens,beaconCollectionDomain:e.beaconCollectionDomain,maxResolution:e.maxResolution,minResolution:e.minResolution,programStartTime:e.programStartTime,programEndTime:e.programEndTime,assetStartTime:e.assetStartTime,assetEndTime:e.assetEndTime,renditionOrder:e.renditionOrder,metadata:e.metadata,playerInitTime:e.playerInitTime,playerSoftwareName:e.playerSoftwareName,playerSoftwareVersion:e.playerSoftwareVersion,startTime:e.startTime,preferPlayback:e.preferPlayback,audio:e.audio,defaultStreamType:e.defaultStreamType,targetLiveWindow:e.getAttribute(hf.TARGET_LIVE_WINDOW),streamType:Hw(e.getAttribute(hf.STREAM_TYPE)),primaryColor:e.getAttribute(RR.PRIMARY_COLOR),secondaryColor:e.getAttribute(RR.SECONDARY_COLOR),accentColor:e.getAttribute(RR.ACCENT_COLOR),forwardSeekOffset:e.forwardSeekOffset,backwardSeekOffset:e.backwardSeekOffset,defaultHiddenCaptions:e.defaultHiddenCaptions,defaultDuration:e.defaultDuration,defaultShowRemainingTime:e.defaultShowRemainingTime,hideDuration:xR(e),playbackRates:e.getAttribute(RR.PLAYBACK_RATES),customDomain:null!=(n=e.getAttribute(hf.CUSTOM_DOMAIN))?n:void 0,title:e.getAttribute(RR.TITLE),videoTitle:null!=(a=e.getAttribute(RR.VIDEO_TITLE))?a:e.getAttribute(RR.TITLE),novolumepref:e.hasAttribute(RR.NO_VOLUME_PREF),proudlyDisplayMuxBadge:e.hasAttribute(RR.PROUDLY_DISPLAY_MUX_BADGE),castReceiver:e.castReceiver},t),{},{extraSourceParams:e.extraSourceParams})}var DR=EA.formatErrorMessage;function CR(e){var t,n,i=e.theme;if(i){var a=null==(n=null==(t=e.getRootNode())?void 0:t.getElementById)?void 0:n.call(t,i);if(a&&a instanceof HTMLTemplateElement)return a;i.startsWith("media-theme-")||(i="media-theme-".concat(i));var r=Dw.customElements.get(i);if(null!=r&&r.template)return r.template}}function xR(e){var t,n=null==(t=e.mediaController)?void 0:t.querySelector("media-time-display");return n&&"none"===getComputedStyle(n).getPropertyValue("--media-duration-display-display").trim()}function MR(e){var t=e.videoTitle?{video_title:e.videoTitle}:{};return e.getAttributeNames().filter((function(e){return e.startsWith("metadata-")})).reduce((function(t,n){var i=e.getAttribute(n);return null!==i&&(t[n.replace(/^metadata-/,"").replace(/-/g,"_")]=i),t}),t)}EA.formatErrorMessage=function(e){var t,n;if(e instanceof Mc){var i=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=ER(e,t).toString(),i=AR(e,t).toString();return{title:n,message:i}}(e,!1);return"\n      ".concat(null!=i&&i.title?"<h3>".concat(i.title,"</h3>"):"","\n      ").concat(null!=i&&i.message||null!=i&&i.linkUrl?"<p>\n        ".concat(null==i?void 0:i.message,"\n        ").concat(null!=i&&i.linkUrl?'<a\n              href="'.concat(i.linkUrl,'"\n              target="_blank"\n              rel="external noopener"\n              aria-label="').concat(null!=(t=i.linkText)?t:""," ").concat(od("(opens in a new window)"),'"\n              >').concat(null!=(n=i.linkText)?n:i.linkUrl,"</a\n            >"):"","\n      </p>"):"","\n    ")}return DR(e)};var OR,PR,NR,UR,FR,BR,HR,GR,KR,WR,VR,qR,YR,jR,zR,XR=Object.values(hf),QR=Object.values(wR),ZR=Object.values(RR),JR=Bw(),$R="mux-player",eL={isDialogOpen:!1},tL={redundant_streams:!0},nL=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){var e;return(0,m.A)(this,n),e=t.call(this),yw((0,Ln.A)(e),HR),yw((0,Ln.A)(e),OR),yw((0,Ln.A)(e),PR,!1),yw((0,Ln.A)(e),NR,{}),yw((0,Ln.A)(e),UR,!0),yw((0,Ln.A)(e),FR,new qw((0,Ln.A)(e),"hotkeys")),yw((0,Ln.A)(e),BR,(0,i.A)((0,i.A)({},eL),{},{onCloseErrorDialog:function(t){var n;"media-error-dialog"===(null==(n=t.composedPath()[0])?void 0:n.localName)&&Aw((0,Ln.A)(e),HR,WR).call((0,Ln.A)(e),{isDialogOpen:!1})},onFocusInErrorDialog:function(t){var n;"media-error-dialog"===(null==(n=t.composedPath()[0])?void 0:n.localName)&&(Nw((0,Ln.A)(e),Cw.activeElement)||t.preventDefault())}})),Ew((0,Ln.A)(e),OR,fh()),e.attachShadow({mode:"open"}),Aw((0,Ln.A)(e),HR,KR).call((0,Ln.A)(e)),e.isConnected&&Aw((0,Ln.A)(e),HR,GR).call((0,Ln.A)(e)),e}return(0,v.A)(n,[{key:"mediaTheme",get:function(){var e;return null==(e=this.shadowRoot)?void 0:e.querySelector("media-theme")}},{key:"mediaController",get:function(){var e,t;return null==(t=null==(e=this.mediaTheme)?void 0:e.shadowRoot)?void 0:t.querySelector("media-controller")}},{key:"connectedCallback",value:function(){var e=this.media;e&&(e.metadata=MR(this))}},{key:"attributeChangedCallback",value:function(e,t,a){switch(Aw(this,HR,GR).call(this),(0,u.A)((0,c.A)(n.prototype),"attributeChangedCallback",this).call(this,e,t,a),e){case RR.HOTKEYS:gw(this,FR).value=a;break;case RR.THUMBNAIL_TIME:null!=a&&this.tokens.thumbnail&&jw(od("Use of thumbnail-time with thumbnail-token is currently unsupported. Ignore thumbnail-time.").toString());break;case RR.THUMBNAIL_TOKEN:if(a){var r=ed(a);if(r){var o=r.aud,l=xd;o!==l&&jw(od("The {tokenNamePrefix}-token has an incorrect aud value: {aud}. aud value should be {expectedAud}.").format({aud:o,expectedAud:l,tokenNamePrefix:"thumbnail"}))}}break;case RR.STORYBOARD_TOKEN:if(a){var d=ed(a);if(d){var h=d.aud,f=Md;h!==f&&jw(od("The {tokenNamePrefix}-token has an incorrect aud value: {aud}. aud value should be {expectedAud}.").format({aud:h,expectedAud:f,tokenNamePrefix:"storyboard"}))}}break;case RR.DRM_TOKEN:if(a){var v=ed(a);if(v){var m=v.aud,p=Od;m!==p&&jw(od("The {tokenNamePrefix}-token has an incorrect aud value: {aud}. aud value should be {expectedAud}.").format({aud:m,expectedAud:p,tokenNamePrefix:"drm"}))}}break;case hf.PLAYBACK_ID:null!=a&&a.includes("?token")&&zw(od("The specificed playback ID {playbackId} contains a token which must be provided via the playback-token attribute.").format({playbackId:a}));break;case hf.STREAM_TYPE:a&&![Nc.LIVE,Nc.ON_DEMAND,Nc.UNKNOWN].includes(a)?["ll-live","live:dvr","ll-live:dvr"].includes(this.streamType)?this.targetLiveWindow=a.includes("dvr")?Number.POSITIVE_INFINITY:0:Xw({file:"invalid-stream-type.md",message:od("Invalid stream-type value supplied: `{streamType}`. Please provide stream-type as either: `on-demand` or `live`").format({streamType:this.streamType})}):a===Nc.LIVE?null==this.getAttribute(RR.TARGET_LIVE_WINDOW)&&(this.targetLiveWindow=0):this.targetLiveWindow=Number.NaN}[hf.PLAYBACK_ID,wR.SRC,RR.PLAYBACK_TOKEN].includes(e)&&t!==a&&Ew(this,BR,(0,i.A)((0,i.A)({},gw(this,BR)),eL)),Aw(this,HR,VR).call(this,(0,s.A)({},function(e){var t;return null!=(t=Gw[e])?t:Mw(e)}(e),a))}},{key:"requestFullscreen",value:function(){var e=(0,d.A)((0,l.A)().mark((function e(t){var n,i=this;return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.mediaController||this.mediaController.hasAttribute(Vv.MEDIA_IS_FULLSCREEN)){e.next=2;break}return e.abrupt("return",(null==(n=this.mediaController)||n.dispatchEvent(new Dw.CustomEvent(Bv.MEDIA_ENTER_FULLSCREEN_REQUEST,{composed:!0,bubbles:!0})),new Promise((function(e,t){var n;null==(n=i.mediaController)||n.addEventListener(qv.MEDIA_IS_FULLSCREEN,(function(){return e()}),{once:!0})}))));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"exitFullscreen",value:function(){var e=(0,d.A)((0,l.A)().mark((function e(){var t,n=this;return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.mediaController||!this.mediaController.hasAttribute(Vv.MEDIA_IS_FULLSCREEN)){e.next=2;break}return e.abrupt("return",(null==(t=this.mediaController)||t.dispatchEvent(new Dw.CustomEvent(Bv.MEDIA_EXIT_FULLSCREEN_REQUEST,{composed:!0,bubbles:!0})),new Promise((function(e,t){var i;null==(i=n.mediaController)||i.addEventListener(qv.MEDIA_IS_FULLSCREEN,(function(){return e()}),{once:!0})}))));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"preferCmcd",get:function(){var e;return null!=(e=this.getAttribute(hf.PREFER_CMCD))?e:void 0},set:function(e){e!==this.preferCmcd&&(e?Hc.includes(e)?this.setAttribute(hf.PREFER_CMCD,e):jw("Invalid value for preferCmcd. Must be one of ".concat(Hc.join())):this.removeAttribute(hf.PREFER_CMCD))}},{key:"hasPlayed",get:function(){var e,t;return null!=(t=null==(e=this.mediaController)?void 0:e.hasAttribute(Vv.MEDIA_HAS_PLAYED))&&t}},{key:"inLiveWindow",get:function(){var e;return null==(e=this.mediaController)?void 0:e.hasAttribute(Vv.MEDIA_TIME_IS_LIVE)}},{key:"_hls",get:function(){var e;return null==(e=this.media)?void 0:e._hls}},{key:"mux",get:function(){var e;return null==(e=this.media)?void 0:e.mux}},{key:"theme",get:function(){var e;return null!=(e=this.getAttribute(RR.THEME))?e:"gerwig"},set:function(e){this.setAttribute(RR.THEME,"".concat(e))}},{key:"themeProps",get:function(){var e=this.mediaTheme;if(e){var t,n={},i=(0,h.A)(e.getAttributeNames());try{for(i.s();!(t=i.n()).done;){var a=t.value;if(!LR.includes(a)){var r=e.getAttribute(a);n[Mw(a)]=""===r||r}}}catch(BL){i.e(BL)}finally{i.f()}return n}},set:function(e){var t,n;Aw(this,HR,GR).call(this);var a=(0,i.A)((0,i.A)({},this.themeProps),e);for(var r in a)if(!LR.includes(r)){var o=null==e?void 0:e[r];"boolean"==typeof o||null==o?null==(t=this.mediaTheme)||t.toggleAttribute(xw(r),!!o):null==(n=this.mediaTheme)||n.setAttribute(xw(r),o)}}},{key:"playbackId",get:function(){var e;return null!=(e=this.getAttribute(hf.PLAYBACK_ID))?e:void 0},set:function(e){e?this.setAttribute(hf.PLAYBACK_ID,e):this.removeAttribute(hf.PLAYBACK_ID)}},{key:"src",get:function(){var e,t;return this.playbackId?null!=(e=iL(this,wR.SRC))?e:void 0:null!=(t=this.getAttribute(wR.SRC))?t:void 0},set:function(e){e?this.setAttribute(wR.SRC,e):this.removeAttribute(wR.SRC)}},{key:"poster",get:function(){var e,t=this.getAttribute(wR.POSTER);if(null!=t)return t;var n=this.tokens;if(!n.playback||n.thumbnail)return this.playbackId&&!this.audio?function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.token,a=n.customDomain,r=void 0===a?Uw:a,o=n.thumbnailTime,s=n.programTime,l=null==i?o:void 0,u=(null!=(t=ed(i))?t:{}).aud;if(!i||"t"===u)return"https://image.".concat(r,"/").concat(e,"/thumbnail.webp").concat(Pw({token:i,time:l,program_time:s}))}(this.playbackId,{customDomain:this.customDomain,thumbnailTime:null!=(e=this.thumbnailTime)?e:this.startTime,programTime:this.programStartTime,token:n.thumbnail}):void 0;jw("Missing expected thumbnail token. No poster image will be shown")},set:function(e){e||""===e?this.setAttribute(wR.POSTER,e):this.removeAttribute(wR.POSTER)}},{key:"storyboardSrc",get:function(){var e;return null!=(e=this.getAttribute(RR.STORYBOARD_SRC))?e:void 0},set:function(e){e?this.setAttribute(RR.STORYBOARD_SRC,e):this.removeAttribute(RR.STORYBOARD_SRC)}},{key:"storyboard",get:function(){var e=this.tokens;return this.storyboardSrc&&!e.storyboard?this.storyboardSrc:this.audio||!this.playbackId||!this.streamType||[Nc.LIVE,Nc.UNKNOWN].includes(this.streamType)||e.playback&&!e.storyboard?void 0:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.token,a=n.customDomain,r=void 0===a?Uw:a,o=n.programStartTime,s=n.programEndTime,l=(null!=(t=ed(i))?t:{}).aud;if(!i||"s"===l)return"https://image.".concat(r,"/").concat(e,"/storyboard.vtt").concat(Pw({token:i,format:"webp",program_start_time:o,program_end_time:s}))}(this.playbackId,{customDomain:this.customDomain,token:e.storyboard,programStartTime:this.programStartTime,programEndTime:this.programEndTime})}},{key:"audio",get:function(){return this.hasAttribute(RR.AUDIO)},set:function(e){e?this.setAttribute(RR.AUDIO,""):this.removeAttribute(RR.AUDIO)}},{key:"hotkeys",get:function(){return gw(this,FR)}},{key:"nohotkeys",get:function(){return this.hasAttribute(RR.NOHOTKEYS)},set:function(e){e?this.setAttribute(RR.NOHOTKEYS,""):this.removeAttribute(RR.NOHOTKEYS)}},{key:"thumbnailTime",get:function(){return Ow(this.getAttribute(RR.THUMBNAIL_TIME))},set:function(e){this.setAttribute(RR.THUMBNAIL_TIME,"".concat(e))}},{key:"videoTitle",get:function(){var e,t;return null!=(t=null!=(e=this.getAttribute(RR.VIDEO_TITLE))?e:this.getAttribute(RR.TITLE))?t:""},set:function(e){e!==this.videoTitle&&(e?this.setAttribute(RR.VIDEO_TITLE,e):this.removeAttribute(RR.VIDEO_TITLE))}},{key:"placeholder",get:function(){var e;return null!=(e=iL(this,RR.PLACEHOLDER))?e:""},set:function(e){this.setAttribute(RR.PLACEHOLDER,"".concat(e))}},{key:"primaryColor",get:function(){var e,t,n=this.getAttribute(RR.PRIMARY_COLOR);if(null!=n||this.mediaTheme&&(n=null==(t=null==(e=Dw.getComputedStyle(this.mediaTheme))?void 0:e.getPropertyValue("--_primary-color"))?void 0:t.trim()))return n},set:function(e){this.setAttribute(RR.PRIMARY_COLOR,"".concat(e))}},{key:"secondaryColor",get:function(){var e,t,n=this.getAttribute(RR.SECONDARY_COLOR);if(null!=n||this.mediaTheme&&(n=null==(t=null==(e=Dw.getComputedStyle(this.mediaTheme))?void 0:e.getPropertyValue("--_secondary-color"))?void 0:t.trim()))return n},set:function(e){this.setAttribute(RR.SECONDARY_COLOR,"".concat(e))}},{key:"accentColor",get:function(){var e,t,n=this.getAttribute(RR.ACCENT_COLOR);if(null!=n||this.mediaTheme&&(n=null==(t=null==(e=Dw.getComputedStyle(this.mediaTheme))?void 0:e.getPropertyValue("--_accent-color"))?void 0:t.trim()))return n},set:function(e){this.setAttribute(RR.ACCENT_COLOR,"".concat(e))}},{key:"defaultShowRemainingTime",get:function(){return this.hasAttribute(RR.DEFAULT_SHOW_REMAINING_TIME)},set:function(e){e?this.setAttribute(RR.DEFAULT_SHOW_REMAINING_TIME,""):this.removeAttribute(RR.DEFAULT_SHOW_REMAINING_TIME)}},{key:"playbackRates",get:function(){if(this.hasAttribute(RR.PLAYBACK_RATES))return this.getAttribute(RR.PLAYBACK_RATES).trim().split(/\s*,?\s+/).map((function(e){return Number(e)})).filter((function(e){return!Number.isNaN(e)})).sort((function(e,t){return e-t}))},set:function(e){e?this.setAttribute(RR.PLAYBACK_RATES,e.join(" ")):this.removeAttribute(RR.PLAYBACK_RATES)}},{key:"forwardSeekOffset",get:function(){var e;return null!=(e=Ow(this.getAttribute(RR.FORWARD_SEEK_OFFSET)))?e:10},set:function(e){this.setAttribute(RR.FORWARD_SEEK_OFFSET,"".concat(e))}},{key:"backwardSeekOffset",get:function(){var e;return null!=(e=Ow(this.getAttribute(RR.BACKWARD_SEEK_OFFSET)))?e:10},set:function(e){this.setAttribute(RR.BACKWARD_SEEK_OFFSET,"".concat(e))}},{key:"defaultHiddenCaptions",get:function(){return this.hasAttribute(RR.DEFAULT_HIDDEN_CAPTIONS)},set:function(e){e?this.setAttribute(RR.DEFAULT_HIDDEN_CAPTIONS,""):this.removeAttribute(RR.DEFAULT_HIDDEN_CAPTIONS)}},{key:"defaultDuration",get:function(){return Ow(this.getAttribute(RR.DEFAULT_DURATION))},set:function(e){null==e?this.removeAttribute(RR.DEFAULT_DURATION):this.setAttribute(RR.DEFAULT_DURATION,"".concat(e))}},{key:"playerInitTime",get:function(){return this.hasAttribute(hf.PLAYER_INIT_TIME)?Ow(this.getAttribute(hf.PLAYER_INIT_TIME)):gw(this,OR)},set:function(e){e!=this.playerInitTime&&(null==e?this.removeAttribute(hf.PLAYER_INIT_TIME):this.setAttribute(hf.PLAYER_INIT_TIME,"".concat(+e)))}},{key:"playerSoftwareName",get:function(){var e;return null!=(e=this.getAttribute(hf.PLAYER_SOFTWARE_NAME))?e:$R}},{key:"playerSoftwareVersion",get:function(){var e;return null!=(e=this.getAttribute(hf.PLAYER_SOFTWARE_VERSION))?e:JR}},{key:"beaconCollectionDomain",get:function(){var e;return null!=(e=this.getAttribute(hf.BEACON_COLLECTION_DOMAIN))?e:void 0},set:function(e){e!==this.beaconCollectionDomain&&(e?this.setAttribute(hf.BEACON_COLLECTION_DOMAIN,e):this.removeAttribute(hf.BEACON_COLLECTION_DOMAIN))}},{key:"maxResolution",get:function(){var e;return null!=(e=this.getAttribute(hf.MAX_RESOLUTION))?e:void 0},set:function(e){e!==this.maxResolution&&(e?this.setAttribute(hf.MAX_RESOLUTION,e):this.removeAttribute(hf.MAX_RESOLUTION))}},{key:"minResolution",get:function(){var e;return null!=(e=this.getAttribute(hf.MIN_RESOLUTION))?e:void 0},set:function(e){e!==this.minResolution&&(e?this.setAttribute(hf.MIN_RESOLUTION,e):this.removeAttribute(hf.MIN_RESOLUTION))}},{key:"renditionOrder",get:function(){var e;return null!=(e=this.getAttribute(hf.RENDITION_ORDER))?e:void 0},set:function(e){e!==this.renditionOrder&&(e?this.setAttribute(hf.RENDITION_ORDER,e):this.removeAttribute(hf.RENDITION_ORDER))}},{key:"programStartTime",get:function(){return Ow(this.getAttribute(hf.PROGRAM_START_TIME))},set:function(e){null==e?this.removeAttribute(hf.PROGRAM_START_TIME):this.setAttribute(hf.PROGRAM_START_TIME,"".concat(e))}},{key:"programEndTime",get:function(){return Ow(this.getAttribute(hf.PROGRAM_END_TIME))},set:function(e){null==e?this.removeAttribute(hf.PROGRAM_END_TIME):this.setAttribute(hf.PROGRAM_END_TIME,"".concat(e))}},{key:"assetStartTime",get:function(){return Ow(this.getAttribute(hf.ASSET_START_TIME))},set:function(e){null==e?this.removeAttribute(hf.ASSET_START_TIME):this.setAttribute(hf.ASSET_START_TIME,"".concat(e))}},{key:"assetEndTime",get:function(){return Ow(this.getAttribute(hf.ASSET_END_TIME))},set:function(e){null==e?this.removeAttribute(hf.ASSET_END_TIME):this.setAttribute(hf.ASSET_END_TIME,"".concat(e))}},{key:"extraSourceParams",get:function(){return this.hasAttribute(RR.EXTRA_SOURCE_PARAMS)?(0,f.A)(new URLSearchParams(this.getAttribute(RR.EXTRA_SOURCE_PARAMS)).entries()).reduce((function(e,t){var n=(0,a.A)(t,2),i=n[0],r=n[1];return e[i]=r,e}),{}):tL},set:function(e){null==e?this.removeAttribute(RR.EXTRA_SOURCE_PARAMS):this.setAttribute(RR.EXTRA_SOURCE_PARAMS,new URLSearchParams(e).toString())}},{key:"customDomain",get:function(){var e;return null!=(e=this.getAttribute(hf.CUSTOM_DOMAIN))?e:void 0},set:function(e){e!==this.customDomain&&(e?this.setAttribute(hf.CUSTOM_DOMAIN,e):this.removeAttribute(hf.CUSTOM_DOMAIN))}},{key:"envKey",get:function(){var e;return null!=(e=iL(this,hf.ENV_KEY))?e:void 0},set:function(e){this.setAttribute(hf.ENV_KEY,"".concat(e))}},{key:"noVolumePref",get:function(){return this.hasAttribute(RR.NO_VOLUME_PREF)},set:function(e){e?this.setAttribute(RR.NO_VOLUME_PREF,""):this.removeAttribute(RR.NO_VOLUME_PREF)}},{key:"debug",get:function(){return null!=iL(this,hf.DEBUG)},set:function(e){e?this.setAttribute(hf.DEBUG,""):this.removeAttribute(hf.DEBUG)}},{key:"disableTracking",get:function(){return null!=iL(this,hf.DISABLE_TRACKING)},set:function(e){this.toggleAttribute(hf.DISABLE_TRACKING,!!e)}},{key:"disableCookies",get:function(){return null!=iL(this,hf.DISABLE_COOKIES)},set:function(e){e?this.setAttribute(hf.DISABLE_COOKIES,""):this.removeAttribute(hf.DISABLE_COOKIES)}},{key:"streamType",get:function(){var e,t,n;return null!=(n=null!=(t=this.getAttribute(hf.STREAM_TYPE))?t:null==(e=this.media)?void 0:e.streamType)?n:Nc.UNKNOWN},set:function(e){this.setAttribute(hf.STREAM_TYPE,"".concat(e))}},{key:"defaultStreamType",get:function(){var e,t,n;return null!=(n=null!=(t=this.getAttribute(RR.DEFAULT_STREAM_TYPE))?t:null==(e=this.mediaController)?void 0:e.getAttribute(RR.DEFAULT_STREAM_TYPE))?n:Nc.ON_DEMAND},set:function(e){e?this.setAttribute(RR.DEFAULT_STREAM_TYPE,e):this.removeAttribute(RR.DEFAULT_STREAM_TYPE)}},{key:"targetLiveWindow",get:function(){var e,t;return this.hasAttribute(RR.TARGET_LIVE_WINDOW)?+this.getAttribute(RR.TARGET_LIVE_WINDOW):null!=(t=null==(e=this.media)?void 0:e.targetLiveWindow)?t:Number.NaN},set:function(e){e==this.targetLiveWindow||Number.isNaN(e)&&Number.isNaN(this.targetLiveWindow)||(null==e?this.removeAttribute(RR.TARGET_LIVE_WINDOW):this.setAttribute(RR.TARGET_LIVE_WINDOW,"".concat(+e)))}},{key:"liveEdgeStart",get:function(){var e;return null==(e=this.media)?void 0:e.liveEdgeStart}},{key:"startTime",get:function(){return Ow(iL(this,hf.START_TIME))},set:function(e){this.setAttribute(hf.START_TIME,"".concat(e))}},{key:"preferPlayback",get:function(){var e=this.getAttribute(hf.PREFER_PLAYBACK);if(e===Uc||e===Fc)return e},set:function(e){e!==this.preferPlayback&&(e===Uc||e===Fc?this.setAttribute(hf.PREFER_PLAYBACK,e):this.removeAttribute(hf.PREFER_PLAYBACK))}},{key:"metadata",get:function(){var e;return null==(e=this.media)?void 0:e.metadata},set:function(e){Aw(this,HR,GR).call(this),this.media?this.media.metadata=(0,i.A)((0,i.A)({},MR(this)),e):zw("underlying media element missing when trying to set metadata. metadata will not be set.")}},{key:"_hlsConfig",get:function(){var e;return null==(e=this.media)?void 0:e._hlsConfig},set:function(e){Aw(this,HR,GR).call(this),this.media?this.media._hlsConfig=e:zw("underlying media element missing when trying to set _hlsConfig. _hlsConfig will not be set.")}},{key:"addCuePoints",value:function(){var e=(0,d.A)((0,l.A)().mark((function e(t){var n;return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Aw(this,HR,GR).call(this),this.media){e.next=3;break}return zw("underlying media element missing when trying to addCuePoints. cuePoints will not be added."),e.abrupt("return");case 3:return e.abrupt("return",null==(n=this.media)?void 0:n.addCuePoints(t));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"activeCuePoint",get:function(){var e;return null==(e=this.media)?void 0:e.activeCuePoint}},{key:"cuePoints",get:function(){var e,t;return null!=(t=null==(e=this.media)?void 0:e.cuePoints)?t:[]}},{key:"addChapters",value:function(e){var t;if(Aw(this,HR,GR).call(this),this.media)return null==(t=this.media)?void 0:t.addChapters(e);zw("underlying media element missing when trying to addChapters. chapters will not be added.")}},{key:"activeChapter",get:function(){var e;return null==(e=this.media)?void 0:e.activeChapter}},{key:"chapters",get:function(){var e,t;return null!=(t=null==(e=this.media)?void 0:e.chapters)?t:[]}},{key:"getStartDate",value:function(){var e;return null==(e=this.media)?void 0:e.getStartDate()}},{key:"currentPdt",get:function(){var e;return null==(e=this.media)?void 0:e.currentPdt}},{key:"tokens",get:function(){var e=this.getAttribute(RR.PLAYBACK_TOKEN),t=this.getAttribute(RR.DRM_TOKEN),n=this.getAttribute(RR.THUMBNAIL_TOKEN),a=this.getAttribute(RR.STORYBOARD_TOKEN);return(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)({},gw(this,NR)),null!=e?{playback:e}:{}),null!=t?{drm:t}:{}),null!=n?{thumbnail:n}:{}),null!=a?{storyboard:a}:{})},set:function(e){Ew(this,NR,null!=e?e:{})}},{key:"playbackToken",get:function(){var e;return null!=(e=this.getAttribute(RR.PLAYBACK_TOKEN))?e:void 0},set:function(e){this.setAttribute(RR.PLAYBACK_TOKEN,"".concat(e))}},{key:"drmToken",get:function(){var e;return null!=(e=this.getAttribute(RR.DRM_TOKEN))?e:void 0},set:function(e){this.setAttribute(RR.DRM_TOKEN,"".concat(e))}},{key:"thumbnailToken",get:function(){var e;return null!=(e=this.getAttribute(RR.THUMBNAIL_TOKEN))?e:void 0},set:function(e){this.setAttribute(RR.THUMBNAIL_TOKEN,"".concat(e))}},{key:"storyboardToken",get:function(){var e;return null!=(e=this.getAttribute(RR.STORYBOARD_TOKEN))?e:void 0},set:function(e){this.setAttribute(RR.STORYBOARD_TOKEN,"".concat(e))}},{key:"addTextTrack",value:function(e,t,n,i){var a,r=null==(a=this.media)?void 0:a.nativeEl;if(r)return fd(r,e,t,n,i)}},{key:"removeTextTrack",value:function(e){var t,n=null==(t=this.media)?void 0:t.nativeEl;if(n)return function(e,t){var n=Array.prototype.find.call(e.querySelectorAll("track"),(function(e){return e.track===t}));null==n||n.remove()}(n,e)}},{key:"textTracks",get:function(){var e;return null==(e=this.media)?void 0:e.textTracks}},{key:"castReceiver",get:function(){var e;return null!=(e=this.getAttribute(RR.CAST_RECEIVER))?e:void 0},set:function(e){e!==this.castReceiver&&(e?this.setAttribute(RR.CAST_RECEIVER,e):this.removeAttribute(RR.CAST_RECEIVER))}},{key:"castCustomData",get:function(){var e;return null==(e=this.media)?void 0:e.castCustomData},set:function(e){this.media?this.media.castCustomData=e:zw("underlying media element missing when trying to set castCustomData. castCustomData will not be set.")}},{key:"noTooltips",get:function(){return this.hasAttribute(RR.NO_TOOLTIPS)},set:function(e){e?this.setAttribute(RR.NO_TOOLTIPS,""):this.removeAttribute(RR.NO_TOOLTIPS)}},{key:"proudlyDisplayMuxBadge",get:function(){return this.hasAttribute(RR.PROUDLY_DISPLAY_MUX_BADGE)},set:function(e){e?this.setAttribute(RR.PROUDLY_DISPLAY_MUX_BADGE,""):this.removeAttribute(RR.PROUDLY_DISPLAY_MUX_BADGE)}}],[{key:"NAME",get:function(){return $R}},{key:"VERSION",get:function(){return JR}},{key:"observedAttributes",get:function(){var e;return[].concat((0,f.A)(null!=(e=aR.observedAttributes)?e:[]),QR,XR,ZR)}}]),n}(aR);function iL(e,t){return e.media?e.media.getAttribute(t):e.getAttribute(t)}OR=new WeakMap,PR=new WeakMap,NR=new WeakMap,UR=new WeakMap,FR=new WeakMap,BR=new WeakMap,HR=new WeakSet,GR=function(){var e,t,n,i,a=this;if(!gw(this,PR)){Ew(this,PR,!0),Aw(this,HR,VR).call(this);try{if(customElements.upgrade(this.mediaTheme),!(this.mediaTheme instanceof Dw.HTMLElement))throw""}catch(r){zw("<media-theme> failed to upgrade!")}try{customElements.upgrade(this.media)}catch(o){zw("underlying media element failed to upgrade!")}try{if(customElements.upgrade(this.mediaController),!(this.mediaController instanceof by))throw""}catch(s){zw("<media-controller> failed to upgrade!")}Aw(this,HR,qR).call(this),Aw(this,HR,YR).call(this),Aw(this,HR,jR).call(this),Ew(this,UR,null==(t=null==(e=this.mediaController)?void 0:e.hasAttribute(wp.USER_INACTIVE))||t),Aw(this,HR,zR).call(this),null==(n=this.media)||n.addEventListener("streamtypechange",(function(){return Aw(a,HR,VR).call(a)})),null==(i=this.media)||i.addEventListener("loadstart",(function(){return Aw(a,HR,VR).call(a)}))}},KR=function(){var e,t;try{null==(e=null==window?void 0:window.CSS)||e.registerProperty({name:"--media-primary-color",syntax:"<color>",inherits:!0}),null==(t=null==window?void 0:window.CSS)||t.registerProperty({name:"--media-secondary-color",syntax:"<color>",inherits:!0})}catch(n){}},WR=function(e){Object.assign(gw(this,BR),e),Aw(this,HR,VR).call(this)},VR=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};vR(mR(IR(this,(0,i.A)((0,i.A)({},gw(this,BR)),e))),this.shadowRoot)},qR=function(){var e=this,t=function(t){var n,i;if(null!=t&&t.startsWith("theme-")){var a=t.replace(/^theme-/,"");if(!LR.includes(a)){var r=e.getAttribute(t);null!=r?null==(n=e.mediaTheme)||n.setAttribute(a,r):null==(i=e.mediaTheme)||i.removeAttribute(a)}}};new MutationObserver((function(e){var n,i=(0,h.A)(e);try{for(i.s();!(n=i.n()).done;){var a=n.value.attributeName;t(a)}}catch(BL){i.e(BL)}finally{i.f()}})).observe(this,{attributes:!0}),this.getAttributeNames().forEach(t)},YR=function(){var e=this;this.addEventListener("error",(function(t){var n,i=null==(n=e.media)?void 0:n.error;if(!(i instanceof Mc)){var a=null!=i?i:{},r=a.message,o=a.code;i=new Mc(r,o)}if(null==i||!i.fatal)return jw(i),void(i.data&&jw("".concat(i.name," data:"),i.data));var s=bR(i);s.message&&Xw(s),zw(i),i.data&&zw("".concat(i.name," data:"),i.data),Aw(e,HR,WR).call(e,{isDialogOpen:!0})})),this.media&&(this.media.errorTranslator=function(){var t,n,i,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!((null==(t=e.media)?void 0:t.error)instanceof Mc))return a;var r=bR(null==(n=e.media)?void 0:n.error);return{player_error_code:null==(i=e.media)?void 0:i.error.code,player_error_message:r.message?String(r.message):a.player_error_message,player_error_context:r.context?String(r.context):a.player_error_context}})},jR=function(){var e,t,n,i,a=this,r=function(){return Aw(a,HR,VR).call(a)};null==(t=null==(e=this.media)?void 0:e.textTracks)||t.addEventListener("addtrack",r),null==(i=null==(n=this.media)?void 0:n.textTracks)||i.addEventListener("removetrack",r)},zR=function(){var e,t,n=this;if(/Firefox/i.test(navigator.userAgent)){var i,a=new WeakMap,r=function(){return n.streamType===Nc.LIVE&&!n.secondaryColor&&n.offsetWidth>=800},o=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r()||Array.from(e&&e.activeCues||[]).forEach((function(e){if(!(!e.snapToLines||e.line<-5||e.line>=0&&e.line<10))if(!t||n.paused){var r=e.text.split("\n").length,o=-3;n.streamType===Nc.LIVE&&(o=-2);var s=o-r;if(e.line===s&&!i)return;a.has(e)||a.set(e,e.line),e.line=s}else setTimeout((function(){e.line=a.get(e)||"auto"}),500)}))},s=function(){var e,t;o(i,null!=(t=null==(e=n.mediaController)?void 0:e.hasAttribute(wp.USER_INACTIVE))&&t)},l=function(){var e,t,a=Array.from((null==(t=null==(e=n.mediaController)?void 0:e.media)?void 0:t.textTracks)||[]).filter((function(e){return["subtitles","captions"].includes(e.kind)&&"showing"===e.mode}))[0];a!==i&&(null==i||i.removeEventListener("cuechange",s)),null==(i=a)||i.addEventListener("cuechange",s),o(i,gw(n,UR))};l(),null==(e=this.textTracks)||e.addEventListener("change",l),null==(t=this.textTracks)||t.addEventListener("addtrack",l),this.addEventListener("userinactivechange",(function(){var e,t,a=null==(t=null==(e=n.mediaController)?void 0:e.hasAttribute(wp.USER_INACTIVE))||t;gw(n,UR)!==a&&(Ew(n,UR,a),o(i,gw(n,UR)))}))}};var aL=nL,rL=function(e){throw TypeError(e)},oL=function(e,t,n){return t.has(e)||rL("Cannot "+n)},sL=function(e,t,n){return t.has(e)?rL("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n)},lL=function(e,t,n,i){return oL(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n},uL=function(){function e(){(0,m.A)(this,e)}return(0,v.A)(e,[{key:"addEventListener",value:function(){}},{key:"removeEventListener",value:function(){}},{key:"dispatchEvent",value:function(e){return!0}}]),e}();if("undefined"==typeof DocumentFragment){var cL=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){return(0,m.A)(this,n),t.apply(this,arguments)}return(0,v.A)(n)}(uL);globalThis.DocumentFragment=cL}var dL,hL=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){return(0,m.A)(this,n),t.apply(this,arguments)}return(0,v.A)(n)}(uL),fL=function(e){(0,p.A)(n,e);var t=(0,g.A)(n);function n(){return(0,m.A)(this,n),t.apply(this,arguments)}return(0,v.A)(n)}(uL),vL={get:function(e){},define:function(e,t,n){},getName:function(e){return null},upgrade:function(e){},whenDefined:function(e){return Promise.resolve(hL)}},mL=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,m.A)(this,e),sL(this,dL),lL(this,dL,null==n?void 0:n.detail)}return(0,v.A)(e,[{key:"detail",get:function(){return function(e,t,n){return oL(e,t,"read from private field"),n?n.call(e):t.get(e)}(this,dL)}},{key:"initCustomEvent",value:function(){}}]),e}();dL=new WeakMap;var pL={document:{createElement:function(e,t){return new hL}},DocumentFragment:DocumentFragment,customElements:vL,CustomEvent:mL,EventTarget:uL,HTMLElement:hL,HTMLVideoElement:fL},gL="undefined"==typeof window||"undefined"==typeof globalThis.customElements,yL=gL?pL:globalThis;gL||globalThis.document;yL.customElements.get("mux-player")||(yL.customElements.define("mux-player",aL),yL.MuxPlayerElement=aL);var EL=["ref"],AL=["children"],bL=["onAbort","onCanPlay","onCanPlayThrough","onEmptied","onLoadStart","onLoadedData","onLoadedMetadata","onProgress","onDurationChange","onVolumeChange","onRateChange","onResize","onWaiting","onPlay","onPlaying","onTimeUpdate","onPause","onSeeking","onSeeked","onStalled","onSuspend","onEnded","onError","onCuePointChange","onChapterChange","metadata","tokens","paused","playbackId","playbackRates","currentTime","themeProps","extraSourceParams","castCustomData","_hlsConfig"],kL=parseInt(o.version)>=19,TL={className:"class",classname:"class",htmlFor:"for",crossOrigin:"crossorigin",viewBox:"viewBox",playsInline:"playsinline",autoPlay:"autoplay",playbackRate:"playbackrate"},_L=function(e,t){if(kL||"boolean"!=typeof t||t){if(function(e,t){return!function(e){return null==e}(t)&&e in t}(e,TL))return TL[e];if("undefined"!=typeof t)return/[A-Z]/.test(e)?function(e){return e.replace(/[A-Z]/g,(function(e){return"-".concat(e.toLowerCase())}))}(e):e}},SL=function(e,t){return kL||"boolean"!=typeof e?e:""};function wL(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function RL(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){var n=!1,i=t.map((function(t){var i=wL(t,e);return!n&&"function"==typeof i&&(n=!0),i}));if(n)return function(){for(var e=0;e<i.length;e++){var n=i[e];"function"==typeof n?n():wL(t[e],null)}}}}var LL=Object.prototype.hasOwnProperty,IL=function(e,t,n){return!function(e,t){if(Object.is(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;if(Array.isArray(e))return!(!Array.isArray(t)||e.length!==t.length)&&e.some((function(e,n){return t[n]===e}));var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(var a=0;a<n.length;a++)if(!LL.call(t,n[a])||!Object.is(e[n[a]],t[n[a]]))return!1;return!0}(t,e[n])},DL=function(e,t,n){e[n]=t},CL=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:DL,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:IL;return(0,o.useEffect)((function(){var r=null==n?void 0:n.current;r&&a(r,t,e)&&i(r,t,e)}),[null==n?void 0:n.current,t])},xL=function(){try{return"3.5.0"}catch(e){}return"UNKNOWN"}(),ML=function(e,t,n){return(0,o.useEffect)((function(){var i=null==t?void 0:t.current;if(i&&n){var a=e,r=n;return i.addEventListener(a,r),function(){i.removeEventListener(a,r)}}}),[null==t?void 0:t.current,n,e])},OL=o.forwardRef((function(e,t){var n=e.children,s=(0,r.A)(e,AL);return o.createElement("mux-player",(0,i.A)((0,i.A)({suppressHydrationWarning:!0},function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(e.ref,(0,r.A)(e,EL));return Object.entries(t).reduce((function(e,t){var n=(0,a.A)(t,2),i=n[0],r=n[1],o=_L(i,r);if(!o)return e;var s=SL(r);return e[o]=s,e}),{})}(s)),{},{ref:t}),n)})),PL=xL,NL="mux-player-react",UL=o.forwardRef((function(e,t){var n,s=(0,o.useRef)(null),l=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return o.useCallback(RL.apply(void 0,t),t)}(s,t),u=function(e,t){var n=t.onAbort,i=t.onCanPlay,a=t.onCanPlayThrough,o=t.onEmptied,s=t.onLoadStart,l=t.onLoadedData,u=t.onLoadedMetadata,c=t.onProgress,d=t.onDurationChange,h=t.onVolumeChange,f=t.onRateChange,v=t.onResize,m=t.onWaiting,p=t.onPlay,g=t.onPlaying,y=t.onTimeUpdate,E=t.onPause,A=t.onSeeking,b=t.onSeeked,k=t.onStalled,T=t.onSuspend,_=t.onEnded,S=t.onError,w=t.onCuePointChange,R=t.onChapterChange,L=t.metadata,I=t.tokens,D=t.paused,C=t.playbackId,x=t.playbackRates,M=t.currentTime,O=t.themeProps,P=t.extraSourceParams,N=t.castCustomData,U=t._hlsConfig,F=(0,r.A)(t,bL);return CL("playbackRates",x,e),CL("metadata",L,e),CL("extraSourceParams",P,e),CL("_hlsConfig",U,e),CL("themeProps",O,e),CL("tokens",I,e),CL("playbackId",C,e),CL("castCustomData",N,e),CL("paused",D,e,(function(e,t){null!=t&&(t?e.pause():e.play())}),(function(e,t,n){return!(e.hasAttribute("autoplay")&&!e.hasPlayed)&&IL(e,t,n)})),CL("currentTime",M,e,(function(e,t){null!=t&&(e.currentTime=t)})),ML("abort",e,n),ML("canplay",e,i),ML("canplaythrough",e,a),ML("emptied",e,o),ML("loadstart",e,s),ML("loadeddata",e,l),ML("loadedmetadata",e,u),ML("progress",e,c),ML("durationchange",e,d),ML("volumechange",e,h),ML("ratechange",e,f),ML("resize",e,v),ML("waiting",e,m),ML("play",e,p),ML("playing",e,g),ML("timeupdate",e,y),ML("pause",e,E),ML("seeking",e,A),ML("seeked",e,b),ML("stalled",e,k),ML("suspend",e,T),ML("ended",e,_),ML("error",e,S),ML("cuepointchange",e,w),ML("chapterchange",e,R),[F]}(s,e),c=(0,a.A)(u,1)[0],d=(0,o.useState)(null!=(n=e.playerInitTime)?n:fh()),h=(0,a.A)(d,1)[0];return o.createElement(OL,(0,i.A)({ref:l,defaultHiddenCaptions:e.defaultHiddenCaptions,playerSoftwareName:NL,playerSoftwareVersion:PL,playerInitTime:h},c))})),FL=UL}}]);
//# sourceMappingURL=reactPlayerMux.d6a5f7fe.chunk.js.map